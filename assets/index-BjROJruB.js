function D_(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in r)){const a=Object.getOwnPropertyDescriptor(n,o);a&&Object.defineProperty(r,o,a.get?a:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();var Gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function L_(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){var o=!1;try{o=this instanceof n}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var o=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return r[n]}})}),t}var Dh={exports:{}},Ea={},Lh={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A0;function O_(){if(A0)return st;A0=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function v(L){return L===null||typeof L!="object"?null:(L=g&&L[g]||L["@@iterator"],typeof L=="function"?L:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function _(L,Q,De){this.props=L,this.context=Q,this.refs=S,this.updater=De||x}_.prototype.isReactComponent={},_.prototype.setState=function(L,Q){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,Q,"setState")},_.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function C(){}C.prototype=_.prototype;function E(L,Q,De){this.props=L,this.context=Q,this.refs=S,this.updater=De||x}var N=E.prototype=new C;N.constructor=E,w(N,_.prototype),N.isPureReactComponent=!0;var M=Array.isArray,A=Object.prototype.hasOwnProperty,K={current:null},Z={key:!0,ref:!0,__self:!0,__source:!0};function W(L,Q,De){var He,rt={},he=null,Ve=null;if(Q!=null)for(He in Q.ref!==void 0&&(Ve=Q.ref),Q.key!==void 0&&(he=""+Q.key),Q)A.call(Q,He)&&!Z.hasOwnProperty(He)&&(rt[He]=Q[He]);var Be=arguments.length-2;if(Be===1)rt.children=De;else if(1<Be){for(var Je=Array(Be),Nt=0;Nt<Be;Nt++)Je[Nt]=arguments[Nt+2];rt.children=Je}if(L&&L.defaultProps)for(He in Be=L.defaultProps,Be)rt[He]===void 0&&(rt[He]=Be[He]);return{$$typeof:r,type:L,key:he,ref:Ve,props:rt,_owner:K.current}}function de(L,Q){return{$$typeof:r,type:L.type,key:Q,ref:L.ref,props:L.props,_owner:L._owner}}function pe(L){return typeof L=="object"&&L!==null&&L.$$typeof===r}function Ee(L){var Q={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(De){return Q[De]})}var ee=/\/+/g;function ye(L,Q){return typeof L=="object"&&L!==null&&L.key!=null?Ee(""+L.key):Q.toString(36)}function G(L,Q,De,He,rt){var he=typeof L;(he==="undefined"||he==="boolean")&&(L=null);var Ve=!1;if(L===null)Ve=!0;else switch(he){case"string":case"number":Ve=!0;break;case"object":switch(L.$$typeof){case r:case e:Ve=!0}}if(Ve)return Ve=L,rt=rt(Ve),L=He===""?"."+ye(Ve,0):He,M(rt)?(De="",L!=null&&(De=L.replace(ee,"$&/")+"/"),G(rt,Q,De,"",function(Nt){return Nt})):rt!=null&&(pe(rt)&&(rt=de(rt,De+(!rt.key||Ve&&Ve.key===rt.key?"":(""+rt.key).replace(ee,"$&/")+"/")+L)),Q.push(rt)),1;if(Ve=0,He=He===""?".":He+":",M(L))for(var Be=0;Be<L.length;Be++){he=L[Be];var Je=He+ye(he,Be);Ve+=G(he,Q,De,Je,rt)}else if(Je=v(L),typeof Je=="function")for(L=Je.call(L),Be=0;!(he=L.next()).done;)he=he.value,Je=He+ye(he,Be++),Ve+=G(he,Q,De,Je,rt);else if(he==="object")throw Q=String(L),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return Ve}function Se(L,Q,De){if(L==null)return L;var He=[],rt=0;return G(L,He,"","",function(he){return Q.call(De,he,rt++)}),He}function Ce(L){if(L._status===-1){var Q=L._result;Q=Q(),Q.then(function(De){(L._status===0||L._status===-1)&&(L._status=1,L._result=De)},function(De){(L._status===0||L._status===-1)&&(L._status=2,L._result=De)}),L._status===-1&&(L._status=0,L._result=Q)}if(L._status===1)return L._result.default;throw L._result}var _e={current:null},te={transition:null},X={ReactCurrentDispatcher:_e,ReactCurrentBatchConfig:te,ReactCurrentOwner:K};function oe(){throw Error("act(...) is not supported in production builds of React.")}return st.Children={map:Se,forEach:function(L,Q,De){Se(L,function(){Q.apply(this,arguments)},De)},count:function(L){var Q=0;return Se(L,function(){Q++}),Q},toArray:function(L){return Se(L,function(Q){return Q})||[]},only:function(L){if(!pe(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},st.Component=_,st.Fragment=t,st.Profiler=o,st.PureComponent=E,st.StrictMode=n,st.Suspense=d,st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,st.act=oe,st.cloneElement=function(L,Q,De){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var He=w({},L.props),rt=L.key,he=L.ref,Ve=L._owner;if(Q!=null){if(Q.ref!==void 0&&(he=Q.ref,Ve=K.current),Q.key!==void 0&&(rt=""+Q.key),L.type&&L.type.defaultProps)var Be=L.type.defaultProps;for(Je in Q)A.call(Q,Je)&&!Z.hasOwnProperty(Je)&&(He[Je]=Q[Je]===void 0&&Be!==void 0?Be[Je]:Q[Je])}var Je=arguments.length-2;if(Je===1)He.children=De;else if(1<Je){Be=Array(Je);for(var Nt=0;Nt<Je;Nt++)Be[Nt]=arguments[Nt+2];He.children=Be}return{$$typeof:r,type:L.type,key:rt,ref:he,props:He,_owner:Ve}},st.createContext=function(L){return L={$$typeof:l,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:a,_context:L},L.Consumer=L},st.createElement=W,st.createFactory=function(L){var Q=W.bind(null,L);return Q.type=L,Q},st.createRef=function(){return{current:null}},st.forwardRef=function(L){return{$$typeof:c,render:L}},st.isValidElement=pe,st.lazy=function(L){return{$$typeof:m,_payload:{_status:-1,_result:L},_init:Ce}},st.memo=function(L,Q){return{$$typeof:h,type:L,compare:Q===void 0?null:Q}},st.startTransition=function(L){var Q=te.transition;te.transition={};try{L()}finally{te.transition=Q}},st.unstable_act=oe,st.useCallback=function(L,Q){return _e.current.useCallback(L,Q)},st.useContext=function(L){return _e.current.useContext(L)},st.useDebugValue=function(){},st.useDeferredValue=function(L){return _e.current.useDeferredValue(L)},st.useEffect=function(L,Q){return _e.current.useEffect(L,Q)},st.useId=function(){return _e.current.useId()},st.useImperativeHandle=function(L,Q,De){return _e.current.useImperativeHandle(L,Q,De)},st.useInsertionEffect=function(L,Q){return _e.current.useInsertionEffect(L,Q)},st.useLayoutEffect=function(L,Q){return _e.current.useLayoutEffect(L,Q)},st.useMemo=function(L,Q){return _e.current.useMemo(L,Q)},st.useReducer=function(L,Q,De){return _e.current.useReducer(L,Q,De)},st.useRef=function(L){return _e.current.useRef(L)},st.useState=function(L){return _e.current.useState(L)},st.useSyncExternalStore=function(L,Q,De){return _e.current.useSyncExternalStore(L,Q,De)},st.useTransition=function(){return _e.current.useTransition()},st.version="18.3.1",st}var j0;function _l(){return j0||(j0=1,Lh.exports=O_()),Lh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R0;function M_(){if(R0)return Ea;R0=1;var r=_l(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,d,h){var m,g={},v=null,x=null;h!==void 0&&(v=""+h),d.key!==void 0&&(v=""+d.key),d.ref!==void 0&&(x=d.ref);for(m in d)n.call(d,m)&&!a.hasOwnProperty(m)&&(g[m]=d[m]);if(c&&c.defaultProps)for(m in d=c.defaultProps,d)g[m]===void 0&&(g[m]=d[m]);return{$$typeof:e,type:c,key:v,ref:x,props:g,_owner:o.current}}return Ea.Fragment=t,Ea.jsx=l,Ea.jsxs=l,Ea}var N0;function $_(){return N0||(N0=1,Dh.exports=M_()),Dh.exports}var p=$_(),j=_l();const Me=Sl(j),U_=D_({__proto__:null,default:Me},[j]);var Kc={},Oh={exports:{}},yr={},Mh={exports:{}},$h={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I0;function F_(){return I0||(I0=1,function(r){function e(te,X){var oe=te.length;te.push(X);e:for(;0<oe;){var L=oe-1>>>1,Q=te[L];if(0<o(Q,X))te[L]=X,te[oe]=Q,oe=L;else break e}}function t(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var X=te[0],oe=te.pop();if(oe!==X){te[0]=oe;e:for(var L=0,Q=te.length,De=Q>>>1;L<De;){var He=2*(L+1)-1,rt=te[He],he=He+1,Ve=te[he];if(0>o(rt,oe))he<Q&&0>o(Ve,rt)?(te[L]=Ve,te[he]=oe,L=he):(te[L]=rt,te[He]=oe,L=He);else if(he<Q&&0>o(Ve,oe))te[L]=Ve,te[he]=oe,L=he;else break e}}return X}function o(te,X){var oe=te.sortIndex-X.sortIndex;return oe!==0?oe:te.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();r.unstable_now=function(){return l.now()-c}}var d=[],h=[],m=1,g=null,v=3,x=!1,w=!1,S=!1,_=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(te){for(var X=t(h);X!==null;){if(X.callback===null)n(h);else if(X.startTime<=te)n(h),X.sortIndex=X.expirationTime,e(d,X);else break;X=t(h)}}function M(te){if(S=!1,N(te),!w)if(t(d)!==null)w=!0,Ce(A);else{var X=t(h);X!==null&&_e(M,X.startTime-te)}}function A(te,X){w=!1,S&&(S=!1,C(W),W=-1),x=!0;var oe=v;try{for(N(X),g=t(d);g!==null&&(!(g.expirationTime>X)||te&&!Ee());){var L=g.callback;if(typeof L=="function"){g.callback=null,v=g.priorityLevel;var Q=L(g.expirationTime<=X);X=r.unstable_now(),typeof Q=="function"?g.callback=Q:g===t(d)&&n(d),N(X)}else n(d);g=t(d)}if(g!==null)var De=!0;else{var He=t(h);He!==null&&_e(M,He.startTime-X),De=!1}return De}finally{g=null,v=oe,x=!1}}var K=!1,Z=null,W=-1,de=5,pe=-1;function Ee(){return!(r.unstable_now()-pe<de)}function ee(){if(Z!==null){var te=r.unstable_now();pe=te;var X=!0;try{X=Z(!0,te)}finally{X?ye():(K=!1,Z=null)}}else K=!1}var ye;if(typeof E=="function")ye=function(){E(ee)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Se=G.port2;G.port1.onmessage=ee,ye=function(){Se.postMessage(null)}}else ye=function(){_(ee,0)};function Ce(te){Z=te,K||(K=!0,ye())}function _e(te,X){W=_(function(){te(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(te){te.callback=null},r.unstable_continueExecution=function(){w||x||(w=!0,Ce(A))},r.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<te?Math.floor(1e3/te):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(te){switch(v){case 1:case 2:case 3:var X=3;break;default:X=v}var oe=v;v=X;try{return te()}finally{v=oe}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(te,X){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var oe=v;v=te;try{return X()}finally{v=oe}},r.unstable_scheduleCallback=function(te,X,oe){var L=r.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?L+oe:L):oe=L,te){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=oe+Q,te={id:m++,callback:X,priorityLevel:te,startTime:oe,expirationTime:Q,sortIndex:-1},oe>L?(te.sortIndex=oe,e(h,te),t(d)===null&&te===t(h)&&(S?(C(W),W=-1):S=!0,_e(M,oe-L))):(te.sortIndex=Q,e(d,te),w||x||(w=!0,Ce(A))),te},r.unstable_shouldYield=Ee,r.unstable_wrapCallback=function(te){var X=v;return function(){var oe=v;v=X;try{return te.apply(this,arguments)}finally{v=oe}}}}($h)),$h}var D0;function z_(){return D0||(D0=1,Mh.exports=F_()),Mh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L0;function V_(){if(L0)return yr;L0=1;var r=_l(),e=z_();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,o={};function a(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(o[s]=i,s=0;s<i.length;s++)n.add(i[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},g={};function v(s){return d.call(g,s)?!0:d.call(m,s)?!1:h.test(s)?g[s]=!0:(m[s]=!0,!1)}function x(s,i,u,f){if(u!==null&&u.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function w(s,i,u,f){if(i===null||typeof i>"u"||x(s,i,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function S(s,i,u,f,y,b,k){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=u,this.propertyName=s,this.type=i,this.sanitizeURL=b,this.removeEmptyString=k}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){_[s]=new S(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];_[i]=new S(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){_[s]=new S(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){_[s]=new S(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){_[s]=new S(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){_[s]=new S(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){_[s]=new S(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){_[s]=new S(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){_[s]=new S(s,5,!1,s.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function E(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(C,E);_[i]=new S(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(C,E);_[i]=new S(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(C,E);_[i]=new S(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){_[s]=new S(s,1,!1,s.toLowerCase(),null,!1,!1)}),_.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){_[s]=new S(s,1,!1,s.toLowerCase(),null,!0,!0)});function N(s,i,u,f){var y=_.hasOwnProperty(i)?_[i]:null;(y!==null?y.type!==0:f||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(w(i,u,y,f)&&(u=null),f||y===null?v(i)&&(u===null?s.removeAttribute(i):s.setAttribute(i,""+u)):y.mustUseProperty?s[y.propertyName]=u===null?y.type===3?!1:"":u:(i=y.attributeName,f=y.attributeNamespace,u===null?s.removeAttribute(i):(y=y.type,u=y===3||y===4&&u===!0?"":""+u,f?s.setAttributeNS(f,i,u):s.setAttribute(i,u))))}var M=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),K=Symbol.for("react.portal"),Z=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),de=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),Ee=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),ye=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),te=Symbol.iterator;function X(s){return s===null||typeof s!="object"?null:(s=te&&s[te]||s["@@iterator"],typeof s=="function"?s:null)}var oe=Object.assign,L;function Q(s){if(L===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);L=i&&i[1]||""}return`
`+L+s}var De=!1;function He(s,i){if(!s||De)return"";De=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(H){var f=H}Reflect.construct(s,[],i)}else{try{i.call()}catch(H){f=H}s.call(i.prototype)}else{try{throw Error()}catch(H){f=H}s()}}catch(H){if(H&&f&&typeof H.stack=="string"){for(var y=H.stack.split(`
`),b=f.stack.split(`
`),k=y.length-1,R=b.length-1;1<=k&&0<=R&&y[k]!==b[R];)R--;for(;1<=k&&0<=R;k--,R--)if(y[k]!==b[R]){if(k!==1||R!==1)do if(k--,R--,0>R||y[k]!==b[R]){var O=`
`+y[k].replace(" at new "," at ");return s.displayName&&O.includes("<anonymous>")&&(O=O.replace("<anonymous>",s.displayName)),O}while(1<=k&&0<=R);break}}}finally{De=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?Q(s):""}function rt(s){switch(s.tag){case 5:return Q(s.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return s=He(s.type,!1),s;case 11:return s=He(s.type.render,!1),s;case 1:return s=He(s.type,!0),s;default:return""}}function he(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Z:return"Fragment";case K:return"Portal";case de:return"Profiler";case W:return"StrictMode";case ye:return"Suspense";case G:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ee:return(s.displayName||"Context")+".Consumer";case pe:return(s._context.displayName||"Context")+".Provider";case ee:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Se:return i=s.displayName||null,i!==null?i:he(s.type)||"Memo";case Ce:i=s._payload,s=s._init;try{return he(s(i))}catch{}}return null}function Ve(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(i);case 8:return i===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Be(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Je(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Nt(s){var i=Je(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),f=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,b=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return y.call(this)},set:function(k){f=""+k,b.call(this,k)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(k){f=""+k},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Rr(s){s._valueTracker||(s._valueTracker=Nt(s))}function sr(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),f="";return s&&(f=Je(s)?s.checked?"true":"false":s.value),s=f,s!==u?(i.setValue(s),!0):!1}function Nr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function ts(s,i){var u=i.checked;return oe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function xr(s,i){var u=i.defaultValue==null?"":i.defaultValue,f=i.checked!=null?i.checked:i.defaultChecked;u=Be(i.value!=null?i.value:u),s._wrapperState={initialChecked:f,initialValue:u,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Hs(s,i){i=i.checked,i!=null&&N(s,"checked",i,!1)}function kn(s,i){Hs(s,i);var u=Be(i.value),f=i.type;if(u!=null)f==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?En(s,i.type,u):i.hasOwnProperty("defaultValue")&&En(s,i.type,Be(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function Cn(s,i,u){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var f=i.type;if(!(f!=="submit"&&f!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,u||i===s.value||(s.value=i),s.defaultValue=i}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function En(s,i,u){(i!=="number"||Nr(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var on=Array.isArray;function br(s,i,u,f){if(s=s.options,i){i={};for(var y=0;y<u.length;y++)i["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=i.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&f&&(s[u].defaultSelected=!0)}else{for(u=""+Be(u),i=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,f&&(s[y].defaultSelected=!0);return}i!==null||s[y].disabled||(i=s[y])}i!==null&&(i.selected=!0)}}function I(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return oe({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function q(s,i){var u=i.value;if(u==null){if(u=i.children,i=i.defaultValue,u!=null){if(i!=null)throw Error(t(92));if(on(u)){if(1<u.length)throw Error(t(93));u=u[0]}i=u}i==null&&(i=""),u=i}s._wrapperState={initialValue:Be(u)}}function J(s,i){var u=Be(i.value),f=Be(i.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),i.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),f!=null&&(s.defaultValue=""+f)}function xe(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function ge(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?ge(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var be,nt=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,u,f,y){MSApp.execUnsafeLocalFunction(function(){return s(i,u,f,y)})}:s}(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(be=be||document.createElement("div"),be.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=be.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function ht(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Co=["Webkit","ms","Moz","O"];Object.keys(yt).forEach(function(s){Co.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),yt[i]=yt[s]})});function Pn(s,i,u){return i==null||typeof i=="boolean"||i===""?"":u||typeof i!="number"||i===0||yt.hasOwnProperty(s)&&yt[s]?(""+i).trim():i+"px"}function an(s,i){s=s.style;for(var u in i)if(i.hasOwnProperty(u)){var f=u.indexOf("--")===0,y=Pn(u,i[u],f);u==="float"&&(u="cssFloat"),f?s.setProperty(u,y):s[u]=y}}var Vi=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rs(s,i){if(i){if(Vi[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Tn(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var An=null;function Bi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ir=null,ns=null,ss=null;function qi(s){if(s=da(s)){if(typeof Ir!="function")throw Error(t(280));var i=s.stateNode;i&&(i=lc(i),Ir(s.stateNode,s.type,i))}}function Rl(s){ns?ss?ss.push(s):ss=[s]:ns=s}function Nl(){if(ns){var s=ns,i=ss;if(ss=ns=null,qi(s),i)for(s=0;s<i.length;s++)qi(i[s])}}function Il(s,i){return s(i)}function Dl(){}var Hi=!1;function Ll(s,i,u){if(Hi)return s(i,u);Hi=!0;try{return Il(s,i,u)}finally{Hi=!1,(ns!==null||ss!==null)&&(Dl(),Nl())}}function Ws(s,i){var u=s.stateNode;if(u===null)return null;var f=lc(u);if(f===null)return null;u=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,i,typeof u));return u}var Wi=!1;if(c)try{var Gs={};Object.defineProperty(Gs,"passive",{get:function(){Wi=!0}}),window.addEventListener("test",Gs,Gs),window.removeEventListener("test",Gs,Gs)}catch{Wi=!1}function Xu(s,i,u,f,y,b,k,R,O){var H=Array.prototype.slice.call(arguments,3);try{i.apply(u,H)}catch(ne){this.onError(ne)}}var os=!1,Eo=null,Po=!1,Gi=null,ed={onError:function(s){os=!0,Eo=s}};function td(s,i,u,f,y,b,k,R,O){os=!1,Eo=null,Xu.apply(ed,arguments)}function rd(s,i,u,f,y,b,k,R,O){if(td.apply(this,arguments),os){if(os){var H=Eo;os=!1,Eo=null}else throw Error(t(198));Po||(Po=!0,Gi=H)}}function jn(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function Ol(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Ml(s){if(jn(s)!==s)throw Error(t(188))}function nd(s){var i=s.alternate;if(!i){if(i=jn(s),i===null)throw Error(t(188));return i!==s?null:s}for(var u=s,f=i;;){var y=u.return;if(y===null)break;var b=y.alternate;if(b===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===u)return Ml(y),s;if(b===f)return Ml(y),i;b=b.sibling}throw Error(t(188))}if(u.return!==f.return)u=y,f=b;else{for(var k=!1,R=y.child;R;){if(R===u){k=!0,u=y,f=b;break}if(R===f){k=!0,f=y,u=b;break}R=R.sibling}if(!k){for(R=b.child;R;){if(R===u){k=!0,u=b,f=y;break}if(R===f){k=!0,f=b,u=y;break}R=R.sibling}if(!k)throw Error(t(189))}}if(u.alternate!==f)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:i}function $l(s){return s=nd(s),s!==null?Ul(s):null}function Ul(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Ul(s);if(i!==null)return i;s=s.sibling}return null}var Fl=e.unstable_scheduleCallback,zl=e.unstable_cancelCallback,sd=e.unstable_shouldYield,Vl=e.unstable_requestPaint,pt=e.unstable_now,Bl=e.unstable_getCurrentPriorityLevel,ln=e.unstable_ImmediatePriority,ql=e.unstable_UserBlockingPriority,Rn=e.unstable_NormalPriority,Ki=e.unstable_LowPriority,Hl=e.unstable_IdlePriority,To=null,dr=null;function od(s){if(dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(To,s,void 0,(s.current.flags&128)===128)}catch{}}var wr=Math.clz32?Math.clz32:T,P=Math.log,D=Math.LN2;function T(s){return s>>>=0,s===0?32:31-(P(s)/D|0)|0}var F=64,z=4194304;function $(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Y(s,i){var u=s.pendingLanes;if(u===0)return 0;var f=0,y=s.suspendedLanes,b=s.pingedLanes,k=u&268435455;if(k!==0){var R=k&~y;R!==0?f=$(R):(b&=k,b!==0&&(f=$(b)))}else k=u&~y,k!==0?f=$(k):b!==0&&(f=$(b));if(f===0)return 0;if(i!==0&&i!==f&&(i&y)===0&&(y=f&-f,b=i&-i,y>=b||y===16&&(b&4194240)!==0))return i;if((f&4)!==0&&(f|=u&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=f;0<i;)u=31-wr(i),y=1<<u,f|=s[u],i&=~y;return f}function se(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ue(s,i){for(var u=s.suspendedLanes,f=s.pingedLanes,y=s.expirationTimes,b=s.pendingLanes;0<b;){var k=31-wr(b),R=1<<k,O=y[k];O===-1?((R&u)===0||(R&f)!==0)&&(y[k]=se(R,i)):O<=i&&(s.expiredLanes|=R),b&=~R}}function ce(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function me(){var s=F;return F<<=1,(F&4194240)===0&&(F=64),s}function Te(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function Ze(s,i,u){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-wr(i),s[i]=u}function ut(s,i){var u=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<u;){var y=31-wr(u),b=1<<y;i[y]=0,f[y]=-1,s[y]=-1,u&=~b}}function at(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var f=31-wr(u),y=1<<f;y&i|s[f]&i&&(s[f]|=i),u&=~y}}var Fe=0;function St(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var or,Nn,Ao,Wl,jo,Gl=!1,Ro=[],cn=null,qr=null,is=null,Zi=new Map,Ji=new Map,as=[],rS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hm(s,i){switch(s){case"focusin":case"focusout":cn=null;break;case"dragenter":case"dragleave":qr=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":Zi.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ji.delete(i.pointerId)}}function Qi(s,i,u,f,y,b){return s===null||s.nativeEvent!==b?(s={blockedOn:i,domEventName:u,eventSystemFlags:f,nativeEvent:b,targetContainers:[y]},i!==null&&(i=da(i),i!==null&&Nn(i)),s):(s.eventSystemFlags|=f,i=s.targetContainers,y!==null&&i.indexOf(y)===-1&&i.push(y),s)}function nS(s,i,u,f,y){switch(i){case"focusin":return cn=Qi(cn,s,i,u,f,y),!0;case"dragenter":return qr=Qi(qr,s,i,u,f,y),!0;case"mouseover":return is=Qi(is,s,i,u,f,y),!0;case"pointerover":var b=y.pointerId;return Zi.set(b,Qi(Zi.get(b)||null,s,i,u,f,y)),!0;case"gotpointercapture":return b=y.pointerId,Ji.set(b,Qi(Ji.get(b)||null,s,i,u,f,y)),!0}return!1}function fm(s){var i=Ks(s.target);if(i!==null){var u=jn(i);if(u!==null){if(i=u.tag,i===13){if(i=Ol(u),i!==null){s.blockedOn=i,jo(s.priority,function(){Ao(u)});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Kl(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=ad(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var f=new u.constructor(u.type,u);An=f,u.target.dispatchEvent(f),An=null}else return i=da(u),i!==null&&Nn(i),s.blockedOn=u,!1;i.shift()}return!0}function pm(s,i,u){Kl(s)&&u.delete(i)}function sS(){Gl=!1,cn!==null&&Kl(cn)&&(cn=null),qr!==null&&Kl(qr)&&(qr=null),is!==null&&Kl(is)&&(is=null),Zi.forEach(pm),Ji.forEach(pm)}function Yi(s,i){s.blockedOn===i&&(s.blockedOn=null,Gl||(Gl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sS)))}function Xi(s){function i(y){return Yi(y,s)}if(0<Ro.length){Yi(Ro[0],s);for(var u=1;u<Ro.length;u++){var f=Ro[u];f.blockedOn===s&&(f.blockedOn=null)}}for(cn!==null&&Yi(cn,s),qr!==null&&Yi(qr,s),is!==null&&Yi(is,s),Zi.forEach(i),Ji.forEach(i),u=0;u<as.length;u++)f=as[u],f.blockedOn===s&&(f.blockedOn=null);for(;0<as.length&&(u=as[0],u.blockedOn===null);)fm(u),u.blockedOn===null&&as.shift()}var No=M.ReactCurrentBatchConfig,Zl=!0;function oS(s,i,u,f){var y=Fe,b=No.transition;No.transition=null;try{Fe=1,id(s,i,u,f)}finally{Fe=y,No.transition=b}}function iS(s,i,u,f){var y=Fe,b=No.transition;No.transition=null;try{Fe=4,id(s,i,u,f)}finally{Fe=y,No.transition=b}}function id(s,i,u,f){if(Zl){var y=ad(s,i,u,f);if(y===null)kd(s,i,f,Jl,u),hm(s,f);else if(nS(y,s,i,u,f))f.stopPropagation();else if(hm(s,f),i&4&&-1<rS.indexOf(s)){for(;y!==null;){var b=da(y);if(b!==null&&or(b),b=ad(s,i,u,f),b===null&&kd(s,i,f,Jl,u),b===y)break;y=b}y!==null&&f.stopPropagation()}else kd(s,i,f,null,u)}}var Jl=null;function ad(s,i,u,f){if(Jl=null,s=Bi(f),s=Ks(s),s!==null)if(i=jn(s),i===null)s=null;else if(u=i.tag,u===13){if(s=Ol(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Jl=s,null}function mm(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bl()){case ln:return 1;case ql:return 4;case Rn:case Ki:return 16;case Hl:return 536870912;default:return 16}default:return 16}}var ls=null,ld=null,Ql=null;function gm(){if(Ql)return Ql;var s,i=ld,u=i.length,f,y="value"in ls?ls.value:ls.textContent,b=y.length;for(s=0;s<u&&i[s]===y[s];s++);var k=u-s;for(f=1;f<=k&&i[u-f]===y[b-f];f++);return Ql=y.slice(s,1<f?1-f:void 0)}function Yl(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Xl(){return!0}function ym(){return!1}function Sr(s){function i(u,f,y,b,k){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=b,this.target=k,this.currentTarget=null;for(var R in s)s.hasOwnProperty(R)&&(u=s[R],this[R]=u?u(b):b[R]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Xl:ym,this.isPropagationStopped=ym,this}return oe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Xl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Xl)},persist:function(){},isPersistent:Xl}),i}var Io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cd=Sr(Io),ea=oe({},Io,{view:0,detail:0}),aS=Sr(ea),ud,dd,ta,ec=oe({},ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ta&&(ta&&s.type==="mousemove"?(ud=s.screenX-ta.screenX,dd=s.screenY-ta.screenY):dd=ud=0,ta=s),ud)},movementY:function(s){return"movementY"in s?s.movementY:dd}}),vm=Sr(ec),lS=oe({},ec,{dataTransfer:0}),cS=Sr(lS),uS=oe({},ea,{relatedTarget:0}),hd=Sr(uS),dS=oe({},Io,{animationName:0,elapsedTime:0,pseudoElement:0}),hS=Sr(dS),fS=oe({},Io,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),pS=Sr(fS),mS=oe({},Io,{data:0}),xm=Sr(mS),gS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xS(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=vS[s])?!!i[s]:!1}function fd(){return xS}var bS=oe({},ea,{key:function(s){if(s.key){var i=gS[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Yl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?yS[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fd,charCode:function(s){return s.type==="keypress"?Yl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Yl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),wS=Sr(bS),SS=oe({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bm=Sr(SS),_S=oe({},ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fd}),kS=Sr(_S),CS=oe({},Io,{propertyName:0,elapsedTime:0,pseudoElement:0}),ES=Sr(CS),PS=oe({},ec,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),TS=Sr(PS),AS=[9,13,27,32],pd=c&&"CompositionEvent"in window,ra=null;c&&"documentMode"in document&&(ra=document.documentMode);var jS=c&&"TextEvent"in window&&!ra,wm=c&&(!pd||ra&&8<ra&&11>=ra),Sm=" ",_m=!1;function km(s,i){switch(s){case"keyup":return AS.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cm(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Do=!1;function RS(s,i){switch(s){case"compositionend":return Cm(i);case"keypress":return i.which!==32?null:(_m=!0,Sm);case"textInput":return s=i.data,s===Sm&&_m?null:s;default:return null}}function NS(s,i){if(Do)return s==="compositionend"||!pd&&km(s,i)?(s=gm(),Ql=ld=ls=null,Do=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return wm&&i.locale!=="ko"?null:i.data;default:return null}}var IS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!IS[s.type]:i==="textarea"}function Pm(s,i,u,f){Rl(f),i=oc(i,"onChange"),0<i.length&&(u=new cd("onChange","change",null,u,f),s.push({event:u,listeners:i}))}var na=null,sa=null;function DS(s){Hm(s,0)}function tc(s){var i=Uo(s);if(sr(i))return s}function LS(s,i){if(s==="change")return i}var Tm=!1;if(c){var md;if(c){var gd="oninput"in document;if(!gd){var Am=document.createElement("div");Am.setAttribute("oninput","return;"),gd=typeof Am.oninput=="function"}md=gd}else md=!1;Tm=md&&(!document.documentMode||9<document.documentMode)}function jm(){na&&(na.detachEvent("onpropertychange",Rm),sa=na=null)}function Rm(s){if(s.propertyName==="value"&&tc(sa)){var i=[];Pm(i,sa,s,Bi(s)),Ll(DS,i)}}function OS(s,i,u){s==="focusin"?(jm(),na=i,sa=u,na.attachEvent("onpropertychange",Rm)):s==="focusout"&&jm()}function MS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return tc(sa)}function $S(s,i){if(s==="click")return tc(i)}function US(s,i){if(s==="input"||s==="change")return tc(i)}function FS(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Hr=typeof Object.is=="function"?Object.is:FS;function oa(s,i){if(Hr(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),f=Object.keys(i);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!d.call(i,y)||!Hr(s[y],i[y]))return!1}return!0}function Nm(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Im(s,i){var u=Nm(s);s=0;for(var f;u;){if(u.nodeType===3){if(f=s+u.textContent.length,s<=i&&f>=i)return{node:u,offset:i-s};s=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Nm(u)}}function Dm(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Dm(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Lm(){for(var s=window,i=Nr();i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Nr(s.document)}return i}function yd(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function zS(s){var i=Lm(),u=s.focusedElem,f=s.selectionRange;if(i!==u&&u&&u.ownerDocument&&Dm(u.ownerDocument.documentElement,u)){if(f!==null&&yd(u)){if(i=f.start,s=f.end,s===void 0&&(s=i),"selectionStart"in u)u.selectionStart=i,u.selectionEnd=Math.min(s,u.value.length);else if(s=(i=u.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var y=u.textContent.length,b=Math.min(f.start,y);f=f.end===void 0?b:Math.min(f.end,y),!s.extend&&b>f&&(y=f,f=b,b=y),y=Im(u,b);var k=Im(u,f);y&&k&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==k.node||s.focusOffset!==k.offset)&&(i=i.createRange(),i.setStart(y.node,y.offset),s.removeAllRanges(),b>f?(s.addRange(i),s.extend(k.node,k.offset)):(i.setEnd(k.node,k.offset),s.addRange(i)))}}for(i=[],s=u;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<i.length;u++)s=i[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var VS=c&&"documentMode"in document&&11>=document.documentMode,Lo=null,vd=null,ia=null,xd=!1;function Om(s,i,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;xd||Lo==null||Lo!==Nr(f)||(f=Lo,"selectionStart"in f&&yd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ia&&oa(ia,f)||(ia=f,f=oc(vd,"onSelect"),0<f.length&&(i=new cd("onSelect","select",null,i,u),s.push({event:i,listeners:f}),i.target=Lo)))}function rc(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var Oo={animationend:rc("Animation","AnimationEnd"),animationiteration:rc("Animation","AnimationIteration"),animationstart:rc("Animation","AnimationStart"),transitionend:rc("Transition","TransitionEnd")},bd={},Mm={};c&&(Mm=document.createElement("div").style,"AnimationEvent"in window||(delete Oo.animationend.animation,delete Oo.animationiteration.animation,delete Oo.animationstart.animation),"TransitionEvent"in window||delete Oo.transitionend.transition);function nc(s){if(bd[s])return bd[s];if(!Oo[s])return s;var i=Oo[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in Mm)return bd[s]=i[u];return s}var $m=nc("animationend"),Um=nc("animationiteration"),Fm=nc("animationstart"),zm=nc("transitionend"),Vm=new Map,Bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(s,i){Vm.set(s,i),a(i,[s])}for(var wd=0;wd<Bm.length;wd++){var Sd=Bm[wd],BS=Sd.toLowerCase(),qS=Sd[0].toUpperCase()+Sd.slice(1);cs(BS,"on"+qS)}cs($m,"onAnimationEnd"),cs(Um,"onAnimationIteration"),cs(Fm,"onAnimationStart"),cs("dblclick","onDoubleClick"),cs("focusin","onFocus"),cs("focusout","onBlur"),cs(zm,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var aa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HS=new Set("cancel close invalid load scroll toggle".split(" ").concat(aa));function qm(s,i,u){var f=s.type||"unknown-event";s.currentTarget=u,rd(f,i,void 0,s),s.currentTarget=null}function Hm(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var f=s[u],y=f.event;f=f.listeners;e:{var b=void 0;if(i)for(var k=f.length-1;0<=k;k--){var R=f[k],O=R.instance,H=R.currentTarget;if(R=R.listener,O!==b&&y.isPropagationStopped())break e;qm(y,R,H),b=O}else for(k=0;k<f.length;k++){if(R=f[k],O=R.instance,H=R.currentTarget,R=R.listener,O!==b&&y.isPropagationStopped())break e;qm(y,R,H),b=O}}}if(Po)throw s=Gi,Po=!1,Gi=null,s}function vt(s,i){var u=i[jd];u===void 0&&(u=i[jd]=new Set);var f=s+"__bubble";u.has(f)||(Wm(i,s,2,!1),u.add(f))}function _d(s,i,u){var f=0;i&&(f|=4),Wm(u,s,f,i)}var sc="_reactListening"+Math.random().toString(36).slice(2);function la(s){if(!s[sc]){s[sc]=!0,n.forEach(function(u){u!=="selectionchange"&&(HS.has(u)||_d(u,!1,s),_d(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[sc]||(i[sc]=!0,_d("selectionchange",!1,i))}}function Wm(s,i,u,f){switch(mm(i)){case 1:var y=oS;break;case 4:y=iS;break;default:y=id}u=y.bind(null,i,u,s),y=void 0,!Wi||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(y=!0),f?y!==void 0?s.addEventListener(i,u,{capture:!0,passive:y}):s.addEventListener(i,u,!0):y!==void 0?s.addEventListener(i,u,{passive:y}):s.addEventListener(i,u,!1)}function kd(s,i,u,f,y){var b=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var k=f.tag;if(k===3||k===4){var R=f.stateNode.containerInfo;if(R===y||R.nodeType===8&&R.parentNode===y)break;if(k===4)for(k=f.return;k!==null;){var O=k.tag;if((O===3||O===4)&&(O=k.stateNode.containerInfo,O===y||O.nodeType===8&&O.parentNode===y))return;k=k.return}for(;R!==null;){if(k=Ks(R),k===null)return;if(O=k.tag,O===5||O===6){f=b=k;continue e}R=R.parentNode}}f=f.return}Ll(function(){var H=b,ne=Bi(u),ie=[];e:{var re=Vm.get(s);if(re!==void 0){var we=cd,Ae=s;switch(s){case"keypress":if(Yl(u)===0)break e;case"keydown":case"keyup":we=wS;break;case"focusin":Ae="focus",we=hd;break;case"focusout":Ae="blur",we=hd;break;case"beforeblur":case"afterblur":we=hd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=vm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=cS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=kS;break;case $m:case Um:case Fm:we=hS;break;case zm:we=ES;break;case"scroll":we=aS;break;case"wheel":we=TS;break;case"copy":case"cut":case"paste":we=pS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=bm}var Re=(i&4)!==0,It=!Re&&s==="scroll",V=Re?re!==null?re+"Capture":null:re;Re=[];for(var U=H,B;U!==null;){B=U;var fe=B.stateNode;if(B.tag===5&&fe!==null&&(B=fe,V!==null&&(fe=Ws(U,V),fe!=null&&Re.push(ca(U,fe,B)))),It)break;U=U.return}0<Re.length&&(re=new we(re,Ae,null,u,ne),ie.push({event:re,listeners:Re}))}}if((i&7)===0){e:{if(re=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",re&&u!==An&&(Ae=u.relatedTarget||u.fromElement)&&(Ks(Ae)||Ae[In]))break e;if((we||re)&&(re=ne.window===ne?ne:(re=ne.ownerDocument)?re.defaultView||re.parentWindow:window,we?(Ae=u.relatedTarget||u.toElement,we=H,Ae=Ae?Ks(Ae):null,Ae!==null&&(It=jn(Ae),Ae!==It||Ae.tag!==5&&Ae.tag!==6)&&(Ae=null)):(we=null,Ae=H),we!==Ae)){if(Re=vm,fe="onMouseLeave",V="onMouseEnter",U="mouse",(s==="pointerout"||s==="pointerover")&&(Re=bm,fe="onPointerLeave",V="onPointerEnter",U="pointer"),It=we==null?re:Uo(we),B=Ae==null?re:Uo(Ae),re=new Re(fe,U+"leave",we,u,ne),re.target=It,re.relatedTarget=B,fe=null,Ks(ne)===H&&(Re=new Re(V,U+"enter",Ae,u,ne),Re.target=B,Re.relatedTarget=It,fe=Re),It=fe,we&&Ae)t:{for(Re=we,V=Ae,U=0,B=Re;B;B=Mo(B))U++;for(B=0,fe=V;fe;fe=Mo(fe))B++;for(;0<U-B;)Re=Mo(Re),U--;for(;0<B-U;)V=Mo(V),B--;for(;U--;){if(Re===V||V!==null&&Re===V.alternate)break t;Re=Mo(Re),V=Mo(V)}Re=null}else Re=null;we!==null&&Gm(ie,re,we,Re,!1),Ae!==null&&It!==null&&Gm(ie,It,Ae,Re,!0)}}e:{if(re=H?Uo(H):window,we=re.nodeName&&re.nodeName.toLowerCase(),we==="select"||we==="input"&&re.type==="file")var Ne=LS;else if(Em(re))if(Tm)Ne=US;else{Ne=MS;var $e=OS}else(we=re.nodeName)&&we.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Ne=$S);if(Ne&&(Ne=Ne(s,H))){Pm(ie,Ne,u,ne);break e}$e&&$e(s,re,H),s==="focusout"&&($e=re._wrapperState)&&$e.controlled&&re.type==="number"&&En(re,"number",re.value)}switch($e=H?Uo(H):window,s){case"focusin":(Em($e)||$e.contentEditable==="true")&&(Lo=$e,vd=H,ia=null);break;case"focusout":ia=vd=Lo=null;break;case"mousedown":xd=!0;break;case"contextmenu":case"mouseup":case"dragend":xd=!1,Om(ie,u,ne);break;case"selectionchange":if(VS)break;case"keydown":case"keyup":Om(ie,u,ne)}var Ue;if(pd)e:{switch(s){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Do?km(s,u)&&(Ge="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ge="onCompositionStart");Ge&&(wm&&u.locale!=="ko"&&(Do||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Do&&(Ue=gm()):(ls=ne,ld="value"in ls?ls.value:ls.textContent,Do=!0)),$e=oc(H,Ge),0<$e.length&&(Ge=new xm(Ge,s,null,u,ne),ie.push({event:Ge,listeners:$e}),Ue?Ge.data=Ue:(Ue=Cm(u),Ue!==null&&(Ge.data=Ue)))),(Ue=jS?RS(s,u):NS(s,u))&&(H=oc(H,"onBeforeInput"),0<H.length&&(ne=new xm("onBeforeInput","beforeinput",null,u,ne),ie.push({event:ne,listeners:H}),ne.data=Ue))}Hm(ie,i)})}function ca(s,i,u){return{instance:s,listener:i,currentTarget:u}}function oc(s,i){for(var u=i+"Capture",f=[];s!==null;){var y=s,b=y.stateNode;y.tag===5&&b!==null&&(y=b,b=Ws(s,u),b!=null&&f.unshift(ca(s,b,y)),b=Ws(s,i),b!=null&&f.push(ca(s,b,y))),s=s.return}return f}function Mo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Gm(s,i,u,f,y){for(var b=i._reactName,k=[];u!==null&&u!==f;){var R=u,O=R.alternate,H=R.stateNode;if(O!==null&&O===f)break;R.tag===5&&H!==null&&(R=H,y?(O=Ws(u,b),O!=null&&k.unshift(ca(u,O,R))):y||(O=Ws(u,b),O!=null&&k.push(ca(u,O,R)))),u=u.return}k.length!==0&&s.push({event:i,listeners:k})}var WS=/\r\n?/g,GS=/\u0000|\uFFFD/g;function Km(s){return(typeof s=="string"?s:""+s).replace(WS,`
`).replace(GS,"")}function ic(s,i,u){if(i=Km(i),Km(s)!==i&&u)throw Error(t(425))}function ac(){}var Cd=null,Ed=null;function Pd(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Td=typeof setTimeout=="function"?setTimeout:void 0,KS=typeof clearTimeout=="function"?clearTimeout:void 0,Zm=typeof Promise=="function"?Promise:void 0,ZS=typeof queueMicrotask=="function"?queueMicrotask:typeof Zm<"u"?function(s){return Zm.resolve(null).then(s).catch(JS)}:Td;function JS(s){setTimeout(function(){throw s})}function Ad(s,i){var u=i,f=0;do{var y=u.nextSibling;if(s.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"){if(f===0){s.removeChild(y),Xi(i);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=y}while(u);Xi(i)}function us(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function Jm(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}var $o=Math.random().toString(36).slice(2),un="__reactFiber$"+$o,ua="__reactProps$"+$o,In="__reactContainer$"+$o,jd="__reactEvents$"+$o,QS="__reactListeners$"+$o,YS="__reactHandles$"+$o;function Ks(s){var i=s[un];if(i)return i;for(var u=s.parentNode;u;){if(i=u[In]||u[un]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=Jm(s);s!==null;){if(u=s[un])return u;s=Jm(s)}return i}s=u,u=s.parentNode}return null}function da(s){return s=s[un]||s[In],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Uo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function lc(s){return s[ua]||null}var Rd=[],Fo=-1;function ds(s){return{current:s}}function xt(s){0>Fo||(s.current=Rd[Fo],Rd[Fo]=null,Fo--)}function mt(s,i){Fo++,Rd[Fo]=s.current,s.current=i}var hs={},Zt=ds(hs),hr=ds(!1),Zs=hs;function zo(s,i){var u=s.type.contextTypes;if(!u)return hs;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===i)return f.__reactInternalMemoizedMaskedChildContext;var y={},b;for(b in u)y[b]=i[b];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=y),y}function fr(s){return s=s.childContextTypes,s!=null}function cc(){xt(hr),xt(Zt)}function Qm(s,i,u){if(Zt.current!==hs)throw Error(t(168));mt(Zt,i),mt(hr,u)}function Ym(s,i,u){var f=s.stateNode;if(i=i.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var y in f)if(!(y in i))throw Error(t(108,Ve(s)||"Unknown",y));return oe({},u,f)}function uc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||hs,Zs=Zt.current,mt(Zt,s),mt(hr,hr.current),!0}function Xm(s,i,u){var f=s.stateNode;if(!f)throw Error(t(169));u?(s=Ym(s,i,Zs),f.__reactInternalMemoizedMergedChildContext=s,xt(hr),xt(Zt),mt(Zt,s)):xt(hr),mt(hr,u)}var Dn=null,dc=!1,Nd=!1;function eg(s){Dn===null?Dn=[s]:Dn.push(s)}function XS(s){dc=!0,eg(s)}function fs(){if(!Nd&&Dn!==null){Nd=!0;var s=0,i=Fe;try{var u=Dn;for(Fe=1;s<u.length;s++){var f=u[s];do f=f(!0);while(f!==null)}Dn=null,dc=!1}catch(y){throw Dn!==null&&(Dn=Dn.slice(s+1)),Fl(ln,fs),y}finally{Fe=i,Nd=!1}}return null}var Vo=[],Bo=0,hc=null,fc=0,Dr=[],Lr=0,Js=null,Ln=1,On="";function Qs(s,i){Vo[Bo++]=fc,Vo[Bo++]=hc,hc=s,fc=i}function tg(s,i,u){Dr[Lr++]=Ln,Dr[Lr++]=On,Dr[Lr++]=Js,Js=s;var f=Ln;s=On;var y=32-wr(f)-1;f&=~(1<<y),u+=1;var b=32-wr(i)+y;if(30<b){var k=y-y%5;b=(f&(1<<k)-1).toString(32),f>>=k,y-=k,Ln=1<<32-wr(i)+y|u<<y|f,On=b+s}else Ln=1<<b|u<<y|f,On=s}function Id(s){s.return!==null&&(Qs(s,1),tg(s,1,0))}function Dd(s){for(;s===hc;)hc=Vo[--Bo],Vo[Bo]=null,fc=Vo[--Bo],Vo[Bo]=null;for(;s===Js;)Js=Dr[--Lr],Dr[Lr]=null,On=Dr[--Lr],Dr[Lr]=null,Ln=Dr[--Lr],Dr[Lr]=null}var _r=null,kr=null,_t=!1,Wr=null;function rg(s,i){var u=Ur(5,null,null,0);u.elementType="DELETED",u.stateNode=i,u.return=s,i=s.deletions,i===null?(s.deletions=[u],s.flags|=16):i.push(u)}function ng(s,i){switch(s.tag){case 5:var u=s.type;return i=i.nodeType!==1||u.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,_r=s,kr=us(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,_r=s,kr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(u=Js!==null?{id:Ln,overflow:On}:null,s.memoizedState={dehydrated:i,treeContext:u,retryLane:1073741824},u=Ur(18,null,null,0),u.stateNode=i,u.return=s,s.child=u,_r=s,kr=null,!0):!1;default:return!1}}function Ld(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Od(s){if(_t){var i=kr;if(i){var u=i;if(!ng(s,i)){if(Ld(s))throw Error(t(418));i=us(u.nextSibling);var f=_r;i&&ng(s,i)?rg(f,u):(s.flags=s.flags&-4097|2,_t=!1,_r=s)}}else{if(Ld(s))throw Error(t(418));s.flags=s.flags&-4097|2,_t=!1,_r=s}}}function sg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;_r=s}function pc(s){if(s!==_r)return!1;if(!_t)return sg(s),_t=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Pd(s.type,s.memoizedProps)),i&&(i=kr)){if(Ld(s))throw og(),Error(t(418));for(;i;)rg(s,i),i=us(i.nextSibling)}if(sg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(i===0){kr=us(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++}s=s.nextSibling}kr=null}}else kr=_r?us(s.stateNode.nextSibling):null;return!0}function og(){for(var s=kr;s;)s=us(s.nextSibling)}function qo(){kr=_r=null,_t=!1}function Md(s){Wr===null?Wr=[s]:Wr.push(s)}var e_=M.ReactCurrentBatchConfig;function ha(s,i,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var f=u.stateNode}if(!f)throw Error(t(147,s));var y=f,b=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(k){var R=y.refs;k===null?delete R[b]:R[b]=k},i._stringRef=b,i)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function mc(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function ig(s){var i=s._init;return i(s._payload)}function ag(s){function i(V,U){if(s){var B=V.deletions;B===null?(V.deletions=[U],V.flags|=16):B.push(U)}}function u(V,U){if(!s)return null;for(;U!==null;)i(V,U),U=U.sibling;return null}function f(V,U){for(V=new Map;U!==null;)U.key!==null?V.set(U.key,U):V.set(U.index,U),U=U.sibling;return V}function y(V,U){return V=ws(V,U),V.index=0,V.sibling=null,V}function b(V,U,B){return V.index=B,s?(B=V.alternate,B!==null?(B=B.index,B<U?(V.flags|=2,U):B):(V.flags|=2,U)):(V.flags|=1048576,U)}function k(V){return s&&V.alternate===null&&(V.flags|=2),V}function R(V,U,B,fe){return U===null||U.tag!==6?(U=Th(B,V.mode,fe),U.return=V,U):(U=y(U,B),U.return=V,U)}function O(V,U,B,fe){var Ne=B.type;return Ne===Z?ne(V,U,B.props.children,fe,B.key):U!==null&&(U.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Ce&&ig(Ne)===U.type)?(fe=y(U,B.props),fe.ref=ha(V,U,B),fe.return=V,fe):(fe=Uc(B.type,B.key,B.props,null,V.mode,fe),fe.ref=ha(V,U,B),fe.return=V,fe)}function H(V,U,B,fe){return U===null||U.tag!==4||U.stateNode.containerInfo!==B.containerInfo||U.stateNode.implementation!==B.implementation?(U=Ah(B,V.mode,fe),U.return=V,U):(U=y(U,B.children||[]),U.return=V,U)}function ne(V,U,B,fe,Ne){return U===null||U.tag!==7?(U=oo(B,V.mode,fe,Ne),U.return=V,U):(U=y(U,B),U.return=V,U)}function ie(V,U,B){if(typeof U=="string"&&U!==""||typeof U=="number")return U=Th(""+U,V.mode,B),U.return=V,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case A:return B=Uc(U.type,U.key,U.props,null,V.mode,B),B.ref=ha(V,null,U),B.return=V,B;case K:return U=Ah(U,V.mode,B),U.return=V,U;case Ce:var fe=U._init;return ie(V,fe(U._payload),B)}if(on(U)||X(U))return U=oo(U,V.mode,B,null),U.return=V,U;mc(V,U)}return null}function re(V,U,B,fe){var Ne=U!==null?U.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return Ne!==null?null:R(V,U,""+B,fe);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case A:return B.key===Ne?O(V,U,B,fe):null;case K:return B.key===Ne?H(V,U,B,fe):null;case Ce:return Ne=B._init,re(V,U,Ne(B._payload),fe)}if(on(B)||X(B))return Ne!==null?null:ne(V,U,B,fe,null);mc(V,B)}return null}function we(V,U,B,fe,Ne){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return V=V.get(B)||null,R(U,V,""+fe,Ne);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case A:return V=V.get(fe.key===null?B:fe.key)||null,O(U,V,fe,Ne);case K:return V=V.get(fe.key===null?B:fe.key)||null,H(U,V,fe,Ne);case Ce:var $e=fe._init;return we(V,U,B,$e(fe._payload),Ne)}if(on(fe)||X(fe))return V=V.get(B)||null,ne(U,V,fe,Ne,null);mc(U,fe)}return null}function Ae(V,U,B,fe){for(var Ne=null,$e=null,Ue=U,Ge=U=0,Bt=null;Ue!==null&&Ge<B.length;Ge++){Ue.index>Ge?(Bt=Ue,Ue=null):Bt=Ue.sibling;var dt=re(V,Ue,B[Ge],fe);if(dt===null){Ue===null&&(Ue=Bt);break}s&&Ue&&dt.alternate===null&&i(V,Ue),U=b(dt,U,Ge),$e===null?Ne=dt:$e.sibling=dt,$e=dt,Ue=Bt}if(Ge===B.length)return u(V,Ue),_t&&Qs(V,Ge),Ne;if(Ue===null){for(;Ge<B.length;Ge++)Ue=ie(V,B[Ge],fe),Ue!==null&&(U=b(Ue,U,Ge),$e===null?Ne=Ue:$e.sibling=Ue,$e=Ue);return _t&&Qs(V,Ge),Ne}for(Ue=f(V,Ue);Ge<B.length;Ge++)Bt=we(Ue,V,Ge,B[Ge],fe),Bt!==null&&(s&&Bt.alternate!==null&&Ue.delete(Bt.key===null?Ge:Bt.key),U=b(Bt,U,Ge),$e===null?Ne=Bt:$e.sibling=Bt,$e=Bt);return s&&Ue.forEach(function(Ss){return i(V,Ss)}),_t&&Qs(V,Ge),Ne}function Re(V,U,B,fe){var Ne=X(B);if(typeof Ne!="function")throw Error(t(150));if(B=Ne.call(B),B==null)throw Error(t(151));for(var $e=Ne=null,Ue=U,Ge=U=0,Bt=null,dt=B.next();Ue!==null&&!dt.done;Ge++,dt=B.next()){Ue.index>Ge?(Bt=Ue,Ue=null):Bt=Ue.sibling;var Ss=re(V,Ue,dt.value,fe);if(Ss===null){Ue===null&&(Ue=Bt);break}s&&Ue&&Ss.alternate===null&&i(V,Ue),U=b(Ss,U,Ge),$e===null?Ne=Ss:$e.sibling=Ss,$e=Ss,Ue=Bt}if(dt.done)return u(V,Ue),_t&&Qs(V,Ge),Ne;if(Ue===null){for(;!dt.done;Ge++,dt=B.next())dt=ie(V,dt.value,fe),dt!==null&&(U=b(dt,U,Ge),$e===null?Ne=dt:$e.sibling=dt,$e=dt);return _t&&Qs(V,Ge),Ne}for(Ue=f(V,Ue);!dt.done;Ge++,dt=B.next())dt=we(Ue,V,Ge,dt.value,fe),dt!==null&&(s&&dt.alternate!==null&&Ue.delete(dt.key===null?Ge:dt.key),U=b(dt,U,Ge),$e===null?Ne=dt:$e.sibling=dt,$e=dt);return s&&Ue.forEach(function(I_){return i(V,I_)}),_t&&Qs(V,Ge),Ne}function It(V,U,B,fe){if(typeof B=="object"&&B!==null&&B.type===Z&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case A:e:{for(var Ne=B.key,$e=U;$e!==null;){if($e.key===Ne){if(Ne=B.type,Ne===Z){if($e.tag===7){u(V,$e.sibling),U=y($e,B.props.children),U.return=V,V=U;break e}}else if($e.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Ce&&ig(Ne)===$e.type){u(V,$e.sibling),U=y($e,B.props),U.ref=ha(V,$e,B),U.return=V,V=U;break e}u(V,$e);break}else i(V,$e);$e=$e.sibling}B.type===Z?(U=oo(B.props.children,V.mode,fe,B.key),U.return=V,V=U):(fe=Uc(B.type,B.key,B.props,null,V.mode,fe),fe.ref=ha(V,U,B),fe.return=V,V=fe)}return k(V);case K:e:{for($e=B.key;U!==null;){if(U.key===$e)if(U.tag===4&&U.stateNode.containerInfo===B.containerInfo&&U.stateNode.implementation===B.implementation){u(V,U.sibling),U=y(U,B.children||[]),U.return=V,V=U;break e}else{u(V,U);break}else i(V,U);U=U.sibling}U=Ah(B,V.mode,fe),U.return=V,V=U}return k(V);case Ce:return $e=B._init,It(V,U,$e(B._payload),fe)}if(on(B))return Ae(V,U,B,fe);if(X(B))return Re(V,U,B,fe);mc(V,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,U!==null&&U.tag===6?(u(V,U.sibling),U=y(U,B),U.return=V,V=U):(u(V,U),U=Th(B,V.mode,fe),U.return=V,V=U),k(V)):u(V,U)}return It}var Ho=ag(!0),lg=ag(!1),gc=ds(null),yc=null,Wo=null,$d=null;function Ud(){$d=Wo=yc=null}function Fd(s){var i=gc.current;xt(gc),s._currentValue=i}function zd(s,i,u){for(;s!==null;){var f=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),s===u)break;s=s.return}}function Go(s,i){yc=s,$d=Wo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(pr=!0),s.firstContext=null)}function Or(s){var i=s._currentValue;if($d!==s)if(s={context:s,memoizedValue:i,next:null},Wo===null){if(yc===null)throw Error(t(308));Wo=s,yc.dependencies={lanes:0,firstContext:s}}else Wo=Wo.next=s;return i}var Ys=null;function Vd(s){Ys===null?Ys=[s]:Ys.push(s)}function cg(s,i,u,f){var y=i.interleaved;return y===null?(u.next=u,Vd(i)):(u.next=y.next,y.next=u),i.interleaved=u,Mn(s,f)}function Mn(s,i){s.lanes|=i;var u=s.alternate;for(u!==null&&(u.lanes|=i),u=s,s=s.return;s!==null;)s.childLanes|=i,u=s.alternate,u!==null&&(u.childLanes|=i),u=s,s=s.return;return u.tag===3?u.stateNode:null}var ps=!1;function Bd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ug(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function $n(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ms(s,i,u){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(lt&2)!==0){var y=f.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),f.pending=i,Mn(s,u)}return y=f.interleaved,y===null?(i.next=i,Vd(f)):(i.next=y.next,y.next=i),f.interleaved=i,Mn(s,u)}function vc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194240)!==0)){var f=i.lanes;f&=s.pendingLanes,u|=f,i.lanes=u,at(s,u)}}function dg(s,i){var u=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,b=null;if(u=u.firstBaseUpdate,u!==null){do{var k={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};b===null?y=b=k:b=b.next=k,u=u.next}while(u!==null);b===null?y=b=i:b=b.next=i}else y=b=i;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:f.shared,effects:f.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}function xc(s,i,u,f){var y=s.updateQueue;ps=!1;var b=y.firstBaseUpdate,k=y.lastBaseUpdate,R=y.shared.pending;if(R!==null){y.shared.pending=null;var O=R,H=O.next;O.next=null,k===null?b=H:k.next=H,k=O;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,R=ne.lastBaseUpdate,R!==k&&(R===null?ne.firstBaseUpdate=H:R.next=H,ne.lastBaseUpdate=O))}if(b!==null){var ie=y.baseState;k=0,ne=H=O=null,R=b;do{var re=R.lane,we=R.eventTime;if((f&re)===re){ne!==null&&(ne=ne.next={eventTime:we,lane:0,tag:R.tag,payload:R.payload,callback:R.callback,next:null});e:{var Ae=s,Re=R;switch(re=i,we=u,Re.tag){case 1:if(Ae=Re.payload,typeof Ae=="function"){ie=Ae.call(we,ie,re);break e}ie=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Re.payload,re=typeof Ae=="function"?Ae.call(we,ie,re):Ae,re==null)break e;ie=oe({},ie,re);break e;case 2:ps=!0}}R.callback!==null&&R.lane!==0&&(s.flags|=64,re=y.effects,re===null?y.effects=[R]:re.push(R))}else we={eventTime:we,lane:re,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ne===null?(H=ne=we,O=ie):ne=ne.next=we,k|=re;if(R=R.next,R===null){if(R=y.shared.pending,R===null)break;re=R,R=re.next,re.next=null,y.lastBaseUpdate=re,y.shared.pending=null}}while(!0);if(ne===null&&(O=ie),y.baseState=O,y.firstBaseUpdate=H,y.lastBaseUpdate=ne,i=y.shared.interleaved,i!==null){y=i;do k|=y.lane,y=y.next;while(y!==i)}else b===null&&(y.shared.lanes=0);to|=k,s.lanes=k,s.memoizedState=ie}}function hg(s,i,u){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var f=s[i],y=f.callback;if(y!==null){if(f.callback=null,f=u,typeof y!="function")throw Error(t(191,y));y.call(f)}}}var fa={},dn=ds(fa),pa=ds(fa),ma=ds(fa);function Xs(s){if(s===fa)throw Error(t(174));return s}function qd(s,i){switch(mt(ma,i),mt(pa,s),mt(dn,fa),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:le(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=le(i,s)}xt(dn),mt(dn,i)}function Ko(){xt(dn),xt(pa),xt(ma)}function fg(s){Xs(ma.current);var i=Xs(dn.current),u=le(i,s.type);i!==u&&(mt(pa,s),mt(dn,u))}function Hd(s){pa.current===s&&(xt(dn),xt(pa))}var kt=ds(0);function bc(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Wd=[];function Gd(){for(var s=0;s<Wd.length;s++)Wd[s]._workInProgressVersionPrimary=null;Wd.length=0}var wc=M.ReactCurrentDispatcher,Kd=M.ReactCurrentBatchConfig,eo=0,Ct=null,$t=null,zt=null,Sc=!1,ga=!1,ya=0,t_=0;function Jt(){throw Error(t(321))}function Zd(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Hr(s[u],i[u]))return!1;return!0}function Jd(s,i,u,f,y,b){if(eo=b,Ct=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,wc.current=s===null||s.memoizedState===null?o_:i_,s=u(f,y),ga){b=0;do{if(ga=!1,ya=0,25<=b)throw Error(t(301));b+=1,zt=$t=null,i.updateQueue=null,wc.current=a_,s=u(f,y)}while(ga)}if(wc.current=Cc,i=$t!==null&&$t.next!==null,eo=0,zt=$t=Ct=null,Sc=!1,i)throw Error(t(300));return s}function Qd(){var s=ya!==0;return ya=0,s}function hn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?Ct.memoizedState=zt=s:zt=zt.next=s,zt}function Mr(){if($t===null){var s=Ct.alternate;s=s!==null?s.memoizedState:null}else s=$t.next;var i=zt===null?Ct.memoizedState:zt.next;if(i!==null)zt=i,$t=s;else{if(s===null)throw Error(t(310));$t=s,s={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},zt===null?Ct.memoizedState=zt=s:zt=zt.next=s}return zt}function va(s,i){return typeof i=="function"?i(s):i}function Yd(s){var i=Mr(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=$t,y=f.baseQueue,b=u.pending;if(b!==null){if(y!==null){var k=y.next;y.next=b.next,b.next=k}f.baseQueue=y=b,u.pending=null}if(y!==null){b=y.next,f=f.baseState;var R=k=null,O=null,H=b;do{var ne=H.lane;if((eo&ne)===ne)O!==null&&(O=O.next={lane:0,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),f=H.hasEagerState?H.eagerState:s(f,H.action);else{var ie={lane:ne,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null};O===null?(R=O=ie,k=f):O=O.next=ie,Ct.lanes|=ne,to|=ne}H=H.next}while(H!==null&&H!==b);O===null?k=f:O.next=R,Hr(f,i.memoizedState)||(pr=!0),i.memoizedState=f,i.baseState=k,i.baseQueue=O,u.lastRenderedState=f}if(s=u.interleaved,s!==null){y=s;do b=y.lane,Ct.lanes|=b,to|=b,y=y.next;while(y!==s)}else y===null&&(u.lanes=0);return[i.memoizedState,u.dispatch]}function Xd(s){var i=Mr(),u=i.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=u.dispatch,y=u.pending,b=i.memoizedState;if(y!==null){u.pending=null;var k=y=y.next;do b=s(b,k.action),k=k.next;while(k!==y);Hr(b,i.memoizedState)||(pr=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),u.lastRenderedState=b}return[b,f]}function pg(){}function mg(s,i){var u=Ct,f=Mr(),y=i(),b=!Hr(f.memoizedState,y);if(b&&(f.memoizedState=y,pr=!0),f=f.queue,eh(vg.bind(null,u,f,s),[s]),f.getSnapshot!==i||b||zt!==null&&zt.memoizedState.tag&1){if(u.flags|=2048,xa(9,yg.bind(null,u,f,y,i),void 0,null),Vt===null)throw Error(t(349));(eo&30)!==0||gg(u,i,y)}return y}function gg(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=Ct.updateQueue,i===null?(i={lastEffect:null,stores:null},Ct.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function yg(s,i,u,f){i.value=u,i.getSnapshot=f,xg(i)&&bg(s)}function vg(s,i,u){return u(function(){xg(i)&&bg(s)})}function xg(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Hr(s,u)}catch{return!0}}function bg(s){var i=Mn(s,1);i!==null&&Jr(i,s,1,-1)}function wg(s){var i=hn();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:s},i.queue=s,s=s.dispatch=s_.bind(null,Ct,s),[i.memoizedState,s]}function xa(s,i,u,f){return s={tag:s,create:i,destroy:u,deps:f,next:null},i=Ct.updateQueue,i===null?(i={lastEffect:null,stores:null},Ct.updateQueue=i,i.lastEffect=s.next=s):(u=i.lastEffect,u===null?i.lastEffect=s.next=s:(f=u.next,u.next=s,s.next=f,i.lastEffect=s)),s}function Sg(){return Mr().memoizedState}function _c(s,i,u,f){var y=hn();Ct.flags|=s,y.memoizedState=xa(1|i,u,void 0,f===void 0?null:f)}function kc(s,i,u,f){var y=Mr();f=f===void 0?null:f;var b=void 0;if($t!==null){var k=$t.memoizedState;if(b=k.destroy,f!==null&&Zd(f,k.deps)){y.memoizedState=xa(i,u,b,f);return}}Ct.flags|=s,y.memoizedState=xa(1|i,u,b,f)}function _g(s,i){return _c(8390656,8,s,i)}function eh(s,i){return kc(2048,8,s,i)}function kg(s,i){return kc(4,2,s,i)}function Cg(s,i){return kc(4,4,s,i)}function Eg(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Pg(s,i,u){return u=u!=null?u.concat([s]):null,kc(4,4,Eg.bind(null,i,s),u)}function th(){}function Tg(s,i){var u=Mr();i=i===void 0?null:i;var f=u.memoizedState;return f!==null&&i!==null&&Zd(i,f[1])?f[0]:(u.memoizedState=[s,i],s)}function Ag(s,i){var u=Mr();i=i===void 0?null:i;var f=u.memoizedState;return f!==null&&i!==null&&Zd(i,f[1])?f[0]:(s=s(),u.memoizedState=[s,i],s)}function jg(s,i,u){return(eo&21)===0?(s.baseState&&(s.baseState=!1,pr=!0),s.memoizedState=u):(Hr(u,i)||(u=me(),Ct.lanes|=u,to|=u,s.baseState=!0),i)}function r_(s,i){var u=Fe;Fe=u!==0&&4>u?u:4,s(!0);var f=Kd.transition;Kd.transition={};try{s(!1),i()}finally{Fe=u,Kd.transition=f}}function Rg(){return Mr().memoizedState}function n_(s,i,u){var f=xs(s);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},Ng(s))Ig(i,u);else if(u=cg(s,i,u,f),u!==null){var y=ar();Jr(u,s,f,y),Dg(u,i,f)}}function s_(s,i,u){var f=xs(s),y={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ng(s))Ig(i,y);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var k=i.lastRenderedState,R=b(k,u);if(y.hasEagerState=!0,y.eagerState=R,Hr(R,k)){var O=i.interleaved;O===null?(y.next=y,Vd(i)):(y.next=O.next,O.next=y),i.interleaved=y;return}}catch{}finally{}u=cg(s,i,y,f),u!==null&&(y=ar(),Jr(u,s,f,y),Dg(u,i,f))}}function Ng(s){var i=s.alternate;return s===Ct||i!==null&&i===Ct}function Ig(s,i){ga=Sc=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function Dg(s,i,u){if((u&4194240)!==0){var f=i.lanes;f&=s.pendingLanes,u|=f,i.lanes=u,at(s,u)}}var Cc={readContext:Or,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},o_={readContext:Or,useCallback:function(s,i){return hn().memoizedState=[s,i===void 0?null:i],s},useContext:Or,useEffect:_g,useImperativeHandle:function(s,i,u){return u=u!=null?u.concat([s]):null,_c(4194308,4,Eg.bind(null,i,s),u)},useLayoutEffect:function(s,i){return _c(4194308,4,s,i)},useInsertionEffect:function(s,i){return _c(4,2,s,i)},useMemo:function(s,i){var u=hn();return i=i===void 0?null:i,s=s(),u.memoizedState=[s,i],s},useReducer:function(s,i,u){var f=hn();return i=u!==void 0?u(i):i,f.memoizedState=f.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},f.queue=s,s=s.dispatch=n_.bind(null,Ct,s),[f.memoizedState,s]},useRef:function(s){var i=hn();return s={current:s},i.memoizedState=s},useState:wg,useDebugValue:th,useDeferredValue:function(s){return hn().memoizedState=s},useTransition:function(){var s=wg(!1),i=s[0];return s=r_.bind(null,s[1]),hn().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,u){var f=Ct,y=hn();if(_t){if(u===void 0)throw Error(t(407));u=u()}else{if(u=i(),Vt===null)throw Error(t(349));(eo&30)!==0||gg(f,i,u)}y.memoizedState=u;var b={value:u,getSnapshot:i};return y.queue=b,_g(vg.bind(null,f,b,s),[s]),f.flags|=2048,xa(9,yg.bind(null,f,b,u,i),void 0,null),u},useId:function(){var s=hn(),i=Vt.identifierPrefix;if(_t){var u=On,f=Ln;u=(f&~(1<<32-wr(f)-1)).toString(32)+u,i=":"+i+"R"+u,u=ya++,0<u&&(i+="H"+u.toString(32)),i+=":"}else u=t_++,i=":"+i+"r"+u.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},i_={readContext:Or,useCallback:Tg,useContext:Or,useEffect:eh,useImperativeHandle:Pg,useInsertionEffect:kg,useLayoutEffect:Cg,useMemo:Ag,useReducer:Yd,useRef:Sg,useState:function(){return Yd(va)},useDebugValue:th,useDeferredValue:function(s){var i=Mr();return jg(i,$t.memoizedState,s)},useTransition:function(){var s=Yd(va)[0],i=Mr().memoizedState;return[s,i]},useMutableSource:pg,useSyncExternalStore:mg,useId:Rg,unstable_isNewReconciler:!1},a_={readContext:Or,useCallback:Tg,useContext:Or,useEffect:eh,useImperativeHandle:Pg,useInsertionEffect:kg,useLayoutEffect:Cg,useMemo:Ag,useReducer:Xd,useRef:Sg,useState:function(){return Xd(va)},useDebugValue:th,useDeferredValue:function(s){var i=Mr();return $t===null?i.memoizedState=s:jg(i,$t.memoizedState,s)},useTransition:function(){var s=Xd(va)[0],i=Mr().memoizedState;return[s,i]},useMutableSource:pg,useSyncExternalStore:mg,useId:Rg,unstable_isNewReconciler:!1};function Gr(s,i){if(s&&s.defaultProps){i=oe({},i),s=s.defaultProps;for(var u in s)i[u]===void 0&&(i[u]=s[u]);return i}return i}function rh(s,i,u,f){i=s.memoizedState,u=u(f,i),u=u==null?i:oe({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Ec={isMounted:function(s){return(s=s._reactInternals)?jn(s)===s:!1},enqueueSetState:function(s,i,u){s=s._reactInternals;var f=ar(),y=xs(s),b=$n(f,y);b.payload=i,u!=null&&(b.callback=u),i=ms(s,b,y),i!==null&&(Jr(i,s,y,f),vc(i,s,y))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var f=ar(),y=xs(s),b=$n(f,y);b.tag=1,b.payload=i,u!=null&&(b.callback=u),i=ms(s,b,y),i!==null&&(Jr(i,s,y,f),vc(i,s,y))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=ar(),f=xs(s),y=$n(u,f);y.tag=2,i!=null&&(y.callback=i),i=ms(s,y,f),i!==null&&(Jr(i,s,f,u),vc(i,s,f))}};function Lg(s,i,u,f,y,b,k){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,b,k):i.prototype&&i.prototype.isPureReactComponent?!oa(u,f)||!oa(y,b):!0}function Og(s,i,u){var f=!1,y=hs,b=i.contextType;return typeof b=="object"&&b!==null?b=Or(b):(y=fr(i)?Zs:Zt.current,f=i.contextTypes,b=(f=f!=null)?zo(s,y):hs),i=new i(u,b),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ec,s.stateNode=i,i._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=b),i}function Mg(s,i,u,f){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,f),i.state!==s&&Ec.enqueueReplaceState(i,i.state,null)}function nh(s,i,u,f){var y=s.stateNode;y.props=u,y.state=s.memoizedState,y.refs={},Bd(s);var b=i.contextType;typeof b=="object"&&b!==null?y.context=Or(b):(b=fr(i)?Zs:Zt.current,y.context=zo(s,b)),y.state=s.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(rh(s,i,b,u),y.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&Ec.enqueueReplaceState(y,y.state,null),xc(s,u,y,f),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function Zo(s,i){try{var u="",f=i;do u+=rt(f),f=f.return;while(f);var y=u}catch(b){y=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:i,stack:y,digest:null}}function sh(s,i,u){return{value:s,source:null,stack:u??null,digest:i??null}}function oh(s,i){try{console.error(i.value)}catch(u){setTimeout(function(){throw u})}}var l_=typeof WeakMap=="function"?WeakMap:Map;function $g(s,i,u){u=$n(-1,u),u.tag=3,u.payload={element:null};var f=i.value;return u.callback=function(){Ic||(Ic=!0,bh=f),oh(s,i)},u}function Ug(s,i,u){u=$n(-1,u),u.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var y=i.value;u.payload=function(){return f(y)},u.callback=function(){oh(s,i)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(u.callback=function(){oh(s,i),typeof f!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var k=i.stack;this.componentDidCatch(i.value,{componentStack:k!==null?k:""})}),u}function Fg(s,i,u){var f=s.pingCache;if(f===null){f=s.pingCache=new l_;var y=new Set;f.set(i,y)}else y=f.get(i),y===void 0&&(y=new Set,f.set(i,y));y.has(u)||(y.add(u),s=S_.bind(null,s,i,u),i.then(s,s))}function zg(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Vg(s,i,u,f,y){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(i=$n(-1,1),i.tag=2,ms(u,i,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var c_=M.ReactCurrentOwner,pr=!1;function ir(s,i,u,f){i.child=s===null?lg(i,null,u,f):Ho(i,s.child,u,f)}function Bg(s,i,u,f,y){u=u.render;var b=i.ref;return Go(i,y),f=Jd(s,i,u,f,b,y),u=Qd(),s!==null&&!pr?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Un(s,i,y)):(_t&&u&&Id(i),i.flags|=1,ir(s,i,f,y),i.child)}function qg(s,i,u,f,y){if(s===null){var b=u.type;return typeof b=="function"&&!Ph(b)&&b.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(i.tag=15,i.type=b,Hg(s,i,b,f,y)):(s=Uc(u.type,null,f,i,i.mode,y),s.ref=i.ref,s.return=i,i.child=s)}if(b=s.child,(s.lanes&y)===0){var k=b.memoizedProps;if(u=u.compare,u=u!==null?u:oa,u(k,f)&&s.ref===i.ref)return Un(s,i,y)}return i.flags|=1,s=ws(b,f),s.ref=i.ref,s.return=i,i.child=s}function Hg(s,i,u,f,y){if(s!==null){var b=s.memoizedProps;if(oa(b,f)&&s.ref===i.ref)if(pr=!1,i.pendingProps=f=b,(s.lanes&y)!==0)(s.flags&131072)!==0&&(pr=!0);else return i.lanes=s.lanes,Un(s,i,y)}return ih(s,i,u,f,y)}function Wg(s,i,u){var f=i.pendingProps,y=f.children,b=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Qo,Cr),Cr|=u;else{if((u&1073741824)===0)return s=b!==null?b.baseLanes|u:u,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,mt(Qo,Cr),Cr|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=b!==null?b.baseLanes:u,mt(Qo,Cr),Cr|=f}else b!==null?(f=b.baseLanes|u,i.memoizedState=null):f=u,mt(Qo,Cr),Cr|=f;return ir(s,i,y,u),i.child}function Gg(s,i){var u=i.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(i.flags|=512,i.flags|=2097152)}function ih(s,i,u,f,y){var b=fr(u)?Zs:Zt.current;return b=zo(i,b),Go(i,y),u=Jd(s,i,u,f,b,y),f=Qd(),s!==null&&!pr?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~y,Un(s,i,y)):(_t&&f&&Id(i),i.flags|=1,ir(s,i,u,y),i.child)}function Kg(s,i,u,f,y){if(fr(u)){var b=!0;uc(i)}else b=!1;if(Go(i,y),i.stateNode===null)Tc(s,i),Og(i,u,f),nh(i,u,f,y),f=!0;else if(s===null){var k=i.stateNode,R=i.memoizedProps;k.props=R;var O=k.context,H=u.contextType;typeof H=="object"&&H!==null?H=Or(H):(H=fr(u)?Zs:Zt.current,H=zo(i,H));var ne=u.getDerivedStateFromProps,ie=typeof ne=="function"||typeof k.getSnapshotBeforeUpdate=="function";ie||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(R!==f||O!==H)&&Mg(i,k,f,H),ps=!1;var re=i.memoizedState;k.state=re,xc(i,f,k,y),O=i.memoizedState,R!==f||re!==O||hr.current||ps?(typeof ne=="function"&&(rh(i,u,ne,f),O=i.memoizedState),(R=ps||Lg(i,u,R,f,re,O,H))?(ie||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(i.flags|=4194308)):(typeof k.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=O),k.props=f,k.state=O,k.context=H,f=R):(typeof k.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{k=i.stateNode,ug(s,i),R=i.memoizedProps,H=i.type===i.elementType?R:Gr(i.type,R),k.props=H,ie=i.pendingProps,re=k.context,O=u.contextType,typeof O=="object"&&O!==null?O=Or(O):(O=fr(u)?Zs:Zt.current,O=zo(i,O));var we=u.getDerivedStateFromProps;(ne=typeof we=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(R!==ie||re!==O)&&Mg(i,k,f,O),ps=!1,re=i.memoizedState,k.state=re,xc(i,f,k,y);var Ae=i.memoizedState;R!==ie||re!==Ae||hr.current||ps?(typeof we=="function"&&(rh(i,u,we,f),Ae=i.memoizedState),(H=ps||Lg(i,u,H,f,re,Ae,O)||!1)?(ne||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(f,Ae,O),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(f,Ae,O)),typeof k.componentDidUpdate=="function"&&(i.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof k.componentDidUpdate!="function"||R===s.memoizedProps&&re===s.memoizedState||(i.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&re===s.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=Ae),k.props=f,k.state=Ae,k.context=O,f=H):(typeof k.componentDidUpdate!="function"||R===s.memoizedProps&&re===s.memoizedState||(i.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&re===s.memoizedState||(i.flags|=1024),f=!1)}return ah(s,i,u,f,b,y)}function ah(s,i,u,f,y,b){Gg(s,i);var k=(i.flags&128)!==0;if(!f&&!k)return y&&Xm(i,u,!1),Un(s,i,b);f=i.stateNode,c_.current=i;var R=k&&typeof u.getDerivedStateFromError!="function"?null:f.render();return i.flags|=1,s!==null&&k?(i.child=Ho(i,s.child,null,b),i.child=Ho(i,null,R,b)):ir(s,i,R,b),i.memoizedState=f.state,y&&Xm(i,u,!0),i.child}function Zg(s){var i=s.stateNode;i.pendingContext?Qm(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Qm(s,i.context,!1),qd(s,i.containerInfo)}function Jg(s,i,u,f,y){return qo(),Md(y),i.flags|=256,ir(s,i,u,f),i.child}var lh={dehydrated:null,treeContext:null,retryLane:0};function ch(s){return{baseLanes:s,cachePool:null,transitions:null}}function Qg(s,i,u){var f=i.pendingProps,y=kt.current,b=!1,k=(i.flags&128)!==0,R;if((R=k)||(R=s!==null&&s.memoizedState===null?!1:(y&2)!==0),R?(b=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),mt(kt,y&1),s===null)return Od(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(k=f.children,s=f.fallback,b?(f=i.mode,b=i.child,k={mode:"hidden",children:k},(f&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=k):b=Fc(k,f,0,null),s=oo(s,f,u,null),b.return=i,s.return=i,b.sibling=s,i.child=b,i.child.memoizedState=ch(u),i.memoizedState=lh,s):uh(i,k));if(y=s.memoizedState,y!==null&&(R=y.dehydrated,R!==null))return u_(s,i,k,f,R,y,u);if(b){b=f.fallback,k=i.mode,y=s.child,R=y.sibling;var O={mode:"hidden",children:f.children};return(k&1)===0&&i.child!==y?(f=i.child,f.childLanes=0,f.pendingProps=O,i.deletions=null):(f=ws(y,O),f.subtreeFlags=y.subtreeFlags&14680064),R!==null?b=ws(R,b):(b=oo(b,k,u,null),b.flags|=2),b.return=i,f.return=i,f.sibling=b,i.child=f,f=b,b=i.child,k=s.child.memoizedState,k=k===null?ch(u):{baseLanes:k.baseLanes|u,cachePool:null,transitions:k.transitions},b.memoizedState=k,b.childLanes=s.childLanes&~u,i.memoizedState=lh,f}return b=s.child,s=b.sibling,f=ws(b,{mode:"visible",children:f.children}),(i.mode&1)===0&&(f.lanes=u),f.return=i,f.sibling=null,s!==null&&(u=i.deletions,u===null?(i.deletions=[s],i.flags|=16):u.push(s)),i.child=f,i.memoizedState=null,f}function uh(s,i){return i=Fc({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function Pc(s,i,u,f){return f!==null&&Md(f),Ho(i,s.child,null,u),s=uh(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function u_(s,i,u,f,y,b,k){if(u)return i.flags&256?(i.flags&=-257,f=sh(Error(t(422))),Pc(s,i,k,f)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(b=f.fallback,y=i.mode,f=Fc({mode:"visible",children:f.children},y,0,null),b=oo(b,y,k,null),b.flags|=2,f.return=i,b.return=i,f.sibling=b,i.child=f,(i.mode&1)!==0&&Ho(i,s.child,null,k),i.child.memoizedState=ch(k),i.memoizedState=lh,b);if((i.mode&1)===0)return Pc(s,i,k,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var R=f.dgst;return f=R,b=Error(t(419)),f=sh(b,f,void 0),Pc(s,i,k,f)}if(R=(k&s.childLanes)!==0,pr||R){if(f=Vt,f!==null){switch(k&-k){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|k))!==0?0:y,y!==0&&y!==b.retryLane&&(b.retryLane=y,Mn(s,y),Jr(f,s,y,-1))}return Eh(),f=sh(Error(t(421))),Pc(s,i,k,f)}return y.data==="$?"?(i.flags|=128,i.child=s.child,i=__.bind(null,s),y._reactRetry=i,null):(s=b.treeContext,kr=us(y.nextSibling),_r=i,_t=!0,Wr=null,s!==null&&(Dr[Lr++]=Ln,Dr[Lr++]=On,Dr[Lr++]=Js,Ln=s.id,On=s.overflow,Js=i),i=uh(i,f.children),i.flags|=4096,i)}function Yg(s,i,u){s.lanes|=i;var f=s.alternate;f!==null&&(f.lanes|=i),zd(s.return,i,u)}function dh(s,i,u,f,y){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=u,b.tailMode=y)}function Xg(s,i,u){var f=i.pendingProps,y=f.revealOrder,b=f.tail;if(ir(s,i,f.children,u),f=kt.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Yg(s,u,i);else if(s.tag===19)Yg(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(mt(kt,f),(i.mode&1)===0)i.memoizedState=null;else switch(y){case"forwards":for(u=i.child,y=null;u!==null;)s=u.alternate,s!==null&&bc(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=i.child,i.child=null):(y=u.sibling,u.sibling=null),dh(i,!1,y,u,b);break;case"backwards":for(u=null,y=i.child,i.child=null;y!==null;){if(s=y.alternate,s!==null&&bc(s)===null){i.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}dh(i,!0,u,null,b);break;case"together":dh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Tc(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Un(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),to|=i.lanes,(u&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,u=ws(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=ws(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function d_(s,i,u){switch(i.tag){case 3:Zg(i),qo();break;case 5:fg(i);break;case 1:fr(i.type)&&uc(i);break;case 4:qd(i,i.stateNode.containerInfo);break;case 10:var f=i.type._context,y=i.memoizedProps.value;mt(gc,f._currentValue),f._currentValue=y;break;case 13:if(f=i.memoizedState,f!==null)return f.dehydrated!==null?(mt(kt,kt.current&1),i.flags|=128,null):(u&i.child.childLanes)!==0?Qg(s,i,u):(mt(kt,kt.current&1),s=Un(s,i,u),s!==null?s.sibling:null);mt(kt,kt.current&1);break;case 19:if(f=(u&i.childLanes)!==0,(s.flags&128)!==0){if(f)return Xg(s,i,u);i.flags|=128}if(y=i.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),mt(kt,kt.current),f)break;return null;case 22:case 23:return i.lanes=0,Wg(s,i,u)}return Un(s,i,u)}var e0,hh,t0,r0;e0=function(s,i){for(var u=i.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},hh=function(){},t0=function(s,i,u,f){var y=s.memoizedProps;if(y!==f){s=i.stateNode,Xs(dn.current);var b=null;switch(u){case"input":y=ts(s,y),f=ts(s,f),b=[];break;case"select":y=oe({},y,{value:void 0}),f=oe({},f,{value:void 0}),b=[];break;case"textarea":y=I(s,y),f=I(s,f),b=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=ac)}rs(u,f);var k;u=null;for(H in y)if(!f.hasOwnProperty(H)&&y.hasOwnProperty(H)&&y[H]!=null)if(H==="style"){var R=y[H];for(k in R)R.hasOwnProperty(k)&&(u||(u={}),u[k]="")}else H!=="dangerouslySetInnerHTML"&&H!=="children"&&H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(o.hasOwnProperty(H)?b||(b=[]):(b=b||[]).push(H,null));for(H in f){var O=f[H];if(R=y?.[H],f.hasOwnProperty(H)&&O!==R&&(O!=null||R!=null))if(H==="style")if(R){for(k in R)!R.hasOwnProperty(k)||O&&O.hasOwnProperty(k)||(u||(u={}),u[k]="");for(k in O)O.hasOwnProperty(k)&&R[k]!==O[k]&&(u||(u={}),u[k]=O[k])}else u||(b||(b=[]),b.push(H,u)),u=O;else H==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,R=R?R.__html:void 0,O!=null&&R!==O&&(b=b||[]).push(H,O)):H==="children"?typeof O!="string"&&typeof O!="number"||(b=b||[]).push(H,""+O):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&(o.hasOwnProperty(H)?(O!=null&&H==="onScroll"&&vt("scroll",s),b||R===O||(b=[])):(b=b||[]).push(H,O))}u&&(b=b||[]).push("style",u);var H=b;(i.updateQueue=H)&&(i.flags|=4)}},r0=function(s,i,u,f){u!==f&&(i.flags|=4)};function ba(s,i){if(!_t)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Qt(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,f=0;if(i)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=f,s.childLanes=u,i}function h_(s,i,u){var f=i.pendingProps;switch(Dd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(i),null;case 1:return fr(i.type)&&cc(),Qt(i),null;case 3:return f=i.stateNode,Ko(),xt(hr),xt(Zt),Gd(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(pc(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Wr!==null&&(_h(Wr),Wr=null))),hh(s,i),Qt(i),null;case 5:Hd(i);var y=Xs(ma.current);if(u=i.type,s!==null&&i.stateNode!=null)t0(s,i,u,f,y),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!f){if(i.stateNode===null)throw Error(t(166));return Qt(i),null}if(s=Xs(dn.current),pc(i)){f=i.stateNode,u=i.type;var b=i.memoizedProps;switch(f[un]=i,f[ua]=b,s=(i.mode&1)!==0,u){case"dialog":vt("cancel",f),vt("close",f);break;case"iframe":case"object":case"embed":vt("load",f);break;case"video":case"audio":for(y=0;y<aa.length;y++)vt(aa[y],f);break;case"source":vt("error",f);break;case"img":case"image":case"link":vt("error",f),vt("load",f);break;case"details":vt("toggle",f);break;case"input":xr(f,b),vt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!b.multiple},vt("invalid",f);break;case"textarea":q(f,b),vt("invalid",f)}rs(u,b),y=null;for(var k in b)if(b.hasOwnProperty(k)){var R=b[k];k==="children"?typeof R=="string"?f.textContent!==R&&(b.suppressHydrationWarning!==!0&&ic(f.textContent,R,s),y=["children",R]):typeof R=="number"&&f.textContent!==""+R&&(b.suppressHydrationWarning!==!0&&ic(f.textContent,R,s),y=["children",""+R]):o.hasOwnProperty(k)&&R!=null&&k==="onScroll"&&vt("scroll",f)}switch(u){case"input":Rr(f),Cn(f,b,!0);break;case"textarea":Rr(f),xe(f);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(f.onclick=ac)}f=y,i.updateQueue=f,f!==null&&(i.flags|=4)}else{k=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=ge(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=k.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=k.createElement(u,{is:f.is}):(s=k.createElement(u),u==="select"&&(k=s,f.multiple?k.multiple=!0:f.size&&(k.size=f.size))):s=k.createElementNS(s,u),s[un]=i,s[ua]=f,e0(s,i,!1,!1),i.stateNode=s;e:{switch(k=Tn(u,f),u){case"dialog":vt("cancel",s),vt("close",s),y=f;break;case"iframe":case"object":case"embed":vt("load",s),y=f;break;case"video":case"audio":for(y=0;y<aa.length;y++)vt(aa[y],s);y=f;break;case"source":vt("error",s),y=f;break;case"img":case"image":case"link":vt("error",s),vt("load",s),y=f;break;case"details":vt("toggle",s),y=f;break;case"input":xr(s,f),y=ts(s,f),vt("invalid",s);break;case"option":y=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},y=oe({},f,{value:void 0}),vt("invalid",s);break;case"textarea":q(s,f),y=I(s,f),vt("invalid",s);break;default:y=f}rs(u,y),R=y;for(b in R)if(R.hasOwnProperty(b)){var O=R[b];b==="style"?an(s,O):b==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,O!=null&&nt(s,O)):b==="children"?typeof O=="string"?(u!=="textarea"||O!=="")&&ht(s,O):typeof O=="number"&&ht(s,""+O):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(o.hasOwnProperty(b)?O!=null&&b==="onScroll"&&vt("scroll",s):O!=null&&N(s,b,O,k))}switch(u){case"input":Rr(s),Cn(s,f,!1);break;case"textarea":Rr(s),xe(s);break;case"option":f.value!=null&&s.setAttribute("value",""+Be(f.value));break;case"select":s.multiple=!!f.multiple,b=f.value,b!=null?br(s,!!f.multiple,b,!1):f.defaultValue!=null&&br(s,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=ac)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Qt(i),null;case 6:if(s&&i.stateNode!=null)r0(s,i,s.memoizedProps,f);else{if(typeof f!="string"&&i.stateNode===null)throw Error(t(166));if(u=Xs(ma.current),Xs(dn.current),pc(i)){if(f=i.stateNode,u=i.memoizedProps,f[un]=i,(b=f.nodeValue!==u)&&(s=_r,s!==null))switch(s.tag){case 3:ic(f.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ic(f.nodeValue,u,(s.mode&1)!==0)}b&&(i.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[un]=i,i.stateNode=f}return Qt(i),null;case 13:if(xt(kt),f=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(_t&&kr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)og(),qo(),i.flags|=98560,b=!1;else if(b=pc(i),f!==null&&f.dehydrated!==null){if(s===null){if(!b)throw Error(t(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[un]=i}else qo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Qt(i),b=!1}else Wr!==null&&(_h(Wr),Wr=null),b=!0;if(!b)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=u,i):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(kt.current&1)!==0?Ut===0&&(Ut=3):Eh())),i.updateQueue!==null&&(i.flags|=4),Qt(i),null);case 4:return Ko(),hh(s,i),s===null&&la(i.stateNode.containerInfo),Qt(i),null;case 10:return Fd(i.type._context),Qt(i),null;case 17:return fr(i.type)&&cc(),Qt(i),null;case 19:if(xt(kt),b=i.memoizedState,b===null)return Qt(i),null;if(f=(i.flags&128)!==0,k=b.rendering,k===null)if(f)ba(b,!1);else{if(Ut!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(k=bc(s),k!==null){for(i.flags|=128,ba(b,!1),f=k.updateQueue,f!==null&&(i.updateQueue=f,i.flags|=4),i.subtreeFlags=0,f=u,u=i.child;u!==null;)b=u,s=f,b.flags&=14680066,k=b.alternate,k===null?(b.childLanes=0,b.lanes=s,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=k.childLanes,b.lanes=k.lanes,b.child=k.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=k.memoizedProps,b.memoizedState=k.memoizedState,b.updateQueue=k.updateQueue,b.type=k.type,s=k.dependencies,b.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return mt(kt,kt.current&1|2),i.child}s=s.sibling}b.tail!==null&&pt()>Yo&&(i.flags|=128,f=!0,ba(b,!1),i.lanes=4194304)}else{if(!f)if(s=bc(k),s!==null){if(i.flags|=128,f=!0,u=s.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),ba(b,!0),b.tail===null&&b.tailMode==="hidden"&&!k.alternate&&!_t)return Qt(i),null}else 2*pt()-b.renderingStartTime>Yo&&u!==1073741824&&(i.flags|=128,f=!0,ba(b,!1),i.lanes=4194304);b.isBackwards?(k.sibling=i.child,i.child=k):(u=b.last,u!==null?u.sibling=k:i.child=k,b.last=k)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=pt(),i.sibling=null,u=kt.current,mt(kt,f?u&1|2:u&1),i):(Qt(i),null);case 22:case 23:return Ch(),f=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(i.flags|=8192),f&&(i.mode&1)!==0?(Cr&1073741824)!==0&&(Qt(i),i.subtreeFlags&6&&(i.flags|=8192)):Qt(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function f_(s,i){switch(Dd(i),i.tag){case 1:return fr(i.type)&&cc(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Ko(),xt(hr),xt(Zt),Gd(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return Hd(i),null;case 13:if(xt(kt),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));qo()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return xt(kt),null;case 4:return Ko(),null;case 10:return Fd(i.type._context),null;case 22:case 23:return Ch(),null;case 24:return null;default:return null}}var Ac=!1,Yt=!1,p_=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function Jo(s,i){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){jt(s,i,f)}else u.current=null}function fh(s,i,u){try{u()}catch(f){jt(s,i,f)}}var n0=!1;function m_(s,i){if(Cd=Zl,s=Lm(),yd(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{u.nodeType,b.nodeType}catch{u=null;break e}var k=0,R=-1,O=-1,H=0,ne=0,ie=s,re=null;t:for(;;){for(var we;ie!==u||y!==0&&ie.nodeType!==3||(R=k+y),ie!==b||f!==0&&ie.nodeType!==3||(O=k+f),ie.nodeType===3&&(k+=ie.nodeValue.length),(we=ie.firstChild)!==null;)re=ie,ie=we;for(;;){if(ie===s)break t;if(re===u&&++H===y&&(R=k),re===b&&++ne===f&&(O=k),(we=ie.nextSibling)!==null)break;ie=re,re=ie.parentNode}ie=we}u=R===-1||O===-1?null:{start:R,end:O}}else u=null}u=u||{start:0,end:0}}else u=null;for(Ed={focusedElem:s,selectionRange:u},Zl=!1,Pe=i;Pe!==null;)if(i=Pe,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,Pe=s;else for(;Pe!==null;){i=Pe;try{var Ae=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Ae!==null){var Re=Ae.memoizedProps,It=Ae.memoizedState,V=i.stateNode,U=V.getSnapshotBeforeUpdate(i.elementType===i.type?Re:Gr(i.type,Re),It);V.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var B=i.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fe){jt(i,i.return,fe)}if(s=i.sibling,s!==null){s.return=i.return,Pe=s;break}Pe=i.return}return Ae=n0,n0=!1,Ae}function wa(s,i,u){var f=i.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&s)===s){var b=y.destroy;y.destroy=void 0,b!==void 0&&fh(i,u,b)}y=y.next}while(y!==f)}}function jc(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var u=i=i.next;do{if((u.tag&s)===s){var f=u.create;u.destroy=f()}u=u.next}while(u!==i)}}function ph(s){var i=s.ref;if(i!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof i=="function"?i(s):i.current=s}}function s0(s){var i=s.alternate;i!==null&&(s.alternate=null,s0(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[un],delete i[ua],delete i[jd],delete i[QS],delete i[YS])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function o0(s){return s.tag===5||s.tag===3||s.tag===4}function i0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||o0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function mh(s,i,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?u.nodeType===8?u.parentNode.insertBefore(s,i):u.insertBefore(s,i):(u.nodeType===8?(i=u.parentNode,i.insertBefore(s,u)):(i=u,i.appendChild(s)),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=ac));else if(f!==4&&(s=s.child,s!==null))for(mh(s,i,u),s=s.sibling;s!==null;)mh(s,i,u),s=s.sibling}function gh(s,i,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(gh(s,i,u),s=s.sibling;s!==null;)gh(s,i,u),s=s.sibling}var Wt=null,Kr=!1;function gs(s,i,u){for(u=u.child;u!==null;)a0(s,i,u),u=u.sibling}function a0(s,i,u){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(To,u)}catch{}switch(u.tag){case 5:Yt||Jo(u,i);case 6:var f=Wt,y=Kr;Wt=null,gs(s,i,u),Wt=f,Kr=y,Wt!==null&&(Kr?(s=Wt,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):Wt.removeChild(u.stateNode));break;case 18:Wt!==null&&(Kr?(s=Wt,u=u.stateNode,s.nodeType===8?Ad(s.parentNode,u):s.nodeType===1&&Ad(s,u),Xi(s)):Ad(Wt,u.stateNode));break;case 4:f=Wt,y=Kr,Wt=u.stateNode.containerInfo,Kr=!0,gs(s,i,u),Wt=f,Kr=y;break;case 0:case 11:case 14:case 15:if(!Yt&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var b=y,k=b.destroy;b=b.tag,k!==void 0&&((b&2)!==0||(b&4)!==0)&&fh(u,i,k),y=y.next}while(y!==f)}gs(s,i,u);break;case 1:if(!Yt&&(Jo(u,i),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(R){jt(u,i,R)}gs(s,i,u);break;case 21:gs(s,i,u);break;case 22:u.mode&1?(Yt=(f=Yt)||u.memoizedState!==null,gs(s,i,u),Yt=f):gs(s,i,u);break;default:gs(s,i,u)}}function l0(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new p_),i.forEach(function(f){var y=k_.bind(null,s,f);u.has(f)||(u.add(f),f.then(y,y))})}}function Zr(s,i){var u=i.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f];try{var b=s,k=i,R=k;e:for(;R!==null;){switch(R.tag){case 5:Wt=R.stateNode,Kr=!1;break e;case 3:Wt=R.stateNode.containerInfo,Kr=!0;break e;case 4:Wt=R.stateNode.containerInfo,Kr=!0;break e}R=R.return}if(Wt===null)throw Error(t(160));a0(b,k,y),Wt=null,Kr=!1;var O=y.alternate;O!==null&&(O.return=null),y.return=null}catch(H){jt(y,i,H)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)c0(i,s),i=i.sibling}function c0(s,i){var u=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Zr(i,s),fn(s),f&4){try{wa(3,s,s.return),jc(3,s)}catch(Re){jt(s,s.return,Re)}try{wa(5,s,s.return)}catch(Re){jt(s,s.return,Re)}}break;case 1:Zr(i,s),fn(s),f&512&&u!==null&&Jo(u,u.return);break;case 5:if(Zr(i,s),fn(s),f&512&&u!==null&&Jo(u,u.return),s.flags&32){var y=s.stateNode;try{ht(y,"")}catch(Re){jt(s,s.return,Re)}}if(f&4&&(y=s.stateNode,y!=null)){var b=s.memoizedProps,k=u!==null?u.memoizedProps:b,R=s.type,O=s.updateQueue;if(s.updateQueue=null,O!==null)try{R==="input"&&b.type==="radio"&&b.name!=null&&Hs(y,b),Tn(R,k);var H=Tn(R,b);for(k=0;k<O.length;k+=2){var ne=O[k],ie=O[k+1];ne==="style"?an(y,ie):ne==="dangerouslySetInnerHTML"?nt(y,ie):ne==="children"?ht(y,ie):N(y,ne,ie,H)}switch(R){case"input":kn(y,b);break;case"textarea":J(y,b);break;case"select":var re=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!b.multiple;var we=b.value;we!=null?br(y,!!b.multiple,we,!1):re!==!!b.multiple&&(b.defaultValue!=null?br(y,!!b.multiple,b.defaultValue,!0):br(y,!!b.multiple,b.multiple?[]:"",!1))}y[ua]=b}catch(Re){jt(s,s.return,Re)}}break;case 6:if(Zr(i,s),fn(s),f&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,b=s.memoizedProps;try{y.nodeValue=b}catch(Re){jt(s,s.return,Re)}}break;case 3:if(Zr(i,s),fn(s),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Xi(i.containerInfo)}catch(Re){jt(s,s.return,Re)}break;case 4:Zr(i,s),fn(s);break;case 13:Zr(i,s),fn(s),y=s.child,y.flags&8192&&(b=y.memoizedState!==null,y.stateNode.isHidden=b,!b||y.alternate!==null&&y.alternate.memoizedState!==null||(xh=pt())),f&4&&l0(s);break;case 22:if(ne=u!==null&&u.memoizedState!==null,s.mode&1?(Yt=(H=Yt)||ne,Zr(i,s),Yt=H):Zr(i,s),fn(s),f&8192){if(H=s.memoizedState!==null,(s.stateNode.isHidden=H)&&!ne&&(s.mode&1)!==0)for(Pe=s,ne=s.child;ne!==null;){for(ie=Pe=ne;Pe!==null;){switch(re=Pe,we=re.child,re.tag){case 0:case 11:case 14:case 15:wa(4,re,re.return);break;case 1:Jo(re,re.return);var Ae=re.stateNode;if(typeof Ae.componentWillUnmount=="function"){f=re,u=re.return;try{i=f,Ae.props=i.memoizedProps,Ae.state=i.memoizedState,Ae.componentWillUnmount()}catch(Re){jt(f,u,Re)}}break;case 5:Jo(re,re.return);break;case 22:if(re.memoizedState!==null){h0(ie);continue}}we!==null?(we.return=re,Pe=we):h0(ie)}ne=ne.sibling}e:for(ne=null,ie=s;;){if(ie.tag===5){if(ne===null){ne=ie;try{y=ie.stateNode,H?(b=y.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(R=ie.stateNode,O=ie.memoizedProps.style,k=O!=null&&O.hasOwnProperty("display")?O.display:null,R.style.display=Pn("display",k))}catch(Re){jt(s,s.return,Re)}}}else if(ie.tag===6){if(ne===null)try{ie.stateNode.nodeValue=H?"":ie.memoizedProps}catch(Re){jt(s,s.return,Re)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===s)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===s)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===s)break e;ne===ie&&(ne=null),ie=ie.return}ne===ie&&(ne=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:Zr(i,s),fn(s),f&4&&l0(s);break;case 21:break;default:Zr(i,s),fn(s)}}function fn(s){var i=s.flags;if(i&2){try{e:{for(var u=s.return;u!==null;){if(o0(u)){var f=u;break e}u=u.return}throw Error(t(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(ht(y,""),f.flags&=-33);var b=i0(s);gh(s,b,y);break;case 3:case 4:var k=f.stateNode.containerInfo,R=i0(s);mh(s,R,k);break;default:throw Error(t(161))}}catch(O){jt(s,s.return,O)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function g_(s,i,u){Pe=s,u0(s)}function u0(s,i,u){for(var f=(s.mode&1)!==0;Pe!==null;){var y=Pe,b=y.child;if(y.tag===22&&f){var k=y.memoizedState!==null||Ac;if(!k){var R=y.alternate,O=R!==null&&R.memoizedState!==null||Yt;R=Ac;var H=Yt;if(Ac=k,(Yt=O)&&!H)for(Pe=y;Pe!==null;)k=Pe,O=k.child,k.tag===22&&k.memoizedState!==null?f0(y):O!==null?(O.return=k,Pe=O):f0(y);for(;b!==null;)Pe=b,u0(b),b=b.sibling;Pe=y,Ac=R,Yt=H}d0(s)}else(y.subtreeFlags&8772)!==0&&b!==null?(b.return=y,Pe=b):d0(s)}}function d0(s){for(;Pe!==null;){var i=Pe;if((i.flags&8772)!==0){var u=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Yt||jc(5,i);break;case 1:var f=i.stateNode;if(i.flags&4&&!Yt)if(u===null)f.componentDidMount();else{var y=i.elementType===i.type?u.memoizedProps:Gr(i.type,u.memoizedProps);f.componentDidUpdate(y,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&hg(i,b,f);break;case 3:var k=i.updateQueue;if(k!==null){if(u=null,i.child!==null)switch(i.child.tag){case 5:u=i.child.stateNode;break;case 1:u=i.child.stateNode}hg(i,k,u)}break;case 5:var R=i.stateNode;if(u===null&&i.flags&4){u=R;var O=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":O.autoFocus&&u.focus();break;case"img":O.src&&(u.src=O.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var H=i.alternate;if(H!==null){var ne=H.memoizedState;if(ne!==null){var ie=ne.dehydrated;ie!==null&&Xi(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Yt||i.flags&512&&ph(i)}catch(re){jt(i,i.return,re)}}if(i===s){Pe=null;break}if(u=i.sibling,u!==null){u.return=i.return,Pe=u;break}Pe=i.return}}function h0(s){for(;Pe!==null;){var i=Pe;if(i===s){Pe=null;break}var u=i.sibling;if(u!==null){u.return=i.return,Pe=u;break}Pe=i.return}}function f0(s){for(;Pe!==null;){var i=Pe;try{switch(i.tag){case 0:case 11:case 15:var u=i.return;try{jc(4,i)}catch(O){jt(i,u,O)}break;case 1:var f=i.stateNode;if(typeof f.componentDidMount=="function"){var y=i.return;try{f.componentDidMount()}catch(O){jt(i,y,O)}}var b=i.return;try{ph(i)}catch(O){jt(i,b,O)}break;case 5:var k=i.return;try{ph(i)}catch(O){jt(i,k,O)}}}catch(O){jt(i,i.return,O)}if(i===s){Pe=null;break}var R=i.sibling;if(R!==null){R.return=i.return,Pe=R;break}Pe=i.return}}var y_=Math.ceil,Rc=M.ReactCurrentDispatcher,yh=M.ReactCurrentOwner,$r=M.ReactCurrentBatchConfig,lt=0,Vt=null,Ot=null,Gt=0,Cr=0,Qo=ds(0),Ut=0,Sa=null,to=0,Nc=0,vh=0,_a=null,mr=null,xh=0,Yo=1/0,Fn=null,Ic=!1,bh=null,ys=null,Dc=!1,vs=null,Lc=0,ka=0,wh=null,Oc=-1,Mc=0;function ar(){return(lt&6)!==0?pt():Oc!==-1?Oc:Oc=pt()}function xs(s){return(s.mode&1)===0?1:(lt&2)!==0&&Gt!==0?Gt&-Gt:e_.transition!==null?(Mc===0&&(Mc=me()),Mc):(s=Fe,s!==0||(s=window.event,s=s===void 0?16:mm(s.type)),s)}function Jr(s,i,u,f){if(50<ka)throw ka=0,wh=null,Error(t(185));Ze(s,u,f),((lt&2)===0||s!==Vt)&&(s===Vt&&((lt&2)===0&&(Nc|=u),Ut===4&&bs(s,Gt)),gr(s,f),u===1&&lt===0&&(i.mode&1)===0&&(Yo=pt()+500,dc&&fs()))}function gr(s,i){var u=s.callbackNode;ue(s,i);var f=Y(s,s===Vt?Gt:0);if(f===0)u!==null&&zl(u),s.callbackNode=null,s.callbackPriority=0;else if(i=f&-f,s.callbackPriority!==i){if(u!=null&&zl(u),i===1)s.tag===0?XS(m0.bind(null,s)):eg(m0.bind(null,s)),ZS(function(){(lt&6)===0&&fs()}),u=null;else{switch(St(f)){case 1:u=ln;break;case 4:u=ql;break;case 16:u=Rn;break;case 536870912:u=Hl;break;default:u=Rn}u=_0(u,p0.bind(null,s))}s.callbackPriority=i,s.callbackNode=u}}function p0(s,i){if(Oc=-1,Mc=0,(lt&6)!==0)throw Error(t(327));var u=s.callbackNode;if(Xo()&&s.callbackNode!==u)return null;var f=Y(s,s===Vt?Gt:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||i)i=$c(s,f);else{i=f;var y=lt;lt|=2;var b=y0();(Vt!==s||Gt!==i)&&(Fn=null,Yo=pt()+500,no(s,i));do try{b_();break}catch(R){g0(s,R)}while(!0);Ud(),Rc.current=b,lt=y,Ot!==null?i=0:(Vt=null,Gt=0,i=Ut)}if(i!==0){if(i===2&&(y=ce(s),y!==0&&(f=y,i=Sh(s,y))),i===1)throw u=Sa,no(s,0),bs(s,f),gr(s,pt()),u;if(i===6)bs(s,f);else{if(y=s.current.alternate,(f&30)===0&&!v_(y)&&(i=$c(s,f),i===2&&(b=ce(s),b!==0&&(f=b,i=Sh(s,b))),i===1))throw u=Sa,no(s,0),bs(s,f),gr(s,pt()),u;switch(s.finishedWork=y,s.finishedLanes=f,i){case 0:case 1:throw Error(t(345));case 2:so(s,mr,Fn);break;case 3:if(bs(s,f),(f&130023424)===f&&(i=xh+500-pt(),10<i)){if(Y(s,0)!==0)break;if(y=s.suspendedLanes,(y&f)!==f){ar(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=Td(so.bind(null,s,mr,Fn),i);break}so(s,mr,Fn);break;case 4:if(bs(s,f),(f&4194240)===f)break;for(i=s.eventTimes,y=-1;0<f;){var k=31-wr(f);b=1<<k,k=i[k],k>y&&(y=k),f&=~b}if(f=y,f=pt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*y_(f/1960))-f,10<f){s.timeoutHandle=Td(so.bind(null,s,mr,Fn),f);break}so(s,mr,Fn);break;case 5:so(s,mr,Fn);break;default:throw Error(t(329))}}}return gr(s,pt()),s.callbackNode===u?p0.bind(null,s):null}function Sh(s,i){var u=_a;return s.current.memoizedState.isDehydrated&&(no(s,i).flags|=256),s=$c(s,i),s!==2&&(i=mr,mr=u,i!==null&&_h(i)),s}function _h(s){mr===null?mr=s:mr.push.apply(mr,s)}function v_(s){for(var i=s;;){if(i.flags&16384){var u=i.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var y=u[f],b=y.getSnapshot;y=y.value;try{if(!Hr(b(),y))return!1}catch{return!1}}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function bs(s,i){for(i&=~vh,i&=~Nc,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var u=31-wr(i),f=1<<u;s[u]=-1,i&=~f}}function m0(s){if((lt&6)!==0)throw Error(t(327));Xo();var i=Y(s,0);if((i&1)===0)return gr(s,pt()),null;var u=$c(s,i);if(s.tag!==0&&u===2){var f=ce(s);f!==0&&(i=f,u=Sh(s,f))}if(u===1)throw u=Sa,no(s,0),bs(s,i),gr(s,pt()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,so(s,mr,Fn),gr(s,pt()),null}function kh(s,i){var u=lt;lt|=1;try{return s(i)}finally{lt=u,lt===0&&(Yo=pt()+500,dc&&fs())}}function ro(s){vs!==null&&vs.tag===0&&(lt&6)===0&&Xo();var i=lt;lt|=1;var u=$r.transition,f=Fe;try{if($r.transition=null,Fe=1,s)return s()}finally{Fe=f,$r.transition=u,lt=i,(lt&6)===0&&fs()}}function Ch(){Cr=Qo.current,xt(Qo)}function no(s,i){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,KS(u)),Ot!==null)for(u=Ot.return;u!==null;){var f=u;switch(Dd(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&cc();break;case 3:Ko(),xt(hr),xt(Zt),Gd();break;case 5:Hd(f);break;case 4:Ko();break;case 13:xt(kt);break;case 19:xt(kt);break;case 10:Fd(f.type._context);break;case 22:case 23:Ch()}u=u.return}if(Vt=s,Ot=s=ws(s.current,null),Gt=Cr=i,Ut=0,Sa=null,vh=Nc=to=0,mr=_a=null,Ys!==null){for(i=0;i<Ys.length;i++)if(u=Ys[i],f=u.interleaved,f!==null){u.interleaved=null;var y=f.next,b=u.pending;if(b!==null){var k=b.next;b.next=y,f.next=k}u.pending=f}Ys=null}return s}function g0(s,i){do{var u=Ot;try{if(Ud(),wc.current=Cc,Sc){for(var f=Ct.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}Sc=!1}if(eo=0,zt=$t=Ct=null,ga=!1,ya=0,yh.current=null,u===null||u.return===null){Ut=1,Sa=i,Ot=null;break}e:{var b=s,k=u.return,R=u,O=i;if(i=Gt,R.flags|=32768,O!==null&&typeof O=="object"&&typeof O.then=="function"){var H=O,ne=R,ie=ne.tag;if((ne.mode&1)===0&&(ie===0||ie===11||ie===15)){var re=ne.alternate;re?(ne.updateQueue=re.updateQueue,ne.memoizedState=re.memoizedState,ne.lanes=re.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var we=zg(k);if(we!==null){we.flags&=-257,Vg(we,k,R,b,i),we.mode&1&&Fg(b,H,i),i=we,O=H;var Ae=i.updateQueue;if(Ae===null){var Re=new Set;Re.add(O),i.updateQueue=Re}else Ae.add(O);break e}else{if((i&1)===0){Fg(b,H,i),Eh();break e}O=Error(t(426))}}else if(_t&&R.mode&1){var It=zg(k);if(It!==null){(It.flags&65536)===0&&(It.flags|=256),Vg(It,k,R,b,i),Md(Zo(O,R));break e}}b=O=Zo(O,R),Ut!==4&&(Ut=2),_a===null?_a=[b]:_a.push(b),b=k;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var V=$g(b,O,i);dg(b,V);break e;case 1:R=O;var U=b.type,B=b.stateNode;if((b.flags&128)===0&&(typeof U.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(ys===null||!ys.has(B)))){b.flags|=65536,i&=-i,b.lanes|=i;var fe=Ug(b,R,i);dg(b,fe);break e}}b=b.return}while(b!==null)}x0(u)}catch(Ne){i=Ne,Ot===u&&u!==null&&(Ot=u=u.return);continue}break}while(!0)}function y0(){var s=Rc.current;return Rc.current=Cc,s===null?Cc:s}function Eh(){(Ut===0||Ut===3||Ut===2)&&(Ut=4),Vt===null||(to&268435455)===0&&(Nc&268435455)===0||bs(Vt,Gt)}function $c(s,i){var u=lt;lt|=2;var f=y0();(Vt!==s||Gt!==i)&&(Fn=null,no(s,i));do try{x_();break}catch(y){g0(s,y)}while(!0);if(Ud(),lt=u,Rc.current=f,Ot!==null)throw Error(t(261));return Vt=null,Gt=0,Ut}function x_(){for(;Ot!==null;)v0(Ot)}function b_(){for(;Ot!==null&&!sd();)v0(Ot)}function v0(s){var i=S0(s.alternate,s,Cr);s.memoizedProps=s.pendingProps,i===null?x0(s):Ot=i,yh.current=null}function x0(s){var i=s;do{var u=i.alternate;if(s=i.return,(i.flags&32768)===0){if(u=h_(u,i,Cr),u!==null){Ot=u;return}}else{if(u=f_(u,i),u!==null){u.flags&=32767,Ot=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Ut=6,Ot=null;return}}if(i=i.sibling,i!==null){Ot=i;return}Ot=i=s}while(i!==null);Ut===0&&(Ut=5)}function so(s,i,u){var f=Fe,y=$r.transition;try{$r.transition=null,Fe=1,w_(s,i,u,f)}finally{$r.transition=y,Fe=f}return null}function w_(s,i,u,f){do Xo();while(vs!==null);if((lt&6)!==0)throw Error(t(327));u=s.finishedWork;var y=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var b=u.lanes|u.childLanes;if(ut(s,b),s===Vt&&(Ot=Vt=null,Gt=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Dc||(Dc=!0,_0(Rn,function(){return Xo(),null})),b=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||b){b=$r.transition,$r.transition=null;var k=Fe;Fe=1;var R=lt;lt|=4,yh.current=null,m_(s,u),c0(u,s),zS(Ed),Zl=!!Cd,Ed=Cd=null,s.current=u,g_(u),Vl(),lt=R,Fe=k,$r.transition=b}else s.current=u;if(Dc&&(Dc=!1,vs=s,Lc=y),b=s.pendingLanes,b===0&&(ys=null),od(u.stateNode),gr(s,pt()),i!==null)for(f=s.onRecoverableError,u=0;u<i.length;u++)y=i[u],f(y.value,{componentStack:y.stack,digest:y.digest});if(Ic)throw Ic=!1,s=bh,bh=null,s;return(Lc&1)!==0&&s.tag!==0&&Xo(),b=s.pendingLanes,(b&1)!==0?s===wh?ka++:(ka=0,wh=s):ka=0,fs(),null}function Xo(){if(vs!==null){var s=St(Lc),i=$r.transition,u=Fe;try{if($r.transition=null,Fe=16>s?16:s,vs===null)var f=!1;else{if(s=vs,vs=null,Lc=0,(lt&6)!==0)throw Error(t(331));var y=lt;for(lt|=4,Pe=s.current;Pe!==null;){var b=Pe,k=b.child;if((Pe.flags&16)!==0){var R=b.deletions;if(R!==null){for(var O=0;O<R.length;O++){var H=R[O];for(Pe=H;Pe!==null;){var ne=Pe;switch(ne.tag){case 0:case 11:case 15:wa(8,ne,b)}var ie=ne.child;if(ie!==null)ie.return=ne,Pe=ie;else for(;Pe!==null;){ne=Pe;var re=ne.sibling,we=ne.return;if(s0(ne),ne===H){Pe=null;break}if(re!==null){re.return=we,Pe=re;break}Pe=we}}}var Ae=b.alternate;if(Ae!==null){var Re=Ae.child;if(Re!==null){Ae.child=null;do{var It=Re.sibling;Re.sibling=null,Re=It}while(Re!==null)}}Pe=b}}if((b.subtreeFlags&2064)!==0&&k!==null)k.return=b,Pe=k;else e:for(;Pe!==null;){if(b=Pe,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:wa(9,b,b.return)}var V=b.sibling;if(V!==null){V.return=b.return,Pe=V;break e}Pe=b.return}}var U=s.current;for(Pe=U;Pe!==null;){k=Pe;var B=k.child;if((k.subtreeFlags&2064)!==0&&B!==null)B.return=k,Pe=B;else e:for(k=U;Pe!==null;){if(R=Pe,(R.flags&2048)!==0)try{switch(R.tag){case 0:case 11:case 15:jc(9,R)}}catch(Ne){jt(R,R.return,Ne)}if(R===k){Pe=null;break e}var fe=R.sibling;if(fe!==null){fe.return=R.return,Pe=fe;break e}Pe=R.return}}if(lt=y,fs(),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(To,s)}catch{}f=!0}return f}finally{Fe=u,$r.transition=i}}return!1}function b0(s,i,u){i=Zo(u,i),i=$g(s,i,1),s=ms(s,i,1),i=ar(),s!==null&&(Ze(s,1,i),gr(s,i))}function jt(s,i,u){if(s.tag===3)b0(s,s,u);else for(;i!==null;){if(i.tag===3){b0(i,s,u);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ys===null||!ys.has(f))){s=Zo(u,s),s=Ug(i,s,1),i=ms(i,s,1),s=ar(),i!==null&&(Ze(i,1,s),gr(i,s));break}}i=i.return}}function S_(s,i,u){var f=s.pingCache;f!==null&&f.delete(i),i=ar(),s.pingedLanes|=s.suspendedLanes&u,Vt===s&&(Gt&u)===u&&(Ut===4||Ut===3&&(Gt&130023424)===Gt&&500>pt()-xh?no(s,0):vh|=u),gr(s,i)}function w0(s,i){i===0&&((s.mode&1)===0?i=1:(i=z,z<<=1,(z&130023424)===0&&(z=4194304)));var u=ar();s=Mn(s,i),s!==null&&(Ze(s,i,u),gr(s,u))}function __(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),w0(s,u)}function k_(s,i){var u=0;switch(s.tag){case 13:var f=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(i),w0(s,u)}var S0;S0=function(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps||hr.current)pr=!0;else{if((s.lanes&u)===0&&(i.flags&128)===0)return pr=!1,d_(s,i,u);pr=(s.flags&131072)!==0}else pr=!1,_t&&(i.flags&1048576)!==0&&tg(i,fc,i.index);switch(i.lanes=0,i.tag){case 2:var f=i.type;Tc(s,i),s=i.pendingProps;var y=zo(i,Zt.current);Go(i,u),y=Jd(null,i,f,s,y,u);var b=Qd();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,fr(f)?(b=!0,uc(i)):b=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Bd(i),y.updater=Ec,i.stateNode=y,y._reactInternals=i,nh(i,f,s,u),i=ah(null,i,f,!0,b,u)):(i.tag=0,_t&&b&&Id(i),ir(null,i,y,u),i=i.child),i;case 16:f=i.elementType;e:{switch(Tc(s,i),s=i.pendingProps,y=f._init,f=y(f._payload),i.type=f,y=i.tag=E_(f),s=Gr(f,s),y){case 0:i=ih(null,i,f,s,u);break e;case 1:i=Kg(null,i,f,s,u);break e;case 11:i=Bg(null,i,f,s,u);break e;case 14:i=qg(null,i,f,Gr(f.type,s),u);break e}throw Error(t(306,f,""))}return i;case 0:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:Gr(f,y),ih(s,i,f,y,u);case 1:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:Gr(f,y),Kg(s,i,f,y,u);case 3:e:{if(Zg(i),s===null)throw Error(t(387));f=i.pendingProps,b=i.memoizedState,y=b.element,ug(s,i),xc(i,f,null,u);var k=i.memoizedState;if(f=k.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:k.cache,pendingSuspenseBoundaries:k.pendingSuspenseBoundaries,transitions:k.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){y=Zo(Error(t(423)),i),i=Jg(s,i,f,u,y);break e}else if(f!==y){y=Zo(Error(t(424)),i),i=Jg(s,i,f,u,y);break e}else for(kr=us(i.stateNode.containerInfo.firstChild),_r=i,_t=!0,Wr=null,u=lg(i,null,f,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(qo(),f===y){i=Un(s,i,u);break e}ir(s,i,f,u)}i=i.child}return i;case 5:return fg(i),s===null&&Od(i),f=i.type,y=i.pendingProps,b=s!==null?s.memoizedProps:null,k=y.children,Pd(f,y)?k=null:b!==null&&Pd(f,b)&&(i.flags|=32),Gg(s,i),ir(s,i,k,u),i.child;case 6:return s===null&&Od(i),null;case 13:return Qg(s,i,u);case 4:return qd(i,i.stateNode.containerInfo),f=i.pendingProps,s===null?i.child=Ho(i,null,f,u):ir(s,i,f,u),i.child;case 11:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:Gr(f,y),Bg(s,i,f,y,u);case 7:return ir(s,i,i.pendingProps,u),i.child;case 8:return ir(s,i,i.pendingProps.children,u),i.child;case 12:return ir(s,i,i.pendingProps.children,u),i.child;case 10:e:{if(f=i.type._context,y=i.pendingProps,b=i.memoizedProps,k=y.value,mt(gc,f._currentValue),f._currentValue=k,b!==null)if(Hr(b.value,k)){if(b.children===y.children&&!hr.current){i=Un(s,i,u);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var R=b.dependencies;if(R!==null){k=b.child;for(var O=R.firstContext;O!==null;){if(O.context===f){if(b.tag===1){O=$n(-1,u&-u),O.tag=2;var H=b.updateQueue;if(H!==null){H=H.shared;var ne=H.pending;ne===null?O.next=O:(O.next=ne.next,ne.next=O),H.pending=O}}b.lanes|=u,O=b.alternate,O!==null&&(O.lanes|=u),zd(b.return,u,i),R.lanes|=u;break}O=O.next}}else if(b.tag===10)k=b.type===i.type?null:b.child;else if(b.tag===18){if(k=b.return,k===null)throw Error(t(341));k.lanes|=u,R=k.alternate,R!==null&&(R.lanes|=u),zd(k,u,i),k=b.sibling}else k=b.child;if(k!==null)k.return=b;else for(k=b;k!==null;){if(k===i){k=null;break}if(b=k.sibling,b!==null){b.return=k.return,k=b;break}k=k.return}b=k}ir(s,i,y.children,u),i=i.child}return i;case 9:return y=i.type,f=i.pendingProps.children,Go(i,u),y=Or(y),f=f(y),i.flags|=1,ir(s,i,f,u),i.child;case 14:return f=i.type,y=Gr(f,i.pendingProps),y=Gr(f.type,y),qg(s,i,f,y,u);case 15:return Hg(s,i,i.type,i.pendingProps,u);case 17:return f=i.type,y=i.pendingProps,y=i.elementType===f?y:Gr(f,y),Tc(s,i),i.tag=1,fr(f)?(s=!0,uc(i)):s=!1,Go(i,u),Og(i,f,y),nh(i,f,y,u),ah(null,i,f,!0,s,u);case 19:return Xg(s,i,u);case 22:return Wg(s,i,u)}throw Error(t(156,i.tag))};function _0(s,i){return Fl(s,i)}function C_(s,i,u,f){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(s,i,u,f){return new C_(s,i,u,f)}function Ph(s){return s=s.prototype,!(!s||!s.isReactComponent)}function E_(s){if(typeof s=="function")return Ph(s)?1:0;if(s!=null){if(s=s.$$typeof,s===ee)return 11;if(s===Se)return 14}return 2}function ws(s,i){var u=s.alternate;return u===null?(u=Ur(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function Uc(s,i,u,f,y,b){var k=2;if(f=s,typeof s=="function")Ph(s)&&(k=1);else if(typeof s=="string")k=5;else e:switch(s){case Z:return oo(u.children,y,b,i);case W:k=8,y|=8;break;case de:return s=Ur(12,u,i,y|2),s.elementType=de,s.lanes=b,s;case ye:return s=Ur(13,u,i,y),s.elementType=ye,s.lanes=b,s;case G:return s=Ur(19,u,i,y),s.elementType=G,s.lanes=b,s;case _e:return Fc(u,y,b,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case pe:k=10;break e;case Ee:k=9;break e;case ee:k=11;break e;case Se:k=14;break e;case Ce:k=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Ur(k,u,i,y),i.elementType=s,i.type=f,i.lanes=b,i}function oo(s,i,u,f){return s=Ur(7,s,f,i),s.lanes=u,s}function Fc(s,i,u,f){return s=Ur(22,s,f,i),s.elementType=_e,s.lanes=u,s.stateNode={isHidden:!1},s}function Th(s,i,u){return s=Ur(6,s,null,i),s.lanes=u,s}function Ah(s,i,u){return i=Ur(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function P_(s,i,u,f,y){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Te(0),this.expirationTimes=Te(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Te(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function jh(s,i,u,f,y,b,k,R,O){return s=new P_(s,i,u,R,O),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Ur(3,null,null,i),s.current=b,b.stateNode=s,b.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bd(b),s}function T_(s,i,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:K,key:f==null?null:""+f,children:s,containerInfo:i,implementation:u}}function k0(s){if(!s)return hs;s=s._reactInternals;e:{if(jn(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(fr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(fr(u))return Ym(s,u,i)}return i}function C0(s,i,u,f,y,b,k,R,O){return s=jh(u,f,!0,s,y,b,k,R,O),s.context=k0(null),u=s.current,f=ar(),y=xs(u),b=$n(f,y),b.callback=i??null,ms(u,b,y),s.current.lanes=y,Ze(s,y,f),gr(s,f),s}function zc(s,i,u,f){var y=i.current,b=ar(),k=xs(y);return u=k0(u),i.context===null?i.context=u:i.pendingContext=u,i=$n(b,k),i.payload={element:s},f=f===void 0?null:f,f!==null&&(i.callback=f),s=ms(y,i,k),s!==null&&(Jr(s,y,k,b),vc(s,y,k)),k}function Vc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function E0(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function Rh(s,i){E0(s,i),(s=s.alternate)&&E0(s,i)}function A_(){return null}var P0=typeof reportError=="function"?reportError:function(s){console.error(s)};function Nh(s){this._internalRoot=s}Bc.prototype.render=Nh.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));zc(s,i,null,null)},Bc.prototype.unmount=Nh.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;ro(function(){zc(null,s,null,null)}),i[In]=null}};function Bc(s){this._internalRoot=s}Bc.prototype.unstable_scheduleHydration=function(s){if(s){var i=Wl();s={blockedOn:null,target:s,priority:i};for(var u=0;u<as.length&&i!==0&&i<as[u].priority;u++);as.splice(u,0,s),u===0&&fm(s)}};function Ih(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function qc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function T0(){}function j_(s,i,u,f,y){if(y){if(typeof f=="function"){var b=f;f=function(){var H=Vc(k);b.call(H)}}var k=C0(i,f,s,0,null,!1,!1,"",T0);return s._reactRootContainer=k,s[In]=k.current,la(s.nodeType===8?s.parentNode:s),ro(),k}for(;y=s.lastChild;)s.removeChild(y);if(typeof f=="function"){var R=f;f=function(){var H=Vc(O);R.call(H)}}var O=jh(s,0,!1,null,null,!1,!1,"",T0);return s._reactRootContainer=O,s[In]=O.current,la(s.nodeType===8?s.parentNode:s),ro(function(){zc(i,O,u,f)}),O}function Hc(s,i,u,f,y){var b=u._reactRootContainer;if(b){var k=b;if(typeof y=="function"){var R=y;y=function(){var O=Vc(k);R.call(O)}}zc(i,k,s,y)}else k=j_(u,i,s,y,f);return Vc(k)}or=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var u=$(i.pendingLanes);u!==0&&(at(i,u|1),gr(i,pt()),(lt&6)===0&&(Yo=pt()+500,fs()))}break;case 13:ro(function(){var f=Mn(s,1);if(f!==null){var y=ar();Jr(f,s,1,y)}}),Rh(s,1)}},Nn=function(s){if(s.tag===13){var i=Mn(s,134217728);if(i!==null){var u=ar();Jr(i,s,134217728,u)}Rh(s,134217728)}},Ao=function(s){if(s.tag===13){var i=xs(s),u=Mn(s,i);if(u!==null){var f=ar();Jr(u,s,i,f)}Rh(s,i)}},Wl=function(){return Fe},jo=function(s,i){var u=Fe;try{return Fe=s,i()}finally{Fe=u}},Ir=function(s,i,u){switch(i){case"input":if(kn(s,u),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<u.length;i++){var f=u[i];if(f!==s&&f.form===s.form){var y=lc(f);if(!y)throw Error(t(90));sr(f),kn(f,y)}}}break;case"textarea":J(s,u);break;case"select":i=u.value,i!=null&&br(s,!!u.multiple,i,!1)}},Il=kh,Dl=ro;var R_={usingClientEntryPoint:!1,Events:[da,Uo,lc,Rl,Nl,kh]},Ca={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},N_={bundleType:Ca.bundleType,version:Ca.version,rendererPackageName:Ca.rendererPackageName,rendererConfig:Ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=$l(s),s===null?null:s.stateNode},findFiberByHostInstance:Ca.findFiberByHostInstance||A_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{To=Wc.inject(N_),dr=Wc}catch{}}return yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R_,yr.createPortal=function(s,i){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ih(i))throw Error(t(200));return T_(s,i,null,u)},yr.createRoot=function(s,i){if(!Ih(s))throw Error(t(299));var u=!1,f="",y=P0;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),i=jh(s,1,!1,null,null,u,!1,f,y),s[In]=i.current,la(s.nodeType===8?s.parentNode:s),new Nh(i)},yr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=$l(i),s=s===null?null:s.stateNode,s},yr.flushSync=function(s){return ro(s)},yr.hydrate=function(s,i,u){if(!qc(i))throw Error(t(200));return Hc(null,s,i,!0,u)},yr.hydrateRoot=function(s,i,u){if(!Ih(s))throw Error(t(405));var f=u!=null&&u.hydratedSources||null,y=!1,b="",k=P0;if(u!=null&&(u.unstable_strictMode===!0&&(y=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onRecoverableError!==void 0&&(k=u.onRecoverableError)),i=C0(i,null,s,1,u??null,y,!1,b,k),s[In]=i.current,la(s),f)for(s=0;s<f.length;s++)u=f[s],y=u._getVersion,y=y(u._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[u,y]:i.mutableSourceEagerHydrationData.push(u,y);return new Bc(i)},yr.render=function(s,i,u){if(!qc(i))throw Error(t(200));return Hc(null,s,i,!1,u)},yr.unmountComponentAtNode=function(s){if(!qc(s))throw Error(t(40));return s._reactRootContainer?(ro(function(){Hc(null,null,s,!1,function(){s._reactRootContainer=null,s[In]=null})}),!0):!1},yr.unstable_batchedUpdates=kh,yr.unstable_renderSubtreeIntoContainer=function(s,i,u,f){if(!qc(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Hc(s,i,u,!1,f)},yr.version="18.3.1-next-f1338f8080-20240426",yr}var O0;function lx(){if(O0)return Oh.exports;O0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Oh.exports=V_(),Oh.exports}var M0;function B_(){if(M0)return Kc;M0=1;var r=lx();return Kc.createRoot=r.createRoot,Kc.hydrateRoot=r.hydrateRoot,Kc}var q_=B_();const H_=Sl(q_);var W_=lx();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ya(){return Ya=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Ya.apply(this,arguments)}var Ns;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(Ns||(Ns={}));const $0="popstate";function G_(r){r===void 0&&(r={});function e(n,o){let{pathname:a,search:l,hash:c}=n.location;return Sf("",{pathname:a,search:l,hash:c},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(n,o){return typeof o=="string"?o:fu(o)}return Z_(e,t,null,r)}function At(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function cx(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function K_(){return Math.random().toString(36).substr(2,8)}function U0(r,e){return{usr:r.state,key:r.key,idx:e}}function Sf(r,e,t,n){return t===void 0&&(t=null),Ya({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof e=="string"?Di(e):e,{state:t,key:e&&e.key||n||K_()})}function fu(r){let{pathname:e="/",search:t="",hash:n=""}=r;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Di(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substr(t),r=r.substr(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substr(n),r=r.substr(0,n)),r&&(e.pathname=r)}return e}function Z_(r,e,t,n){n===void 0&&(n={});let{window:o=document.defaultView,v5Compat:a=!1}=n,l=o.history,c=Ns.Pop,d=null,h=m();h==null&&(h=0,l.replaceState(Ya({},l.state,{idx:h}),""));function m(){return(l.state||{idx:null}).idx}function g(){c=Ns.Pop;let _=m(),C=_==null?null:_-h;h=_,d&&d({action:c,location:S.location,delta:C})}function v(_,C){c=Ns.Push;let E=Sf(S.location,_,C);h=m()+1;let N=U0(E,h),M=S.createHref(E);try{l.pushState(N,"",M)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;o.location.assign(M)}a&&d&&d({action:c,location:S.location,delta:1})}function x(_,C){c=Ns.Replace;let E=Sf(S.location,_,C);h=m();let N=U0(E,h),M=S.createHref(E);l.replaceState(N,"",M),a&&d&&d({action:c,location:S.location,delta:0})}function w(_){let C=o.location.origin!=="null"?o.location.origin:o.location.href,E=typeof _=="string"?_:fu(_);return E=E.replace(/ $/,"%20"),At(C,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,C)}let S={get action(){return c},get location(){return r(o,l)},listen(_){if(d)throw new Error("A history only accepts one active listener");return o.addEventListener($0,g),d=_,()=>{o.removeEventListener($0,g),d=null}},createHref(_){return e(o,_)},createURL:w,encodeLocation(_){let C=w(_);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:v,replace:x,go(_){return l.go(_)}};return S}var F0;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(F0||(F0={}));function J_(r,e,t){return t===void 0&&(t="/"),Q_(r,e,t)}function Q_(r,e,t,n){let o=typeof e=="string"?Di(e):e,a=_i(o.pathname||"/",t);if(a==null)return null;let l=ux(r);Y_(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let h=ck(a);c=ak(l[d],h)}return c}function ux(r,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let o=(a,l,c)=>{let d={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};d.relativePath.startsWith("/")&&(At(d.relativePath.startsWith(n),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(n.length));let h=Is([n,d.relativePath]),m=t.concat(d);a.children&&a.children.length>0&&(At(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),ux(a.children,e,m,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:ok(h,a.index),routesMeta:m})};return r.forEach((a,l)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))o(a,l);else for(let d of dx(a.path))o(a,l,d)}),e}function dx(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,o=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return o?[a,""]:[a];let l=dx(n.join("/")),c=[];return c.push(...l.map(d=>d===""?a:[a,d].join("/"))),o&&c.push(...l),c.map(d=>r.startsWith("/")&&d===""?"/":d)}function Y_(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:ik(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const X_=/^:[\w-]+$/,ek=3,tk=2,rk=1,nk=10,sk=-2,z0=r=>r==="*";function ok(r,e){let t=r.split("/"),n=t.length;return t.some(z0)&&(n+=sk),e&&(n+=tk),t.filter(o=>!z0(o)).reduce((o,a)=>o+(X_.test(a)?ek:a===""?rk:nk),n)}function ik(r,e){return r.length===e.length&&r.slice(0,-1).every((n,o)=>n===e[o])?r[r.length-1]-e[e.length-1]:0}function ak(r,e,t){let{routesMeta:n}=r,o={},a="/",l=[];for(let c=0;c<n.length;++c){let d=n[c],h=c===n.length-1,m=a==="/"?e:e.slice(a.length)||"/",g=_f({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),v=d.route;if(!g)return null;Object.assign(o,g.params),l.push({params:o,pathname:Is([a,g.pathname]),pathnameBase:fk(Is([a,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(a=Is([a,g.pathnameBase]))}return l}function _f(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=lk(r.path,r.caseSensitive,r.end),o=e.match(t);if(!o)return null;let a=o[0],l=a.replace(/(.)\/+$/,"$1"),c=o.slice(1);return{params:n.reduce((h,m,g)=>{let{paramName:v,isOptional:x}=m;if(v==="*"){let S=c[g]||"";l=a.slice(0,a.length-S.length).replace(/(.)\/+$/,"$1")}const w=c[g];return x&&!w?h[v]=void 0:h[v]=(w||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:l,pattern:r}}function lk(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),cx(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let n=[],o="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(n.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),o+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":r!==""&&r!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),n]}function ck(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return cx(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),r}}function _i(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function uk(r,e){e===void 0&&(e="/");let{pathname:t,search:n="",hash:o=""}=typeof r=="string"?Di(r):r;return{pathname:t?t.startsWith("/")?t:dk(t,e):e,search:pk(n),hash:mk(o)}}function dk(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Uh(r,e,t,n){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hk(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function cp(r,e){let t=hk(r);return e?t.map((n,o)=>o===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function up(r,e,t,n){n===void 0&&(n=!1);let o;typeof r=="string"?o=Di(r):(o=Ya({},r),At(!o.pathname||!o.pathname.includes("?"),Uh("?","pathname","search",o)),At(!o.pathname||!o.pathname.includes("#"),Uh("#","pathname","hash",o)),At(!o.search||!o.search.includes("#"),Uh("#","search","hash",o)));let a=r===""||o.pathname==="",l=a?"/":o.pathname,c;if(l==null)c=t;else{let g=e.length-1;if(!n&&l.startsWith("..")){let v=l.split("/");for(;v[0]==="..";)v.shift(),g-=1;o.pathname=v.join("/")}c=g>=0?e[g]:"/"}let d=uk(o,c),h=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}const Is=r=>r.join("/").replace(/\/\/+/g,"/"),fk=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),pk=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,mk=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function gk(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const hx=["post","put","patch","delete"];new Set(hx);const yk=["get",...hx];new Set(yk);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xa(){return Xa=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Xa.apply(this,arguments)}const Mu=j.createContext(null),fx=j.createContext(null),Yn=j.createContext(null),$u=j.createContext(null),Xn=j.createContext({outlet:null,matches:[],isDataRoute:!1}),px=j.createContext(null);function vk(r,e){let{relative:t}=e===void 0?{}:e;Li()||At(!1);let{basename:n,navigator:o}=j.useContext(Yn),{hash:a,pathname:l,search:c}=Uu(r,{relative:t}),d=l;return n!=="/"&&(d=l==="/"?n:Is([n,l])),o.createHref({pathname:d,search:c,hash:a})}function Li(){return j.useContext($u)!=null}function Oi(){return Li()||At(!1),j.useContext($u).location}function mx(r){j.useContext(Yn).static||j.useLayoutEffect(r)}function Vs(){let{isDataRoute:r}=j.useContext(Xn);return r?Ik():xk()}function xk(){Li()||At(!1);let r=j.useContext(Mu),{basename:e,future:t,navigator:n}=j.useContext(Yn),{matches:o}=j.useContext(Xn),{pathname:a}=Oi(),l=JSON.stringify(cp(o,t.v7_relativeSplatPath)),c=j.useRef(!1);return mx(()=>{c.current=!0}),j.useCallback(function(h,m){if(m===void 0&&(m={}),!c.current)return;if(typeof h=="number"){n.go(h);return}let g=up(h,JSON.parse(l),a,m.relative==="path");r==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Is([e,g.pathname])),(m.replace?n.replace:n.push)(g,m.state,m)},[e,n,l,a,r])}const bk=j.createContext(null);function wk(r){let e=j.useContext(Xn).outlet;return e&&j.createElement(bk.Provider,{value:r},e)}function Uu(r,e){let{relative:t}=e===void 0?{}:e,{future:n}=j.useContext(Yn),{matches:o}=j.useContext(Xn),{pathname:a}=Oi(),l=JSON.stringify(cp(o,n.v7_relativeSplatPath));return j.useMemo(()=>up(r,JSON.parse(l),a,t==="path"),[r,l,a,t])}function Sk(r,e){return _k(r,e)}function _k(r,e,t,n){Li()||At(!1);let{navigator:o,static:a}=j.useContext(Yn),{matches:l}=j.useContext(Xn),c=l[l.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let m=Oi(),g;if(e){var v;let C=typeof e=="string"?Di(e):e;h==="/"||(v=C.pathname)!=null&&v.startsWith(h)||At(!1),g=C}else g=m;let x=g.pathname||"/",w=x;if(h!=="/"){let C=h.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=J_(r,{pathname:w}),_=Tk(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},d,C.params),pathname:Is([h,o.encodeLocation?o.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Is([h,o.encodeLocation?o.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),l,t,n);return e&&_?j.createElement($u.Provider,{value:{location:Xa({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Ns.Pop}},_):_}function kk(){let r=Nk(),e=gk(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:o},t):null,null)}const Ck=j.createElement(kk,null);class Ek extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(Xn.Provider,{value:this.props.routeContext},j.createElement(px.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Pk(r){let{routeContext:e,match:t,children:n}=r,o=j.useContext(Mu);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(Xn.Provider,{value:e},n)}function Tk(r,e,t,n){var o;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),r==null){var a;if(!t)return null;if(t.errors)r=t.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let l=r,c=(o=t)==null?void 0:o.errors;if(c!=null){let m=l.findIndex(g=>g.route.id&&c?.[g.route.id]!==void 0);m>=0||At(!1),l=l.slice(0,Math.min(l.length,m+1))}let d=!1,h=-1;if(t&&n&&n.v7_partialHydration)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=m),g.route.id){let{loaderData:v,errors:x}=t,w=g.route.loader&&v[g.route.id]===void 0&&(!x||x[g.route.id]===void 0);if(g.route.lazy||w){d=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((m,g,v)=>{let x,w=!1,S=null,_=null;t&&(x=c&&g.route.id?c[g.route.id]:void 0,S=g.route.errorElement||Ck,d&&(h<0&&v===0?(Dk("route-fallback"),w=!0,_=null):h===v&&(w=!0,_=g.route.hydrateFallbackElement||null)));let C=e.concat(l.slice(0,v+1)),E=()=>{let N;return x?N=S:w?N=_:g.route.Component?N=j.createElement(g.route.Component,null):g.route.element?N=g.route.element:N=m,j.createElement(Pk,{match:g,routeContext:{outlet:m,matches:C,isDataRoute:t!=null},children:N})};return t&&(g.route.ErrorBoundary||g.route.errorElement||v===0)?j.createElement(Ek,{location:t.location,revalidation:t.revalidation,component:S,error:x,children:E(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):E()},null)}var gx=function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r}(gx||{}),yx=function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r}(yx||{});function Ak(r){let e=j.useContext(Mu);return e||At(!1),e}function jk(r){let e=j.useContext(fx);return e||At(!1),e}function Rk(r){let e=j.useContext(Xn);return e||At(!1),e}function vx(r){let e=Rk(),t=e.matches[e.matches.length-1];return t.route.id||At(!1),t.route.id}function Nk(){var r;let e=j.useContext(px),t=jk(),n=vx();return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function Ik(){let{router:r}=Ak(gx.UseNavigateStable),e=vx(yx.UseNavigateStable),t=j.useRef(!1);return mx(()=>{t.current=!0}),j.useCallback(function(o,a){a===void 0&&(a={}),t.current&&(typeof o=="number"?r.navigate(o):r.navigate(o,Xa({fromRouteId:e},a)))},[r,e])}const V0={};function Dk(r,e,t){V0[r]||(V0[r]=!0)}function Lk(r,e){r?.v7_startTransition,r?.v7_relativeSplatPath}function Fh(r){let{to:e,replace:t,state:n,relative:o}=r;Li()||At(!1);let{future:a,static:l}=j.useContext(Yn),{matches:c}=j.useContext(Xn),{pathname:d}=Oi(),h=Vs(),m=up(e,cp(c,a.v7_relativeSplatPath),d,o==="path"),g=JSON.stringify(m);return j.useEffect(()=>h(JSON.parse(g),{replace:t,state:n,relative:o}),[h,g,o,t,n]),null}function Ok(r){return wk(r.context)}function co(r){At(!1)}function Mk(r){let{basename:e="/",children:t=null,location:n,navigationType:o=Ns.Pop,navigator:a,static:l=!1,future:c}=r;Li()&&At(!1);let d=e.replace(/^\/*/,"/"),h=j.useMemo(()=>({basename:d,navigator:a,static:l,future:Xa({v7_relativeSplatPath:!1},c)}),[d,c,a,l]);typeof n=="string"&&(n=Di(n));let{pathname:m="/",search:g="",hash:v="",state:x=null,key:w="default"}=n,S=j.useMemo(()=>{let _=_i(m,d);return _==null?null:{location:{pathname:_,search:g,hash:v,state:x,key:w},navigationType:o}},[d,m,g,v,x,w,o]);return S==null?null:j.createElement(Yn.Provider,{value:h},j.createElement($u.Provider,{children:t,value:S}))}function $k(r){let{children:e,location:t}=r;return Sk(kf(e),t)}new Promise(()=>{});function kf(r,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(r,(n,o)=>{if(!j.isValidElement(n))return;let a=[...e,o];if(n.type===j.Fragment){t.push.apply(t,kf(n.props.children,a));return}n.type!==co&&At(!1),!n.props.index||!n.props.children||At(!1);let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=kf(n.props.children,a)),t.push(l)}),t}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pu(){return pu=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},pu.apply(this,arguments)}function xx(r,e){if(r==null)return{};var t={},n=Object.keys(r),o,a;for(a=0;a<n.length;a++)o=n[a],!(e.indexOf(o)>=0)&&(t[o]=r[o]);return t}function Uk(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function Fk(r,e){return r.button===0&&(!e||e==="_self")&&!Uk(r)}const zk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Vk=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Bk="6";try{window.__reactRouterVersion=Bk}catch{}const qk=j.createContext({isTransitioning:!1}),Hk="startTransition",B0=U_[Hk];function Wk(r){let{basename:e,children:t,future:n,window:o}=r,a=j.useRef();a.current==null&&(a.current=G_({window:o,v5Compat:!0}));let l=a.current,[c,d]=j.useState({action:l.action,location:l.location}),{v7_startTransition:h}=n||{},m=j.useCallback(g=>{h&&B0?B0(()=>d(g)):d(g)},[d,h]);return j.useLayoutEffect(()=>l.listen(m),[l,m]),j.useEffect(()=>Lk(n),[n]),j.createElement(Mk,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:l,future:n})}const Gk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Kk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bx=j.forwardRef(function(e,t){let{onClick:n,relative:o,reloadDocument:a,replace:l,state:c,target:d,to:h,preventScrollReset:m,viewTransition:g}=e,v=xx(e,zk),{basename:x}=j.useContext(Yn),w,S=!1;if(typeof h=="string"&&Kk.test(h)&&(w=h,Gk))try{let N=new URL(window.location.href),M=h.startsWith("//")?new URL(N.protocol+h):new URL(h),A=_i(M.pathname,x);M.origin===N.origin&&A!=null?h=A+M.search+M.hash:S=!0}catch{}let _=vk(h,{relative:o}),C=Jk(h,{replace:l,state:c,target:d,preventScrollReset:m,relative:o,viewTransition:g});function E(N){n&&n(N),N.defaultPrevented||C(N)}return j.createElement("a",pu({},v,{href:w||_,onClick:S||a?n:E,ref:t,target:d}))}),zh=j.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:o=!1,className:a="",end:l=!1,style:c,to:d,viewTransition:h,children:m}=e,g=xx(e,Vk),v=Uu(d,{relative:g.relative}),x=Oi(),w=j.useContext(fx),{navigator:S,basename:_}=j.useContext(Yn),C=w!=null&&Qk(v)&&h===!0,E=S.encodeLocation?S.encodeLocation(v).pathname:v.pathname,N=x.pathname,M=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;o||(N=N.toLowerCase(),M=M?M.toLowerCase():null,E=E.toLowerCase()),M&&_&&(M=_i(M,_)||M);const A=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let K=N===E||!l&&N.startsWith(E)&&N.charAt(A)==="/",Z=M!=null&&(M===E||!l&&M.startsWith(E)&&M.charAt(E.length)==="/"),W={isActive:K,isPending:Z,isTransitioning:C},de=K?n:void 0,pe;typeof a=="function"?pe=a(W):pe=[a,K?"active":null,Z?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let Ee=typeof c=="function"?c(W):c;return j.createElement(bx,pu({},g,{"aria-current":de,className:pe,ref:t,style:Ee,to:d,viewTransition:h}),typeof m=="function"?m(W):m)});var Cf;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(Cf||(Cf={}));var q0;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(q0||(q0={}));function Zk(r){let e=j.useContext(Mu);return e||At(!1),e}function Jk(r,e){let{target:t,replace:n,state:o,preventScrollReset:a,relative:l,viewTransition:c}=e===void 0?{}:e,d=Vs(),h=Oi(),m=Uu(r,{relative:l});return j.useCallback(g=>{if(Fk(g,t)){g.preventDefault();let v=n!==void 0?n:fu(h)===fu(m);d(r,{replace:v,state:o,preventScrollReset:a,relative:l,viewTransition:c})}},[h,d,m,n,o,t,r,a,l,c])}function Qk(r,e){e===void 0&&(e={});let t=j.useContext(qk);t==null&&At(!1);let{basename:n}=Zk(Cf.useViewTransitionState),o=Uu(r,{relative:e.relative});if(!t.isTransitioning)return!1;let a=_i(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=_i(t.nextLocation.pathname,n)||t.nextLocation.pathname;return _f(o.pathname,l)!=null||_f(o.pathname,a)!=null}const dp=j.createContext({});function hp(r){const e=j.useRef(null);return e.current===null&&(e.current=r()),e.current}const Fu=j.createContext(null),fp=j.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});class Yk extends j.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Xk({children:r,isPresent:e}){const t=j.useId(),n=j.useRef(null),o=j.useRef({width:0,height:0,top:0,left:0}),{nonce:a}=j.useContext(fp);return j.useInsertionEffect(()=>{const{width:l,height:c,top:d,left:h}=o.current;if(e||!n.current||!l||!c)return;n.current.dataset.motionPopId=t;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            top: ${d}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(m)}},[e]),p.jsx(Yk,{isPresent:e,childRef:n,sizeRef:o,children:j.cloneElement(r,{ref:n})})}const e1=({children:r,initial:e,isPresent:t,onExitComplete:n,custom:o,presenceAffectsLayout:a,mode:l})=>{const c=hp(t1),d=j.useId(),h=j.useCallback(g=>{c.set(g,!0);for(const v of c.values())if(!v)return;n&&n()},[c,n]),m=j.useMemo(()=>({id:d,initial:e,isPresent:t,custom:o,onExitComplete:h,register:g=>(c.set(g,!1),()=>c.delete(g))}),a?[Math.random(),h]:[t,h]);return j.useMemo(()=>{c.forEach((g,v)=>c.set(v,!1))},[t]),j.useEffect(()=>{!t&&!c.size&&n&&n()},[t]),l==="popLayout"&&(r=p.jsx(Xk,{isPresent:t,children:r})),p.jsx(Fu.Provider,{value:m,children:r})};function t1(){return new Map}function wx(r=!0){const e=j.useContext(Fu);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:o}=e,a=j.useId();j.useEffect(()=>{r&&o(a)},[r]);const l=j.useCallback(()=>r&&n&&n(a),[a,n,r]);return!t&&n?[!1,l]:[!0]}const Zc=r=>r.key||"";function H0(r){const e=[];return j.Children.forEach(r,t=>{j.isValidElement(t)&&e.push(t)}),e}const pp=typeof window<"u",Sx=pp?j.useLayoutEffect:j.useEffect,Mi=({children:r,custom:e,initial:t=!0,onExitComplete:n,presenceAffectsLayout:o=!0,mode:a="sync",propagate:l=!1})=>{const[c,d]=wx(l),h=j.useMemo(()=>H0(r),[r]),m=l&&!c?[]:h.map(Zc),g=j.useRef(!0),v=j.useRef(h),x=hp(()=>new Map),[w,S]=j.useState(h),[_,C]=j.useState(h);Sx(()=>{g.current=!1,v.current=h;for(let M=0;M<_.length;M++){const A=Zc(_[M]);m.includes(A)?x.delete(A):x.get(A)!==!0&&x.set(A,!1)}},[_,m.length,m.join("-")]);const E=[];if(h!==w){let M=[...h];for(let A=0;A<_.length;A++){const K=_[A],Z=Zc(K);m.includes(Z)||(M.splice(A,0,K),E.push(K))}a==="wait"&&E.length&&(M=E),C(H0(M)),S(h);return}const{forceRender:N}=j.useContext(dp);return p.jsx(p.Fragment,{children:_.map(M=>{const A=Zc(M),K=l&&!c?!1:h===_||m.includes(A),Z=()=>{if(x.has(A))x.set(A,!0);else return;let W=!0;x.forEach(de=>{de||(W=!1)}),W&&(N?.(),C(v.current),l&&d?.(),n&&n())};return p.jsx(e1,{isPresent:K,initial:!g.current||t?void 0:!1,custom:K?void 0:e,presenceAffectsLayout:o,mode:a,onExitComplete:K?void 0:Z,children:M},A)})})},Tr=r=>r;let _x=Tr;function mp(r){let e;return()=>(e===void 0&&(e=r()),e)}const ki=(r,e,t)=>{const n=e-r;return n===0?1:(t-r)/n},Kn=r=>r*1e3,Zn=r=>r/1e3,r1={useManualTiming:!1};function n1(r){let e=new Set,t=new Set,n=!1,o=!1;const a=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(h){a.has(h)&&(d.schedule(h),r()),h(l)}const d={schedule:(h,m=!1,g=!1)=>{const x=g&&n?e:t;return m&&a.add(h),x.has(h)||x.add(h),h},cancel:h=>{t.delete(h),a.delete(h)},process:h=>{if(l=h,n){o=!0;return}n=!0,[e,t]=[t,e],e.forEach(c),e.clear(),n=!1,o&&(o=!1,d.process(h))}};return d}const Jc=["read","resolveKeyframes","update","preRender","render","postRender"],s1=40;function kx(r,e){let t=!1,n=!0;const o={delta:0,timestamp:0,isProcessing:!1},a=()=>t=!0,l=Jc.reduce((C,E)=>(C[E]=n1(a),C),{}),{read:c,resolveKeyframes:d,update:h,preRender:m,render:g,postRender:v}=l,x=()=>{const C=performance.now();t=!1,o.delta=n?1e3/60:Math.max(Math.min(C-o.timestamp,s1),1),o.timestamp=C,o.isProcessing=!0,c.process(o),d.process(o),h.process(o),m.process(o),g.process(o),v.process(o),o.isProcessing=!1,t&&e&&(n=!1,r(x))},w=()=>{t=!0,n=!0,o.isProcessing||r(x)};return{schedule:Jc.reduce((C,E)=>{const N=l[E];return C[E]=(M,A=!1,K=!1)=>(t||w(),N.schedule(M,A,K)),C},{}),cancel:C=>{for(let E=0;E<Jc.length;E++)l[Jc[E]].cancel(C)},state:o,steps:l}}const{schedule:wt,cancel:Os,state:Kt,steps:Vh}=kx(typeof requestAnimationFrame<"u"?requestAnimationFrame:Tr,!0),Cx=j.createContext({strict:!1}),W0={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ci={};for(const r in W0)Ci[r]={isEnabled:e=>W0[r].some(t=>!!e[t])};function o1(r){for(const e in r)Ci[e]={...Ci[e],...r[e]}}const i1=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function mu(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||i1.has(r)}let Ex=r=>!mu(r);function a1(r){r&&(Ex=e=>e.startsWith("on")?!mu(e):r(e))}try{a1(require("@emotion/is-prop-valid").default)}catch{}function l1(r,e,t){const n={};for(const o in r)o==="values"&&typeof r.values=="object"||(Ex(o)||t===!0&&mu(o)||!e&&!mu(o)||r.draggable&&o.startsWith("onDrag"))&&(n[o]=r[o]);return n}function c1(r){if(typeof Proxy>"u")return r;const e=new Map,t=(...n)=>r(...n);return new Proxy(t,{get:(n,o)=>o==="create"?r:(e.has(o)||e.set(o,r(o)),e.get(o))})}const zu=j.createContext({});function el(r){return typeof r=="string"||Array.isArray(r)}function Vu(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}const gp=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],yp=["initial",...gp];function Bu(r){return Vu(r.animate)||yp.some(e=>el(r[e]))}function Px(r){return!!(Bu(r)||r.variants)}function u1(r,e){if(Bu(r)){const{initial:t,animate:n}=r;return{initial:t===!1||el(t)?t:void 0,animate:el(n)?n:void 0}}return r.inherit!==!1?e:{}}function d1(r){const{initial:e,animate:t}=u1(r,j.useContext(zu));return j.useMemo(()=>({initial:e,animate:t}),[G0(e),G0(t)])}function G0(r){return Array.isArray(r)?r.join(" "):r}const h1=Symbol.for("motionComponentSymbol");function fi(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function f1(r,e,t){return j.useCallback(n=>{n&&r.onMount&&r.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):fi(t)&&(t.current=n))},[e])}const vp=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),p1="framerAppearId",Tx="data-"+vp(p1),{schedule:xp}=kx(queueMicrotask,!1),Ax=j.createContext({});function m1(r,e,t,n,o){var a,l;const{visualElement:c}=j.useContext(zu),d=j.useContext(Cx),h=j.useContext(Fu),m=j.useContext(fp).reducedMotion,g=j.useRef(null);n=n||d.renderer,!g.current&&n&&(g.current=n(r,{visualState:e,parent:c,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:m}));const v=g.current,x=j.useContext(Ax);v&&!v.projection&&o&&(v.type==="html"||v.type==="svg")&&g1(g.current,t,o,x);const w=j.useRef(!1);j.useInsertionEffect(()=>{v&&w.current&&v.update(t,h)});const S=t[Tx],_=j.useRef(!!S&&!(!((a=window.MotionHandoffIsComplete)===null||a===void 0)&&a.call(window,S))&&((l=window.MotionHasOptimisedAnimation)===null||l===void 0?void 0:l.call(window,S)));return Sx(()=>{v&&(w.current=!0,window.MotionIsMounted=!0,v.updateFeatures(),xp.render(v.render),_.current&&v.animationState&&v.animationState.animateChanges())}),j.useEffect(()=>{v&&(!_.current&&v.animationState&&v.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)===null||C===void 0||C.call(window,S)}),_.current=!1))}),v}function g1(r,e,t,n){const{layoutId:o,layout:a,drag:l,dragConstraints:c,layoutScroll:d,layoutRoot:h}=e;r.projection=new t(r.latestValues,e["data-framer-portal-id"]?void 0:jx(r.parent)),r.projection.setOptions({layoutId:o,layout:a,alwaysMeasureLayout:!!l||c&&fi(c),visualElement:r,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,layoutScroll:d,layoutRoot:h})}function jx(r){if(r)return r.options.allowProjection!==!1?r.projection:jx(r.parent)}function y1({preloadedFeatures:r,createVisualElement:e,useRender:t,useVisualState:n,Component:o}){var a,l;r&&o1(r);function c(h,m){let g;const v={...j.useContext(fp),...h,layoutId:v1(h)},{isStatic:x}=v,w=d1(h),S=n(h,x);if(!x&&pp){x1();const _=b1(v);g=_.MeasureLayout,w.visualElement=m1(o,S,v,e,_.ProjectionNode)}return p.jsxs(zu.Provider,{value:w,children:[g&&w.visualElement?p.jsx(g,{visualElement:w.visualElement,...v}):null,t(o,h,f1(S,w.visualElement,m),S,x,w.visualElement)]})}c.displayName=`motion.${typeof o=="string"?o:`create(${(l=(a=o.displayName)!==null&&a!==void 0?a:o.name)!==null&&l!==void 0?l:""})`}`;const d=j.forwardRef(c);return d[h1]=o,d}function v1({layoutId:r}){const e=j.useContext(dp).id;return e&&r!==void 0?e+"-"+r:r}function x1(r,e){j.useContext(Cx).strict}function b1(r){const{drag:e,layout:t}=Ci;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e?.isEnabled(r)||t?.isEnabled(r)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const w1=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function bp(r){return typeof r!="string"||r.includes("-")?!1:!!(w1.indexOf(r)>-1||/[A-Z]/u.test(r))}function K0(r){const e=[{},{}];return r?.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function wp(r,e,t,n){if(typeof e=="function"){const[o,a]=K0(n);e=e(t!==void 0?t:r.custom,o,a)}if(typeof e=="string"&&(e=r.variants&&r.variants[e]),typeof e=="function"){const[o,a]=K0(n);e=e(t!==void 0?t:r.custom,o,a)}return e}const Ef=r=>Array.isArray(r),S1=r=>!!(r&&typeof r=="object"&&r.mix&&r.toValue),_1=r=>Ef(r)?r[r.length-1]||0:r,rr=r=>!!(r&&r.getVelocity);function lu(r){const e=rr(r)?r.get():r;return S1(e)?e.toValue():e}function k1({scrapeMotionValuesFromProps:r,createRenderState:e,onUpdate:t},n,o,a){const l={latestValues:C1(n,o,a,r),renderState:e()};return t&&(l.onMount=c=>t({props:n,current:c,...l}),l.onUpdate=c=>t(c)),l}const Rx=r=>(e,t)=>{const n=j.useContext(zu),o=j.useContext(Fu),a=()=>k1(r,e,n,o);return t?a():hp(a)};function C1(r,e,t,n){const o={},a=n(r,{});for(const v in a)o[v]=lu(a[v]);let{initial:l,animate:c}=r;const d=Bu(r),h=Px(r);e&&h&&!d&&r.inherit!==!1&&(l===void 0&&(l=e.initial),c===void 0&&(c=e.animate));let m=t?t.initial===!1:!1;m=m||l===!1;const g=m?c:l;if(g&&typeof g!="boolean"&&!Vu(g)){const v=Array.isArray(g)?g:[g];for(let x=0;x<v.length;x++){const w=wp(r,v[x]);if(w){const{transitionEnd:S,transition:_,...C}=w;for(const E in C){let N=C[E];if(Array.isArray(N)){const M=m?N.length-1:0;N=N[M]}N!==null&&(o[E]=N)}for(const E in S)o[E]=S[E]}}}return o}const $i=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_o=new Set($i),Nx=r=>e=>typeof e=="string"&&e.startsWith(r),Ix=Nx("--"),E1=Nx("var(--"),Sp=r=>E1(r)?P1.test(r.split("/*")[0].trim()):!1,P1=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Dx=(r,e)=>e&&typeof r=="number"?e.transform(r):r,Jn=(r,e,t)=>t>e?e:t<r?r:t,Ui={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},tl={...Ui,transform:r=>Jn(0,1,r)},Qc={...Ui,default:1},kl=r=>({test:e=>typeof e=="string"&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),Cs=kl("deg"),vn=kl("%"),ze=kl("px"),T1=kl("vh"),A1=kl("vw"),Z0={...vn,parse:r=>vn.parse(r)/100,transform:r=>vn.transform(r*100)},j1={borderWidth:ze,borderTopWidth:ze,borderRightWidth:ze,borderBottomWidth:ze,borderLeftWidth:ze,borderRadius:ze,radius:ze,borderTopLeftRadius:ze,borderTopRightRadius:ze,borderBottomRightRadius:ze,borderBottomLeftRadius:ze,width:ze,maxWidth:ze,height:ze,maxHeight:ze,top:ze,right:ze,bottom:ze,left:ze,padding:ze,paddingTop:ze,paddingRight:ze,paddingBottom:ze,paddingLeft:ze,margin:ze,marginTop:ze,marginRight:ze,marginBottom:ze,marginLeft:ze,backgroundPositionX:ze,backgroundPositionY:ze},R1={rotate:Cs,rotateX:Cs,rotateY:Cs,rotateZ:Cs,scale:Qc,scaleX:Qc,scaleY:Qc,scaleZ:Qc,skew:Cs,skewX:Cs,skewY:Cs,distance:ze,translateX:ze,translateY:ze,translateZ:ze,x:ze,y:ze,z:ze,perspective:ze,transformPerspective:ze,opacity:tl,originX:Z0,originY:Z0,originZ:ze},J0={...Ui,transform:Math.round},_p={...j1,...R1,zIndex:J0,size:ze,fillOpacity:tl,strokeOpacity:tl,numOctaves:J0},N1={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},I1=$i.length;function D1(r,e,t){let n="",o=!0;for(let a=0;a<I1;a++){const l=$i[a],c=r[l];if(c===void 0)continue;let d=!0;if(typeof c=="number"?d=c===(l.startsWith("scale")?1:0):d=parseFloat(c)===0,!d||t){const h=Dx(c,_p[l]);if(!d){o=!1;const m=N1[l]||l;n+=`${m}(${h}) `}t&&(e[l]=h)}}return n=n.trim(),t?n=t(e,o?"":n):o&&(n="none"),n}function kp(r,e,t){const{style:n,vars:o,transformOrigin:a}=r;let l=!1,c=!1;for(const d in e){const h=e[d];if(_o.has(d)){l=!0;continue}else if(Ix(d)){o[d]=h;continue}else{const m=Dx(h,_p[d]);d.startsWith("origin")?(c=!0,a[d]=m):n[d]=m}}if(e.transform||(l||t?n.transform=D1(e,r.transform,t):n.transform&&(n.transform="none")),c){const{originX:d="50%",originY:h="50%",originZ:m=0}=a;n.transformOrigin=`${d} ${h} ${m}`}}const L1={offset:"stroke-dashoffset",array:"stroke-dasharray"},O1={offset:"strokeDashoffset",array:"strokeDasharray"};function M1(r,e,t=1,n=0,o=!0){r.pathLength=1;const a=o?L1:O1;r[a.offset]=ze.transform(-n);const l=ze.transform(e),c=ze.transform(t);r[a.array]=`${l} ${c}`}function Q0(r,e,t){return typeof r=="string"?r:ze.transform(e+t*r)}function $1(r,e,t){const n=Q0(e,r.x,r.width),o=Q0(t,r.y,r.height);return`${n} ${o}`}function Cp(r,{attrX:e,attrY:t,attrScale:n,originX:o,originY:a,pathLength:l,pathSpacing:c=1,pathOffset:d=0,...h},m,g){if(kp(r,h,g),m){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:v,style:x,dimensions:w}=r;v.transform&&(w&&(x.transform=v.transform),delete v.transform),w&&(o!==void 0||a!==void 0||x.transform)&&(x.transformOrigin=$1(w,o!==void 0?o:.5,a!==void 0?a:.5)),e!==void 0&&(v.x=e),t!==void 0&&(v.y=t),n!==void 0&&(v.scale=n),l!==void 0&&M1(v,l,c,d,!1)}const Ep=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Lx=()=>({...Ep(),attrs:{}}),Pp=r=>typeof r=="string"&&r.toLowerCase()==="svg";function Ox(r,{style:e,vars:t},n,o){Object.assign(r.style,e,o&&o.getProjectionStyles(n));for(const a in t)r.style.setProperty(a,t[a])}const Mx=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function $x(r,e,t,n){Ox(r,e,void 0,n);for(const o in e.attrs)r.setAttribute(Mx.has(o)?o:vp(o),e.attrs[o])}const gu={};function U1(r){Object.assign(gu,r)}function Ux(r,{layout:e,layoutId:t}){return _o.has(r)||r.startsWith("origin")||(e||t!==void 0)&&(!!gu[r]||r==="opacity")}function Tp(r,e,t){var n;const{style:o}=r,a={};for(const l in o)(rr(o[l])||e.style&&rr(e.style[l])||Ux(l,r)||((n=t?.getValue(l))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(a[l]=o[l]);return a}function Fx(r,e,t){const n=Tp(r,e,t);for(const o in r)if(rr(r[o])||rr(e[o])){const a=$i.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;n[a]=r[o]}return n}function F1(r,e){try{e.dimensions=typeof r.getBBox=="function"?r.getBBox():r.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Y0=["x","y","width","height","cx","cy","r"],z1={useVisualState:Rx({scrapeMotionValuesFromProps:Fx,createRenderState:Lx,onUpdate:({props:r,prevProps:e,current:t,renderState:n,latestValues:o})=>{if(!t)return;let a=!!r.drag;if(!a){for(const c in o)if(_o.has(c)){a=!0;break}}if(!a)return;let l=!e;if(e)for(let c=0;c<Y0.length;c++){const d=Y0[c];r[d]!==e[d]&&(l=!0)}l&&wt.read(()=>{F1(t,n),wt.render(()=>{Cp(n,o,Pp(t.tagName),r.transformTemplate),$x(t,n)})})}})},V1={useVisualState:Rx({scrapeMotionValuesFromProps:Tp,createRenderState:Ep})};function zx(r,e,t){for(const n in e)!rr(e[n])&&!Ux(n,t)&&(r[n]=e[n])}function B1({transformTemplate:r},e){return j.useMemo(()=>{const t=Ep();return kp(t,e,r),Object.assign({},t.vars,t.style)},[e])}function q1(r,e){const t=r.style||{},n={};return zx(n,t,r),Object.assign(n,B1(r,e)),n}function H1(r,e){const t={},n=q1(r,e);return r.drag&&r.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(t.tabIndex=0),t.style=n,t}function W1(r,e,t,n){const o=j.useMemo(()=>{const a=Lx();return Cp(a,e,Pp(n),r.transformTemplate),{...a.attrs,style:{...a.style}}},[e]);if(r.style){const a={};zx(a,r.style,r),o.style={...a,...o.style}}return o}function G1(r=!1){return(t,n,o,{latestValues:a},l)=>{const d=(bp(t)?W1:H1)(n,a,l,t),h=l1(n,typeof t=="string",r),m=t!==j.Fragment?{...h,...d,ref:o}:{},{children:g}=n,v=j.useMemo(()=>rr(g)?g.get():g,[g]);return j.createElement(t,{...m,children:v})}}function K1(r,e){return function(n,{forwardMotionProps:o}={forwardMotionProps:!1}){const l={...bp(n)?z1:V1,preloadedFeatures:r,useRender:G1(o),createVisualElement:e,Component:n};return y1(l)}}function Vx(r,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==r.length)return!1;for(let n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}function qu(r,e,t){const n=r.getProps();return wp(n,e,t!==void 0?t:n.custom,r)}const Z1=mp(()=>window.ScrollTimeline!==void 0);class J1{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map(o=>{if(Z1()&&o.attachTimeline)return o.attachTimeline(e);if(typeof t=="function")return t(o)});return()=>{n.forEach((o,a)=>{o&&o(),this.animations[a].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Q1 extends J1{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function Ap(r,e){return r?r[e]||r.default||r:void 0}const Pf=2e4;function Bx(r){let e=0;const t=50;let n=r.next(e);for(;!n.done&&e<Pf;)e+=t,n=r.next(e);return e>=Pf?1/0:e}function jp(r){return typeof r=="function"}function X0(r,e){r.timeline=e,r.onfinish=null}const Rp=r=>Array.isArray(r)&&typeof r[0]=="number",Y1={linearEasing:void 0};function X1(r,e){const t=mp(r);return()=>{var n;return(n=Y1[e])!==null&&n!==void 0?n:t()}}const yu=X1(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),qx=(r,e,t=10)=>{let n="";const o=Math.max(Math.round(e/t),2);for(let a=0;a<o;a++)n+=r(ki(0,o-1,a))+", ";return`linear(${n.substring(0,n.length-2)})`};function Hx(r){return!!(typeof r=="function"&&yu()||!r||typeof r=="string"&&(r in Tf||yu())||Rp(r)||Array.isArray(r)&&r.every(Hx))}const Oa=([r,e,t,n])=>`cubic-bezier(${r}, ${e}, ${t}, ${n})`,Tf={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Oa([0,.65,.55,1]),circOut:Oa([.55,0,1,.45]),backIn:Oa([.31,.01,.66,-.59]),backOut:Oa([.33,1.53,.69,.99])};function Wx(r,e){if(r)return typeof r=="function"&&yu()?qx(r,e):Rp(r)?Oa(r):Array.isArray(r)?r.map(t=>Wx(t,e)||Tf.easeOut):Tf[r]}const Qr={x:!1,y:!1};function Gx(){return Qr.x||Qr.y}function eC(r,e,t){var n;if(r instanceof Element)return[r];if(typeof r=="string"){let o=document;const a=(n=void 0)!==null&&n!==void 0?n:o.querySelectorAll(r);return a?Array.from(a):[]}return Array.from(r)}function Kx(r,e){const t=eC(r),n=new AbortController,o={passive:!0,...e,signal:n.signal};return[t,o,()=>n.abort()]}function ey(r){return e=>{e.pointerType==="touch"||Gx()||r(e)}}function tC(r,e,t={}){const[n,o,a]=Kx(r,t),l=ey(c=>{const{target:d}=c,h=e(c);if(typeof h!="function"||!d)return;const m=ey(g=>{h(g),d.removeEventListener("pointerleave",m)});d.addEventListener("pointerleave",m,o)});return n.forEach(c=>{c.addEventListener("pointerenter",l,o)}),a}const Zx=(r,e)=>e?r===e?!0:Zx(r,e.parentElement):!1,Np=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,rC=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function nC(r){return rC.has(r.tagName)||r.tabIndex!==-1}const Ma=new WeakSet;function ty(r){return e=>{e.key==="Enter"&&r(e)}}function Bh(r,e){r.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const sC=(r,e)=>{const t=r.currentTarget;if(!t)return;const n=ty(()=>{if(Ma.has(t))return;Bh(t,"down");const o=ty(()=>{Bh(t,"up")}),a=()=>Bh(t,"cancel");t.addEventListener("keyup",o,e),t.addEventListener("blur",a,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function ry(r){return Np(r)&&!Gx()}function oC(r,e,t={}){const[n,o,a]=Kx(r,t),l=c=>{const d=c.currentTarget;if(!ry(c)||Ma.has(d))return;Ma.add(d);const h=e(c),m=(x,w)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",v),!(!ry(x)||!Ma.has(d))&&(Ma.delete(d),typeof h=="function"&&h(x,{success:w}))},g=x=>{m(x,t.useGlobalTarget||Zx(d,x.target))},v=x=>{m(x,!1)};window.addEventListener("pointerup",g,o),window.addEventListener("pointercancel",v,o)};return n.forEach(c=>{!nC(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(t.useGlobalTarget?window:c).addEventListener("pointerdown",l,o),c.addEventListener("focus",h=>sC(h,o),o)}),a}function iC(r){return r==="x"||r==="y"?Qr[r]?null:(Qr[r]=!0,()=>{Qr[r]=!1}):Qr.x||Qr.y?null:(Qr.x=Qr.y=!0,()=>{Qr.x=Qr.y=!1})}const Jx=new Set(["width","height","top","left","right","bottom",...$i]);let cu;function aC(){cu=void 0}const xn={now:()=>(cu===void 0&&xn.set(Kt.isProcessing||r1.useManualTiming?Kt.timestamp:performance.now()),cu),set:r=>{cu=r,queueMicrotask(aC)}};function Ip(r,e){r.indexOf(e)===-1&&r.push(e)}function Dp(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}let Lp=class{constructor(){this.subscriptions=[]}add(e){return Ip(this.subscriptions,e),()=>Dp(this.subscriptions,e)}notify(e,t,n){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](e,t,n);else for(let a=0;a<o;a++){const l=this.subscriptions[a];l&&l(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}};function Qx(r,e){return e?r*(1e3/e):0}const ny=30,lC=r=>!isNaN(parseFloat(r));class cC{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,o=!0)=>{const a=xn.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=xn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=lC(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Lp);const n=this.events[e].add(t);return e==="change"?()=>{n(),wt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=xn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>ny)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,ny);return Qx(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function rl(r,e){return new cC(r,e)}function uC(r,e,t){r.hasValue(e)?r.getValue(e).set(t):r.addValue(e,rl(t))}function dC(r,e){const t=qu(r,e);let{transitionEnd:n={},transition:o={},...a}=t||{};a={...a,...n};for(const l in a){const c=_1(a[l]);uC(r,l,c)}}function hC(r){return!!(rr(r)&&r.add)}function Af(r,e){const t=r.getValue("willChange");if(hC(t))return t.add(e)}function Yx(r){return r.props[Tx]}const Xx=(r,e,t)=>(((1-3*t+3*e)*r+(3*t-6*e))*r+3*e)*r,fC=1e-7,pC=12;function mC(r,e,t,n,o){let a,l,c=0;do l=e+(t-e)/2,a=Xx(l,n,o)-r,a>0?t=l:e=l;while(Math.abs(a)>fC&&++c<pC);return l}function Cl(r,e,t,n){if(r===e&&t===n)return Tr;const o=a=>mC(a,0,1,r,t);return a=>a===0||a===1?a:Xx(o(a),e,n)}const eb=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,tb=r=>e=>1-r(1-e),rb=Cl(.33,1.53,.69,.99),Op=tb(rb),nb=eb(Op),sb=r=>(r*=2)<1?.5*Op(r):.5*(2-Math.pow(2,-10*(r-1))),Mp=r=>1-Math.sin(Math.acos(r)),ob=tb(Mp),ib=eb(Mp),ab=r=>/^0[^.\s]+$/u.test(r);function gC(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||ab(r):!0}const Ba=r=>Math.round(r*1e5)/1e5,$p=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function yC(r){return r==null}const vC=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Up=(r,e)=>t=>!!(typeof t=="string"&&vC.test(t)&&t.startsWith(r)||e&&!yC(t)&&Object.prototype.hasOwnProperty.call(t,e)),lb=(r,e,t)=>n=>{if(typeof n!="string")return n;const[o,a,l,c]=n.match($p);return{[r]:parseFloat(o),[e]:parseFloat(a),[t]:parseFloat(l),alpha:c!==void 0?parseFloat(c):1}},xC=r=>Jn(0,255,r),qh={...Ui,transform:r=>Math.round(xC(r))},go={test:Up("rgb","red"),parse:lb("red","green","blue"),transform:({red:r,green:e,blue:t,alpha:n=1})=>"rgba("+qh.transform(r)+", "+qh.transform(e)+", "+qh.transform(t)+", "+Ba(tl.transform(n))+")"};function bC(r){let e="",t="",n="",o="";return r.length>5?(e=r.substring(1,3),t=r.substring(3,5),n=r.substring(5,7),o=r.substring(7,9)):(e=r.substring(1,2),t=r.substring(2,3),n=r.substring(3,4),o=r.substring(4,5),e+=e,t+=t,n+=n,o+=o),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:o?parseInt(o,16)/255:1}}const jf={test:Up("#"),parse:bC,transform:go.transform},pi={test:Up("hsl","hue"),parse:lb("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(r)+", "+vn.transform(Ba(e))+", "+vn.transform(Ba(t))+", "+Ba(tl.transform(n))+")"},er={test:r=>go.test(r)||jf.test(r)||pi.test(r),parse:r=>go.test(r)?go.parse(r):pi.test(r)?pi.parse(r):jf.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?go.transform(r):pi.transform(r)},wC=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function SC(r){var e,t;return isNaN(r)&&typeof r=="string"&&(((e=r.match($p))===null||e===void 0?void 0:e.length)||0)+(((t=r.match(wC))===null||t===void 0?void 0:t.length)||0)>0}const cb="number",ub="color",_C="var",kC="var(",sy="${}",CC=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function nl(r){const e=r.toString(),t=[],n={color:[],number:[],var:[]},o=[];let a=0;const c=e.replace(CC,d=>(er.test(d)?(n.color.push(a),o.push(ub),t.push(er.parse(d))):d.startsWith(kC)?(n.var.push(a),o.push(_C),t.push(d)):(n.number.push(a),o.push(cb),t.push(parseFloat(d))),++a,sy)).split(sy);return{values:t,split:c,indexes:n,types:o}}function db(r){return nl(r).values}function hb(r){const{split:e,types:t}=nl(r),n=e.length;return o=>{let a="";for(let l=0;l<n;l++)if(a+=e[l],o[l]!==void 0){const c=t[l];c===cb?a+=Ba(o[l]):c===ub?a+=er.transform(o[l]):a+=o[l]}return a}}const EC=r=>typeof r=="number"?0:r;function PC(r){const e=db(r);return hb(r)(e.map(EC))}const Ms={test:SC,parse:db,createTransformer:hb,getAnimatableNone:PC},TC=new Set(["brightness","contrast","saturate","opacity"]);function AC(r){const[e,t]=r.slice(0,-1).split("(");if(e==="drop-shadow")return r;const[n]=t.match($p)||[];if(!n)return r;const o=t.replace(n,"");let a=TC.has(e)?1:0;return n!==t&&(a*=100),e+"("+a+o+")"}const jC=/\b([a-z-]*)\(.*?\)/gu,Rf={...Ms,getAnimatableNone:r=>{const e=r.match(jC);return e?e.map(AC).join(" "):r}},RC={..._p,color:er,backgroundColor:er,outlineColor:er,fill:er,stroke:er,borderColor:er,borderTopColor:er,borderRightColor:er,borderBottomColor:er,borderLeftColor:er,filter:Rf,WebkitFilter:Rf},Fp=r=>RC[r];function fb(r,e){let t=Fp(r);return t!==Rf&&(t=Ms),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const NC=new Set(["auto","none","0"]);function IC(r,e,t){let n=0,o;for(;n<r.length&&!o;){const a=r[n];typeof a=="string"&&!NC.has(a)&&nl(a).values.length&&(o=r[n]),n++}if(o&&t)for(const a of e)r[a]=fb(t,o)}const oy=r=>r===Ui||r===ze,iy=(r,e)=>parseFloat(r.split(", ")[e]),ay=(r,e)=>(t,{transform:n})=>{if(n==="none"||!n)return 0;const o=n.match(/^matrix3d\((.+)\)$/u);if(o)return iy(o[1],e);{const a=n.match(/^matrix\((.+)\)$/u);return a?iy(a[1],r):0}},DC=new Set(["x","y","z"]),LC=$i.filter(r=>!DC.has(r));function OC(r){const e=[];return LC.forEach(t=>{const n=r.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const Ei={width:({x:r},{paddingLeft:e="0",paddingRight:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),height:({y:r},{paddingTop:e="0",paddingBottom:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),top:(r,{top:e})=>parseFloat(e),left:(r,{left:e})=>parseFloat(e),bottom:({y:r},{top:e})=>parseFloat(e)+(r.max-r.min),right:({x:r},{left:e})=>parseFloat(e)+(r.max-r.min),x:ay(4,13),y:ay(5,14)};Ei.translateX=Ei.x;Ei.translateY=Ei.y;const vo=new Set;let Nf=!1,If=!1;function pb(){if(If){const r=Array.from(vo).filter(n=>n.needsMeasurement),e=new Set(r.map(n=>n.element)),t=new Map;e.forEach(n=>{const o=OC(n);o.length&&(t.set(n,o),n.render())}),r.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const o=t.get(n);o&&o.forEach(([a,l])=>{var c;(c=n.getValue(a))===null||c===void 0||c.set(l)})}),r.forEach(n=>n.measureEndState()),r.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}If=!1,Nf=!1,vo.forEach(r=>r.complete()),vo.clear()}function mb(){vo.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(If=!0)})}function MC(){mb(),pb()}class zp{constructor(e,t,n,o,a,l=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=o,this.element=a,this.isAsync=l}scheduleResolve(){this.isScheduled=!0,this.isAsync?(vo.add(this),Nf||(Nf=!0,wt.read(mb),wt.resolveKeyframes(pb))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:o}=this;for(let a=0;a<e.length;a++)if(e[a]===null)if(a===0){const l=o?.get(),c=e[e.length-1];if(l!==void 0)e[0]=l;else if(n&&t){const d=n.readValue(t,c);d!=null&&(e[0]=d)}e[0]===void 0&&(e[0]=c),o&&l===void 0&&o.set(e[0])}else e[a]=e[a-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),vo.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,vo.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const gb=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r),$C=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function UC(r){const e=$C.exec(r);if(!e)return[,];const[,t,n,o]=e;return[`--${t??n}`,o]}function yb(r,e,t=1){const[n,o]=UC(r);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const l=a.trim();return gb(l)?parseFloat(l):l}return Sp(o)?yb(o,e,t+1):o}const vb=r=>e=>e.test(r),FC={test:r=>r==="auto",parse:r=>r},xb=[Ui,ze,vn,Cs,A1,T1,FC],ly=r=>xb.find(vb(r));class bb extends zp{constructor(e,t,n,o,a){super(e,t,n,o,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let d=0;d<e.length;d++){let h=e[d];if(typeof h=="string"&&(h=h.trim(),Sp(h))){const m=yb(h,t.current);m!==void 0&&(e[d]=m),d===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!Jx.has(n)||e.length!==2)return;const[o,a]=e,l=ly(o),c=ly(a);if(l!==c)if(oy(l)&&oy(c))for(let d=0;d<e.length;d++){const h=e[d];typeof h=="string"&&(e[d]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let o=0;o<e.length;o++)gC(e[o])&&n.push(o);n.length&&IC(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ei[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const o=t[t.length-1];o!==void 0&&e.getValue(n,o).jump(o,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:o}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const l=o.length-1,c=o[l];o[l]=Ei[n](t.measureViewportBox(),window.getComputedStyle(t.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([d,h])=>{t.getValue(d).set(h)}),this.resolveNoneKeyframes()}}const cy=(r,e)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(Ms.test(r)||r==="0")&&!r.startsWith("url("));function zC(r){const e=r[0];if(r.length===1)return!0;for(let t=0;t<r.length;t++)if(r[t]!==e)return!0}function VC(r,e,t,n){const o=r[0];if(o===null)return!1;if(e==="display"||e==="visibility")return!0;const a=r[r.length-1],l=cy(o,e),c=cy(a,e);return!l||!c?!1:zC(r)||(t==="spring"||jp(t))&&n}const BC=r=>r!==null;function Hu(r,{repeat:e,repeatType:t="loop"},n){const o=r.filter(BC),a=e&&t!=="loop"&&e%2===1?0:o.length-1;return!a||n===void 0?o[a]:n}const qC=40;class wb{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:o=0,repeatDelay:a=0,repeatType:l="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=xn.now(),this.options={autoplay:e,delay:t,type:n,repeat:o,repeatDelay:a,repeatType:l,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>qC?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&MC(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=xn.now(),this.hasAttemptedResolve=!0;const{name:n,type:o,velocity:a,delay:l,onComplete:c,onUpdate:d,isGenerator:h}=this.options;if(!h&&!VC(e,n,o,a))if(l)this.options.duration=0;else{d&&d(Hu(e,this.options,t)),c&&c(),this.resolveFinishedPromise();return}const m=this.initPlayback(e,t);m!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...m},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Pt=(r,e,t)=>r+(e-r)*t;function Hh(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function HC({hue:r,saturation:e,lightness:t,alpha:n}){r/=360,e/=100,t/=100;let o=0,a=0,l=0;if(!e)o=a=l=t;else{const c=t<.5?t*(1+e):t+e-t*e,d=2*t-c;o=Hh(d,c,r+1/3),a=Hh(d,c,r),l=Hh(d,c,r-1/3)}return{red:Math.round(o*255),green:Math.round(a*255),blue:Math.round(l*255),alpha:n}}function vu(r,e){return t=>t>0?e:r}const Wh=(r,e,t)=>{const n=r*r,o=t*(e*e-n)+n;return o<0?0:Math.sqrt(o)},WC=[jf,go,pi],GC=r=>WC.find(e=>e.test(r));function uy(r){const e=GC(r);if(!e)return!1;let t=e.parse(r);return e===pi&&(t=HC(t)),t}const dy=(r,e)=>{const t=uy(r),n=uy(e);if(!t||!n)return vu(r,e);const o={...t};return a=>(o.red=Wh(t.red,n.red,a),o.green=Wh(t.green,n.green,a),o.blue=Wh(t.blue,n.blue,a),o.alpha=Pt(t.alpha,n.alpha,a),go.transform(o))},KC=(r,e)=>t=>e(r(t)),El=(...r)=>r.reduce(KC),Df=new Set(["none","hidden"]);function ZC(r,e){return Df.has(r)?t=>t<=0?r:e:t=>t>=1?e:r}function JC(r,e){return t=>Pt(r,e,t)}function Vp(r){return typeof r=="number"?JC:typeof r=="string"?Sp(r)?vu:er.test(r)?dy:XC:Array.isArray(r)?Sb:typeof r=="object"?er.test(r)?dy:QC:vu}function Sb(r,e){const t=[...r],n=t.length,o=r.map((a,l)=>Vp(a)(a,e[l]));return a=>{for(let l=0;l<n;l++)t[l]=o[l](a);return t}}function QC(r,e){const t={...r,...e},n={};for(const o in t)r[o]!==void 0&&e[o]!==void 0&&(n[o]=Vp(r[o])(r[o],e[o]));return o=>{for(const a in n)t[a]=n[a](o);return t}}function YC(r,e){var t;const n=[],o={color:0,var:0,number:0};for(let a=0;a<e.values.length;a++){const l=e.types[a],c=r.indexes[l][o[l]],d=(t=r.values[c])!==null&&t!==void 0?t:0;n[a]=d,o[l]++}return n}const XC=(r,e)=>{const t=Ms.createTransformer(e),n=nl(r),o=nl(e);return n.indexes.var.length===o.indexes.var.length&&n.indexes.color.length===o.indexes.color.length&&n.indexes.number.length>=o.indexes.number.length?Df.has(r)&&!o.values.length||Df.has(e)&&!n.values.length?ZC(r,e):El(Sb(YC(n,o),o.values),t):vu(r,e)};function _b(r,e,t){return typeof r=="number"&&typeof e=="number"&&typeof t=="number"?Pt(r,e,t):Vp(r)(r,e)}const eE=5;function kb(r,e,t){const n=Math.max(e-eE,0);return Qx(t-r(n),e-n)}const Rt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Gh=.001;function tE({duration:r=Rt.duration,bounce:e=Rt.bounce,velocity:t=Rt.velocity,mass:n=Rt.mass}){let o,a,l=1-e;l=Jn(Rt.minDamping,Rt.maxDamping,l),r=Jn(Rt.minDuration,Rt.maxDuration,Zn(r)),l<1?(o=h=>{const m=h*l,g=m*r,v=m-t,x=Lf(h,l),w=Math.exp(-g);return Gh-v/x*w},a=h=>{const g=h*l*r,v=g*t+t,x=Math.pow(l,2)*Math.pow(h,2)*r,w=Math.exp(-g),S=Lf(Math.pow(h,2),l);return(-o(h)+Gh>0?-1:1)*((v-x)*w)/S}):(o=h=>{const m=Math.exp(-h*r),g=(h-t)*r+1;return-Gh+m*g},a=h=>{const m=Math.exp(-h*r),g=(t-h)*(r*r);return m*g});const c=5/r,d=nE(o,a,c);if(r=Kn(r),isNaN(d))return{stiffness:Rt.stiffness,damping:Rt.damping,duration:r};{const h=Math.pow(d,2)*n;return{stiffness:h,damping:l*2*Math.sqrt(n*h),duration:r}}}const rE=12;function nE(r,e,t){let n=t;for(let o=1;o<rE;o++)n=n-r(n)/e(n);return n}function Lf(r,e){return r*Math.sqrt(1-e*e)}const sE=["duration","bounce"],oE=["stiffness","damping","mass"];function hy(r,e){return e.some(t=>r[t]!==void 0)}function iE(r){let e={velocity:Rt.velocity,stiffness:Rt.stiffness,damping:Rt.damping,mass:Rt.mass,isResolvedFromDuration:!1,...r};if(!hy(r,oE)&&hy(r,sE))if(r.visualDuration){const t=r.visualDuration,n=2*Math.PI/(t*1.2),o=n*n,a=2*Jn(.05,1,1-(r.bounce||0))*Math.sqrt(o);e={...e,mass:Rt.mass,stiffness:o,damping:a}}else{const t=tE(r);e={...e,...t,mass:Rt.mass},e.isResolvedFromDuration=!0}return e}function Cb(r=Rt.visualDuration,e=Rt.bounce){const t=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:e}:r;let{restSpeed:n,restDelta:o}=t;const a=t.keyframes[0],l=t.keyframes[t.keyframes.length-1],c={done:!1,value:a},{stiffness:d,damping:h,mass:m,duration:g,velocity:v,isResolvedFromDuration:x}=iE({...t,velocity:-Zn(t.velocity||0)}),w=v||0,S=h/(2*Math.sqrt(d*m)),_=l-a,C=Zn(Math.sqrt(d/m)),E=Math.abs(_)<5;n||(n=E?Rt.restSpeed.granular:Rt.restSpeed.default),o||(o=E?Rt.restDelta.granular:Rt.restDelta.default);let N;if(S<1){const A=Lf(C,S);N=K=>{const Z=Math.exp(-S*C*K);return l-Z*((w+S*C*_)/A*Math.sin(A*K)+_*Math.cos(A*K))}}else if(S===1)N=A=>l-Math.exp(-C*A)*(_+(w+C*_)*A);else{const A=C*Math.sqrt(S*S-1);N=K=>{const Z=Math.exp(-S*C*K),W=Math.min(A*K,300);return l-Z*((w+S*C*_)*Math.sinh(W)+A*_*Math.cosh(W))/A}}const M={calculatedDuration:x&&g||null,next:A=>{const K=N(A);if(x)c.done=A>=g;else{let Z=0;S<1&&(Z=A===0?Kn(w):kb(N,A,K));const W=Math.abs(Z)<=n,de=Math.abs(l-K)<=o;c.done=W&&de}return c.value=c.done?l:K,c},toString:()=>{const A=Math.min(Bx(M),Pf),K=qx(Z=>M.next(A*Z).value,A,30);return A+"ms "+K}};return M}function fy({keyframes:r,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:l,min:c,max:d,restDelta:h=.5,restSpeed:m}){const g=r[0],v={done:!1,value:g},x=W=>c!==void 0&&W<c||d!==void 0&&W>d,w=W=>c===void 0?d:d===void 0||Math.abs(c-W)<Math.abs(d-W)?c:d;let S=t*e;const _=g+S,C=l===void 0?_:l(_);C!==_&&(S=C-g);const E=W=>-S*Math.exp(-W/n),N=W=>C+E(W),M=W=>{const de=E(W),pe=N(W);v.done=Math.abs(de)<=h,v.value=v.done?C:pe};let A,K;const Z=W=>{x(v.value)&&(A=W,K=Cb({keyframes:[v.value,w(v.value)],velocity:kb(N,W,v.value),damping:o,stiffness:a,restDelta:h,restSpeed:m}))};return Z(0),{calculatedDuration:null,next:W=>{let de=!1;return!K&&A===void 0&&(de=!0,M(W),Z(W)),A!==void 0&&W>=A?K.next(W-A):(!de&&M(W),v)}}}const aE=Cl(.42,0,1,1),lE=Cl(0,0,.58,1),Eb=Cl(.42,0,.58,1),cE=r=>Array.isArray(r)&&typeof r[0]!="number",uE={linear:Tr,easeIn:aE,easeInOut:Eb,easeOut:lE,circIn:Mp,circInOut:ib,circOut:ob,backIn:Op,backInOut:nb,backOut:rb,anticipate:sb},py=r=>{if(Rp(r)){_x(r.length===4);const[e,t,n,o]=r;return Cl(e,t,n,o)}else if(typeof r=="string")return uE[r];return r};function dE(r,e,t){const n=[],o=t||_b,a=r.length-1;for(let l=0;l<a;l++){let c=o(r[l],r[l+1]);if(e){const d=Array.isArray(e)?e[l]||Tr:e;c=El(d,c)}n.push(c)}return n}function hE(r,e,{clamp:t=!0,ease:n,mixer:o}={}){const a=r.length;if(_x(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const l=r[0]===r[1];r[0]>r[a-1]&&(r=[...r].reverse(),e=[...e].reverse());const c=dE(e,n,o),d=c.length,h=m=>{if(l&&m<r[0])return e[0];let g=0;if(d>1)for(;g<r.length-2&&!(m<r[g+1]);g++);const v=ki(r[g],r[g+1],m);return c[g](v)};return t?m=>h(Jn(r[0],r[a-1],m)):h}function fE(r,e){const t=r[r.length-1];for(let n=1;n<=e;n++){const o=ki(0,e,n);r.push(Pt(t,1,o))}}function pE(r){const e=[0];return fE(e,r.length-1),e}function mE(r,e){return r.map(t=>t*e)}function gE(r,e){return r.map(()=>e||Eb).splice(0,r.length-1)}function xu({duration:r=300,keyframes:e,times:t,ease:n="easeInOut"}){const o=cE(n)?n.map(py):py(n),a={done:!1,value:e[0]},l=mE(t&&t.length===e.length?t:pE(e),r),c=hE(l,e,{ease:Array.isArray(o)?o:gE(e,o)});return{calculatedDuration:r,next:d=>(a.value=c(d),a.done=d>=r,a)}}const yE=r=>{const e=({timestamp:t})=>r(t);return{start:()=>wt.update(e,!0),stop:()=>Os(e),now:()=>Kt.isProcessing?Kt.timestamp:xn.now()}},vE={decay:fy,inertia:fy,tween:xu,keyframes:xu,spring:Cb},xE=r=>r/100;class Bp extends wb{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:d}=this.options;d&&d()};const{name:t,motionValue:n,element:o,keyframes:a}=this.options,l=o?.KeyframeResolver||zp,c=(d,h)=>this.onKeyframesResolved(d,h);this.resolver=new l(a,c,t,n,o),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:o=0,repeatType:a,velocity:l=0}=this.options,c=jp(t)?t:vE[t]||xu;let d,h;c!==xu&&typeof e[0]!="number"&&(d=El(xE,_b(e[0],e[1])),e=[0,100]);const m=c({...this.options,keyframes:e});a==="mirror"&&(h=c({...this.options,keyframes:[...e].reverse(),velocity:-l})),m.calculatedDuration===null&&(m.calculatedDuration=Bx(m));const{calculatedDuration:g}=m,v=g+o,x=v*(n+1)-o;return{generator:m,mirroredGenerator:h,mapPercentToKeyframes:d,calculatedDuration:g,resolvedDuration:v,totalDuration:x}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:n}=this;if(!n){const{keyframes:W}=this.options;return{done:!0,value:W[W.length-1]}}const{finalKeyframe:o,generator:a,mirroredGenerator:l,mapPercentToKeyframes:c,keyframes:d,calculatedDuration:h,totalDuration:m,resolvedDuration:g}=n;if(this.startTime===null)return a.next(0);const{delay:v,repeat:x,repeatType:w,repeatDelay:S,onUpdate:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-m/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const C=this.currentTime-v*(this.speed>=0?1:-1),E=this.speed>=0?C<0:C>m;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=m);let N=this.currentTime,M=a;if(x){const W=Math.min(this.currentTime,m)/g;let de=Math.floor(W),pe=W%1;!pe&&W>=1&&(pe=1),pe===1&&de--,de=Math.min(de,x+1),!!(de%2)&&(w==="reverse"?(pe=1-pe,S&&(pe-=S/g)):w==="mirror"&&(M=l)),N=Jn(0,1,pe)*g}const A=E?{done:!1,value:d[0]}:M.next(N);c&&(A.value=c(A.value));let{done:K}=A;!E&&h!==null&&(K=this.speed>=0?this.currentTime>=m:this.currentTime<=0);const Z=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&K);return Z&&o!==void 0&&(A.value=Hu(d,this.options,o)),_&&_(A.value),Z&&this.finish(),A}get duration(){const{resolved:e}=this;return e?Zn(e.calculatedDuration):0}get time(){return Zn(this.currentTime)}set time(e){e=Kn(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Zn(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=yE,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),t&&t();const o=this.driver.now();this.holdTime!==null?this.startTime=o-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=o):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const bE=new Set(["opacity","clipPath","filter","transform"]);function wE(r,e,t,{delay:n=0,duration:o=300,repeat:a=0,repeatType:l="loop",ease:c="easeInOut",times:d}={}){const h={[e]:t};d&&(h.offset=d);const m=Wx(c,o);return Array.isArray(m)&&(h.easing=m),r.animate(h,{delay:n,duration:o,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:a+1,direction:l==="reverse"?"alternate":"normal"})}const SE=mp(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),bu=10,_E=2e4;function kE(r){return jp(r.type)||r.type==="spring"||!Hx(r.ease)}function CE(r,e){const t=new Bp({...e,keyframes:r,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:r[0]};const o=[];let a=0;for(;!n.done&&a<_E;)n=t.sample(a),o.push(n.value),a+=bu;return{times:void 0,keyframes:o,duration:a-bu,ease:"linear"}}const Pb={anticipate:sb,backInOut:nb,circInOut:ib};function EE(r){return r in Pb}class my extends wb{constructor(e){super(e);const{name:t,motionValue:n,element:o,keyframes:a}=this.options;this.resolver=new bb(a,(l,c)=>this.onKeyframesResolved(l,c),t,n,o),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:n=300,times:o,ease:a,type:l,motionValue:c,name:d,startTime:h}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof a=="string"&&yu()&&EE(a)&&(a=Pb[a]),kE(this.options)){const{onComplete:g,onUpdate:v,motionValue:x,element:w,...S}=this.options,_=CE(e,S);e=_.keyframes,e.length===1&&(e[1]=e[0]),n=_.duration,o=_.times,a=_.ease,l="keyframes"}const m=wE(c.owner.current,d,e,{...this.options,duration:n,times:o,ease:a});return m.startTime=h??this.calcStartTime(),this.pendingTimeline?(X0(m,this.pendingTimeline),this.pendingTimeline=void 0):m.onfinish=()=>{const{onComplete:g}=this.options;c.set(Hu(e,this.options,t)),g&&g(),this.cancel(),this.resolveFinishedPromise()},{animation:m,duration:n,times:o,type:l,ease:a,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Zn(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Zn(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=Kn(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Tr;const{animation:n}=t;X0(n,e)}return Tr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:o,type:a,ease:l,times:c}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:m,onComplete:g,element:v,...x}=this.options,w=new Bp({...x,keyframes:n,duration:o,type:a,ease:l,times:c,isGenerator:!0}),S=Kn(this.time);h.setWithVelocity(w.sample(S-bu).value,w.sample(S).value,bu)}const{onStop:d}=this.options;d&&d(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:o,repeatType:a,damping:l,type:c}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:h}=t.owner.getProps();return SE()&&n&&bE.has(n)&&!d&&!h&&!o&&a!=="mirror"&&l!==0&&c!=="inertia"}}const PE={type:"spring",stiffness:500,damping:25,restSpeed:10},TE=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),AE={type:"keyframes",duration:.8},jE={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},RE=(r,{keyframes:e})=>e.length>2?AE:_o.has(r)?r.startsWith("scale")?TE(e[1]):PE:jE;function NE({when:r,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:o,repeat:a,repeatType:l,repeatDelay:c,from:d,elapsed:h,...m}){return!!Object.keys(m).length}const qp=(r,e,t,n={},o,a)=>l=>{const c=Ap(n,r)||{},d=c.delay||n.delay||0;let{elapsed:h=0}=n;h=h-Kn(d);let m={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-h,onUpdate:v=>{e.set(v),c.onUpdate&&c.onUpdate(v)},onComplete:()=>{l(),c.onComplete&&c.onComplete()},name:r,motionValue:e,element:a?void 0:o};NE(c)||(m={...m,...RE(r,m)}),m.duration&&(m.duration=Kn(m.duration)),m.repeatDelay&&(m.repeatDelay=Kn(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let g=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(m.duration=0,m.delay===0&&(g=!0)),g&&!a&&e.get()!==void 0){const v=Hu(m.keyframes,c);if(v!==void 0)return wt.update(()=>{m.onUpdate(v),m.onComplete()}),new Q1([])}return!a&&my.supports(m)?new my(m):new Bp(m)};function IE({protectedKeys:r,needsAnimating:e},t){const n=r.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function Tb(r,e,{delay:t=0,transitionOverride:n,type:o}={}){var a;let{transition:l=r.getDefaultTransition(),transitionEnd:c,...d}=e;n&&(l=n);const h=[],m=o&&r.animationState&&r.animationState.getState()[o];for(const g in d){const v=r.getValue(g,(a=r.latestValues[g])!==null&&a!==void 0?a:null),x=d[g];if(x===void 0||m&&IE(m,g))continue;const w={delay:t,...Ap(l||{},g)};let S=!1;if(window.MotionHandoffAnimation){const C=Yx(r);if(C){const E=window.MotionHandoffAnimation(C,g,wt);E!==null&&(w.startTime=E,S=!0)}}Af(r,g),v.start(qp(g,v,x,r.shouldReduceMotion&&Jx.has(g)?{type:!1}:w,r,S));const _=v.animation;_&&h.push(_)}return c&&Promise.all(h).then(()=>{wt.update(()=>{c&&dC(r,c)})}),h}function Of(r,e,t={}){var n;const o=qu(r,e,t.type==="exit"?(n=r.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:a=r.getDefaultTransition()||{}}=o||{};t.transitionOverride&&(a=t.transitionOverride);const l=o?()=>Promise.all(Tb(r,o,t)):()=>Promise.resolve(),c=r.variantChildren&&r.variantChildren.size?(h=0)=>{const{delayChildren:m=0,staggerChildren:g,staggerDirection:v}=a;return DE(r,e,m+h,g,v,t)}:()=>Promise.resolve(),{when:d}=a;if(d){const[h,m]=d==="beforeChildren"?[l,c]:[c,l];return h().then(()=>m())}else return Promise.all([l(),c(t.delay)])}function DE(r,e,t=0,n=0,o=1,a){const l=[],c=(r.variantChildren.size-1)*n,d=o===1?(h=0)=>h*n:(h=0)=>c-h*n;return Array.from(r.variantChildren).sort(LE).forEach((h,m)=>{h.notify("AnimationStart",e),l.push(Of(h,e,{...a,delay:t+d(m)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(l)}function LE(r,e){return r.sortNodePosition(e)}function OE(r,e,t={}){r.notify("AnimationStart",e);let n;if(Array.isArray(e)){const o=e.map(a=>Of(r,a,t));n=Promise.all(o)}else if(typeof e=="string")n=Of(r,e,t);else{const o=typeof e=="function"?qu(r,e,t.custom):e;n=Promise.all(Tb(r,o,t))}return n.then(()=>{r.notify("AnimationComplete",e)})}const ME=yp.length;function Ab(r){if(!r)return;if(!r.isControllingVariants){const t=r.parent?Ab(r.parent)||{}:{};return r.props.initial!==void 0&&(t.initial=r.props.initial),t}const e={};for(let t=0;t<ME;t++){const n=yp[t],o=r.props[n];(el(o)||o===!1)&&(e[n]=o)}return e}const $E=[...gp].reverse(),UE=gp.length;function FE(r){return e=>Promise.all(e.map(({animation:t,options:n})=>OE(r,t,n)))}function zE(r){let e=FE(r),t=gy(),n=!0;const o=d=>(h,m)=>{var g;const v=qu(r,m,d==="exit"?(g=r.presenceContext)===null||g===void 0?void 0:g.custom:void 0);if(v){const{transition:x,transitionEnd:w,...S}=v;h={...h,...S,...w}}return h};function a(d){e=d(r)}function l(d){const{props:h}=r,m=Ab(r.parent)||{},g=[],v=new Set;let x={},w=1/0;for(let _=0;_<UE;_++){const C=$E[_],E=t[C],N=h[C]!==void 0?h[C]:m[C],M=el(N),A=C===d?E.isActive:null;A===!1&&(w=_);let K=N===m[C]&&N!==h[C]&&M;if(K&&n&&r.manuallyAnimateOnMount&&(K=!1),E.protectedKeys={...x},!E.isActive&&A===null||!N&&!E.prevProp||Vu(N)||typeof N=="boolean")continue;const Z=VE(E.prevProp,N);let W=Z||C===d&&E.isActive&&!K&&M||_>w&&M,de=!1;const pe=Array.isArray(N)?N:[N];let Ee=pe.reduce(o(C),{});A===!1&&(Ee={});const{prevResolvedValues:ee={}}=E,ye={...ee,...Ee},G=_e=>{W=!0,v.has(_e)&&(de=!0,v.delete(_e)),E.needsAnimating[_e]=!0;const te=r.getValue(_e);te&&(te.liveStyle=!1)};for(const _e in ye){const te=Ee[_e],X=ee[_e];if(x.hasOwnProperty(_e))continue;let oe=!1;Ef(te)&&Ef(X)?oe=!Vx(te,X):oe=te!==X,oe?te!=null?G(_e):v.add(_e):te!==void 0&&v.has(_e)?G(_e):E.protectedKeys[_e]=!0}E.prevProp=N,E.prevResolvedValues=Ee,E.isActive&&(x={...x,...Ee}),n&&r.blockInitialAnimation&&(W=!1),W&&(!(K&&Z)||de)&&g.push(...pe.map(_e=>({animation:_e,options:{type:C}})))}if(v.size){const _={};v.forEach(C=>{const E=r.getBaseTarget(C),N=r.getValue(C);N&&(N.liveStyle=!0),_[C]=E??null}),g.push({animation:_})}let S=!!g.length;return n&&(h.initial===!1||h.initial===h.animate)&&!r.manuallyAnimateOnMount&&(S=!1),n=!1,S?e(g):Promise.resolve()}function c(d,h){var m;if(t[d].isActive===h)return Promise.resolve();(m=r.variantChildren)===null||m===void 0||m.forEach(v=>{var x;return(x=v.animationState)===null||x===void 0?void 0:x.setActive(d,h)}),t[d].isActive=h;const g=l(d);for(const v in t)t[v].protectedKeys={};return g}return{animateChanges:l,setActive:c,setAnimateFunction:a,getState:()=>t,reset:()=>{t=gy(),n=!0}}}function VE(r,e){return typeof e=="string"?e!==r:Array.isArray(e)?!Vx(e,r):!1}function io(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function gy(){return{animate:io(!0),whileInView:io(),whileHover:io(),whileTap:io(),whileDrag:io(),whileFocus:io(),exit:io()}}class Bs{constructor(e){this.isMounted=!1,this.node=e}update(){}}class BE extends Bs{constructor(e){super(e),e.animationState||(e.animationState=zE(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Vu(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let qE=0;class HE extends Bs{constructor(){super(...arguments),this.id=qE++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const o=this.node.animationState.setActive("exit",!e);t&&!e&&o.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const WE={animation:{Feature:BE},exit:{Feature:HE}};function sl(r,e,t,n={passive:!0}){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t)}function Pl(r){return{point:{x:r.pageX,y:r.pageY}}}const GE=r=>e=>Np(e)&&r(e,Pl(e));function qa(r,e,t,n){return sl(r,e,GE(t),n)}const yy=(r,e)=>Math.abs(r-e);function KE(r,e){const t=yy(r.x,e.x),n=yy(r.y,e.y);return Math.sqrt(t**2+n**2)}class jb{constructor(e,t,{transformPagePoint:n,contextWindow:o,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=Zh(this.lastMoveEventInfo,this.history),v=this.startEvent!==null,x=KE(g.offset,{x:0,y:0})>=3;if(!v&&!x)return;const{point:w}=g,{timestamp:S}=Kt;this.history.push({...w,timestamp:S});const{onStart:_,onMove:C}=this.handlers;v||(_&&_(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,g)},this.handlePointerMove=(g,v)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=Kh(v,this.transformPagePoint),wt.update(this.updatePoint,!0)},this.handlePointerUp=(g,v)=>{this.end();const{onEnd:x,onSessionEnd:w,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=Zh(g.type==="pointercancel"?this.lastMoveEventInfo:Kh(v,this.transformPagePoint),this.history);this.startEvent&&x&&x(g,_),w&&w(g,_)},!Np(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=n,this.contextWindow=o||window;const l=Pl(e),c=Kh(l,this.transformPagePoint),{point:d}=c,{timestamp:h}=Kt;this.history=[{...d,timestamp:h}];const{onSessionStart:m}=t;m&&m(e,Zh(c,this.history)),this.removeListeners=El(qa(this.contextWindow,"pointermove",this.handlePointerMove),qa(this.contextWindow,"pointerup",this.handlePointerUp),qa(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Os(this.updatePoint)}}function Kh(r,e){return e?{point:e(r.point)}:r}function vy(r,e){return{x:r.x-e.x,y:r.y-e.y}}function Zh({point:r},e){return{point:r,delta:vy(r,Rb(e)),offset:vy(r,ZE(e)),velocity:JE(e,.1)}}function ZE(r){return r[0]}function Rb(r){return r[r.length-1]}function JE(r,e){if(r.length<2)return{x:0,y:0};let t=r.length-1,n=null;const o=Rb(r);for(;t>=0&&(n=r[t],!(o.timestamp-n.timestamp>Kn(e)));)t--;if(!n)return{x:0,y:0};const a=Zn(o.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const l={x:(o.x-n.x)/a,y:(o.y-n.y)/a};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}const Nb=1e-4,QE=1-Nb,YE=1+Nb,Ib=.01,XE=0-Ib,eP=0+Ib;function jr(r){return r.max-r.min}function tP(r,e,t){return Math.abs(r-e)<=t}function xy(r,e,t,n=.5){r.origin=n,r.originPoint=Pt(e.min,e.max,r.origin),r.scale=jr(t)/jr(e),r.translate=Pt(t.min,t.max,r.origin)-r.originPoint,(r.scale>=QE&&r.scale<=YE||isNaN(r.scale))&&(r.scale=1),(r.translate>=XE&&r.translate<=eP||isNaN(r.translate))&&(r.translate=0)}function Ha(r,e,t,n){xy(r.x,e.x,t.x,n?n.originX:void 0),xy(r.y,e.y,t.y,n?n.originY:void 0)}function by(r,e,t){r.min=t.min+e.min,r.max=r.min+jr(e)}function rP(r,e,t){by(r.x,e.x,t.x),by(r.y,e.y,t.y)}function wy(r,e,t){r.min=e.min-t.min,r.max=r.min+jr(e)}function Wa(r,e,t){wy(r.x,e.x,t.x),wy(r.y,e.y,t.y)}function nP(r,{min:e,max:t},n){return e!==void 0&&r<e?r=n?Pt(e,r,n.min):Math.max(r,e):t!==void 0&&r>t&&(r=n?Pt(t,r,n.max):Math.min(r,t)),r}function Sy(r,e,t){return{min:e!==void 0?r.min+e:void 0,max:t!==void 0?r.max+t-(r.max-r.min):void 0}}function sP(r,{top:e,left:t,bottom:n,right:o}){return{x:Sy(r.x,t,o),y:Sy(r.y,e,n)}}function _y(r,e){let t=e.min-r.min,n=e.max-r.max;return e.max-e.min<r.max-r.min&&([t,n]=[n,t]),{min:t,max:n}}function oP(r,e){return{x:_y(r.x,e.x),y:_y(r.y,e.y)}}function iP(r,e){let t=.5;const n=jr(r),o=jr(e);return o>n?t=ki(e.min,e.max-n,r.min):n>o&&(t=ki(r.min,r.max-o,e.min)),Jn(0,1,t)}function aP(r,e){const t={};return e.min!==void 0&&(t.min=e.min-r.min),e.max!==void 0&&(t.max=e.max-r.min),t}const Mf=.35;function lP(r=Mf){return r===!1?r=0:r===!0&&(r=Mf),{x:ky(r,"left","right"),y:ky(r,"top","bottom")}}function ky(r,e,t){return{min:Cy(r,e),max:Cy(r,t)}}function Cy(r,e){return typeof r=="number"?r:r[e]||0}const Ey=()=>({translate:0,scale:1,origin:0,originPoint:0}),mi=()=>({x:Ey(),y:Ey()}),Py=()=>({min:0,max:0}),Dt=()=>({x:Py(),y:Py()});function Vr(r){return[r("x"),r("y")]}function Db({top:r,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:r,max:n}}}function cP({x:r,y:e}){return{top:e.min,right:r.max,bottom:e.max,left:r.min}}function uP(r,e){if(!e)return r;const t=e({x:r.left,y:r.top}),n=e({x:r.right,y:r.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function Jh(r){return r===void 0||r===1}function $f({scale:r,scaleX:e,scaleY:t}){return!Jh(r)||!Jh(e)||!Jh(t)}function uo(r){return $f(r)||Lb(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function Lb(r){return Ty(r.x)||Ty(r.y)}function Ty(r){return r&&r!=="0%"}function wu(r,e,t){const n=r-t,o=e*n;return t+o}function Ay(r,e,t,n,o){return o!==void 0&&(r=wu(r,o,n)),wu(r,t,n)+e}function Uf(r,e=0,t=1,n,o){r.min=Ay(r.min,e,t,n,o),r.max=Ay(r.max,e,t,n,o)}function Ob(r,{x:e,y:t}){Uf(r.x,e.translate,e.scale,e.originPoint),Uf(r.y,t.translate,t.scale,t.originPoint)}const jy=.999999999999,Ry=1.0000000000001;function dP(r,e,t,n=!1){const o=t.length;if(!o)return;e.x=e.y=1;let a,l;for(let c=0;c<o;c++){a=t[c],l=a.projectionDelta;const{visualElement:d}=a.options;d&&d.props.style&&d.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&yi(r,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),l&&(e.x*=l.x.scale,e.y*=l.y.scale,Ob(r,l)),n&&uo(a.latestValues)&&yi(r,a.latestValues))}e.x<Ry&&e.x>jy&&(e.x=1),e.y<Ry&&e.y>jy&&(e.y=1)}function gi(r,e){r.min=r.min+e,r.max=r.max+e}function Ny(r,e,t,n,o=.5){const a=Pt(r.min,r.max,o);Uf(r,e,t,a,n)}function yi(r,e){Ny(r.x,e.x,e.scaleX,e.scale,e.originX),Ny(r.y,e.y,e.scaleY,e.scale,e.originY)}function Mb(r,e){return Db(uP(r.getBoundingClientRect(),e))}function hP(r,e,t){const n=Mb(r,t),{scroll:o}=e;return o&&(gi(n.x,o.offset.x),gi(n.y,o.offset.y)),n}const $b=({current:r})=>r?r.ownerDocument.defaultView:null,fP=new WeakMap;class pP{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Dt(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const o=m=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Pl(m).point)},a=(m,g)=>{const{drag:v,dragPropagation:x,onDragStart:w}=this.getProps();if(v&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=iC(v),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vr(_=>{let C=this.getAxisMotionValue(_).get()||0;if(vn.test(C)){const{projection:E}=this.visualElement;if(E&&E.layout){const N=E.layout.layoutBox[_];N&&(C=jr(N)*(parseFloat(C)/100))}}this.originPoint[_]=C}),w&&wt.postRender(()=>w(m,g)),Af(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},l=(m,g)=>{const{dragPropagation:v,dragDirectionLock:x,onDirectionLock:w,onDrag:S}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:_}=g;if(x&&this.currentDirection===null){this.currentDirection=mP(_),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",g.point,_),this.updateAxis("y",g.point,_),this.visualElement.render(),S&&S(m,g)},c=(m,g)=>this.stop(m,g),d=()=>Vr(m=>{var g;return this.getAnimationState(m)==="paused"&&((g=this.getAxisMotionValue(m).animation)===null||g===void 0?void 0:g.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new jb(e,{onSessionStart:o,onStart:a,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:$b(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:o}=t;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&wt.postRender(()=>a(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:o}=this.getProps();if(!n||!Yc(e,o,this.currentDirection))return;const a=this.getAxisMotionValue(e);let l=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(l=nP(l,this.constraints[e],this.elastic[e])),a.set(l)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,a=this.constraints;t&&fi(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&o?this.constraints=sP(o.layoutBox,t):this.constraints=!1,this.elastic=lP(n),a!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Vr(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=aP(o.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!fi(e))return!1;const n=e.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const a=hP(n,o.root,this.visualElement.getTransformPagePoint());let l=oP(o.layout.layoutBox,a);if(t){const c=t(cP(l));this.hasMutatedConstraints=!!c,c&&(l=Db(c))}return l}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:o,dragTransition:a,dragSnapToOrigin:l,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},h=Vr(m=>{if(!Yc(m,t,this.currentDirection))return;let g=d&&d[m]||{};l&&(g={min:0,max:0});const v=o?200:1e6,x=o?40:1e7,w={type:"inertia",velocity:n?e[m]:0,bounceStiffness:v,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...a,...g};return this.startAxisValueAnimation(m,w)});return Promise.all(h).then(c)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return Af(this.visualElement,e),n.start(qp(e,n,0,t,this.visualElement,!1))}stopAnimation(){Vr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Vr(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),o=n[t];return o||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Vr(t=>{const{drag:n}=this.getProps();if(!Yc(t,n,this.currentDirection))return;const{projection:o}=this.visualElement,a=this.getAxisMotionValue(t);if(o&&o.layout){const{min:l,max:c}=o.layout.layoutBox[t];a.set(e[t]-Pt(l,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!fi(t)||!n||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Vr(l=>{const c=this.getAxisMotionValue(l);if(c&&this.constraints!==!1){const d=c.get();o[l]=iP({min:d,max:d},this.constraints[l])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Vr(l=>{if(!Yc(l,e,null))return;const c=this.getAxisMotionValue(l),{min:d,max:h}=this.constraints[l];c.set(Pt(d,h,o[l]))})}addListeners(){if(!this.visualElement.current)return;fP.set(this.visualElement,this);const e=this.visualElement.current,t=qa(e,"pointerdown",d=>{const{drag:h,dragListener:m=!0}=this.getProps();h&&m&&this.start(d)}),n=()=>{const{dragConstraints:d}=this.getProps();fi(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,a=o.addEventListener("measure",n);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),wt.read(n);const l=sl(window,"resize",()=>this.scalePositionWithinConstraints()),c=o.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h})=>{this.isDragging&&h&&(Vr(m=>{const g=this.getAxisMotionValue(m);g&&(this.originPoint[m]+=d[m].translate,g.set(g.get()+d[m].translate))}),this.visualElement.render())});return()=>{l(),t(),a(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:o=!1,dragConstraints:a=!1,dragElastic:l=Mf,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:o,dragConstraints:a,dragElastic:l,dragMomentum:c}}}function Yc(r,e,t){return(e===!0||e===r)&&(t===null||t===r)}function mP(r,e=10){let t=null;return Math.abs(r.y)>e?t="y":Math.abs(r.x)>e&&(t="x"),t}class gP extends Bs{constructor(e){super(e),this.removeGroupControls=Tr,this.removeListeners=Tr,this.controls=new pP(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Tr}unmount(){this.removeGroupControls(),this.removeListeners()}}const Iy=r=>(e,t)=>{r&&wt.postRender(()=>r(e,t))};class yP extends Bs{constructor(){super(...arguments),this.removePointerDownListener=Tr}onPointerDown(e){this.session=new jb(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:$b(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:o}=this.node.getProps();return{onSessionStart:Iy(e),onStart:Iy(t),onMove:n,onEnd:(a,l)=>{delete this.session,o&&wt.postRender(()=>o(a,l))}}}mount(){this.removePointerDownListener=qa(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const uu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Dy(r,e){return e.max===e.min?0:r/(e.max-e.min)*100}const Pa={correct:(r,e)=>{if(!e.target)return r;if(typeof r=="string")if(ze.test(r))r=parseFloat(r);else return r;const t=Dy(r,e.target.x),n=Dy(r,e.target.y);return`${t}% ${n}%`}},vP={correct:(r,{treeScale:e,projectionDelta:t})=>{const n=r,o=Ms.parse(r);if(o.length>5)return n;const a=Ms.createTransformer(r),l=typeof o[0]!="number"?1:0,c=t.x.scale*e.x,d=t.y.scale*e.y;o[0+l]/=c,o[1+l]/=d;const h=Pt(c,d,.5);return typeof o[2+l]=="number"&&(o[2+l]/=h),typeof o[3+l]=="number"&&(o[3+l]/=h),a(o)}};class xP extends j.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:o}=this.props,{projection:a}=e;U1(bP),a&&(t.group&&t.group.add(a),n&&n.register&&o&&n.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),uu.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:o,isPresent:a}=this.props,l=n.projection;return l&&(l.isPresent=a,o||e.layoutDependency!==t||t===void 0?l.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?l.promote():l.relegate()||wt.postRender(()=>{const c=l.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),xp.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:o}=e;o&&(o.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(o),n&&n.deregister&&n.deregister(o))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ub(r){const[e,t]=wx(),n=j.useContext(dp);return p.jsx(xP,{...r,layoutGroup:n,switchLayoutGroup:j.useContext(Ax),isPresent:e,safeToRemove:t})}const bP={borderRadius:{...Pa,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Pa,borderTopRightRadius:Pa,borderBottomLeftRadius:Pa,borderBottomRightRadius:Pa,boxShadow:vP};function wP(r,e,t){const n=rr(r)?r:rl(r);return n.start(qp("",n,e,t)),n.animation}function SP(r){return r instanceof SVGElement&&r.tagName!=="svg"}const _P=(r,e)=>r.depth-e.depth;class kP{constructor(){this.children=[],this.isDirty=!1}add(e){Ip(this.children,e),this.isDirty=!0}remove(e){Dp(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(_P),this.isDirty=!1,this.children.forEach(e)}}function CP(r,e){const t=xn.now(),n=({timestamp:o})=>{const a=o-t;a>=e&&(Os(n),r(a-e))};return wt.read(n,!0),()=>Os(n)}const Fb=["TopLeft","TopRight","BottomLeft","BottomRight"],EP=Fb.length,Ly=r=>typeof r=="string"?parseFloat(r):r,Oy=r=>typeof r=="number"||ze.test(r);function PP(r,e,t,n,o,a){o?(r.opacity=Pt(0,t.opacity!==void 0?t.opacity:1,TP(n)),r.opacityExit=Pt(e.opacity!==void 0?e.opacity:1,0,AP(n))):a&&(r.opacity=Pt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,n));for(let l=0;l<EP;l++){const c=`border${Fb[l]}Radius`;let d=My(e,c),h=My(t,c);if(d===void 0&&h===void 0)continue;d||(d=0),h||(h=0),d===0||h===0||Oy(d)===Oy(h)?(r[c]=Math.max(Pt(Ly(d),Ly(h),n),0),(vn.test(h)||vn.test(d))&&(r[c]+="%")):r[c]=h}(e.rotate||t.rotate)&&(r.rotate=Pt(e.rotate||0,t.rotate||0,n))}function My(r,e){return r[e]!==void 0?r[e]:r.borderRadius}const TP=zb(0,.5,ob),AP=zb(.5,.95,Tr);function zb(r,e,t){return n=>n<r?0:n>e?1:t(ki(r,e,n))}function $y(r,e){r.min=e.min,r.max=e.max}function Fr(r,e){$y(r.x,e.x),$y(r.y,e.y)}function Uy(r,e){r.translate=e.translate,r.scale=e.scale,r.originPoint=e.originPoint,r.origin=e.origin}function Fy(r,e,t,n,o){return r-=e,r=wu(r,1/t,n),o!==void 0&&(r=wu(r,1/o,n)),r}function jP(r,e=0,t=1,n=.5,o,a=r,l=r){if(vn.test(e)&&(e=parseFloat(e),e=Pt(l.min,l.max,e/100)-l.min),typeof e!="number")return;let c=Pt(a.min,a.max,n);r===a&&(c-=e),r.min=Fy(r.min,e,t,c,o),r.max=Fy(r.max,e,t,c,o)}function zy(r,e,[t,n,o],a,l){jP(r,e[t],e[n],e[o],e.scale,a,l)}const RP=["x","scaleX","originX"],NP=["y","scaleY","originY"];function Vy(r,e,t,n){zy(r.x,e,RP,t?t.x:void 0,n?n.x:void 0),zy(r.y,e,NP,t?t.y:void 0,n?n.y:void 0)}function By(r){return r.translate===0&&r.scale===1}function Vb(r){return By(r.x)&&By(r.y)}function qy(r,e){return r.min===e.min&&r.max===e.max}function IP(r,e){return qy(r.x,e.x)&&qy(r.y,e.y)}function Hy(r,e){return Math.round(r.min)===Math.round(e.min)&&Math.round(r.max)===Math.round(e.max)}function Bb(r,e){return Hy(r.x,e.x)&&Hy(r.y,e.y)}function Wy(r){return jr(r.x)/jr(r.y)}function Gy(r,e){return r.translate===e.translate&&r.scale===e.scale&&r.originPoint===e.originPoint}class DP{constructor(){this.members=[]}add(e){Ip(this.members,e),e.scheduleRender()}remove(e){if(Dp(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(o=>e===o);if(t===0)return!1;let n;for(let o=t;o>=0;o--){const a=this.members[o];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:o}=e.options;o===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function LP(r,e,t){let n="";const o=r.x.translate/e.x,a=r.y.translate/e.y,l=t?.z||0;if((o||a||l)&&(n=`translate3d(${o}px, ${a}px, ${l}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:m,rotateX:g,rotateY:v,skewX:x,skewY:w}=t;h&&(n=`perspective(${h}px) ${n}`),m&&(n+=`rotate(${m}deg) `),g&&(n+=`rotateX(${g}deg) `),v&&(n+=`rotateY(${v}deg) `),x&&(n+=`skewX(${x}deg) `),w&&(n+=`skewY(${w}deg) `)}const c=r.x.scale*e.x,d=r.y.scale*e.y;return(c!==1||d!==1)&&(n+=`scale(${c}, ${d})`),n||"none"}const ho={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},$a=typeof window<"u"&&window.MotionDebug!==void 0,Qh=["","X","Y","Z"],OP={visibility:"hidden"},Ky=1e3;let MP=0;function Yh(r,e,t,n){const{latestValues:o}=e;o[r]&&(t[r]=o[r],e.setStaticValue(r,0),n&&(n[r]=0))}function qb(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:e}=r.options;if(!e)return;const t=Yx(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:o,layoutId:a}=r.options;window.MotionCancelOptimisedAnimation(t,"transform",wt,!(o||a))}const{parent:n}=r;n&&!n.hasCheckedOptimisedAppear&&qb(n)}function Hb({attachResizeListener:r,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:o}){return class{constructor(l={},c=e?.()){this.id=MP++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,$a&&(ho.totalNodes=ho.resolvedTargetDeltas=ho.recalculatedProjection=0),this.nodes.forEach(FP),this.nodes.forEach(HP),this.nodes.forEach(WP),this.nodes.forEach(zP),$a&&window.MotionDebug.record(ho)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new kP)}addEventListener(l,c){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new Lp),this.eventHandlers.get(l).add(c)}notifyListeners(l,...c){const d=this.eventHandlers.get(l);d&&d.notify(...c)}hasListeners(l){return this.eventHandlers.has(l)}mount(l,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=SP(l),this.instance=l;const{layoutId:d,layout:h,visualElement:m}=this.options;if(m&&!m.current&&m.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(h||d)&&(this.isLayoutDirty=!0),r){let g;const v=()=>this.root.updateBlockedByResize=!1;r(l,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=CP(v,250),uu.hasAnimatedSinceResize&&(uu.hasAnimatedSinceResize=!1,this.nodes.forEach(Jy))})}d&&this.root.registerSharedNode(d,this),this.options.animate!==!1&&m&&(d||h)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:v,hasRelativeTargetChanged:x,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const S=this.options.transition||m.getDefaultTransition()||QP,{onLayoutAnimationStart:_,onLayoutAnimationComplete:C}=m.getProps(),E=!this.targetLayout||!Bb(this.targetLayout,w)||x,N=!v&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||N||v&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,N);const M={...Ap(S,"layout"),onPlay:_,onComplete:C};(m.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else v||Jy(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Os(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(GP),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&qb(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const g=this.path[m];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Zy);return}this.isUpdating||this.nodes.forEach(BP),this.isUpdating=!1,this.nodes.forEach(qP),this.nodes.forEach($P),this.nodes.forEach(UP),this.clearAllSnapshots();const c=xn.now();Kt.delta=Jn(0,1e3/60,c-Kt.timestamp),Kt.timestamp=c,Kt.isProcessing=!0,Vh.update.process(Kt),Vh.preRender.process(Kt),Vh.render.process(Kt),Kt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,xp.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(VP),this.sharedNodes.forEach(KP)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,wt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){wt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Dt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(c=!1),c){const d=n(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:d,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!o)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!Vb(this.projectionDelta),d=this.getTransformTemplate(),h=d?d(this.latestValues,""):void 0,m=h!==this.prevTransformTemplateValue;l&&(c||uo(this.latestValues)||m)&&(o(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return l&&(d=this.removeTransform(d)),YP(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var l;const{visualElement:c}=this.options;if(!c)return Dt();const d=c.measureViewportBox();if(!(((l=this.scroll)===null||l===void 0?void 0:l.wasRoot)||this.path.some(XP))){const{scroll:m}=this.root;m&&(gi(d.x,m.offset.x),gi(d.y,m.offset.y))}return d}removeElementScroll(l){var c;const d=Dt();if(Fr(d,l),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return d;for(let h=0;h<this.path.length;h++){const m=this.path[h],{scroll:g,options:v}=m;m!==this.root&&g&&v.layoutScroll&&(g.wasRoot&&Fr(d,l),gi(d.x,g.offset.x),gi(d.y,g.offset.y))}return d}applyTransform(l,c=!1){const d=Dt();Fr(d,l);for(let h=0;h<this.path.length;h++){const m=this.path[h];!c&&m.options.layoutScroll&&m.scroll&&m!==m.root&&yi(d,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),uo(m.latestValues)&&yi(d,m.latestValues)}return uo(this.latestValues)&&yi(d,this.latestValues),d}removeTransform(l){const c=Dt();Fr(c,l);for(let d=0;d<this.path.length;d++){const h=this.path[d];if(!h.instance||!uo(h.latestValues))continue;$f(h.latestValues)&&h.updateSnapshot();const m=Dt(),g=h.measurePageBox();Fr(m,g),Vy(c,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,m)}return uo(this.latestValues)&&Vy(c,this.latestValues),c}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Kt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var c;const d=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=d.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=d.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=d.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==d;if(!(l||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:v}=this.options;if(!(!this.layout||!(g||v))){if(this.resolvedRelativeTargetAt=Kt.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Dt(),this.relativeTargetOrigin=Dt(),Wa(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),Fr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Dt(),this.targetWithTransforms=Dt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),rP(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Fr(this.target,this.layout.layoutBox),Ob(this.target,this.targetDelta)):Fr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Dt(),this.relativeTargetOrigin=Dt(),Wa(this.relativeTargetOrigin,this.target,x.target),Fr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}$a&&ho.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||$f(this.parent.latestValues)||Lb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var l;const c=this.getLead(),d=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty)&&(h=!1),d&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===Kt.timestamp&&(h=!1),h)return;const{layout:m,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(m||g))return;Fr(this.layoutCorrected,this.layout.layoutBox);const v=this.treeScale.x,x=this.treeScale.y;dP(this.layoutCorrected,this.treeScale,this.path,d),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Dt());const{target:w}=c;if(!w){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Uy(this.prevProjectionDelta.x,this.projectionDelta.x),Uy(this.prevProjectionDelta.y,this.projectionDelta.y)),Ha(this.projectionDelta,this.layoutCorrected,w,this.latestValues),(this.treeScale.x!==v||this.treeScale.y!==x||!Gy(this.projectionDelta.x,this.prevProjectionDelta.x)||!Gy(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),$a&&ho.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),l){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mi(),this.projectionDelta=mi(),this.projectionDeltaWithTransform=mi()}setAnimationOrigin(l,c=!1){const d=this.snapshot,h=d?d.latestValues:{},m={...this.latestValues},g=mi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const v=Dt(),x=d?d.source:void 0,w=this.layout?this.layout.source:void 0,S=x!==w,_=this.getStack(),C=!_||_.members.length<=1,E=!!(S&&!C&&this.options.crossfade===!0&&!this.path.some(JP));this.animationProgress=0;let N;this.mixTargetDelta=M=>{const A=M/1e3;Qy(g.x,l.x,A),Qy(g.y,l.y,A),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Wa(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ZP(this.relativeTarget,this.relativeTargetOrigin,v,A),N&&IP(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Dt()),Fr(N,this.relativeTarget)),S&&(this.animationValues=m,PP(m,h,this.latestValues,A,E,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Os(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=wt.update(()=>{uu.hasAnimatedSinceResize=!0,this.currentAnimation=wP(0,Ky,{...l,onUpdate:c=>{this.mixTargetDelta(c),l.onUpdate&&l.onUpdate(c)},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ky),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:c,target:d,layout:h,latestValues:m}=l;if(!(!c||!d||!h)){if(this!==l&&this.layout&&h&&Wb(this.options.animationType,this.layout.layoutBox,h.layoutBox)){d=this.target||Dt();const g=jr(this.layout.layoutBox.x);d.x.min=l.target.x.min,d.x.max=d.x.min+g;const v=jr(this.layout.layoutBox.y);d.y.min=l.target.y.min,d.y.max=d.y.min+v}Fr(c,d),yi(c,m),Ha(this.projectionDeltaWithTransform,this.layoutCorrected,c,m)}}registerSharedNode(l,c){this.sharedNodes.has(l)||this.sharedNodes.set(l,new DP),this.sharedNodes.get(l).add(c);const h=c.options.initialPromotionConfig;c.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(c):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var l;const{layoutId:c}=this.options;return c?((l=this.getStack())===null||l===void 0?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:c}=this.options;return c?(l=this.getStack())===null||l===void 0?void 0:l.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:c,preserveFollowOpacity:d}={}){const h=this.getStack();h&&h.promote(this,d),l&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let c=!1;const{latestValues:d}=l;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const h={};d.z&&Yh("z",l,h,this.animationValues);for(let m=0;m<Qh.length;m++)Yh(`rotate${Qh[m]}`,l,h,this.animationValues),Yh(`skew${Qh[m]}`,l,h,this.animationValues);l.render();for(const m in h)l.setStaticValue(m,h[m]),this.animationValues&&(this.animationValues[m]=h[m]);l.scheduleRender()}getProjectionStyles(l){var c,d;if(!this.instance||this.isSVG)return;if(!this.isVisible)return OP;const h={visibility:""},m=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=lu(l?.pointerEvents)||"",h.transform=m?m(this.latestValues,""):"none",h;const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){const S={};return this.options.layoutId&&(S.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,S.pointerEvents=lu(l?.pointerEvents)||""),this.hasProjected&&!uo(this.latestValues)&&(S.transform=m?m({},""):"none",this.hasProjected=!1),S}const v=g.animationValues||g.latestValues;this.applyTransformsToTarget(),h.transform=LP(this.projectionDeltaWithTransform,this.treeScale,v),m&&(h.transform=m(v,h.transform));const{x,y:w}=this.projectionDelta;h.transformOrigin=`${x.origin*100}% ${w.origin*100}% 0`,g.animationValues?h.opacity=g===this?(d=(c=v.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&d!==void 0?d:1:this.preserveOpacity?this.latestValues.opacity:v.opacityExit:h.opacity=g===this?v.opacity!==void 0?v.opacity:"":v.opacityExit!==void 0?v.opacityExit:0;for(const S in gu){if(v[S]===void 0)continue;const{correct:_,applyTo:C}=gu[S],E=h.transform==="none"?v[S]:_(v[S],g);if(C){const N=C.length;for(let M=0;M<N;M++)h[C[M]]=E}else h[S]=E}return this.options.layoutId&&(h.pointerEvents=g===this?lu(l?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var c;return(c=l.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach(Zy),this.root.sharedNodes.clear()}}}function $P(r){r.updateLayout()}function UP(r){var e;const t=((e=r.resumeFrom)===null||e===void 0?void 0:e.snapshot)||r.snapshot;if(r.isLead()&&r.layout&&t&&r.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:o}=r.layout,{animationType:a}=r.options,l=t.source!==r.layout.source;a==="size"?Vr(g=>{const v=l?t.measuredBox[g]:t.layoutBox[g],x=jr(v);v.min=n[g].min,v.max=v.min+x}):Wb(a,t.layoutBox,n)&&Vr(g=>{const v=l?t.measuredBox[g]:t.layoutBox[g],x=jr(n[g]);v.max=v.min+x,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[g].max=r.relativeTarget[g].min+x)});const c=mi();Ha(c,n,t.layoutBox);const d=mi();l?Ha(d,r.applyTransform(o,!0),t.measuredBox):Ha(d,n,t.layoutBox);const h=!Vb(c);let m=!1;if(!r.resumeFrom){const g=r.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:v,layout:x}=g;if(v&&x){const w=Dt();Wa(w,t.layoutBox,v.layoutBox);const S=Dt();Wa(S,n,x.layoutBox),Bb(w,S)||(m=!0),g.options.layoutRoot&&(r.relativeTarget=S,r.relativeTargetOrigin=w,r.relativeParent=g)}}}r.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:d,layoutDelta:c,hasLayoutChanged:h,hasRelativeTargetChanged:m})}else if(r.isLead()){const{onExitComplete:n}=r.options;n&&n()}r.options.transition=void 0}function FP(r){$a&&ho.totalNodes++,r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function zP(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function VP(r){r.clearSnapshot()}function Zy(r){r.clearMeasurements()}function BP(r){r.isLayoutDirty=!1}function qP(r){const{visualElement:e}=r.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),r.resetTransform()}function Jy(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function HP(r){r.resolveTargetDelta()}function WP(r){r.calcProjection()}function GP(r){r.resetSkewAndRotation()}function KP(r){r.removeLeadSnapshot()}function Qy(r,e,t){r.translate=Pt(e.translate,0,t),r.scale=Pt(e.scale,1,t),r.origin=e.origin,r.originPoint=e.originPoint}function Yy(r,e,t,n){r.min=Pt(e.min,t.min,n),r.max=Pt(e.max,t.max,n)}function ZP(r,e,t,n){Yy(r.x,e.x,t.x,n),Yy(r.y,e.y,t.y,n)}function JP(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const QP={duration:.45,ease:[.4,0,.1,1]},Xy=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),ev=Xy("applewebkit/")&&!Xy("chrome/")?Math.round:Tr;function tv(r){r.min=ev(r.min),r.max=ev(r.max)}function YP(r){tv(r.x),tv(r.y)}function Wb(r,e,t){return r==="position"||r==="preserve-aspect"&&!tP(Wy(e),Wy(t),.2)}function XP(r){var e;return r!==r.root&&((e=r.scroll)===null||e===void 0?void 0:e.wasRoot)}const eT=Hb({attachResizeListener:(r,e)=>sl(r,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Xh={current:void 0},Gb=Hb({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!Xh.current){const r=new eT({});r.mount(window),r.setOptions({layoutScroll:!0}),Xh.current=r}return Xh.current},resetTransform:(r,e)=>{r.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),tT={pan:{Feature:yP},drag:{Feature:gP,ProjectionNode:Gb,MeasureLayout:Ub}};function rv(r,e,t){const{props:n}=r;r.animationState&&n.whileHover&&r.animationState.setActive("whileHover",t==="Start");const o="onHover"+t,a=n[o];a&&wt.postRender(()=>a(e,Pl(e)))}class rT extends Bs{mount(){const{current:e}=this.node;e&&(this.unmount=tC(e,t=>(rv(this.node,t,"Start"),n=>rv(this.node,n,"End"))))}unmount(){}}class nT extends Bs{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=El(sl(this.node.current,"focus",()=>this.onFocus()),sl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function nv(r,e,t){const{props:n}=r;r.animationState&&n.whileTap&&r.animationState.setActive("whileTap",t==="Start");const o="onTap"+(t==="End"?"":t),a=n[o];a&&wt.postRender(()=>a(e,Pl(e)))}class sT extends Bs{mount(){const{current:e}=this.node;e&&(this.unmount=oC(e,t=>(nv(this.node,t,"Start"),(n,{success:o})=>nv(this.node,n,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ff=new WeakMap,ef=new WeakMap,oT=r=>{const e=Ff.get(r.target);e&&e(r)},iT=r=>{r.forEach(oT)};function aT({root:r,...e}){const t=r||document;ef.has(t)||ef.set(t,{});const n=ef.get(t),o=JSON.stringify(e);return n[o]||(n[o]=new IntersectionObserver(iT,{root:r,...e})),n[o]}function lT(r,e,t){const n=aT(e);return Ff.set(r,t),n.observe(r),()=>{Ff.delete(r),n.unobserve(r)}}const cT={some:0,all:1};class uT extends Bs{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:o="some",once:a}=e,l={root:t?t.current:void 0,rootMargin:n,threshold:typeof o=="number"?o:cT[o]},c=d=>{const{isIntersecting:h}=d;if(this.isInView===h||(this.isInView=h,a&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:m,onViewportLeave:g}=this.node.getProps(),v=h?m:g;v&&v(d)};return lT(this.node.current,l,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(dT(e,t))&&this.startObserver()}unmount(){}}function dT({viewport:r={}},{viewport:e={}}={}){return t=>r[t]!==e[t]}const hT={inView:{Feature:uT},tap:{Feature:sT},focus:{Feature:nT},hover:{Feature:rT}},fT={layout:{ProjectionNode:Gb,MeasureLayout:Ub}},zf={current:null},Kb={current:!1};function pT(){if(Kb.current=!0,!!pp)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),e=()=>zf.current=r.matches;r.addListener(e),e()}else zf.current=!1}const mT=[...xb,er,Ms],gT=r=>mT.find(vb(r)),sv=new WeakMap;function yT(r,e,t){for(const n in e){const o=e[n],a=t[n];if(rr(o))r.addValue(n,o);else if(rr(a))r.addValue(n,rl(o,{owner:r}));else if(a!==o)if(r.hasValue(n)){const l=r.getValue(n);l.liveStyle===!0?l.jump(o):l.hasAnimated||l.set(o)}else{const l=r.getStaticValue(n);r.addValue(n,rl(l!==void 0?l:o,{owner:r}))}}for(const n in t)e[n]===void 0&&r.removeValue(n);return e}const ov=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class vT{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:o,blockInitialAnimation:a,visualState:l},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=zp,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const x=xn.now();this.renderScheduledAt<x&&(this.renderScheduledAt=x,wt.render(this.render,!1,!0))};const{latestValues:d,renderState:h,onUpdate:m}=l;this.onUpdate=m,this.latestValues=d,this.baseTarget={...d},this.initialValues=t.initial?{...d}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=o,this.options=c,this.blockInitialAnimation=!!a,this.isControllingVariants=Bu(t),this.isVariantNode=Px(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:g,...v}=this.scrapeMotionValuesFromProps(t,{},this);for(const x in v){const w=v[x];d[x]!==void 0&&rr(w)&&w.set(d[x],!1)}}mount(e){this.current=e,sv.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),Kb.current||pT(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:zf.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){sv.delete(this.current),this.projection&&this.projection.unmount(),Os(this.notifyUpdate),Os(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=_o.has(e),o=t.on("change",c=>{this.latestValues[e]=c,this.props.onUpdate&&wt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),a=t.on("renderRequest",this.scheduleRender);let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{o(),a(),l&&l(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ci){const t=Ci[e];if(!t)continue;const{isEnabled:n,Feature:o}=t;if(!this.features[e]&&o&&n(this.props)&&(this.features[e]=new o(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Dt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<ov.length;n++){const o=ov[n];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const a="on"+o,l=e[a];l&&(this.propEventSubscriptions[o]=this.on(o,l))}this.prevMotionValues=yT(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=rl(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let o=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return o!=null&&(typeof o=="string"&&(gb(o)||ab(o))?o=parseFloat(o):!gT(o)&&Ms.test(t)&&(o=fb(e,t)),this.setBaseTarget(e,rr(o)?o.get():o)),rr(o)?o.get():o}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let o;if(typeof n=="string"||typeof n=="object"){const l=wp(this.props,n,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);l&&(o=l[e])}if(n&&o!==void 0)return o;const a=this.getBaseTargetFromProps(this.props,e);return a!==void 0&&!rr(a)?a:this.initialValues[e]!==void 0&&o===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Lp),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class Zb extends vT{constructor(){super(...arguments),this.KeyframeResolver=bb}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;rr(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function xT(r){return window.getComputedStyle(r)}class bT extends Zb{constructor(){super(...arguments),this.type="html",this.renderInstance=Ox}readValueFromInstance(e,t){if(_o.has(t)){const n=Fp(t);return n&&n.default||0}else{const n=xT(e),o=(Ix(t)?n.getPropertyValue(t):n[t])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(e,{transformPagePoint:t}){return Mb(e,t)}build(e,t,n){kp(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return Tp(e,t,n)}}class wT extends Zb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Dt}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(_o.has(t)){const n=Fp(t);return n&&n.default||0}return t=Mx.has(t)?t:vp(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return Fx(e,t,n)}build(e,t,n){Cp(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,o){$x(e,t,n,o)}mount(e){this.isSVGTag=Pp(e.tagName),super.mount(e)}}const ST=(r,e)=>bp(r)?new wT(e):new bT(e,{allowProjection:r!==j.Fragment}),_T=K1({...WE,...hT,...tT,...fT},ST),Le=c1(_T),kT={},iv=r=>{let e;const t=new Set,n=(m,g)=>{const v=typeof m=="function"?m(e):m;if(!Object.is(v,e)){const x=e;e=g??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(w=>w(e,x))}},o=()=>e,d={setState:n,getState:o,getInitialState:()=>h,subscribe:m=>(t.add(m),()=>t.delete(m)),destroy:()=>{(kT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=r(n,o,d);return d},CT=r=>r?iv(r):iv;var tf={exports:{}},rf={},nf={exports:{}},sf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function ET(){if(av)return sf;av=1;var r=_l();function e(g,v){return g===v&&(g!==0||1/g===1/v)||g!==g&&v!==v}var t=typeof Object.is=="function"?Object.is:e,n=r.useState,o=r.useEffect,a=r.useLayoutEffect,l=r.useDebugValue;function c(g,v){var x=v(),w=n({inst:{value:x,getSnapshot:v}}),S=w[0].inst,_=w[1];return a(function(){S.value=x,S.getSnapshot=v,d(S)&&_({inst:S})},[g,x,v]),o(function(){return d(S)&&_({inst:S}),g(function(){d(S)&&_({inst:S})})},[g]),l(x),x}function d(g){var v=g.getSnapshot;g=g.value;try{var x=v();return!t(g,x)}catch{return!0}}function h(g,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return sf.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:m,sf}var lv;function PT(){return lv||(lv=1,nf.exports=ET()),nf.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cv;function TT(){if(cv)return rf;cv=1;var r=_l(),e=PT();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var n=typeof Object.is=="function"?Object.is:t,o=e.useSyncExternalStore,a=r.useRef,l=r.useEffect,c=r.useMemo,d=r.useDebugValue;return rf.useSyncExternalStoreWithSelector=function(h,m,g,v,x){var w=a(null);if(w.current===null){var S={hasValue:!1,value:null};w.current=S}else S=w.current;w=c(function(){function C(K){if(!E){if(E=!0,N=K,K=v(K),x!==void 0&&S.hasValue){var Z=S.value;if(x(Z,K))return M=Z}return M=K}if(Z=M,n(N,K))return Z;var W=v(K);return x!==void 0&&x(Z,W)?(N=K,Z):(N=K,M=W)}var E=!1,N,M,A=g===void 0?null:g;return[function(){return C(m())},A===null?void 0:function(){return C(A())}]},[m,g,v,x]);var _=o(h,w[0],w[1]);return l(function(){S.hasValue=!0,S.value=_},[_]),d(_),_},rf}var uv;function AT(){return uv||(uv=1,tf.exports=TT()),tf.exports}var jT=AT();const RT=Sl(jT),Jb={},{useDebugValue:NT}=Me,{useSyncExternalStoreWithSelector:IT}=RT;let dv=!1;const DT=r=>r;function LT(r,e=DT,t){(Jb?"production":void 0)!=="production"&&t&&!dv&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),dv=!0);const n=IT(r.subscribe,r.getState,r.getServerState||r.getInitialState,e,t);return NT(n),n}const hv=r=>{(Jb?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof r=="function"?CT(r):r,t=(n,o)=>LT(e,n,o);return Object.assign(t,e),t},Wu=r=>r?hv(r):hv,Qb=Wu((r,e)=>({theme:"light",isTransitioning:!1,toggleTheme:()=>{const t=e().theme==="light"?"dark":"light";r({isTransitioning:!0}),document.documentElement.style.setProperty("--theme-transition","all 0.25s cubic-bezier(0.4, 0, 0.2, 1)"),document.documentElement.style.transition="background-color 0.25s cubic-bezier(0.4, 0, 0.2, 1), color 0.25s cubic-bezier(0.4, 0, 0.2, 1)",t==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),r({theme:t}),localStorage.setItem("theme",t),setTimeout(()=>{document.documentElement.style.removeProperty("--theme-transition"),document.documentElement.style.transition="",r({isTransitioning:!1})},250)},setTheme:t=>{r({theme:t}),document.documentElement.style.transition="background-color 0.3s ease, color 0.3s ease",t==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",t),setTimeout(()=>{document.documentElement.style.transition=""},300)},initializeTheme:()=>{const t=localStorage.getItem("theme"),n=window.matchMedia("(prefers-color-scheme: dark)").matches,o=t||(n?"dark":"light");document.documentElement.classList.add("preload-transitions"),r({theme:o}),o==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("theme",o),requestAnimationFrame(()=>{document.documentElement.classList.remove("preload-transitions")})}})),OT=({children:r})=>{const{theme:e,isTransitioning:t,initializeTheme:n}=Qb();return j.useEffect(()=>{n()},[n]),p.jsxs(Le.div,{initial:!1,animate:{opacity:t?.98:1},transition:{duration:.25,ease:[.4,0,.2,1]},className:"min-h-screen",style:{transition:t?"var(--theme-transition)":void 0},children:[r,p.jsx(Mi,{children:t&&p.jsx(Le.div,{initial:{opacity:0},animate:{opacity:.03},exit:{opacity:0},transition:{duration:.125},className:"fixed inset-0 bg-white dark:bg-gray-900 pointer-events-none z-[9998]"})})]})},MT="modulepreload",$T=function(r){return"/"+r},fv={},ct=function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");o=d(t.map(h=>{if(h=$T(h),h in fv)return;fv[h]=!0;const m=h.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":MT,m||(v.as="script"),v.crossOrigin="",v.href=h,c&&v.setAttribute("nonce",c),document.head.appendChild(v),m)return new Promise((x,w)=>{v.addEventListener("load",x),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},UT={};function Hp(r,e){let t;try{t=r()}catch{return}return{getItem:o=>{var a;const l=d=>d===null?null:JSON.parse(d,e?.reviver),c=(a=t.getItem(o))!=null?a:null;return c instanceof Promise?c.then(l):l(c)},setItem:(o,a)=>t.setItem(o,JSON.stringify(a,e?.replacer)),removeItem:o=>t.removeItem(o)}}const ol=r=>e=>{try{const t=r(e);return t instanceof Promise?t:{then(n){return ol(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return ol(n)(t)}}}},FT=(r,e)=>(t,n,o)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:_=>_,version:0,merge:(_,C)=>({...C,..._}),...e},l=!1;const c=new Set,d=new Set;let h;try{h=a.getStorage()}catch{}if(!h)return r((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(..._)},n,o);const m=ol(a.serialize),g=()=>{const _=a.partialize({...n()});let C;const E=m({state:_,version:a.version}).then(N=>h.setItem(a.name,N)).catch(N=>{C=N});if(C)throw C;return E},v=o.setState;o.setState=(_,C)=>{v(_,C),g()};const x=r((..._)=>{t(..._),g()},n,o);let w;const S=()=>{var _;if(!h)return;l=!1,c.forEach(E=>E(n()));const C=((_=a.onRehydrateStorage)==null?void 0:_.call(a,n()))||void 0;return ol(h.getItem.bind(h))(a.name).then(E=>{if(E)return a.deserialize(E)}).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==a.version){if(a.migrate)return a.migrate(E.state,E.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return E.state}).then(E=>{var N;return w=a.merge(E,(N=n())!=null?N:x),t(w,!0),g()}).then(()=>{C?.(w,void 0),l=!0,d.forEach(E=>E(w))}).catch(E=>{C?.(void 0,E)})};return o.persist={setOptions:_=>{a={...a,..._},_.getStorage&&(h=_.getStorage())},clearStorage:()=>{h?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>S(),hasHydrated:()=>l,onHydrate:_=>(c.add(_),()=>{c.delete(_)}),onFinishHydration:_=>(d.add(_),()=>{d.delete(_)})},S(),w||x},zT=(r,e)=>(t,n,o)=>{let a={storage:Hp(()=>localStorage),partialize:S=>S,version:0,merge:(S,_)=>({..._,...S}),...e},l=!1;const c=new Set,d=new Set;let h=a.storage;if(!h)return r((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...S)},n,o);const m=()=>{const S=a.partialize({...n()});return h.setItem(a.name,{state:S,version:a.version})},g=o.setState;o.setState=(S,_)=>{g(S,_),m()};const v=r((...S)=>{t(...S),m()},n,o);o.getInitialState=()=>v;let x;const w=()=>{var S,_;if(!h)return;l=!1,c.forEach(E=>{var N;return E((N=n())!=null?N:v)});const C=((_=a.onRehydrateStorage)==null?void 0:_.call(a,(S=n())!=null?S:v))||void 0;return ol(h.getItem.bind(h))(a.name).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==a.version){if(a.migrate)return[!0,a.migrate(E.state,E.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,E.state];return[!1,void 0]}).then(E=>{var N;const[M,A]=E;if(x=a.merge(A,(N=n())!=null?N:v),t(x,!0),M)return m()}).then(()=>{C?.(x,void 0),x=n(),l=!0,d.forEach(E=>E(x))}).catch(E=>{C?.(void 0,E)})};return o.persist={setOptions:S=>{a={...a,...S},S.storage&&(h=S.storage)},clearStorage:()=>{h?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>l,onHydrate:S=>(c.add(S),()=>{c.delete(S)}),onFinishHydration:S=>(d.add(S),()=>{d.delete(S)})},a.skipHydration||w(),x||v},VT=(r,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((UT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),FT(r,e)):zT(r,e),Wp=VT,BT=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ct(async()=>{const{default:n}=await Promise.resolve().then(()=>Fi);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Gp extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class qT extends Gp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class HT extends Gp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class WT extends Gp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Vf;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Vf||(Vf={}));var GT=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};class KT{constructor(e,{headers:t={},customFetch:n,region:o=Vf.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=BT(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return GT(this,void 0,void 0,function*(){try{const{headers:o,method:a,body:l}=t;let c={},{region:d}=t;d||(d=this.region),d&&d!=="any"&&(c["x-region"]=d);let h;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(c["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(c["Content-Type"]="application/json",h=JSON.stringify(l)));const m=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),o),body:h}).catch(w=>{throw new qT(w)}),g=m.headers.get("x-relay-error");if(g&&g==="true")throw new HT(m);if(!m.ok)throw new WT(m);let v=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return v==="application/json"?x=yield m.json():v==="application/octet-stream"?x=yield m.blob():v==="text/event-stream"?x=m:v==="multipart/form-data"?x=yield m.formData():x=yield m.text(),{data:x,error:null}}catch(o){return{data:null,error:o}}})}}var qt={},ei={},ti={},ri={},ni={},si={},ZT=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Pi=ZT();const JT=Pi.fetch,Yb=Pi.fetch.bind(Pi),Xb=Pi.Headers,QT=Pi.Request,YT=Pi.Response,Fi=Object.freeze(Object.defineProperty({__proto__:null,Headers:Xb,Request:QT,Response:YT,default:Yb,fetch:JT},Symbol.toStringTag,{value:"Module"})),XT=L_(Fi);var Xc={},pv;function ew(){if(pv)return Xc;pv=1,Object.defineProperty(Xc,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Xc.default=r,Xc}var mv;function tw(){if(mv)return si;mv=1;var r=si&&si.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(si,"__esModule",{value:!0});const e=r(XT),t=r(ew());class n{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=Object.assign({},this.headers),this.headers[a]=l,this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var m,g,v;let x=null,w=null,S=null,_=h.status,C=h.statusText;if(h.ok){if(this.method!=="HEAD"){const A=await h.text();A===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?w=A:w=JSON.parse(A))}const N=(m=this.headers.Prefer)===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),M=(g=h.headers.get("content-range"))===null||g===void 0?void 0:g.split("/");N&&M&&M.length>1&&(S=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(x={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,S=null,_=406,C="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const N=await h.text();try{x=JSON.parse(N),Array.isArray(x)&&h.status===404&&(w=[],x=null,_=200,C="OK")}catch{h.status===404&&N===""?(_=204,C="No Content"):x={message:N}}if(x&&this.isMaybeSingle&&(!((v=x?.details)===null||v===void 0)&&v.includes("0 rows"))&&(x=null,_=200,C="OK"),x&&this.shouldThrowOnError)throw new t.default(x)}return{error:x,data:w,count:S,status:_,statusText:C}});return this.shouldThrowOnError||(d=d.catch(h=>{var m,g,v;return{error:{message:`${(m=h?.name)!==null&&m!==void 0?m:"FetchError"}: ${h?.message}`,details:`${(g=h?.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=h?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return si.default=n,si}var gv;function rw(){if(gv)return ni;gv=1;var r=ni&&ni.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ni,"__esModule",{value:!0});const e=r(tw());class t extends e.default{select(o){let a=!1;const l=(o??"*").split("").map(c=>/\s/.test(c)&&!a?"":(c==='"'&&(a=!a),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(o,{ascending:a=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const h=d?`${d}.order`:"order",m=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${m?`${m},`:""}${o}.${a?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${o}`),this}range(o,a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${o}`),this.url.searchParams.set(h,`${a-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:o=!1,verbose:a=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:h="text"}={}){var m;const g=[o?"analyze":null,a?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),v=(m=this.headers.Accept)!==null&&m!==void 0?m:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${v}"; options=${g};`,h==="json"?this:this}rollback(){var o;return((o=this.headers.Prefer)!==null&&o!==void 0?o:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return ni.default=t,ni}var yv;function Kp(){if(yv)return ri;yv=1;var r=ri&&ri.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ri,"__esModule",{value:!0});const e=r(rw());class t extends e.default{eq(o,a){return this.url.searchParams.append(o,`eq.${a}`),this}neq(o,a){return this.url.searchParams.append(o,`neq.${a}`),this}gt(o,a){return this.url.searchParams.append(o,`gt.${a}`),this}gte(o,a){return this.url.searchParams.append(o,`gte.${a}`),this}lt(o,a){return this.url.searchParams.append(o,`lt.${a}`),this}lte(o,a){return this.url.searchParams.append(o,`lte.${a}`),this}like(o,a){return this.url.searchParams.append(o,`like.${a}`),this}likeAllOf(o,a){return this.url.searchParams.append(o,`like(all).{${a.join(",")}}`),this}likeAnyOf(o,a){return this.url.searchParams.append(o,`like(any).{${a.join(",")}}`),this}ilike(o,a){return this.url.searchParams.append(o,`ilike.${a}`),this}ilikeAllOf(o,a){return this.url.searchParams.append(o,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(o,a){return this.url.searchParams.append(o,`ilike(any).{${a.join(",")}}`),this}is(o,a){return this.url.searchParams.append(o,`is.${a}`),this}in(o,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(o,`in.(${l})`),this}contains(o,a){return typeof a=="string"?this.url.searchParams.append(o,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(o,`cs.{${a.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(a)}`),this}containedBy(o,a){return typeof a=="string"?this.url.searchParams.append(o,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(o,`cd.{${a.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(a)}`),this}rangeGt(o,a){return this.url.searchParams.append(o,`sr.${a}`),this}rangeGte(o,a){return this.url.searchParams.append(o,`nxl.${a}`),this}rangeLt(o,a){return this.url.searchParams.append(o,`sl.${a}`),this}rangeLte(o,a){return this.url.searchParams.append(o,`nxr.${a}`),this}rangeAdjacent(o,a){return this.url.searchParams.append(o,`adj.${a}`),this}overlaps(o,a){return typeof a=="string"?this.url.searchParams.append(o,`ov.${a}`):this.url.searchParams.append(o,`ov.{${a.join(",")}}`),this}textSearch(o,a,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(o,`${d}fts${h}.${a}`),this}match(o){return Object.entries(o).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(o,a,l){return this.url.searchParams.append(o,`not.${a}.${l}`),this}or(o,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${o})`),this}filter(o,a,l){return this.url.searchParams.append(o,`${a}.${l}`),this}}return ri.default=t,ri}var vv;function nw(){if(vv)return ti;vv=1;var r=ti&&ti.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ti,"__esModule",{value:!0});const e=r(Kp());class t{constructor(o,{headers:a={},schema:l,fetch:c}){this.url=o,this.headers=a,this.schema=l,this.fetch=c}select(o,{head:a=!1,count:l}={}){const c=a?"HEAD":"GET";let d=!1;const h=(o??"*").split("").map(m=>/\s/.test(m)&&!d?"":(m==='"'&&(d=!d),m)).join("");return this.url.searchParams.set("select",h),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(o,{count:a,defaultToNull:l=!0}={}){const c="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),a&&d.push(`count=${a}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(o)){const h=o.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(h.length>0){const m=[...new Set(h)].map(g=>`"${g}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}upsert(o,{onConflict:a,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){const h="POST",m=[`resolution=${l?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&m.push(this.headers.Prefer),c&&m.push(`count=${c}`),d||m.push("missing=default"),this.headers.Prefer=m.join(","),Array.isArray(o)){const g=o.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(g.length>0){const v=[...new Set(g)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}update(o,{count:a}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}delete({count:o}={}){const a="DELETE",l=[];return o&&l.push(`count=${o}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ti.default=t,ti}var Ta={},Aa={},xv;function eA(){return xv||(xv=1,Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.version=void 0,Aa.version="0.0.0-automated"),Aa}var bv;function tA(){if(bv)return Ta;bv=1,Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.DEFAULT_HEADERS=void 0;const r=eA();return Ta.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},Ta}var wv;function rA(){if(wv)return ei;wv=1;var r=ei&&ei.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ei,"__esModule",{value:!0});const e=r(nw()),t=r(Kp()),n=tA();class o{constructor(l,{headers:c={},schema:d,fetch:h}={}){this.url=l,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=h}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new o(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:h=!1,count:m}={}){let g;const v=new URL(`${this.url}/rpc/${l}`);let x;d||h?(g=d?"HEAD":"GET",Object.entries(c).filter(([S,_])=>_!==void 0).map(([S,_])=>[S,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([S,_])=>{v.searchParams.append(S,_)})):(g="POST",x=c);const w=Object.assign({},this.headers);return m&&(w.Prefer=`count=${m}`),new t.default({method:g,url:v,headers:w,schema:this.schemaName,body:x,fetch:this.fetch,allowEmpty:!1})}}return ei.default=o,ei}var Sv;function nA(){if(Sv)return qt;Sv=1;var r=qt&&qt.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(qt,"__esModule",{value:!0}),qt.PostgrestError=qt.PostgrestBuilder=qt.PostgrestTransformBuilder=qt.PostgrestFilterBuilder=qt.PostgrestQueryBuilder=qt.PostgrestClient=void 0;const e=r(rA());qt.PostgrestClient=e.default;const t=r(nw());qt.PostgrestQueryBuilder=t.default;const n=r(Kp());qt.PostgrestFilterBuilder=n.default;const o=r(rw());qt.PostgrestTransformBuilder=o.default;const a=r(tw());qt.PostgrestBuilder=a.default;const l=r(ew());return qt.PostgrestError=l.default,qt.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:a.default,PostgrestError:l.default},qt}var sA=nA();const oA=Sl(sA),{PostgrestClient:iA,PostgrestQueryBuilder:dD,PostgrestFilterBuilder:hD,PostgrestTransformBuilder:fD,PostgrestBuilder:pD,PostgrestError:mD}=oA,aA="2.11.2",lA={"X-Client-Info":`realtime-js/${aA}`},cA="1.0.0",sw=1e4,uA=1e3;var xi;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(xi||(xi={}));var Er;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Er||(Er={}));var Yr;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Yr||(Yr={}));var Bf;(function(r){r.websocket="websocket"})(Bf||(Bf={}));var mo;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(mo||(mo={}));class dA{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const o=t.getUint8(1),a=t.getUint8(2);let l=this.HEADER_LENGTH+2;const c=n.decode(e.slice(l,l+o));l=l+o;const d=n.decode(e.slice(l,l+a));l=l+a;const h=JSON.parse(n.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:d,payload:h}}}class ow{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gt;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(gt||(gt={}));const _v=(r,e,t={})=>{var n;const o=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((a,l)=>(a[l]=hA(l,r,e,o),a),{})},hA=(r,e,t,n)=>{const o=e.find(c=>c.name===r),a=o?.type,l=t[r];return a&&!n.includes(a)?iw(a,l):qf(l)},iw=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return gA(e,t)}switch(r){case gt.bool:return fA(e);case gt.float4:case gt.float8:case gt.int2:case gt.int4:case gt.int8:case gt.numeric:case gt.oid:return pA(e);case gt.json:case gt.jsonb:return mA(e);case gt.timestamp:return yA(e);case gt.abstime:case gt.date:case gt.daterange:case gt.int4range:case gt.int8range:case gt.money:case gt.reltime:case gt.text:case gt.time:case gt.timestamptz:case gt.timetz:case gt.tsrange:case gt.tstzrange:return qf(e);default:return qf(e)}},qf=r=>r,fA=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},pA=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},mA=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},gA=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let a;const l=r.slice(1,t);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(c=>iw(e,c))}return r},yA=r=>typeof r=="string"?r.replace(" ","T"):r,aw=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class of{constructor(e,t,n={},o=sw){this.channel=e,this.event=t,this.payload=n,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var kv;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(kv||(kv={}));class Ga{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},o=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ga.syncState(this.state,o,a,l),this.pendingDiffs.forEach(d=>{this.state=Ga.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},o=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Ga.syncDiff(this.state,o,a,l),c())}),this.onJoin((o,a,l)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:a,newPresences:l})}),this.onLeave((o,a,l)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,o){const a=this.cloneDeep(e),l=this.transformState(t),c={},d={};return this.map(a,(h,m)=>{l[h]||(d[h]=m)}),this.map(l,(h,m)=>{const g=a[h];if(g){const v=m.map(_=>_.presence_ref),x=g.map(_=>_.presence_ref),w=m.filter(_=>x.indexOf(_.presence_ref)<0),S=g.filter(_=>v.indexOf(_.presence_ref)<0);w.length>0&&(c[h]=w),S.length>0&&(d[h]=S)}else c[h]=m}),this.syncDiff(a,{joins:c,leaves:d},n,o)}static syncDiff(e,t,n,o){const{joins:a,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),o||(o=()=>{}),this.map(a,(c,d)=>{var h;const m=(h=e[c])!==null&&h!==void 0?h:[];if(e[c]=this.cloneDeep(d),m.length>0){const g=e[c].map(x=>x.presence_ref),v=m.filter(x=>g.indexOf(x.presence_ref)<0);e[c].unshift(...v)}n(c,m,d)}),this.map(l,(c,d)=>{let h=e[c];if(!h)return;const m=d.map(g=>g.presence_ref);h=h.filter(g=>m.indexOf(g.presence_ref)<0),e[c]=h,o(c,h,d),h.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const o=e[n];return"metas"in o?t[n]=o.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[n]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Cv;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Cv||(Cv={}));var Ev;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Ev||(Ev={}));var qn;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(qn||(qn={}));class Zp{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Er.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new of(this,Yr.join,this.params,this.timeout),this.rejoinTimer=new ow(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Er.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Er.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Er.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Er.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yr.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new Ga(this),this.broadcastEndpointURL=aw(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,o;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:l,private:c}}=this.params;this._onError(m=>e?.(qn.CHANNEL_ERROR,m)),this._onClose(()=>e?.(qn.CLOSED));const d={},h={broadcast:a,presence:l,postgres_changes:(o=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&o!==void 0?o:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var g;if(this.socket.setAuth(),m===void 0){e?.(qn.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,x=(g=v?.length)!==null&&g!==void 0?g:0,w=[];for(let S=0;S<x;S++){const _=v[S],{filter:{event:C,schema:E,table:N,filter:M}}=_,A=m&&m[S];if(A&&A.event===C&&A.schema===E&&A.table===N&&A.filter===M)w.push(Object.assign(Object.assign({},_),{id:A.id}));else{this.unsubscribe(),e?.(qn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(qn.SUBSCRIBED);return}}).receive("error",m=>{e?.(qn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e?.(qn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,o;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((o=h.body)===null||o===void 0?void 0:o.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,c,d;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),h.receive("ok",()=>a("ok")),h.receive("error",()=>a("error")),h.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Er.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const o=new of(this,Yr.leave,{},e);o.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),o.send(),this._canPush()||o.trigger("ok",{})})}async _fetchWithTimeout(e,t,n){const o=new AbortController,a=setTimeout(()=>o.abort(),n),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(a),l}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new of(this,e,t,n);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var o,a;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:h,join:m}=Yr;if(n&&[c,d,h,m].indexOf(l)>=0&&n!==this._joinRef())return;let v=this._onMessage(l,t,n);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(x=>{var w,S,_;return((w=x.filter)===null||w===void 0?void 0:w.event)==="*"||((_=(S=x.filter)===null||S===void 0?void 0:S.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===l}).map(x=>x.callback(v,n)):(a=this.bindings[l])===null||a===void 0||a.filter(x=>{var w,S,_,C,E,N;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in x){const M=x.id,A=(w=x.filter)===null||w===void 0?void 0:w.event;return M&&((S=t.ids)===null||S===void 0?void 0:S.includes(M))&&(A==="*"||A?.toLocaleLowerCase()===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const M=(E=(C=x?.filter)===null||C===void 0?void 0:C.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return M==="*"||M===((N=t?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===l}).map(x=>{if(typeof v=="object"&&"ids"in v){const w=v.data,{schema:S,table:_,commit_timestamp:C,type:E,errors:N}=w;v=Object.assign(Object.assign({},{schema:S,table:_,commit_timestamp:C,eventType:E,new:{},old:{},errors:N}),this._getPayloadRecords(w))}x.callback(v,n)})}_isClosed(){return this.state===Er.closed}_isJoined(){return this.state===Er.joined}_isJoining(){return this.state===Er.joining}_isLeaving(){return this.state===Er.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const o=e.toLocaleLowerCase(),a={type:o,filter:t,callback:n};return this.bindings[o]?this.bindings[o].push(a):this.bindings[o]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(o=>{var a;return!(((a=o.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Zp.isEqual(o.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yr.close,{},e)}_onError(e){this._on(Yr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Er.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=_v(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=_v(e.columns,e.old_record)),t}}const vA=()=>{},xA=typeof WebSocket<"u",bA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wA{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=lA,this.params={},this.timeout=sw,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=vA,this.conn=null,this.sendBuffer=[],this.serializer=new dA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>ct(async()=>{const{default:d}=await Promise.resolve().then(()=>Fi);return{default:d}},void 0).then(({default:d})=>d(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${Bf.websocket}`,this.httpEndpoint=aw(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const o=(n=t?.params)===null||n===void 0?void 0:n.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t?.encode?t.encode:(a,l)=>l(JSON.stringify(a)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ow(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}this.accessToken=t?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(xA){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new SA(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ct(async()=>{const{default:e}=await import("./browser-DC0AiRvP.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cA}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case xi.connecting:return mo.Connecting;case xi.open:return mo.Open;case xi.closing:return mo.Closing;default:return mo.Closed}}isConnected(){return this.connectionState()===mo.Open}channel(e,t={config:{}}){const n=new Zp(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:o,ref:a}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${t} ${n} (${a})`,o),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(o=>{t&&o.updateJoinPayload({access_token:t}),o.joinedOnce&&o._isJoined()&&o._push(Yr.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(uA,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:o,payload:a,ref:l}=t;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${n} ${o} ${l&&"("+l+")"||""}`,a),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(o,a,l)),this.stateChangeCallbacks.message.forEach(c=>c(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${n}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([bA],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class SA{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=xi.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class Jp extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ht(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class _A extends Jp{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Hf extends Jp{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var kA=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};const lw=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ct(async()=>{const{default:n}=await Promise.resolve().then(()=>Fi);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},CA=()=>kA(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ct(()=>Promise.resolve().then(()=>Fi),void 0)).Response:Response}),Wf=r=>{if(Array.isArray(r))return r.map(t=>Wf(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const o=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[o]=Wf(n)}),e};var ko=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};const af=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),EA=(r,e,t)=>ko(void 0,void 0,void 0,function*(){const n=yield CA();r instanceof n&&!t?.noResolveJson?r.json().then(o=>{e(new _A(af(o),r.status||500))}).catch(o=>{e(new Hf(af(o),o))}):e(new Hf(af(r),r))}),PA=(r,e,t,n)=>{const o={method:r,headers:e?.headers||{}};return r==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n&&(o.body=JSON.stringify(n)),Object.assign(Object.assign({},o),t))};function Tl(r,e,t,n,o,a){return ko(this,void 0,void 0,function*(){return new Promise((l,c)=>{r(t,PA(e,n,o,a)).then(d=>{if(!d.ok)throw d;return n?.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>EA(d,c,n))})})}function Su(r,e,t,n){return ko(this,void 0,void 0,function*(){return Tl(r,"GET",e,t,n)})}function As(r,e,t,n,o){return ko(this,void 0,void 0,function*(){return Tl(r,"POST",e,n,o,t)})}function TA(r,e,t,n,o){return ko(this,void 0,void 0,function*(){return Tl(r,"PUT",e,n,o,t)})}function AA(r,e,t,n){return ko(this,void 0,void 0,function*(){return Tl(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function cw(r,e,t,n,o){return ko(this,void 0,void 0,function*(){return Tl(r,"DELETE",e,n,o,t)})}var vr=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};const jA={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class RA{constructor(e,t={},n,o){this.url=e,this.headers=t,this.bucketId=n,this.fetch=lw(o)}uploadOrUpdate(e,t,n,o){return vr(this,void 0,void 0,function*(){try{let a;const l=Object.assign(Object.assign({},Pv),o);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=n,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),o?.headers&&(c=Object.assign(Object.assign({},c),o.headers));const h=this._removeEmptyFolders(t),m=this._getFinalPath(h),g=yield this.fetch(`${this.url}/object/${m}`,Object.assign({method:e,body:a,headers:c},l?.duplex?{duplex:l.duplex}:{})),v=yield g.json();return g.ok?{data:{path:h,id:v.Id,fullPath:v.Key},error:null}:{data:null,error:v}}catch(a){if(Ht(a))return{data:null,error:a};throw a}})}upload(e,t,n){return vr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,o){return vr(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),l=this._getFinalPath(a),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",t);try{let d;const h=Object.assign({upsert:Pv.upsert},o),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",h.cacheControl)):(d=n,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType);const g=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:m}),v=yield g.json();return g.ok?{data:{path:a,fullPath:v.Key},error:null}:{data:null,error:v}}catch(d){if(Ht(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,t){return vr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const o=Object.assign({},this.headers);t?.upsert&&(o["x-upsert"]="true");const a=yield As(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:o}),l=new URL(this.url+a.url),c=l.searchParams.get("token");if(!c)throw new Jp("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(n){if(Ht(n))return{data:null,error:n};throw n}})}update(e,t,n){return vr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return vr(this,void 0,void 0,function*(){try{return{data:yield As(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(Ht(o))return{data:null,error:o};throw o}})}copy(e,t,n){return vr(this,void 0,void 0,function*(){try{return{data:{path:(yield As(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(Ht(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,n){return vr(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),a=yield As(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(o){if(Ht(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,n){return vr(this,void 0,void 0,function*(){try{const o=yield As(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:o.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${a}`):null})),error:null}}catch(o){if(Ht(o))return{data:null,error:o};throw o}})}download(e,t){return vr(this,void 0,void 0,function*(){const o=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),l=a?`?${a}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield Su(this.fetch,`${this.url}/${o}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Ht(c))return{data:null,error:c};throw c}})}info(e){return vr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield Su(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Wf(n),error:null}}catch(n){if(Ht(n))return{data:null,error:n};throw n}})}exists(e){return vr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield AA(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Ht(n)&&n instanceof Hf){const o=n.originalError;if([400,404].includes(o?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),o=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&o.push(a);const c=typeof t?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(t?.transform||{});d!==""&&o.push(d);let h=o.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${n}${h}`)}}}remove(e){return vr(this,void 0,void 0,function*(){try{return{data:yield cw(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ht(t))return{data:null,error:t};throw t}})}list(e,t,n){return vr(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},jA),t),{prefix:e||""});return{data:yield As(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(Ht(o))return{data:null,error:o};throw o}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const NA="2.7.1",IA={"X-Client-Info":`storage-js/${NA}`};var oi=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};class DA{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},IA),t),this.fetch=lw(n)}listBuckets(){return oi(this,void 0,void 0,function*(){try{return{data:yield Su(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ht(e))return{data:null,error:e};throw e}})}getBucket(e){return oi(this,void 0,void 0,function*(){try{return{data:yield Su(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ht(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return oi(this,void 0,void 0,function*(){try{return{data:yield As(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ht(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return oi(this,void 0,void 0,function*(){try{return{data:yield TA(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Ht(n))return{data:null,error:n};throw n}})}emptyBucket(e){return oi(this,void 0,void 0,function*(){try{return{data:yield As(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ht(t))return{data:null,error:t};throw t}})}deleteBucket(e){return oi(this,void 0,void 0,function*(){try{return{data:yield cw(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ht(t))return{data:null,error:t};throw t}})}}class LA extends DA{constructor(e,t={},n){super(e,t,n)}from(e){return new RA(this.url,this.headers,e,this.fetch)}}const OA="2.49.8";let Ua="";typeof Deno<"u"?Ua="deno":typeof document<"u"?Ua="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ua="react-native":Ua="node";const MA={"X-Client-Info":`supabase-js-${Ua}/${OA}`},$A={headers:MA},UA={schema:"public"},FA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},zA={};var VA=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};const BA=r=>{let e;return r?e=r:typeof fetch>"u"?e=Yb:e=fetch,(...t)=>e(...t)},qA=()=>typeof Headers>"u"?Xb:Headers,HA=(r,e,t)=>{const n=BA(t),o=qA();return(a,l)=>VA(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:r;let h=new o(l?.headers);return h.has("apikey")||h.set("apikey",r),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),n(a,Object.assign(Object.assign({},l),{headers:h}))})};var WA=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};function GA(r){return r.endsWith("/")?r:r+"/"}function KA(r,e){var t,n;const{db:o,auth:a,realtime:l,global:c}=r,{db:d,auth:h,realtime:m,global:g}=e,v={db:Object.assign(Object.assign({},d),o),auth:Object.assign(Object.assign({},h),a),realtime:Object.assign(Object.assign({},m),l),global:Object.assign(Object.assign(Object.assign({},g),c),{headers:Object.assign(Object.assign({},(t=g?.headers)!==null&&t!==void 0?t:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>WA(this,void 0,void 0,function*(){return""})};return r.accessToken?v.accessToken=r.accessToken:delete v.accessToken,v}const uw="2.69.1",ci=30*1e3,Gf=3,lf=Gf*ci,ZA="http://localhost:9999",JA="supabase.auth.token",QA={"X-Client-Info":`gotrue-js/${uw}`},Kf="X-Supabase-Api-Version",dw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},YA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,XA=6e5;class Qp extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Xe(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class ej extends Qp{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function tj(r){return Xe(r)&&r.name==="AuthApiError"}class hw extends Qp{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class qs extends Qp{constructor(e,t,n,o){super(e,n,o),this.name=t,this.status=n}}class Es extends qs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rj(r){return Xe(r)&&r.name==="AuthSessionMissingError"}class cf extends qs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class eu extends qs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class tu extends qs{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function nj(r){return Xe(r)&&r.name==="AuthImplicitGrantRedirectError"}class Tv extends qs{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zf extends qs{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function uf(r){return Xe(r)&&r.name==="AuthRetryableFetchError"}class Av extends qs{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Ka extends qs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const jv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Rv=` 	
\r=`.split(""),sj=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Rv.length;e+=1)r[Rv[e].charCodeAt(0)]=-2;for(let e=0;e<jv.length;e+=1)r[jv[e].charCodeAt(0)]=e;return r})();function fw(r,e,t){const n=sj[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Nv(r){const e=[],t=l=>{e.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},a=l=>{aj(l,n,t)};for(let l=0;l<r.length;l+=1)fw(r.charCodeAt(l),o,a);return e.join("")}function oj(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function ij(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const o=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|o)+65536,t+=1}oj(n,e)}}function aj(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if((r>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function lj(r){const e=[],t={queue:0,queuedBits:0},n=o=>{e.push(o)};for(let o=0;o<r.length;o+=1)fw(r.charCodeAt(o),t,n);return new Uint8Array(e)}function cj(r){const e=[];return ij(r,t=>e.push(t)),new Uint8Array(e)}function uj(r){return Math.round(Date.now()/1e3)+r}function dj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const pn=()=>typeof window<"u"&&typeof document<"u",ao={tested:!1,writable:!1},Za=()=>{if(!pn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ao.tested)return ao.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),ao.tested=!0,ao.writable=!0}catch{ao.tested=!0,ao.writable=!1}return ao.writable};function hj(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,a)=>{e[a]=o})}catch{}return t.searchParams.forEach((n,o)=>{e[o]=n}),e}const pw=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ct(async()=>{const{default:n}=await Promise.resolve().then(()=>Fi);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},fj=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",mw=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ru=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},nu=async(r,e)=>{await r.removeItem(e)};class Gu{constructor(){this.promise=new Gu.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Gu.promiseConstructor=Promise;function df(r){const e=r.split(".");if(e.length!==3)throw new Ka("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!YA.test(e[n]))throw new Ka("JWT not in base64url format");return{header:JSON.parse(Nv(e[0])),payload:JSON.parse(Nv(e[1])),signature:lj(e[2]),raw:{header:e[0],payload:e[1]}}}async function pj(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function mj(r,e){return new Promise((n,o)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await r(a);if(!e(a,null,l)){n(l);return}}catch(l){if(!e(a,l)){o(l);return}}})()})}function gj(r){return("0"+r.toString(16)).substr(-2)}function yj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let o="";for(let a=0;a<56;a++)o+=t.charAt(Math.floor(Math.random()*n));return o}return crypto.getRandomValues(e),Array.from(e,gj).join("")}async function vj(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(n);return Array.from(o).map(a=>String.fromCharCode(a)).join("")}async function xj(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await vj(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ii(r,e,t=!1){const n=yj();let o=n;t&&(o+="/PASSWORD_RECOVERY"),await mw(r,`${e}-code-verifier`,o);const a=await xj(n);return[a,n===a?"plain":"s256"]}const bj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wj(r){const e=r.headers.get(Kf);if(!e||!e.match(bj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Sj(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function _j(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var kj=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(t[n[o]]=r[n[o]]);return t};const fo=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Cj=[502,503,504];async function Iv(r){var e;if(!fj(r))throw new Zf(fo(r),0);if(Cj.includes(r.status))throw new Zf(fo(r),r.status);let t;try{t=await r.json()}catch(a){throw new hw(fo(a),a)}let n;const o=wj(r);if(o&&o.getTime()>=dw["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Av(fo(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Es}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new Av(fo(t),r.status,t.weak_password.reasons);throw new ej(fo(t),r.status||500,n)}const Ej=(r,e,t,n)=>{const o={method:r,headers:e?.headers||{}};return r==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(n),Object.assign(Object.assign({},o),t))};async function ot(r,e,t,n){var o;const a=Object.assign({},n?.headers);a[Kf]||(a[Kf]=dw["2024-01-01"].name),n?.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const l=(o=n?.query)!==null&&o!==void 0?o:{};n?.redirectTo&&(l.redirect_to=n.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await Pj(r,e,t+c,{headers:a,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(d):{data:Object.assign({},d),error:null}}async function Pj(r,e,t,n,o,a){const l=Ej(e,n,o,a);let c;try{c=await r(t,Object.assign({},l))}catch(d){throw console.error(d),new Zf(fo(d),0)}if(c.ok||await Iv(c),n?.noResolveJson)return c;try{return await c.json()}catch(d){await Iv(d)}}function Ps(r){var e;let t=null;Rj(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=uj(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function Dv(r){const e=Ps(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function js(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Tj(r){return{data:r,error:null}}function Aj(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:o,verification_type:a}=r,l=kj(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:o,verification_type:a},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function jj(r){return r}function Rj(r){return r.access_token&&r.refresh_token&&r.expires_in}var Nj=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(t[n[o]]=r[n[o]]);return t};class Ij{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=pw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ot(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await ot(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:js})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Nj(e,["options"]),o=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(o.new_email=n?.newEmail,delete o.newEmail),await ot(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Aj,redirectTo:t?.redirectTo})}catch(t){if(Xe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ot(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:js})}catch(t){if(Xe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,o,a,l,c,d;try{const h={nextPage:null,lastPage:0,total:0},m=await ot(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(a=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&a!==void 0?a:""},xform:jj});if(m.error)throw m.error;const g=await m.json(),v=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(w=>{const S=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);h[`${_}Page`]=S}),h.total=parseInt(v)),{data:Object.assign(Object.assign({},g),h),error:null}}catch(h){if(Xe(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){try{return await ot(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:js})}catch(t){if(Xe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await ot(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:js})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){try{return await ot(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:js})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await ot(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:n}}catch(t){if(Xe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await ot(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Xe(t))return{data:null,error:t};throw t}}}const Dj={getItem:r=>Za()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Za()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Za()&&globalThis.localStorage.removeItem(r)}};function Lv(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Lj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ai={debug:!!(globalThis&&Za()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Oj extends gw{}async function Mj(r,e,t){ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),ai.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async o=>{if(o){ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,o.name);try{return await t()}finally{ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,o.name)}}else{if(e===0)throw ai.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Oj(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(ai.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Lj();const $j={url:ZA,storageKey:JA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ov(r,e,t){return await t()}class il{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=il.nextInstanceID,il.nextInstanceID+=1,this.instanceID>0&&pn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},$j),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Ij({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=pw(o.fetch),this.lock=o.lock||Ov,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:pn()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Mj:this.lock=Ov,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:Za()?this.storage=Dj:(this.memoryStorage={},this.storage=Lv(this.memoryStorage)):(this.memoryStorage={},this.storage=Lv(this.memoryStorage)),pn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${uw}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=hj(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),pn()&&this.detectSessionInUrl&&n!=="none"){const{data:o,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),nj(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:l,redirectType:c}=o;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Xe(t)?{error:t}:{error:new hw("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,o;try{const a=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Ps}),{data:l,error:c}=a;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(a){if(Xe(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,n,o;try{let a;if("email"in e){const{email:m,password:g,options:v}=e;let x=null,w=null;this.flowType==="pkce"&&([x,w]=await ii(this.storage,this.storageKey)),a=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:m,password:g,data:(t=v?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:x,code_challenge_method:w},xform:Ps})}else if("phone"in e){const{phone:m,password:g,options:v}=e;a=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:g,data:(n=v?.data)!==null&&n!==void 0?n:{},channel:(o=v?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Ps})}else throw new eu("You must provide either an email or phone number and a password");const{data:l,error:c}=a;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(a){if(Xe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:l,options:c}=e;t=await ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Dv})}else if("phone"in e){const{phone:a,password:l,options:c}=e;t=await ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Dv})}else throw new eu("You must provide either an email or phone number and a password");const{data:n,error:o}=t;return o?{data:{user:null,session:null},error:o}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new cf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:o})}catch(t){if(Xe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,o,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await ru(this.storage,`${this.storageKey}-code-verifier`),[n,o]=(t??"").split("/");try{const{data:a,error:l}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ps});if(await nu(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new cf}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:o??null}),error:l})}catch(a){if(Xe(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:o,access_token:a,nonce:l}=e,c=await ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:o,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ps}),{data:d,error:h}=c;return h?{data:{user:null,session:null},error:h}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new cf}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:h})}catch(t){if(Xe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,o,a,l;try{if("email"in e){const{email:c,options:d}=e;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await ii(this.storage,this.storageKey));const{error:g}=await ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=d?.data)!==null&&t!==void 0?t:{},create_user:(n=d?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in e){const{phone:c,options:d}=e,{data:h,error:m}=await ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(o=d?.data)!==null&&o!==void 0?o:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:h?.message_id},error:m}}throw new eu("You must provide either an email or phone number.")}catch(c){if(Xe(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var t,n;try{let o,a;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:c}=await ot(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:o,xform:Ps});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(o){if(Xe(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,n,o;try{let a=null,l=null;return this.flowType==="pkce"&&([a,l]=await ii(this.storage,this.storageKey)),await ot(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:Tj})}catch(a){if(Xe(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Es;const{error:o}=await ot(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(Xe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:o,options:a}=e,{error:l}=await ot(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:n,type:o,options:a}=e,{data:l,error:c}=await ot(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:o,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:c}}throw new eu("You must provide either an email or phone number and a type")}catch(t){if(Xe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ru(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<lf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,h,m)=>(!l&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,h,m))})}return{data:{session:e},error:null}}const{session:o,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:js}):await this._useSession(async t=>{var n,o,a;const{data:l,error:c}=t;if(c)throw c;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Es}:await ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(o=l.session)===null||o===void 0?void 0:o.access_token)!==null&&a!==void 0?a:void 0,xform:js})})}catch(t){if(Xe(t))return rj(t)&&(await this._removeSession(),await nu(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:o,error:a}=n;if(a)throw a;if(!o.session)throw new Es;const l=o.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await ii(this.storage,this.storageKey));const{data:h,error:m}=await ot(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:js});if(m)throw m;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Xe(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Es;const t=Date.now()/1e3;let n=t,o=!0,a=null;const{payload:l}=df(e.access_token);if(l.exp&&(n=l.exp,o=n<=t),o){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Xe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:l,error:c}=t;if(c)throw c;e=(n=l.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Es;const{session:o,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Xe(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!pn())throw new tu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new tu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Tv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new tu("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Tv("No code detected.");const{data:E,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:o,access_token:a,refresh_token:l,expires_in:c,expires_at:d,token_type:h}=e;if(!a||!c||!l||!h)throw new tu("No session defined in URL");const m=Math.round(Date.now()/1e3),g=parseInt(c);let v=m+g;d&&(v=parseInt(d));const x=v-m;x*1e3<=ci&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${g}s`);const w=v-g;m-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,v,m):m-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,v,m);const{data:S,error:_}=await this._getUser(a);if(_)throw _;const C={provider_token:n,provider_refresh_token:o,access_token:a,expires_in:g,expires_at:v,refresh_token:l,token_type:h,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:C,redirectType:e.type},error:null}}catch(n){if(Xe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ru(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:o,error:a}=t;if(a)return{error:a};const l=(n=o.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(tj(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await nu(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=dj(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,o;try{const{data:{session:a},error:l}=t;if(l)throw l;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let n=null,o=null;this.flowType==="pkce"&&([n,o]=await ii(this.storage,this.storageKey,!0));try{return await ot(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Xe(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Xe(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:o}=await this._useSession(async a=>{var l,c,d,h,m;const{data:g,error:v}=a;if(v)throw v;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await ot(this.fetch,"GET",x,{headers:this.headers,jwt:(m=(h=g.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(o)throw o;return pn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(Xe(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,o;const{data:a,error:l}=t;if(l)throw l;return await ot(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if(Xe(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await mj(async o=>(o>0&&await pj(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await ot(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ps})),(o,a)=>{const l=200*Math.pow(2,o);return a&&uf(a)&&Date.now()+l-n<ci})}catch(n){if(this._debug(t,"error",n),Xe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),pn()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ru(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const o=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<lf;if(this._debug(t,`session has${o?"":" not"} expired with margin of ${lf}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),uf(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Es;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Gu;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new Es;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={session:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(o,"error",a),Xe(a)){const l={session:null,error:a};return uf(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,n=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await mw(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await nu(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ci);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((n.expires_at*1e3-e)/ci);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${ci}ms, refresh threshold is ${Gf} ticks`),o<=Gf&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof gw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const o=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,l]=await ii(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});o.push(c.toString())}if(n?.queryParams){const a=new URLSearchParams(n.queryParams);o.push(a.toString())}return n?.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:o,error:a}=t;return a?{data:null,error:a}:await ot(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Xe(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,o;const{data:a,error:l}=t;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:h}=await ot(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(e.factorType==="totp"&&(!((o=d?.totp)===null||o===void 0)&&o.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(Xe(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:o,error:a}=t;if(a)return{data:null,error:a};const{data:l,error:c}=await ot(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(t){if(Xe(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:o,error:a}=t;return a?{data:null,error:a}:await ot(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Xe(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=e?.factors||[],o=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),a=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:o,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:o},error:a}=e;if(a)return{data:null,error:a};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=df(o.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((n=(t=o.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const m=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(l=>l.kid===e);if(n||(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+XA>Date.now()))return n;const{data:o,error:a}=await ot(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!o.keys||o.keys.length===0)throw new Ka("JWKS is empty");if(this.jwks=o,this.jwks_cached_at=Date.now(),n=o.keys.find(l=>l.kid===e),!n)throw new Ka("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:x,error:w}=await this.getSession();if(w||!x.session)return{data:null,error:w};n=x.session.access_token}const{header:o,payload:a,signature:l,raw:{header:c,payload:d}}=df(n);if(Sj(a.exp),!o.kid||o.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:a,header:o,signature:l},error:null}}const h=_j(o.alg),m=await this.fetchJwk(o.kid,t),g=await crypto.subtle.importKey("jwk",m,h,!0,["verify"]);if(!await crypto.subtle.verify(h,g,l,cj(`${c}.${d}`)))throw new Ka("Invalid JWT signature");return{data:{claims:a,header:o,signature:l},error:null}}catch(n){if(Xe(n))return{data:null,error:n};throw n}}}il.nextInstanceID=0;const Uj=il;class Fj extends Uj{constructor(e){super(e)}}var zj=function(r,e,t,n){function o(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function c(m){try{h(n.next(m))}catch(g){l(g)}}function d(m){try{h(n.throw(m))}catch(g){l(g)}}function h(m){m.done?a(m.value):o(m.value).then(c,d)}h((n=n.apply(r,e||[])).next())})};class Vj{constructor(e,t,n){var o,a,l;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const c=GA(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:UA,realtime:zA,auth:Object.assign(Object.assign({},FA),{storageKey:h}),global:$A},g=KA(n??{},m);this.storageKey=(o=g.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(a=g.global.headers)!==null&&a!==void 0?a:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=g.auth)!==null&&l!==void 0?l:{},this.headers,g.global.fetch),this.fetch=HA(t,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new iA(new URL("rest/v1",d).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),g.accessToken||this._listenForAuthEvents()}get functions(){return new KT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new LA(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return zj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:o,storageKey:a,flowType:l,lock:c,debug:d},h,m){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Fj({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),h),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:o,flowType:l,lock:c,debug:d,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new wA(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Bj=(r,e,t)=>new Vj(r,e,t),qj="https://akmicemcgohflolembbb.supabase.co",Hj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFrbWljZW1jZ29oZmxvbGVtYmJiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyMzQ3MDMsImV4cCI6MjA2MTgxMDcwM30.CsxmVgBJDY0OOKEcLmuR3_42JDoQcEY9-gFKBmgpJp4",Oe=Bj(qj,Hj,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1,storage:window?.localStorage,storageKey:"supabase.auth.token.delivery-app",flowType:"pkce",debug:!1},realtime:{params:{eventsPerSecond:2}}}),Ts=Object.freeze(Object.defineProperty({__proto__:null,supabase:Oe},Symbol.toStringTag,{value:"Module"}));class su{static async signIn(e,t){try{const{data:n,error:o}=await Oe.auth.signInWithPassword({email:e,password:t});if(o||!n.user)return{data:null,error:o||new Error("Échec de connexion")};const{role:a,profile:l,error:c}=await this.getUserRole(n.user.id);if(c)return{data:null,error:c};if(a!=="driver"){await Oe.auth.signOut();let d="Compte non reconnu. Cette application est réservée aux livreurs.";return a==="laboratory"?d="Cette application est réservée aux livreurs. Veuillez utiliser l'interface laboratoire.":a==="admin"&&(d="Cette application est réservée aux livreurs. Veuillez utiliser l'interface administrateur."),{data:null,error:new Error(d)}}return{data:{user:n.user,role:a,profile:l},error:null}}catch(n){return{data:null,error:n}}}static async signOut(){const{error:e}=await Oe.auth.signOut();return{error:e}}static async getCurrentSession(){try{const{data:e,error:t}=await Oe.auth.getSession();if(t||!e.session?.user)return{data:null,error:t||new Error("Aucune session active")};const{role:n,profile:o,error:a}=await this.getUserRole(e.session.user.id);return a?{data:null,error:a}:n!=="driver"?(await Oe.auth.signOut(),{data:null,error:new Error("Accès refusé : cette application est réservée aux livreurs")}):{data:{user:e.session.user,role:n,profile:o},error:null}}catch(e){return{data:null,error:e}}}static async getUserRole(e){try{const{data:t,error:n}=await Oe.from("drivers").select("id, full_name, email").eq("user_id",e).single();if(!n&&t)return{role:"driver",profile:{id:t.id,full_name:t.full_name,email:t.email},error:null};const{data:o,error:a}=await Oe.from("laboratories").select("id, name, email").eq("user_id",e).single();if(!a&&o)return{role:"laboratory",profile:{id:o.id,full_name:o.name,email:o.email},error:null};const{data:l,error:c}=await Oe.from("admins").select("id").eq("user_id",e).single();return!c&&l?{role:"admin",profile:{id:l.id,full_name:"Administrateur",email:""},error:null}:{role:null,error:new Error("Utilisateur non trouvé dans le système")}}catch(t){return{role:null,error:t}}}static onAuthStateChange(e){return Oe.auth.onAuthStateChange(async(t,n)=>{if(t==="SIGNED_OUT"||!n?.user){e(null);return}if(t==="SIGNED_IN"||t==="TOKEN_REFRESHED"){const{data:o,error:a}=await this.getCurrentSession();if(a||!o){e(null);return}e(o)}})}}class Wj{intervalId=null;options;isActive=!1;lastActivity=Date.now();constructor(e={}){this.options={checkInterval:e.checkInterval??15,refreshBeforeExpiry:e.refreshBeforeExpiry??5,debug:e.debug??!1},this.setupActivityListeners()}start(){if(this.isActive){this.log("Service déjà actif");return}this.isActive=!0,this.lastActivity=Date.now(),this.intervalId=setInterval(()=>this.checkAndRefreshSession(),this.options.checkInterval*60*1e3),this.log(`🚀 Service démarré - vérification toutes les ${this.options.checkInterval} minutes`),this.checkAndRefreshSession()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.isActive=!1,this.log("🛑 Service arrêté")}async checkAndRefreshSession(){try{const{data:{session:e},error:t}=await Oe.auth.getSession();if(t){this.log("❌ Erreur lors de la récupération de session:",t.message);return}if(!e){this.log("⚠️ Aucune session active - arrêt du service"),this.stop();return}const n=Math.floor(Date.now()/1e3),o=e.expires_at??0,a=Math.floor((o-n)/60);if(this.log(`⏰ Session expire dans ${a} minutes`),a<=this.options.refreshBeforeExpiry){this.log("🔄 Rafraîchissement de la session...");const{data:l,error:c}=await Oe.auth.refreshSession();c?(this.log("❌ Erreur lors du rafraîchissement:",c.message),(c.message.includes("refresh_token_not_found")||c.message.includes("invalid_token"))&&this.handleSessionExpired()):l.session&&(this.log("✅ Session rafraîchie avec succès"),this.lastActivity=Date.now())}}catch(e){this.log("❌ Erreur lors de la vérification de session:",e)}}handleSessionExpired(){this.log("⚠️ Session expirée - notification utilisateur nécessaire"),window.dispatchEvent(new CustomEvent("session-expired",{detail:{message:"Votre session a expiré. Veuillez vous reconnecter.",timestamp:Date.now()}})),this.stop()}setupActivityListeners(){const e=["mousedown","mousemove","keypress","scroll","touchstart","click"],t=()=>{this.lastActivity=Date.now()};e.forEach(n=>{document.addEventListener(n,t,{passive:!0})}),document.addEventListener("visibilitychange",()=>{document.hidden||(this.lastActivity=Date.now(),this.log("📱 Page redevenue visible - activité mise à jour"))})}getTimeSinceLastActivity(){return Math.floor((Date.now()-this.lastActivity)/1e3/60)}isUserActive(e=30){return this.getTimeSinceLastActivity()<e}async forceRefresh(){try{this.log("🔄 Rafraîchissement forcé de la session...");const{data:e,error:t}=await Oe.auth.refreshSession();return t?(this.log("❌ Erreur lors du rafraîchissement forcé:",t.message),!1):(this.log("✅ Rafraîchissement forcé réussi"),this.lastActivity=Date.now(),!0)}catch(e){return this.log("❌ Erreur lors du rafraîchissement forcé:",e),!1}}log(e,...t){this.options.debug&&console.log(`[SessionKeepAlive] ${e}`,...t)}getStats(){return{isActive:this.isActive,lastActivity:new Date(this.lastActivity),timeSinceLastActivity:this.getTimeSinceLastActivity(),checkInterval:this.options.checkInterval,refreshBeforeExpiry:this.options.refreshBeforeExpiry}}}const lo=new Wj({checkInterval:15,refreshBeforeExpiry:5,debug:!1}),Ti=Wu()(Wp((r,e)=>({user:null,isLoading:!1,error:null,initialized:!1,signIn:async(t,n)=>{r({isLoading:!0,error:null});try{const{data:o,error:a}=await su.signIn(t,n);return a?(r({error:a.message,isLoading:!1}),{success:!1,error:a.message}):o?(r({user:o,isLoading:!1,error:null}),lo.start(),console.log("🚀 Service de maintien de session démarré pour le livreur"),{success:!0}):(r({error:"Échec de connexion",isLoading:!1}),{success:!1,error:"Échec de connexion"})}catch(o){const a=o instanceof Error?o.message:"Erreur inconnue";return r({error:a,isLoading:!1}),{success:!1,error:a}}},signOut:async()=>{r({isLoading:!0});try{lo.stop(),console.log("🛑 Service de maintien de session arrêté"),await e().performOptionalCleanup();const{error:t}=await su.signOut();if(t){r({error:t.message,isLoading:!1});return}r({user:null,isLoading:!1,error:null})}catch{r({error:"Erreur lors de la déconnexion",isLoading:!1})}},performOptionalCleanup:async()=>{try{const{shouldCleanupOnLogout:t,getCleanupLevel:n}=await ct(async()=>{const{shouldCleanupOnLogout:m,getCleanupLevel:g}=await import("./featureFlags-CPRGbfg9.js");return{shouldCleanupOnLogout:m,getCleanupLevel:g}},[]);if(!t()){console.log("🚩 [Auth] Nettoyage désactivé par feature flag");return}const o=n();console.log(`🧹 [Auth] Nettoyage activé - niveau: ${o}`);const{sessionCleanupService:a}=await ct(async()=>{const{sessionCleanupService:m}=await Promise.resolve().then(()=>lD);return{sessionCleanupService:m}},void 0);let l={};switch(o){case"minimal":l={clearMainAppStore:!0,clearLabToursStore:!1,clearLocalForage:!1,clearLocalStorage:!1,clearAuthStorage:!1};break;case"standard":l={clearMainAppStore:!0,clearLabToursStore:!0,clearLocalForage:!1,clearLocalStorage:!1,clearAuthStorage:!1};break;case"full":l={clearMainAppStore:!0,clearLabToursStore:!0,clearLocalForage:!0,clearLocalStorage:!0,clearAuthStorage:!1};break}console.log("🧹 [Auth] Configuration nettoyage:",l);const c=a.cleanupSession(l),d=new Promise((m,g)=>setTimeout(()=>g(new Error("Timeout nettoyage")),5e3)),h=await Promise.race([c,d]);h.success?console.log("✅ [Auth] Nettoyage réussi:",{duration:h.duration,operations:h.operations}):console.warn("⚠️ [Auth] Nettoyage partiel:",h.errors)}catch(t){console.error("❌ [Auth] Erreur nettoyage (non bloquante):",t);try{const{featureFlags:n}=await ct(async()=>{const{featureFlags:o}=await import("./featureFlags-CPRGbfg9.js");return{featureFlags:o}},[]);n.setFlag("cleanupOnLogout",!1),console.warn("🛑 [Auth] Nettoyage auto-désactivé suite à erreur")}catch(n){console.error("❌ [Auth] Impossible de désactiver le flag:",n)}}},clearError:()=>{r({error:null})},initializeAuth:async()=>{if(!e().initialized){r({isLoading:!0});try{const{data:t,error:n}=await su.getCurrentSession();if(n||!t){r({user:null,isLoading:!1,initialized:!0});return}r({user:t,isLoading:!1,initialized:!0}),lo.start(),console.log("🔄 Service de maintien de session démarré pour session existante"),su.onAuthStateChange(o=>{const a=e().user;a&&!o&&(lo.stop(),console.log("🛑 Déconnexion détectée - service arrêté")),!a&&o&&(lo.start(),console.log("🚀 Connexion détectée - service démarré")),r({user:o})}),window.addEventListener("session-expired",o=>{console.warn("⚠️ Session expirée:",o.detail.message),confirm(`⚠️ Votre session a expiré pour des raisons de sécurité.

Cliquez OK pour vous reconnecter automatiquement, ou Annuler pour aller à la page de connexion.`)?e().tryAutoReconnect():e().signOut()})}catch{r({user:null,isLoading:!1,initialized:!0,error:"Erreur d'initialisation"})}}},tryAutoReconnect:async()=>e().user?.profile?.email?(console.log("🔄 Tentative de reconnexion automatique..."),await lo.forceRefresh()?(console.log("✅ Reconnexion automatique réussie"),!0):(console.log("❌ Reconnexion automatique échouée - redirection vers login"),e().signOut(),!1)):(console.warn("⚠️ Impossible de reconnecter - email manquant"),e().signOut(),!1),getSessionStats:()=>lo.getStats()}),{name:"auth-storage",partialize:r=>({user:r.user,initialized:r.initialized})}));function ou(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hf={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var Mv;function Gj(){return Mv||(Mv=1,function(r,e){(function(t){r.exports=t()})(function(){return function t(n,o,a){function l(h,m){if(!o[h]){if(!n[h]){var g=typeof ou=="function"&&ou;if(!m&&g)return g(h,!0);if(c)return c(h,!0);var v=new Error("Cannot find module '"+h+"'");throw v.code="MODULE_NOT_FOUND",v}var x=o[h]={exports:{}};n[h][0].call(x.exports,function(w){var S=n[h][1][w];return l(S||w)},x,x.exports,t,n,o,a)}return o[h].exports}for(var c=typeof ou=="function"&&ou,d=0;d<a.length;d++)l(a[d]);return l}({1:[function(t,n,o){(function(a){var l=a.MutationObserver||a.WebKitMutationObserver,c;if(l){var d=0,h=new l(w),m=a.document.createTextNode("");h.observe(m,{characterData:!0}),c=function(){m.data=d=++d%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var g=new a.MessageChannel;g.port1.onmessage=w,c=function(){g.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?c=function(){var _=a.document.createElement("script");_.onreadystatechange=function(){w(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},a.document.documentElement.appendChild(_)}:c=function(){setTimeout(w,0)};var v,x=[];function w(){v=!0;for(var _,C,E=x.length;E;){for(C=x,x=[],_=-1;++_<E;)C[_]();E=x.length}v=!1}n.exports=S;function S(_){x.push(_)===1&&!v&&c()}}).call(this,typeof Gc<"u"?Gc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,n,o){var a=t(1);function l(){}var c={},d=["REJECTED"],h=["FULFILLED"],m=["PENDING"];n.exports=g;function g(A){if(typeof A!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,A!==l&&S(this,A)}g.prototype.catch=function(A){return this.then(null,A)},g.prototype.then=function(A,K){if(typeof A!="function"&&this.state===h||typeof K!="function"&&this.state===d)return this;var Z=new this.constructor(l);if(this.state!==m){var W=this.state===h?A:K;x(Z,W,this.outcome)}else this.queue.push(new v(Z,A,K));return Z};function v(A,K,Z){this.promise=A,typeof K=="function"&&(this.onFulfilled=K,this.callFulfilled=this.otherCallFulfilled),typeof Z=="function"&&(this.onRejected=Z,this.callRejected=this.otherCallRejected)}v.prototype.callFulfilled=function(A){c.resolve(this.promise,A)},v.prototype.otherCallFulfilled=function(A){x(this.promise,this.onFulfilled,A)},v.prototype.callRejected=function(A){c.reject(this.promise,A)},v.prototype.otherCallRejected=function(A){x(this.promise,this.onRejected,A)};function x(A,K,Z){a(function(){var W;try{W=K(Z)}catch(de){return c.reject(A,de)}W===A?c.reject(A,new TypeError("Cannot resolve promise with itself")):c.resolve(A,W)})}c.resolve=function(A,K){var Z=_(w,K);if(Z.status==="error")return c.reject(A,Z.value);var W=Z.value;if(W)S(A,W);else{A.state=h,A.outcome=K;for(var de=-1,pe=A.queue.length;++de<pe;)A.queue[de].callFulfilled(K)}return A},c.reject=function(A,K){A.state=d,A.outcome=K;for(var Z=-1,W=A.queue.length;++Z<W;)A.queue[Z].callRejected(K);return A};function w(A){var K=A&&A.then;if(A&&(typeof A=="object"||typeof A=="function")&&typeof K=="function")return function(){K.apply(A,arguments)}}function S(A,K){var Z=!1;function W(ee){Z||(Z=!0,c.reject(A,ee))}function de(ee){Z||(Z=!0,c.resolve(A,ee))}function pe(){K(de,W)}var Ee=_(pe);Ee.status==="error"&&W(Ee.value)}function _(A,K){var Z={};try{Z.value=A(K),Z.status="success"}catch(W){Z.status="error",Z.value=W}return Z}g.resolve=C;function C(A){return A instanceof this?A:c.resolve(new this(l),A)}g.reject=E;function E(A){var K=new this(l);return c.reject(K,A)}g.all=N;function N(A){var K=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Z=A.length,W=!1;if(!Z)return this.resolve([]);for(var de=new Array(Z),pe=0,Ee=-1,ee=new this(l);++Ee<Z;)ye(A[Ee],Ee);return ee;function ye(G,Se){K.resolve(G).then(Ce,function(_e){W||(W=!0,c.reject(ee,_e))});function Ce(_e){de[Se]=_e,++pe===Z&&!W&&(W=!0,c.resolve(ee,de))}}}g.race=M;function M(A){var K=this;if(Object.prototype.toString.call(A)!=="[object Array]")return this.reject(new TypeError("must be an array"));var Z=A.length,W=!1;if(!Z)return this.resolve([]);for(var de=-1,pe=new this(l);++de<Z;)Ee(A[de]);return pe;function Ee(ee){K.resolve(ee).then(function(ye){W||(W=!0,c.resolve(pe,ye))},function(ye){W||(W=!0,c.reject(pe,ye))})}}},{1:1}],3:[function(t,n,o){(function(a){typeof a.Promise!="function"&&(a.Promise=t(2))}).call(this,typeof Gc<"u"?Gc:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,n,o){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P};function l(P,D){if(!(P instanceof D))throw new TypeError("Cannot call a class as a function")}function c(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var d=c();function h(){try{if(!d||!d.open)return!1;var P=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),D=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!P||D)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function m(P,D){P=P||[],D=D||{};try{return new Blob(P,D)}catch($){if($.name!=="TypeError")throw $;for(var T=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,F=new T,z=0;z<P.length;z+=1)F.append(P[z]);return F.getBlob(D.type)}}typeof Promise>"u"&&t(3);var g=Promise;function v(P,D){D&&P.then(function(T){D(null,T)},function(T){D(T)})}function x(P,D,T){typeof D=="function"&&P.then(D),typeof T=="function"&&P.catch(T)}function w(P){return typeof P!="string"&&(console.warn(P+" used as a key, but it is not a string."),P=String(P)),P}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var _="local-forage-detect-blob-support",C=void 0,E={},N=Object.prototype.toString,M="readonly",A="readwrite";function K(P){for(var D=P.length,T=new ArrayBuffer(D),F=new Uint8Array(T),z=0;z<D;z++)F[z]=P.charCodeAt(z);return T}function Z(P){return new g(function(D){var T=P.transaction(_,A),F=m([""]);T.objectStore(_).put(F,"key"),T.onabort=function(z){z.preventDefault(),z.stopPropagation(),D(!1)},T.oncomplete=function(){var z=navigator.userAgent.match(/Chrome\/(\d+)/),$=navigator.userAgent.match(/Edge\//);D($||!z||parseInt(z[1],10)>=43)}}).catch(function(){return!1})}function W(P){return typeof C=="boolean"?g.resolve(C):Z(P).then(function(D){return C=D,C})}function de(P){var D=E[P.name],T={};T.promise=new g(function(F,z){T.resolve=F,T.reject=z}),D.deferredOperations.push(T),D.dbReady?D.dbReady=D.dbReady.then(function(){return T.promise}):D.dbReady=T.promise}function pe(P){var D=E[P.name],T=D.deferredOperations.pop();if(T)return T.resolve(),T.promise}function Ee(P,D){var T=E[P.name],F=T.deferredOperations.pop();if(F)return F.reject(D),F.promise}function ee(P,D){return new g(function(T,F){if(E[P.name]=E[P.name]||Q(),P.db)if(D)de(P),P.db.close();else return T(P.db);var z=[P.name];D&&z.push(P.version);var $=d.open.apply(d,z);D&&($.onupgradeneeded=function(Y){var se=$.result;try{se.createObjectStore(P.storeName),Y.oldVersion<=1&&se.createObjectStore(_)}catch(ue){if(ue.name==="ConstraintError")console.warn('The database "'+P.name+'" has been upgraded from version '+Y.oldVersion+" to version "+Y.newVersion+', but the storage "'+P.storeName+'" already exists.');else throw ue}}),$.onerror=function(Y){Y.preventDefault(),F($.error)},$.onsuccess=function(){var Y=$.result;Y.onversionchange=function(se){se.target.close()},T(Y),pe(P)}})}function ye(P){return ee(P,!1)}function G(P){return ee(P,!0)}function Se(P,D){if(!P.db)return!0;var T=!P.db.objectStoreNames.contains(P.storeName),F=P.version<P.db.version,z=P.version>P.db.version;if(F&&(P.version!==D&&console.warn('The database "'+P.name+`" can't be downgraded from version `+P.db.version+" to version "+P.version+"."),P.version=P.db.version),z||T){if(T){var $=P.db.version+1;$>P.version&&(P.version=$)}return!0}return!1}function Ce(P){return new g(function(D,T){var F=new FileReader;F.onerror=T,F.onloadend=function(z){var $=btoa(z.target.result||"");D({__local_forage_encoded_blob:!0,data:$,type:P.type})},F.readAsBinaryString(P)})}function _e(P){var D=K(atob(P.data));return m([D],{type:P.type})}function te(P){return P&&P.__local_forage_encoded_blob}function X(P){var D=this,T=D._initReady().then(function(){var F=E[D._dbInfo.name];if(F&&F.dbReady)return F.dbReady});return x(T,P,P),T}function oe(P){de(P);for(var D=E[P.name],T=D.forages,F=0;F<T.length;F++){var z=T[F];z._dbInfo.db&&(z._dbInfo.db.close(),z._dbInfo.db=null)}return P.db=null,ye(P).then(function($){return P.db=$,Se(P)?G(P):$}).then(function($){P.db=D.db=$;for(var Y=0;Y<T.length;Y++)T[Y]._dbInfo.db=$}).catch(function($){throw Ee(P,$),$})}function L(P,D,T,F){F===void 0&&(F=1);try{var z=P.db.transaction(P.storeName,D);T(null,z)}catch($){if(F>0&&(!P.db||$.name==="InvalidStateError"||$.name==="NotFoundError"))return g.resolve().then(function(){if(!P.db||$.name==="NotFoundError"&&!P.db.objectStoreNames.contains(P.storeName)&&P.version<=P.db.version)return P.db&&(P.version=P.db.version+1),G(P)}).then(function(){return oe(P).then(function(){L(P,D,T,F-1)})}).catch(T);T($)}}function Q(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function De(P){var D=this,T={db:null};if(P)for(var F in P)T[F]=P[F];var z=E[T.name];z||(z=Q(),E[T.name]=z),z.forages.push(D),D._initReady||(D._initReady=D.ready,D.ready=X);var $=[];function Y(){return g.resolve()}for(var se=0;se<z.forages.length;se++){var ue=z.forages[se];ue!==D&&$.push(ue._initReady().catch(Y))}var ce=z.forages.slice(0);return g.all($).then(function(){return T.db=z.db,ye(T)}).then(function(me){return T.db=me,Se(T,D._defaultConfig.version)?G(T):me}).then(function(me){T.db=z.db=me,D._dbInfo=T;for(var Te=0;Te<ce.length;Te++){var Ze=ce[Te];Ze!==D&&(Ze._dbInfo.db=T.db,Ze._dbInfo.version=T.version)}})}function He(P,D){var T=this;P=w(P);var F=new g(function(z,$){T.ready().then(function(){L(T._dbInfo,M,function(Y,se){if(Y)return $(Y);try{var ue=se.objectStore(T._dbInfo.storeName),ce=ue.get(P);ce.onsuccess=function(){var me=ce.result;me===void 0&&(me=null),te(me)&&(me=_e(me)),z(me)},ce.onerror=function(){$(ce.error)}}catch(me){$(me)}})}).catch($)});return v(F,D),F}function rt(P,D){var T=this,F=new g(function(z,$){T.ready().then(function(){L(T._dbInfo,M,function(Y,se){if(Y)return $(Y);try{var ue=se.objectStore(T._dbInfo.storeName),ce=ue.openCursor(),me=1;ce.onsuccess=function(){var Te=ce.result;if(Te){var Ze=Te.value;te(Ze)&&(Ze=_e(Ze));var ut=P(Ze,Te.key,me++);ut!==void 0?z(ut):Te.continue()}else z()},ce.onerror=function(){$(ce.error)}}catch(Te){$(Te)}})}).catch($)});return v(F,D),F}function he(P,D,T){var F=this;P=w(P);var z=new g(function($,Y){var se;F.ready().then(function(){return se=F._dbInfo,N.call(D)==="[object Blob]"?W(se.db).then(function(ue){return ue?D:Ce(D)}):D}).then(function(ue){L(F._dbInfo,A,function(ce,me){if(ce)return Y(ce);try{var Te=me.objectStore(F._dbInfo.storeName);ue===null&&(ue=void 0);var Ze=Te.put(ue,P);me.oncomplete=function(){ue===void 0&&(ue=null),$(ue)},me.onabort=me.onerror=function(){var ut=Ze.error?Ze.error:Ze.transaction.error;Y(ut)}}catch(ut){Y(ut)}})}).catch(Y)});return v(z,T),z}function Ve(P,D){var T=this;P=w(P);var F=new g(function(z,$){T.ready().then(function(){L(T._dbInfo,A,function(Y,se){if(Y)return $(Y);try{var ue=se.objectStore(T._dbInfo.storeName),ce=ue.delete(P);se.oncomplete=function(){z()},se.onerror=function(){$(ce.error)},se.onabort=function(){var me=ce.error?ce.error:ce.transaction.error;$(me)}}catch(me){$(me)}})}).catch($)});return v(F,D),F}function Be(P){var D=this,T=new g(function(F,z){D.ready().then(function(){L(D._dbInfo,A,function($,Y){if($)return z($);try{var se=Y.objectStore(D._dbInfo.storeName),ue=se.clear();Y.oncomplete=function(){F()},Y.onabort=Y.onerror=function(){var ce=ue.error?ue.error:ue.transaction.error;z(ce)}}catch(ce){z(ce)}})}).catch(z)});return v(T,P),T}function Je(P){var D=this,T=new g(function(F,z){D.ready().then(function(){L(D._dbInfo,M,function($,Y){if($)return z($);try{var se=Y.objectStore(D._dbInfo.storeName),ue=se.count();ue.onsuccess=function(){F(ue.result)},ue.onerror=function(){z(ue.error)}}catch(ce){z(ce)}})}).catch(z)});return v(T,P),T}function Nt(P,D){var T=this,F=new g(function(z,$){if(P<0){z(null);return}T.ready().then(function(){L(T._dbInfo,M,function(Y,se){if(Y)return $(Y);try{var ue=se.objectStore(T._dbInfo.storeName),ce=!1,me=ue.openKeyCursor();me.onsuccess=function(){var Te=me.result;if(!Te){z(null);return}P===0||ce?z(Te.key):(ce=!0,Te.advance(P))},me.onerror=function(){$(me.error)}}catch(Te){$(Te)}})}).catch($)});return v(F,D),F}function Rr(P){var D=this,T=new g(function(F,z){D.ready().then(function(){L(D._dbInfo,M,function($,Y){if($)return z($);try{var se=Y.objectStore(D._dbInfo.storeName),ue=se.openKeyCursor(),ce=[];ue.onsuccess=function(){var me=ue.result;if(!me){F(ce);return}ce.push(me.key),me.continue()},ue.onerror=function(){z(ue.error)}}catch(me){z(me)}})}).catch(z)});return v(T,P),T}function sr(P,D){D=S.apply(this,arguments);var T=this.config();P=typeof P!="function"&&P||{},P.name||(P.name=P.name||T.name,P.storeName=P.storeName||T.storeName);var F=this,z;if(!P.name)z=g.reject("Invalid arguments");else{var $=P.name===T.name&&F._dbInfo.db,Y=$?g.resolve(F._dbInfo.db):ye(P).then(function(se){var ue=E[P.name],ce=ue.forages;ue.db=se;for(var me=0;me<ce.length;me++)ce[me]._dbInfo.db=se;return se});P.storeName?z=Y.then(function(se){if(se.objectStoreNames.contains(P.storeName)){var ue=se.version+1;de(P);var ce=E[P.name],me=ce.forages;se.close();for(var Te=0;Te<me.length;Te++){var Ze=me[Te];Ze._dbInfo.db=null,Ze._dbInfo.version=ue}var ut=new g(function(at,Fe){var St=d.open(P.name,ue);St.onerror=function(or){var Nn=St.result;Nn.close(),Fe(or)},St.onupgradeneeded=function(){var or=St.result;or.deleteObjectStore(P.storeName)},St.onsuccess=function(){var or=St.result;or.close(),at(or)}});return ut.then(function(at){ce.db=at;for(var Fe=0;Fe<me.length;Fe++){var St=me[Fe];St._dbInfo.db=at,pe(St._dbInfo)}}).catch(function(at){throw(Ee(P,at)||g.resolve()).catch(function(){}),at})}}):z=Y.then(function(se){de(P);var ue=E[P.name],ce=ue.forages;se.close();for(var me=0;me<ce.length;me++){var Te=ce[me];Te._dbInfo.db=null}var Ze=new g(function(ut,at){var Fe=d.deleteDatabase(P.name);Fe.onerror=function(){var St=Fe.result;St&&St.close(),at(Fe.error)},Fe.onblocked=function(){console.warn('dropInstance blocked for database "'+P.name+'" until all open connections are closed')},Fe.onsuccess=function(){var St=Fe.result;St&&St.close(),ut(St)}});return Ze.then(function(ut){ue.db=ut;for(var at=0;at<ce.length;at++){var Fe=ce[at];pe(Fe._dbInfo)}}).catch(function(ut){throw(Ee(P,ut)||g.resolve()).catch(function(){}),ut})})}return v(z,D),z}var Nr={_driver:"asyncStorage",_initStorage:De,_support:h(),iterate:rt,getItem:He,setItem:he,removeItem:Ve,clear:Be,length:Je,key:Nt,keys:Rr,dropInstance:sr};function ts(){return typeof openDatabase=="function"}var xr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Hs="~~local_forage_type~",kn=/^~~local_forage_type~([^~]+)~/,Cn="__lfsc__:",En=Cn.length,on="arbf",br="blob",I="si08",q="ui08",J="uic8",xe="si16",ge="si32",le="ur16",be="ui32",nt="fl32",ht="fl64",yt=En+on.length,Co=Object.prototype.toString;function Pn(P){var D=P.length*.75,T=P.length,F,z=0,$,Y,se,ue;P[P.length-1]==="="&&(D--,P[P.length-2]==="="&&D--);var ce=new ArrayBuffer(D),me=new Uint8Array(ce);for(F=0;F<T;F+=4)$=xr.indexOf(P[F]),Y=xr.indexOf(P[F+1]),se=xr.indexOf(P[F+2]),ue=xr.indexOf(P[F+3]),me[z++]=$<<2|Y>>4,me[z++]=(Y&15)<<4|se>>2,me[z++]=(se&3)<<6|ue&63;return ce}function an(P){var D=new Uint8Array(P),T="",F;for(F=0;F<D.length;F+=3)T+=xr[D[F]>>2],T+=xr[(D[F]&3)<<4|D[F+1]>>4],T+=xr[(D[F+1]&15)<<2|D[F+2]>>6],T+=xr[D[F+2]&63];return D.length%3===2?T=T.substring(0,T.length-1)+"=":D.length%3===1&&(T=T.substring(0,T.length-2)+"=="),T}function Vi(P,D){var T="";if(P&&(T=Co.call(P)),P&&(T==="[object ArrayBuffer]"||P.buffer&&Co.call(P.buffer)==="[object ArrayBuffer]")){var F,z=Cn;P instanceof ArrayBuffer?(F=P,z+=on):(F=P.buffer,T==="[object Int8Array]"?z+=I:T==="[object Uint8Array]"?z+=q:T==="[object Uint8ClampedArray]"?z+=J:T==="[object Int16Array]"?z+=xe:T==="[object Uint16Array]"?z+=le:T==="[object Int32Array]"?z+=ge:T==="[object Uint32Array]"?z+=be:T==="[object Float32Array]"?z+=nt:T==="[object Float64Array]"?z+=ht:D(new Error("Failed to get type for BinaryArray"))),D(z+an(F))}else if(T==="[object Blob]"){var $=new FileReader;$.onload=function(){var Y=Hs+P.type+"~"+an(this.result);D(Cn+br+Y)},$.readAsArrayBuffer(P)}else try{D(JSON.stringify(P))}catch(Y){console.error("Couldn't convert value into a JSON string: ",P),D(null,Y)}}function rs(P){if(P.substring(0,En)!==Cn)return JSON.parse(P);var D=P.substring(yt),T=P.substring(En,yt),F;if(T===br&&kn.test(D)){var z=D.match(kn);F=z[1],D=D.substring(z[0].length)}var $=Pn(D);switch(T){case on:return $;case br:return m([$],{type:F});case I:return new Int8Array($);case q:return new Uint8Array($);case J:return new Uint8ClampedArray($);case xe:return new Int16Array($);case le:return new Uint16Array($);case ge:return new Int32Array($);case be:return new Uint32Array($);case nt:return new Float32Array($);case ht:return new Float64Array($);default:throw new Error("Unkown type: "+T)}}var Tn={serialize:Vi,deserialize:rs,stringToBuffer:Pn,bufferToString:an};function An(P,D,T,F){P.executeSql("CREATE TABLE IF NOT EXISTS "+D.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],T,F)}function Bi(P){var D=this,T={db:null};if(P)for(var F in P)T[F]=typeof P[F]!="string"?P[F].toString():P[F];var z=new g(function($,Y){try{T.db=openDatabase(T.name,String(T.version),T.description,T.size)}catch(se){return Y(se)}T.db.transaction(function(se){An(se,T,function(){D._dbInfo=T,$()},function(ue,ce){Y(ce)})},Y)});return T.serializer=Tn,z}function Ir(P,D,T,F,z,$){P.executeSql(T,F,z,function(Y,se){se.code===se.SYNTAX_ERR?Y.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[D.storeName],function(ue,ce){ce.rows.length?$(ue,se):An(ue,D,function(){ue.executeSql(T,F,z,$)},$)},$):$(Y,se)},$)}function ns(P,D){var T=this;P=w(P);var F=new g(function(z,$){T.ready().then(function(){var Y=T._dbInfo;Y.db.transaction(function(se){Ir(se,Y,"SELECT * FROM "+Y.storeName+" WHERE key = ? LIMIT 1",[P],function(ue,ce){var me=ce.rows.length?ce.rows.item(0).value:null;me&&(me=Y.serializer.deserialize(me)),z(me)},function(ue,ce){$(ce)})})}).catch($)});return v(F,D),F}function ss(P,D){var T=this,F=new g(function(z,$){T.ready().then(function(){var Y=T._dbInfo;Y.db.transaction(function(se){Ir(se,Y,"SELECT * FROM "+Y.storeName,[],function(ue,ce){for(var me=ce.rows,Te=me.length,Ze=0;Ze<Te;Ze++){var ut=me.item(Ze),at=ut.value;if(at&&(at=Y.serializer.deserialize(at)),at=P(at,ut.key,Ze+1),at!==void 0){z(at);return}}z()},function(ue,ce){$(ce)})})}).catch($)});return v(F,D),F}function qi(P,D,T,F){var z=this;P=w(P);var $=new g(function(Y,se){z.ready().then(function(){D===void 0&&(D=null);var ue=D,ce=z._dbInfo;ce.serializer.serialize(D,function(me,Te){Te?se(Te):ce.db.transaction(function(Ze){Ir(Ze,ce,"INSERT OR REPLACE INTO "+ce.storeName+" (key, value) VALUES (?, ?)",[P,me],function(){Y(ue)},function(ut,at){se(at)})},function(Ze){if(Ze.code===Ze.QUOTA_ERR){if(F>0){Y(qi.apply(z,[P,ue,T,F-1]));return}se(Ze)}})})}).catch(se)});return v($,T),$}function Rl(P,D,T){return qi.apply(this,[P,D,T,1])}function Nl(P,D){var T=this;P=w(P);var F=new g(function(z,$){T.ready().then(function(){var Y=T._dbInfo;Y.db.transaction(function(se){Ir(se,Y,"DELETE FROM "+Y.storeName+" WHERE key = ?",[P],function(){z()},function(ue,ce){$(ce)})})}).catch($)});return v(F,D),F}function Il(P){var D=this,T=new g(function(F,z){D.ready().then(function(){var $=D._dbInfo;$.db.transaction(function(Y){Ir(Y,$,"DELETE FROM "+$.storeName,[],function(){F()},function(se,ue){z(ue)})})}).catch(z)});return v(T,P),T}function Dl(P){var D=this,T=new g(function(F,z){D.ready().then(function(){var $=D._dbInfo;$.db.transaction(function(Y){Ir(Y,$,"SELECT COUNT(key) as c FROM "+$.storeName,[],function(se,ue){var ce=ue.rows.item(0).c;F(ce)},function(se,ue){z(ue)})})}).catch(z)});return v(T,P),T}function Hi(P,D){var T=this,F=new g(function(z,$){T.ready().then(function(){var Y=T._dbInfo;Y.db.transaction(function(se){Ir(se,Y,"SELECT key FROM "+Y.storeName+" WHERE id = ? LIMIT 1",[P+1],function(ue,ce){var me=ce.rows.length?ce.rows.item(0).key:null;z(me)},function(ue,ce){$(ce)})})}).catch($)});return v(F,D),F}function Ll(P){var D=this,T=new g(function(F,z){D.ready().then(function(){var $=D._dbInfo;$.db.transaction(function(Y){Ir(Y,$,"SELECT key FROM "+$.storeName,[],function(se,ue){for(var ce=[],me=0;me<ue.rows.length;me++)ce.push(ue.rows.item(me).key);F(ce)},function(se,ue){z(ue)})})}).catch(z)});return v(T,P),T}function Ws(P){return new g(function(D,T){P.transaction(function(F){F.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(z,$){for(var Y=[],se=0;se<$.rows.length;se++)Y.push($.rows.item(se).name);D({db:P,storeNames:Y})},function(z,$){T($)})},function(F){T(F)})})}function Wi(P,D){D=S.apply(this,arguments);var T=this.config();P=typeof P!="function"&&P||{},P.name||(P.name=P.name||T.name,P.storeName=P.storeName||T.storeName);var F=this,z;return P.name?z=new g(function($){var Y;P.name===T.name?Y=F._dbInfo.db:Y=openDatabase(P.name,"","",0),P.storeName?$({db:Y,storeNames:[P.storeName]}):$(Ws(Y))}).then(function($){return new g(function(Y,se){$.db.transaction(function(ue){function ce(ut){return new g(function(at,Fe){ue.executeSql("DROP TABLE IF EXISTS "+ut,[],function(){at()},function(St,or){Fe(or)})})}for(var me=[],Te=0,Ze=$.storeNames.length;Te<Ze;Te++)me.push(ce($.storeNames[Te]));g.all(me).then(function(){Y()}).catch(function(ut){se(ut)})},function(ue){se(ue)})})}):z=g.reject("Invalid arguments"),v(z,D),z}var Gs={_driver:"webSQLStorage",_initStorage:Bi,_support:ts(),iterate:ss,getItem:ns,setItem:Rl,removeItem:Nl,clear:Il,length:Dl,key:Hi,keys:Ll,dropInstance:Wi};function Xu(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function os(P,D){var T=P.name+"/";return P.storeName!==D.storeName&&(T+=P.storeName+"/"),T}function Eo(){var P="_localforage_support_test";try{return localStorage.setItem(P,!0),localStorage.removeItem(P),!1}catch{return!0}}function Po(){return!Eo()||localStorage.length>0}function Gi(P){var D=this,T={};if(P)for(var F in P)T[F]=P[F];return T.keyPrefix=os(P,D._defaultConfig),Po()?(D._dbInfo=T,T.serializer=Tn,g.resolve()):g.reject()}function ed(P){var D=this,T=D.ready().then(function(){for(var F=D._dbInfo.keyPrefix,z=localStorage.length-1;z>=0;z--){var $=localStorage.key(z);$.indexOf(F)===0&&localStorage.removeItem($)}});return v(T,P),T}function td(P,D){var T=this;P=w(P);var F=T.ready().then(function(){var z=T._dbInfo,$=localStorage.getItem(z.keyPrefix+P);return $&&($=z.serializer.deserialize($)),$});return v(F,D),F}function rd(P,D){var T=this,F=T.ready().then(function(){for(var z=T._dbInfo,$=z.keyPrefix,Y=$.length,se=localStorage.length,ue=1,ce=0;ce<se;ce++){var me=localStorage.key(ce);if(me.indexOf($)===0){var Te=localStorage.getItem(me);if(Te&&(Te=z.serializer.deserialize(Te)),Te=P(Te,me.substring(Y),ue++),Te!==void 0)return Te}}});return v(F,D),F}function jn(P,D){var T=this,F=T.ready().then(function(){var z=T._dbInfo,$;try{$=localStorage.key(P)}catch{$=null}return $&&($=$.substring(z.keyPrefix.length)),$});return v(F,D),F}function Ol(P){var D=this,T=D.ready().then(function(){for(var F=D._dbInfo,z=localStorage.length,$=[],Y=0;Y<z;Y++){var se=localStorage.key(Y);se.indexOf(F.keyPrefix)===0&&$.push(se.substring(F.keyPrefix.length))}return $});return v(T,P),T}function Ml(P){var D=this,T=D.keys().then(function(F){return F.length});return v(T,P),T}function nd(P,D){var T=this;P=w(P);var F=T.ready().then(function(){var z=T._dbInfo;localStorage.removeItem(z.keyPrefix+P)});return v(F,D),F}function $l(P,D,T){var F=this;P=w(P);var z=F.ready().then(function(){D===void 0&&(D=null);var $=D;return new g(function(Y,se){var ue=F._dbInfo;ue.serializer.serialize(D,function(ce,me){if(me)se(me);else try{localStorage.setItem(ue.keyPrefix+P,ce),Y($)}catch(Te){(Te.name==="QuotaExceededError"||Te.name==="NS_ERROR_DOM_QUOTA_REACHED")&&se(Te),se(Te)}})})});return v(z,T),z}function Ul(P,D){if(D=S.apply(this,arguments),P=typeof P!="function"&&P||{},!P.name){var T=this.config();P.name=P.name||T.name,P.storeName=P.storeName||T.storeName}var F=this,z;return P.name?z=new g(function($){P.storeName?$(os(P,F._defaultConfig)):$(P.name+"/")}).then(function($){for(var Y=localStorage.length-1;Y>=0;Y--){var se=localStorage.key(Y);se.indexOf($)===0&&localStorage.removeItem(se)}}):z=g.reject("Invalid arguments"),v(z,D),z}var Fl={_driver:"localStorageWrapper",_initStorage:Gi,_support:Xu(),iterate:rd,getItem:td,setItem:$l,removeItem:nd,clear:ed,length:Ml,key:jn,keys:Ol,dropInstance:Ul},zl=function(D,T){return D===T||typeof D=="number"&&typeof T=="number"&&isNaN(D)&&isNaN(T)},sd=function(D,T){for(var F=D.length,z=0;z<F;){if(zl(D[z],T))return!0;z++}return!1},Vl=Array.isArray||function(P){return Object.prototype.toString.call(P)==="[object Array]"},pt={},Bl={},ln={INDEXEDDB:Nr,WEBSQL:Gs,LOCALSTORAGE:Fl},ql=[ln.INDEXEDDB._driver,ln.WEBSQL._driver,ln.LOCALSTORAGE._driver],Rn=["dropInstance"],Ki=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Rn),Hl={description:"",driver:ql.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function To(P,D){P[D]=function(){var T=arguments;return P.ready().then(function(){return P[D].apply(P,T)})}}function dr(){for(var P=1;P<arguments.length;P++){var D=arguments[P];if(D)for(var T in D)D.hasOwnProperty(T)&&(Vl(D[T])?arguments[0][T]=D[T].slice():arguments[0][T]=D[T])}return arguments[0]}var od=function(){function P(D){l(this,P);for(var T in ln)if(ln.hasOwnProperty(T)){var F=ln[T],z=F._driver;this[T]=z,pt[z]||this.defineDriver(F)}this._defaultConfig=dr({},Hl),this._config=dr({},this._defaultConfig,D),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return P.prototype.config=function(T){if((typeof T>"u"?"undefined":a(T))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var F in T){if(F==="storeName"&&(T[F]=T[F].replace(/\W/g,"_")),F==="version"&&typeof T[F]!="number")return new Error("Database version must be a number.");this._config[F]=T[F]}return"driver"in T&&T.driver?this.setDriver(this._config.driver):!0}else return typeof T=="string"?this._config[T]:this._config},P.prototype.defineDriver=function(T,F,z){var $=new g(function(Y,se){try{var ue=T._driver,ce=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!T._driver){se(ce);return}for(var me=Ki.concat("_initStorage"),Te=0,Ze=me.length;Te<Ze;Te++){var ut=me[Te],at=!sd(Rn,ut);if((at||T[ut])&&typeof T[ut]!="function"){se(ce);return}}var Fe=function(){for(var Nn=function(Ro){return function(){var cn=new Error("Method "+Ro+" is not implemented by the current driver"),qr=g.reject(cn);return v(qr,arguments[arguments.length-1]),qr}},Ao=0,Wl=Rn.length;Ao<Wl;Ao++){var jo=Rn[Ao];T[jo]||(T[jo]=Nn(jo))}};Fe();var St=function(Nn){pt[ue]&&console.info("Redefining LocalForage driver: "+ue),pt[ue]=T,Bl[ue]=Nn,Y()};"_support"in T?T._support&&typeof T._support=="function"?T._support().then(St,se):St(!!T._support):St(!0)}catch(or){se(or)}});return x($,F,z),$},P.prototype.driver=function(){return this._driver||null},P.prototype.getDriver=function(T,F,z){var $=pt[T]?g.resolve(pt[T]):g.reject(new Error("Driver not found."));return x($,F,z),$},P.prototype.getSerializer=function(T){var F=g.resolve(Tn);return x(F,T),F},P.prototype.ready=function(T){var F=this,z=F._driverSet.then(function(){return F._ready===null&&(F._ready=F._initDriver()),F._ready});return x(z,T,T),z},P.prototype.setDriver=function(T,F,z){var $=this;Vl(T)||(T=[T]);var Y=this._getSupportedDrivers(T);function se(){$._config.driver=$.driver()}function ue(Te){return $._extend(Te),se(),$._ready=$._initStorage($._config),$._ready}function ce(Te){return function(){var Ze=0;function ut(){for(;Ze<Te.length;){var at=Te[Ze];return Ze++,$._dbInfo=null,$._ready=null,$.getDriver(at).then(ue).catch(ut)}se();var Fe=new Error("No available storage method found.");return $._driverSet=g.reject(Fe),$._driverSet}return ut()}}var me=this._driverSet!==null?this._driverSet.catch(function(){return g.resolve()}):g.resolve();return this._driverSet=me.then(function(){var Te=Y[0];return $._dbInfo=null,$._ready=null,$.getDriver(Te).then(function(Ze){$._driver=Ze._driver,se(),$._wrapLibraryMethodsWithReady(),$._initDriver=ce(Y)})}).catch(function(){se();var Te=new Error("No available storage method found.");return $._driverSet=g.reject(Te),$._driverSet}),x(this._driverSet,F,z),this._driverSet},P.prototype.supports=function(T){return!!Bl[T]},P.prototype._extend=function(T){dr(this,T)},P.prototype._getSupportedDrivers=function(T){for(var F=[],z=0,$=T.length;z<$;z++){var Y=T[z];this.supports(Y)&&F.push(Y)}return F},P.prototype._wrapLibraryMethodsWithReady=function(){for(var T=0,F=Ki.length;T<F;T++)To(this,Ki[T])},P.prototype.createInstance=function(T){return new P(T)},P}(),wr=new od;n.exports=wr},{3:3}]},{},[4])(4)})}(hf)),hf.exports}var Kj=Gj();const Ds=Sl(Kj),Zj=Object.freeze(Object.defineProperty({__proto__:null,default:Ds},Symbol.toStringTag,{value:"Module"})),Jj=Ds.createInstance({name:"labTours",storeName:"validatedTours"}),Ku=Wu()(Wp((r,e)=>({labTours:[],currentDriverId:null,isLoading:!0,isRefreshing:!1,error:null,lastDataHash:"",lastUpdateTime:0,setLabTours:t=>{r({labTours:t,lastUpdateTime:Date.now(),error:null})},setCurrentDriverId:t=>{r({currentDriverId:t})},setLoading:t=>{r({isLoading:t})},setRefreshing:t=>{r({isRefreshing:t})},setError:t=>{r({error:t})},updateDataHash:t=>{r({lastDataHash:t})},hasDataChanged:t=>e().lastDataHash!==t,clearStore:()=>{r({labTours:[],currentDriverId:null,isLoading:!0,isRefreshing:!1,error:null,lastDataHash:"",lastUpdateTime:0})}}),{name:"lab-tours-storage",storage:Hp(()=>Jj),partialize:r=>({labTours:r.labTours,currentDriverId:r.currentDriverId,lastDataHash:r.lastDataHash,lastUpdateTime:r.lastUpdateTime}),onRehydrateStorage:()=>r=>{r&&(r.isLoading=!1,console.log("💾 Store lab tours réhydraté avec",r.labTours.length,"laboratoires"))}})),Qj=Object.freeze(Object.defineProperty({__proto__:null,useLabToursStore:Ku},Symbol.toStringTag,{value:"Module"}));function yw(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var o=r.length;for(e=0;e<o;e++)r[e]&&(t=yw(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Yj(){for(var r,e,t=0,n="",o=arguments.length;t<o;t++)(r=arguments[t])&&(e=yw(r))&&(n&&(n+=" "),n+=e);return n}const Yp="-",Xj=r=>{const e=t2(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:l=>{const c=l.split(Yp);return c[0]===""&&c.length!==1&&c.shift(),vw(c,e)||e2(l)},getConflictingClassGroupIds:(l,c)=>{const d=t[l]||[];return c&&n[l]?[...d,...n[l]]:d}}},vw=(r,e)=>{if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),o=n?vw(r.slice(1),n):void 0;if(o)return o;if(e.validators.length===0)return;const a=r.join(Yp);return e.validators.find(({validator:l})=>l(a))?.classGroupId},$v=/^\[(.+)\]$/,e2=r=>{if($v.test(r)){const e=$v.exec(r)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},t2=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return n2(Object.entries(r.classGroups),t).forEach(([a,l])=>{Jf(l,n,a,e)}),n},Jf=(r,e,t,n)=>{r.forEach(o=>{if(typeof o=="string"){const a=o===""?e:Uv(e,o);a.classGroupId=t;return}if(typeof o=="function"){if(r2(o)){Jf(o(n),e,t,n);return}e.validators.push({validator:o,classGroupId:t});return}Object.entries(o).forEach(([a,l])=>{Jf(l,Uv(e,a),t,n)})})},Uv=(r,e)=>{let t=r;return e.split(Yp).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},r2=r=>r.isThemeGetter,n2=(r,e)=>e?r.map(([t,n])=>{const o=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([l,c])=>[e+l,c])):a);return[t,o]}):r,s2=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const o=(a,l)=>{t.set(a,l),e++,e>r&&(e=0,n=t,t=new Map)};return{get(a){let l=t.get(a);if(l!==void 0)return l;if((l=n.get(a))!==void 0)return o(a,l),l},set(a,l){t.has(a)?t.set(a,l):o(a,l)}}},xw="!",o2=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,o=e[0],a=e.length,l=c=>{const d=[];let h=0,m=0,g;for(let _=0;_<c.length;_++){let C=c[_];if(h===0){if(C===o&&(n||c.slice(_,_+a)===e)){d.push(c.slice(m,_)),m=_+a;continue}if(C==="/"){g=_;continue}}C==="["?h++:C==="]"&&h--}const v=d.length===0?c:c.substring(m),x=v.startsWith(xw),w=x?v.substring(1):v,S=g&&g>m?g-m:void 0;return{modifiers:d,hasImportantModifier:x,baseClassName:w,maybePostfixModifierPosition:S}};return t?c=>t({className:c,parseClassName:l}):l},i2=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},a2=r=>({cache:s2(r.cacheSize),parseClassName:o2(r),...Xj(r)}),l2=/\s+/,c2=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:o}=e,a=[],l=r.trim().split(l2);let c="";for(let d=l.length-1;d>=0;d-=1){const h=l[d],{modifiers:m,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:x}=t(h);let w=!!x,S=n(w?v.substring(0,x):v);if(!S){if(!w){c=h+(c.length>0?" "+c:c);continue}if(S=n(v),!S){c=h+(c.length>0?" "+c:c);continue}w=!1}const _=i2(m).join(":"),C=g?_+xw:_,E=C+S;if(a.includes(E))continue;a.push(E);const N=o(S,w);for(let M=0;M<N.length;++M){const A=N[M];a.push(C+A)}c=h+(c.length>0?" "+c:c)}return c};function u2(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=bw(e))&&(n&&(n+=" "),n+=t);return n}const bw=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=bw(r[n]))&&(t&&(t+=" "),t+=e);return t};function d2(r,...e){let t,n,o,a=l;function l(d){const h=e.reduce((m,g)=>g(m),r());return t=a2(h),n=t.cache.get,o=t.cache.set,a=c,c(d)}function c(d){const h=n(d);if(h)return h;const m=c2(d,t);return o(d,m),m}return function(){return a(u2.apply(null,arguments))}}const bt=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},ww=/^\[(?:([a-z-]+):)?(.+)\]$/i,h2=/^\d+\/\d+$/,f2=new Set(["px","full","screen"]),p2=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,m2=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,g2=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,y2=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,v2=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,zn=r=>bi(r)||f2.has(r)||h2.test(r),_s=r=>zi(r,"length",E2),bi=r=>!!r&&!Number.isNaN(Number(r)),ff=r=>zi(r,"number",bi),ja=r=>!!r&&Number.isInteger(Number(r)),x2=r=>r.endsWith("%")&&bi(r.slice(0,-1)),Ye=r=>ww.test(r),ks=r=>p2.test(r),b2=new Set(["length","size","percentage"]),w2=r=>zi(r,b2,Sw),S2=r=>zi(r,"position",Sw),_2=new Set(["image","url"]),k2=r=>zi(r,_2,T2),C2=r=>zi(r,"",P2),Ra=()=>!0,zi=(r,e,t)=>{const n=ww.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},E2=r=>m2.test(r)&&!g2.test(r),Sw=()=>!1,P2=r=>y2.test(r),T2=r=>v2.test(r),A2=()=>{const r=bt("colors"),e=bt("spacing"),t=bt("blur"),n=bt("brightness"),o=bt("borderColor"),a=bt("borderRadius"),l=bt("borderSpacing"),c=bt("borderWidth"),d=bt("contrast"),h=bt("grayscale"),m=bt("hueRotate"),g=bt("invert"),v=bt("gap"),x=bt("gradientColorStops"),w=bt("gradientColorStopPositions"),S=bt("inset"),_=bt("margin"),C=bt("opacity"),E=bt("padding"),N=bt("saturate"),M=bt("scale"),A=bt("sepia"),K=bt("skew"),Z=bt("space"),W=bt("translate"),de=()=>["auto","contain","none"],pe=()=>["auto","hidden","clip","visible","scroll"],Ee=()=>["auto",Ye,e],ee=()=>[Ye,e],ye=()=>["",zn,_s],G=()=>["auto",bi,Ye],Se=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ce=()=>["solid","dashed","dotted","double","none"],_e=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],te=()=>["start","end","center","between","around","evenly","stretch"],X=()=>["","0",Ye],oe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],L=()=>[bi,Ye];return{cacheSize:500,separator:":",theme:{colors:[Ra],spacing:[zn,_s],blur:["none","",ks,Ye],brightness:L(),borderColor:[r],borderRadius:["none","","full",ks,Ye],borderSpacing:ee(),borderWidth:ye(),contrast:L(),grayscale:X(),hueRotate:L(),invert:X(),gap:ee(),gradientColorStops:[r],gradientColorStopPositions:[x2,_s],inset:Ee(),margin:Ee(),opacity:L(),padding:ee(),saturate:L(),scale:L(),sepia:X(),skew:L(),space:ee(),translate:ee()},classGroups:{aspect:[{aspect:["auto","square","video",Ye]}],container:["container"],columns:[{columns:[ks]}],"break-after":[{"break-after":oe()}],"break-before":[{"break-before":oe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Se(),Ye]}],overflow:[{overflow:pe()}],"overflow-x":[{"overflow-x":pe()}],"overflow-y":[{"overflow-y":pe()}],overscroll:[{overscroll:de()}],"overscroll-x":[{"overscroll-x":de()}],"overscroll-y":[{"overscroll-y":de()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ja,Ye]}],basis:[{basis:Ee()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ye]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",ja,Ye]}],"grid-cols":[{"grid-cols":[Ra]}],"col-start-end":[{col:["auto",{span:["full",ja,Ye]},Ye]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[Ra]}],"row-start-end":[{row:["auto",{span:[ja,Ye]},Ye]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ye]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ye]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...te()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...te(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...te(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[E]}],px:[{px:[E]}],py:[{py:[E]}],ps:[{ps:[E]}],pe:[{pe:[E]}],pt:[{pt:[E]}],pr:[{pr:[E]}],pb:[{pb:[E]}],pl:[{pl:[E]}],m:[{m:[_]}],mx:[{mx:[_]}],my:[{my:[_]}],ms:[{ms:[_]}],me:[{me:[_]}],mt:[{mt:[_]}],mr:[{mr:[_]}],mb:[{mb:[_]}],ml:[{ml:[_]}],"space-x":[{"space-x":[Z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ye,e]}],"min-w":[{"min-w":[Ye,e,"min","max","fit"]}],"max-w":[{"max-w":[Ye,e,"none","full","min","max","fit","prose",{screen:[ks]},ks]}],h:[{h:[Ye,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ye,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ye,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ye,e,"auto","min","max","fit"]}],"font-size":[{text:["base",ks,_s]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ff]}],"font-family":[{font:[Ra]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ye]}],"line-clamp":[{"line-clamp":["none",bi,ff]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",zn,Ye]}],"list-image":[{"list-image":["none",Ye]}],"list-style-type":[{list:["none","disc","decimal",Ye]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[C]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[C]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ce(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",zn,_s]}],"underline-offset":[{"underline-offset":["auto",zn,Ye]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ee()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ye]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ye]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[C]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Se(),S2]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",w2]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},k2]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[x]}],"gradient-via":[{via:[x]}],"gradient-to":[{to:[x]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[C]}],"border-style":[{border:[...Ce(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[C]}],"divide-style":[{divide:Ce()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...Ce()]}],"outline-offset":[{"outline-offset":[zn,Ye]}],"outline-w":[{outline:[zn,_s]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:ye()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[C]}],"ring-offset-w":[{"ring-offset":[zn,_s]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",ks,C2]}],"shadow-color":[{shadow:[Ra]}],opacity:[{opacity:[C]}],"mix-blend":[{"mix-blend":[..._e(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":_e()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",ks,Ye]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[g]}],saturate:[{saturate:[N]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[g]}],"backdrop-opacity":[{"backdrop-opacity":[C]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ye]}],duration:[{duration:L()}],ease:[{ease:["linear","in","out","in-out",Ye]}],delay:[{delay:L()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ye]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[ja,Ye]}],"translate-x":[{"translate-x":[W]}],"translate-y":[{"translate-y":[W]}],"skew-x":[{"skew-x":[K]}],"skew-y":[{"skew-y":[K]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ye]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ye]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ee()}],"scroll-mx":[{"scroll-mx":ee()}],"scroll-my":[{"scroll-my":ee()}],"scroll-ms":[{"scroll-ms":ee()}],"scroll-me":[{"scroll-me":ee()}],"scroll-mt":[{"scroll-mt":ee()}],"scroll-mr":[{"scroll-mr":ee()}],"scroll-mb":[{"scroll-mb":ee()}],"scroll-ml":[{"scroll-ml":ee()}],"scroll-p":[{"scroll-p":ee()}],"scroll-px":[{"scroll-px":ee()}],"scroll-py":[{"scroll-py":ee()}],"scroll-ps":[{"scroll-ps":ee()}],"scroll-pe":[{"scroll-pe":ee()}],"scroll-pt":[{"scroll-pt":ee()}],"scroll-pr":[{"scroll-pr":ee()}],"scroll-pb":[{"scroll-pb":ee()}],"scroll-pl":[{"scroll-pl":ee()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ye]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[zn,_s,ff]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},j2=d2(A2);function es(...r){return j2(Yj(r))}function wi(r){const e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${e}-${t}-${n}`}const R2=Object.freeze(Object.defineProperty({__proto__:null,cn:es,formatLocalDateISO:wi},Symbol.toStringTag,{value:"Module"}));class N2{debounceTimer=null;generateDataHash(e){if(!e||e.length===0)return"";const t=e.map(n=>({id:n.id,laboratory_id:n.laboratory_id,status:n.status,date:n.date,shipments:n.lab_tour_shipments?.map(o=>({id:o.id,type:o.shipment_type,date:o.scheduled_date,from_location_id:o.from_location_id,to_location_id:o.to_location_id}))||[]}));return JSON.stringify(t)}async getCurrentDriverId(){try{const{data:{user:e}}=await Oe.auth.getUser();if(!e)return console.warn("⚠️ Aucun utilisateur connecté"),null;const{data:t,error:n}=await Oe.from("drivers").select("id, full_name").eq("user_id",e.id).single();return n?(console.error("❌ Erreur récupération driver:",n),null):t?(console.log("✅ Livreur connecté identifié:",t.full_name,"(ID:",t.id,")"),t.id):null}catch(e){return console.error("❌ Erreur auth getCurrentDriverId:",e),null}}processLabToursData(e,t){const n=[],o=new Map;return console.log("🔄 Traitement des données pour livreur ID:",t),e?.forEach(a=>{const l=a.laboratory_id,c=a.laboratories.name,d=a.laboratories.locations.formatted_address;o.has(l)||o.set(l,{id:l,laboratoryName:c,laboratoryAddress:d,pickups:[]}),a.lab_tour_shipments.forEach(h=>{const m=h.locations?.laboratory_clients?.[0];if(m){const g=t&&m.driver_id===t;m.driver_id&&console.log(`📦 Colis ${m.name}:`,{assignedDriverId:m.driver_id,assignedDriverName:m.drivers?.full_name||"Non assigné",currentDriverId:t,isCurrentDriver:g}),o.get(l).pickups.push({id:`${a.id}_${h.id}`,shipmentId:h.id,clientName:m.name,clientAddress:h.locations.formatted_address,assignedDriverName:m.drivers?.full_name||"Non assigné",assignedDriverId:m.driver_id||"",isCurrentDriver:g,shipmentType:h.shipment_type,scheduledDate:h.scheduled_date})}})}),o.forEach(a=>{const l=a.pickups.sort((c,d)=>c.isCurrentDriver!==d.isCurrentDriver?d.isCurrentDriver?1:-1:c.clientName.localeCompare(d.clientName,"fr",{sensitivity:"base"}));n.push({...a,pickups:l,totalPickups:l.length})}),n.sort((a,l)=>a.laboratoryName.localeCompare(l.laboratoryName,"fr",{sensitivity:"base"}))}async fetchLabTours(e=!1){const t=Ku.getState();try{e?t.setRefreshing(!0):t.setLoading(!0),t.setError(null);let n=t.currentDriverId;n||(n=await this.getCurrentDriverId(),n&&t.setCurrentDriverId(n));const o=wi(new Date);console.log("📅 Recherche lab tours pour la date:",o),console.log("🚛 Driver ID courant:",n),console.log("🔍 Étape 1: Requête simple lab_tours...");const{data:a,error:l}=await Oe.from("lab_tours").select("*").in("status",["validated","pending_changes"]);console.log("📊 Lab tours totaux (tous status):",a?.length||0),l&&console.error("❌ Erreur requête simple:",l),console.log("🔍 Étape 2: Shipments d'aujourd'hui...");const{data:c,error:d}=await Oe.from("lab_tour_shipments").select("*").eq("shipment_type","lab_to_client").eq("scheduled_date",o);console.log("📦 Shipments lab_to_client aujourd'hui:",c?.length||0),d&&console.error("❌ Erreur requête shipments:",d),console.log("🔍 Étape 3: Requête complète avec jointures...");const{data:h,error:m}=await Oe.from("lab_tours").select(`
          id,
          laboratory_id,
          date,
          status,
          laboratories!inner (
            name,
            shared_pickup,
            depot_is_lab,
            locations!inner (
              formatted_address
            )
          ),
          lab_tour_shipments!inner (
            id,
            shipment_type,
            scheduled_date,
            from_location_id,
            to_location_id,
            locations!lab_tour_shipments_to_location_id_fkey (
              id,
              formatted_address,
              laboratory_clients!inner (
                name,
                driver_id,
                drivers (
                  id,
                  full_name
                )
              )
            )
          )
        `).in("status",["validated","pending_changes"]).or("shared_pickup.eq.true,depot_is_lab.eq.true",{foreignTable:"laboratories"}).in("lab_tour_shipments.shipment_type",["lab_to_client","lab_to_depot","depot_to_client"]).eq("lab_tour_shipments.scheduled_date",o);if(console.log("📊 Résultat requête complète:",h?.length||0,"tours trouvés"),m)throw console.error("❌ Erreur requête complète:",m),m;h&&h.length>0?(console.log("🔎 Premier tour récupéré:",{id:h[0].id,laboratory_id:h[0].laboratory_id,date:h[0].date,status:h[0].status,laboratoryName:h[0].laboratories?.name,shipmentsCount:h[0].lab_tour_shipments?.length||0}),h[0].lab_tour_shipments&&(console.log("📦 Shipments du premier tour:"),h[0].lab_tour_shipments.forEach((w,S)=>{console.log(`  ${S+1}. Shipment ${w.id}:`,{type:w.shipment_type,scheduled_date:w.scheduled_date,client_name:w.locations?.laboratory_clients?.[0]?.name||"Client inconnu",driver_id:w.locations?.laboratory_clients?.[0]?.driver_id||"Pas de driver"})}))):(console.warn("⚠️ Aucun tour trouvé avec la requête complète"),console.log("🔍 Critères de recherche:"),console.log("  - Status: validated ou pending_changes"),console.log("  - Shipment type: lab_to_client"),console.log("  - Scheduled date:",o));const g=this.generateDataHash(h||[]),v=t.lastDataHash;console.log("🔐 Comparaison hash:"),console.log("  - Ancien hash:",v?.slice(-8)||"Aucun"),console.log("  - Nouveau hash:",g?.slice(-8)||"Aucun"),console.log("  - Données changées:",g!==v),e&&!t.hasDataChanged(g)&&console.log("🔄 Pas de changement détecté dans le hash, mais on force la mise à jour en debug"),console.log("🔄 Traitement des données...");const x=this.processLabToursData(h||[],n);console.log("✨ Données traitées:",x.length,"laboratoires"),x.length>0&&x.forEach((w,S)=>{console.log(`  ${S+1}. ${w.laboratoryName}: ${w.totalPickups} pickups`)}),t.updateDataHash(g),e&&x.length>0?setTimeout(()=>{t.setLabTours(x),console.log("✨ Données lab tours mises à jour:",x.length,"laboratoires")},300):t.setLabTours(x)}catch(n){console.error("❌ Erreur récupération lab tours:",n),t.setError(n instanceof Error?n.message:"Erreur inconnue")}finally{e?setTimeout(()=>{t.setRefreshing(!1)},500):t.setLoading(!1)}}debouncedRefresh(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.fetchLabTours(!0)},1e3)}cleanup(){this.debounceTimer&&clearTimeout(this.debounceTimer)}}const Na=new N2,I2=()=>{const r=Ku();j.useEffect(()=>{(async()=>{console.log("🚀 Initialisation du hook lab tours validés"),await Na.fetchLabTours(!1)})();const n=Oe.channel("lab_tours_realtime").on("postgres_changes",{event:"*",schema:"public",table:"lab_tours",filter:"status=in.(validated,pending_changes)"},a=>{console.log("🔔 Changement détecté sur lab_tours:",a.eventType,a.new?a.new.id:"N/A"),Na.debouncedRefresh()}).subscribe(),o=Oe.channel("lab_tour_shipments_realtime").on("postgres_changes",{event:"*",schema:"public",table:"lab_tour_shipments",filter:"shipment_type=eq.lab_to_client"},a=>{console.log("🔔 Changement détecté sur lab_tour_shipments:",a.eventType,a.new?a.new.id:"N/A"),Na.debouncedRefresh()}).subscribe();return()=>{console.log("🧹 Nettoyage du hook lab tours validés"),Na.cleanup(),Oe.removeChannel(n),Oe.removeChannel(o)}},[]);const e=()=>{Na.fetchLabTours(!0)};return{labTours:r.labTours,loading:r.isLoading,isRefreshing:r.isRefreshing,error:r.error,currentDriverId:r.currentDriverId,refetch:e}};function D2(r){const e=r.filter(a=>a.is_late_stop);if(e.length===0)return{hasLateStops:!1,lateStopsCount:0,affectedLocations:[],potentialGroupChanges:0,lateStops:[]};const t=new Set(e.map(a=>a.location_id)),n=Array.from(t);let o=0;return e.forEach(a=>{r.filter(c=>c.location_id===a.location_id&&!c.is_late_stop).length>0&&o++}),{hasLateStops:!0,lateStopsCount:e.length,affectedLocations:n,potentialGroupChanges:o,lateStops:e}}function po(r,e,t){const n=[...r].sort((h,m)=>h.stop_order-m.stop_order),o=D2(n);o.hasLateStops&&console.log("🆕 Late stops détectés:",{count:o.lateStopsCount,locations:o.affectedLocations,groupsImpacted:o.potentialGroupChanges});const a=_w(e),l=[];let c=0;for(;c<n.length;){const h=n[c];if(L2(h,t)){const m=pf(h,a,t);h.is_late_stop&&(m.isLateStop=!0,m.lateStopInfo={addedAt:new Date().toISOString(),originalOrder:h.stop_order,reason:"Ajout tardif laboratoire/dépôt"}),l.push(m),c++;continue}if(kw(h,t)){const m=O2(n,c,t);if(m.length>1){const g=M2(m,a,t),v=m.filter(x=>x.is_late_stop);v.length>0&&(g.hasLateStops=!0,g.lateStopsInfo={count:v.length,lateStops:v.map(x=>({stopId:x.id,order:x.stop_order,addedAt:new Date().toISOString()})),groupReformed:!0},console.log("🔄 Groupe reformé à cause de late stops:",{location:g.locationInfo.formatted_address,lateStopsCount:v.length,totalStopsInGroup:m.length})),l.push(g)}else{const g=pf(h,a,t);h.is_late_stop&&(g.isLateStop=!0,g.lateStopInfo={addedAt:new Date().toISOString(),originalOrder:h.stop_order,reason:"Ajout tardif client unique"}),l.push(g)}c+=m.length}else console.warn("Type de stop non reconnu:",h.stop_type),l.push(pf(h,a,t)),c++}console.log(`🔄 Fusion terminée: ${r.length} stops → ${l.length} stops groupés`);const d=l.filter(h=>h.hasLateStops||h.isLateStop);return d.length>0&&console.log(`🆕 Résumé late stops: ${d.length} groupes affectés`),l}function _w(r){const e=new Map;return r.forEach(t=>{t.pickup_stop_id&&(e.has(t.pickup_stop_id)||e.set(t.pickup_stop_id,[]),e.get(t.pickup_stop_id).push(t)),t.delivery_stop_id&&(e.has(t.delivery_stop_id)||e.set(t.delivery_stop_id,[]),e.get(t.delivery_stop_id).push(t))}),e}function L2(r,e){const t=e.locations.get(r.location_id);return t?t.type==="laboratory"||t.type==="depot":(console.warn("⚠️ Location introuvable pour stop:",r.id),!1)}function kw(r,e){const t=e.locations.get(r.location_id);return t?t.type==="dentist_client"||t.type==="lab_client":(console.warn("⚠️ Location introuvable pour stop:",r.id),!1)}function O2(r,e,t){const n=[r[e]],o=r[e].location_id;let a=e+1;for(;a<r.length;){const l=r[a],c=r[a-1];if(l.stop_order===c.stop_order+1&&l.location_id===o&&kw(l,t))n.push(l),a++;else break}return n.length>1&&console.log(`📦 Groupe trouvé: ${n.length} stops consécutifs à la location ${o}`),n}function pf(r,e,t){const n=e.get(r.id)||[],o=t.locations.get(r.location_id);if(!o)throw new Error(`Location introuvable: ${r.location_id}`);const{deliveryShipments:a,pickupShipments:l}=Xp(n,r);let c;o.type==="laboratory"?c="laboratory":o.type==="depot"?c="depot":(o.type==="dentist_client"||o.type,c="client_single");const d=em(o,t,c);return{id:`single_${r.id}`,type:c,location_id:r.location_id,locationInfo:o,originalStopIds:[r.id],orderRange:[r.stop_order,r.stop_order],deliveryShipments:a,pickupShipments:l,status:r.completed?"completed":"pending",allDeliveriesCompleted:a.every(h=>h.delivery_status==="delivered"),allPickupsCompleted:l.every(h=>h.pickup_status==="picked_up"),estimatedDuration:r.duration_from_previous||0,address:o.formatted_address,clientName:d.clientName,laboratoryName:d.laboratoryName}}function M2(r,e,t){const n=r[0],o=r[r.length-1],a=t.locations.get(n.location_id);if(!a)throw new Error(`Location introuvable: ${n.location_id}`);let l=[],c=[],d=0;r.forEach(x=>{const w=e.get(x.id)||[],{deliveryShipments:S,pickupShipments:_}=Xp(w,x);l=[...l,...S],c=[...c,..._],d+=x.duration_from_previous||0});const h=r.every(x=>x.completed),m=r.some(x=>!x.completed&&x.arrival_time);let g;h?g="completed":m?g="in_progress":g="pending";const v=em(a,t,"client_grouped");return{id:`grouped_${n.location_id}_${n.stop_order}_${o.stop_order}`,type:"client_grouped",location_id:n.location_id,locationInfo:a,originalStopIds:r.map(x=>x.id),orderRange:[n.stop_order,o.stop_order],deliveryShipments:l,pickupShipments:c,status:g,allDeliveriesCompleted:l.every(x=>x.delivery_status==="delivered"),allPickupsCompleted:c.every(x=>x.pickup_status==="picked_up"),estimatedDuration:d,address:a.formatted_address,clientName:v.clientName,laboratoryName:v.laboratoryName}}function Xp(r,e){const t=[],n=[];return r.forEach(o=>{o.delivery_stop_id===e.id&&t.push(o),o.pickup_stop_id===e.id&&n.push(o)}),{deliveryShipments:t,pickupShipments:n}}function em(r,e,t){return t==="laboratory"?{laboratoryName:Array.from(e.laboratories.values()).find(o=>o.location_id===r.id)?.name||"Laboratoire inconnu"}:t==="client_grouped"||t==="client_single"?{clientName:Array.from(e.laboratoryClients.values()).find(o=>o.location_id===r.id)?.name||"Client inconnu"}:{}}function Cw(r,e,t){console.log("🆕 [mapPreGroupedStops] Mode backend fusionné - mapping 1:1");const n=[...r].sort((d,h)=>d.stop_order-h.stop_order),o=_w(e),a=n.filter(d=>d.is_late_stop);a.length>0&&console.log(`🆕 ${a.length} late stop(s) détecté(s) (architecture simplifiée):`,a.map(d=>({id:d.id.slice(-8),order:d.stop_order,location:d.location_id,actions:d.client_actions})));const l=n.map(d=>{const h=t.locations.get(d.location_id);if(!h)throw new Error(`Location introuvable: ${d.location_id}`);const m=o.get(d.id)||[],{deliveryShipments:g,pickupShipments:v}=Xp(m,d);let x;d.stop_type==="client"?x="client_single":d.stop_type==="lab_pickup"||d.stop_type==="lab_dropoff"?x="laboratory":d.stop_type==="depot_dropoff"||d.stop_type==="depot_pickup"?x="depot":x="client_single";const w=em(h,t,x);return{id:`single_${d.id}`,type:x,location_id:d.location_id,locationInfo:h,originalStopIds:[d.id],orderRange:[d.stop_order,d.stop_order],deliveryShipments:g,pickupShipments:v,status:d.completed?"completed":"pending",allDeliveriesCompleted:g.every(_=>_.delivery_status==="completed"),allPickupsCompleted:v.every(_=>_.pickup_status==="picked_up"),estimatedDuration:d.duration_from_previous||0,address:h.formatted_address,clientName:w.clientName,laboratoryName:w.laboratoryName,isLateStop:d.is_late_stop,lateStopInfo:d.is_late_stop?{addedAt:new Date().toISOString(),originalOrder:d.stop_order,reason:`Ajout tardif: ${d.client_actions||d.stop_type}`}:void 0}});console.log(`✨ Mapping simplifié terminé: ${r.length} stops → ${l.length} groupés (1:1)`);const c=l.filter(d=>d.isLateStop).length;return c>0&&console.log(`🆕 ${c} late stop(s) intégré(s) sans regroupement complexe`),l}function $2(r,e,t,n=!1){return n?(console.log("🆕 Mode forcé: Nouvelle architecture backend"),Cw(r,e,t)):(console.log("🔧 [RETOUR FUSION ORIGINALE] Utilisation de groupConsecutiveStops"),po(r,e,t))}const U2=Ds.createInstance({name:"provenceCourses",storeName:"mainApp"}),F2=(r,e)=>e instanceof Map?{__type:"Map",__data:Array.from(e.entries())}:e,z2=(r,e)=>e&&e.__type==="Map"?new Map(e.__data):e,V2=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),iu=r=>{for(let t=0;t<r.length;t++)if(r[t].status!=="completed")return console.log(`📍 Stop actuel calculé: index ${t} (premier stop non complété)`),t;const e=Math.max(0,r.length-1);return console.log(`📍 Tous les stops complétés, index: ${e}`),e},B2=()=>({eligibilityByStop:new Map,isInitialized:!1,lastRefreshTime:0,laboratoryClientsByLocation:new Map,createdUnexpectedShipments:new Set}),du=()=>({driverRoute:null,rawStops:[],rawShipments:[],groupedStops:[],currentStopIndex:0,isActive:!1,routeInitializedAt:void 0,stopMapping:new Map}),mf=()=>({route:du(),referenceData:{locations:new Map,laboratories:new Map,laboratoryClients:new Map,lastRefreshTime:0},sync:{pendingActions:[],isOnline:navigator.onLine,isSyncing:!1,lastSyncTime:0,failedActions:[]},assets:{photos:new Map,uploadQueue:[],totalPhotos:0,uploadedPhotos:0,isCleaningPhotos:!1},currentDriverId:null,lastUpdateTime:0,isInitialized:!1,userInteraction:{isActive:!1,lastActionTime:0,actionType:void 0},unexpectedPickups:B2()}),et=Wu()(Wp((r,e)=>({...mf(),initializeStore:t=>{console.log("🚀 Initialisation du store principal pour driver:",t),r({currentDriverId:t,isInitialized:!0,lastUpdateTime:Date.now()}),setTimeout(()=>{console.log("🧹 [initializeStore] Déclenchement nettoyage initial des photos..."),e().analyzeStoredPhotos(),setTimeout(()=>{e().safeCleanupUploadedPhotos(!1).catch(n=>{console.warn("⚠️ [initializeStore] Erreur nettoyage initial:",n)})},5e3)},2e3)},clearStore:()=>{console.log("🧹 Nettoyage complet du store"),r(mf())},setActiveRoute:async(t,n,o)=>{const a=e();console.log("🔄 [setActiveRoute] Configuration route avec regroupement intelligent"),a.referenceData.locations.size>0?console.log("✅ Données de référence disponibles en cache"):(console.log("⚠️ Données de référence manquantes - chargement en arrière-plan..."),e().refreshAllReferenceData().then(()=>{console.log("✅ Données de référence chargées en arrière-plan")}).catch(C=>{console.warn("⚠️ Échec chargement données de référence:",C)}));const c=e(),d=n.filter(C=>C.is_late_stop),h=d.length>0;h&&console.log(`🆕 ${d.length} late stop(s) détecté(s):`,d.map(C=>({id:C.id.slice(-8),order:C.stop_order,location:C.location_id,actions:C.client_actions})));const m=$2(n,o,{locations:c.referenceData.locations,laboratories:c.referenceData.laboratories,laboratoryClients:c.referenceData.laboratoryClients});let g=0;const v=a.route.isActive,x=a.route.groupedStops;v&&x.length>0&&h?(console.log("🔄 Préservation du contexte utilisateur (late stops détectés)"),g=e().preserveUserContextOnLateStops(m,x)):g=iu(m);const w=new Map;m.forEach(C=>{w.set(C.id,C.originalStopIds)}),r(C=>({route:{driverRoute:t,rawStops:n,rawShipments:o,groupedStops:m,currentStopIndex:g,isActive:!0,routeInitializedAt:new Date().toISOString(),stopMapping:w},lastUpdateTime:Date.now()}));const S=m.length===n.length?"Backend fusionné":"Frontend groupé",_=m.filter(C=>C.isLateStop).length;console.log(`✅ Route configurée (${S}): ${n.length} stops → ${m.length} groupés`),console.log(`📍 Index courant: ${g}/${m.length-1}`),_>0&&console.log(`🆕 ${_} late stop(s) intégré(s) - contexte préservé`)},startRoute:()=>{const t=e();if(!t.route.driverRoute)throw new Error("Aucune route active à démarrer");const n=new Date().toISOString(),o=t.route.driverRoute;r(a=>({route:{...a.route,driverRoute:{...o,status:"in_progress",updated_at:n},isActive:!0,startedAt:n}})),e().addPendingAction({type:"START_ROUTE",data:{routeId:o.id,routeUpdate:{status:"in_progress",updated_at:n}},maxRetries:5}),console.log("🏁 [startRoute] Route démarrée avec statut local mis à jour:",{routeId:o.id.slice(-8),status:"in_progress"})},completeRoute:()=>{const t=e();if(console.log("🏁 Tentative de finalisation de tournée:",{hasActiveRoute:!!t.route.driverRoute,routeId:t.route.driverRoute?.id,routeStatus:t.route.driverRoute?.status,isActive:t.route.isActive,currentStopIndex:t.route.currentStopIndex,totalStops:t.route.groupedStops.length,completedAt:t.route.completedAt}),!t.route.isActive)throw console.error("❌ Route non active - impossible de terminer"),new Error("Aucune route active à terminer");if(!t.route.driverRoute)throw console.error("❌ Aucune route dans le store - impossible de terminer"),new Error("Aucune route trouvée dans le store");if(!t.route.groupedStops.every(l=>l.status==="completed"||l.isCompleted)){const l=t.route.groupedStops.filter(c=>c.status!=="completed"&&!c.isCompleted);console.warn("⚠️ Des stops ne sont pas encore complétés:",l.map(c=>({id:c.id,status:c.status,isCompleted:c.isCompleted,address:c.address}))),console.log("➡️ Finalisation forcée malgré les stops incomplets (dernier stop validé)")}const o=new Date().toISOString(),a=t.route.driverRoute;console.log('✅ Mise à jour du statut local de la route vers "completed"'),r(l=>({route:{...l.route,driverRoute:a?{...a,status:"completed",updated_at:o}:null,isActive:!1,completedAt:o}}));try{e().addPendingAction({type:"COMPLETE_ROUTE",data:{routeId:a.id,routeUpdate:{status:"completed",updated_at:o}},maxRetries:5}),console.log("📤 [completeRoute] Action de synchronisation ajoutée à la queue:",{routeId:a.id.slice(-8),status:"completed"})}catch(l){console.error("❌ Erreur lors de l'ajout de l'action de sync:",l),console.log("➡️ Finalisation locale effectuée malgré l'erreur de sync")}console.log("🏁 Route terminée avec statut local mis à jour"),e().waitForSyncAndCleanup(),console.log("ℹ️ [CompleteRoute] Recherche automatique désactivée - recharger pour nouvelle tournée")},moveToNextStop:()=>{r(t=>{const n=Math.min(t.route.currentStopIndex+1,t.route.groupedStops.length-1);return console.log(`➡️ Passage au stop ${n+1}/${t.route.groupedStops.length}`),{route:{...t.route,currentStopIndex:n},lastUpdateTime:Date.now()}})},moveToPreviousStop:()=>{r(t=>{const n=Math.max(t.route.currentStopIndex-1,0);return console.log(`⬅️ Retour au stop ${n+1}/${t.route.groupedStops.length}`),{route:{...t.route,currentStopIndex:n},lastUpdateTime:Date.now()}})},completeGroupedStop:t=>{const n=e(),o=n.route.groupedStops.find(d=>d.id===t);if(!o)throw new Error(`Stop groupé introuvable: ${t}`);if(!(o.deliveryShipments.every(d=>d.delivery_status==="completed"||d.delivery_status==="failed")&&o.pickupShipments.every(d=>d.pickup_status==="completed"||d.pickup_status==="failed")))throw new Error("Tous les colis doivent être traités avant de valider le stop");const l=new Date().toISOString();r(d=>({route:{...d.route,groupedStops:d.route.groupedStops.map(h=>h.id===t?{...h,status:"completed"}:h),rawStops:d.route.rawStops.map(h=>o.originalStopIds.includes(h.id)?{...h,completed:!0,arrival_time:l}:h)},lastUpdateTime:Date.now()}));const c=[...o.deliveryShipments,...o.pickupShipments].map(d=>({id:d.id,pickup_status:d.pickup_status,delivery_status:d.delivery_status,proof_photo_url:d.proof_photo_url,issue_type:d.issue_type,pickup_time:d.pickup_time,delivery_time:d.delivery_time}));e().addPendingAction({type:"COMPLETE_GROUPED_STOP",groupedStopId:t,data:{originalStopIds:o.originalStopIds,shipmentUpdates:c,photoUploads:o.deliveryShipments.concat(o.pickupShipments).map(d=>d.id).filter(d=>n.assets.photos.has(d))},maxRetries:3}),console.log(`✅ Stop ${t} validé`)},startUserInteraction:t=>{console.log(`🔒 [USER LOCK] Début interaction: ${t}`),r(n=>({userInteraction:{isActive:!0,lastActionTime:Date.now(),actionType:t},lastUpdateTime:Date.now()}))},endUserInteraction:()=>{console.log("🔓 [USER UNLOCK] Fin interaction"),r(t=>({userInteraction:{...t.userInteraction,isActive:!1}}))},isUserInteractionActive:()=>e().userInteraction.isActive,isRecentUserActivity:(t=1e4)=>{const n=e(),o=Date.now()-n.userInteraction.lastActionTime,a=o<t;return a&&console.log(`⏱️ [USER ACTIVITY] Activité récente: ${o}ms (seuil: ${t}ms)`),a},updateShipmentStatus:(t,n,o,a)=>{const l=new Date().toISOString();e().startUserInteraction(`shipment_${n}`),r(c=>{const d={updated_at:l};if(n==="completed_pickup"?(d.pickup_status="completed",d.pickup_time=l):n==="completed_delivery"?(d.delivery_status="completed",d.delivery_time=l):n==="failed_pickup"?(d.pickup_status="failed",a&&(d.issue_type=a)):n==="failed_delivery"?(d.delivery_status="failed",a&&(d.issue_type=a)):n==="pending_pickup"?(d.pickup_status="pending",d.pickup_time=void 0,d.issue_type=void 0):n==="pending_delivery"&&(d.delivery_status="pending",d.delivery_time=void 0,d.issue_type=void 0),o&&o.uploadUrl&&(d.proof_photo_url=o.uploadUrl),n==="failed_pickup"&&(d.delivery_status="failed",console.log(`📦 LOGIQUE MÉTIER: Pickup failed → Delivery automatiquement failed pour ${t.slice(-8)}`)),n==="completed_pickup"||n==="pending_pickup"){const x=c.route.rawShipments.find(w=>w.id===t);x&&x.delivery_status==="failed"&&x.pickup_status==="failed"&&(d.delivery_status="pending",d.issue_type=void 0,console.log(`📦 LOGIQUE MÉTIER: Pickup récupéré → Delivery remise en pending pour ${t.slice(-8)}`))}const h=c.route.rawShipments.map(x=>x.id===t?{...x,...d}:x),m=(x,w)=>x.map(S=>S.id===t&&w.find(C=>C.id===t)||S),g=c.route.groupedStops.map(x=>{const w=x.deliveryShipments.some(C=>C.id===t),S=x.pickupShipments.some(C=>C.id===t);if(!w&&!S)return x;const _={...x,deliveryShipments:m(x.deliveryShipments,h),pickupShipments:m(x.pickupShipments,h)};return _.allDeliveriesCompleted=_.deliveryShipments.every(C=>C.delivery_status==="completed"||C.delivery_status==="failed"),_.allPickupsCompleted=_.pickupShipments.every(C=>C.pickup_status==="completed"||C.pickup_status==="failed"),_});let v=c.assets.photos;return o&&(v=new Map(c.assets.photos),v.set(t,o)),console.log(`📦 Shipment ${t.slice(-8)} mis à jour: ${n}`,{shipmentUpdate:d,rawShipmentsCount:h.length,groupedStopsCount:g.length}),{route:{...c.route,rawShipments:h,groupedStops:g},assets:{...c.assets,photos:v,totalPhotos:o?c.assets.totalPhotos+1:c.assets.totalPhotos},lastUpdateTime:Date.now()}}),o&&(console.log(`📤 [updateShipmentStatus] Ajout action upload automatique pour photo ${o.id}`),e().addPendingAction({type:"UPLOAD_PHOTO",data:{photoData:o},maxRetries:5})),e().addPendingAction({type:"UPDATE_SHIPMENT_STATUS",data:{shipmentUpdate:{id:t,pickup_status:n==="completed_pickup"?"completed":n==="failed_pickup"?"failed":n==="pending_pickup"?"pending":void 0,delivery_status:n==="completed_delivery"?"completed":n==="failed_delivery"?"failed":n==="pending_delivery"?"pending":n==="failed_pickup"?"failed":void 0,pickup_time:n==="completed_pickup"?l:void 0,delivery_time:n==="completed_delivery"?l:void 0,proof_photo_url:o?.uploadUrl,issue_type:a,updated_at:l}},maxRetries:3}),console.log(`📦 Shipment ${t} mis à jour: ${n}${a?` (${a})`:""}${o?" avec photo":""}`),setTimeout(()=>{e().endUserInteraction()},2e3)},updateShipmentFields:(t,n)=>{console.log(`📦 [updateShipmentFields] DÉBUT mise à jour shipment ${t.slice(-8)}:`,n),r(o=>{const a=o.route.rawShipments.map(c=>c.id===t?{...c,...n}:c),l=o.route.groupedStops.map(c=>({...c,deliveryShipments:c.deliveryShipments.map(d=>d.id===t?{...d,...n}:d),pickupShipments:c.pickupShipments.map(d=>d.id===t?{...d,...n}:d)}));return console.log("✅ [updateShipmentFields] Nouvel état créé, déclenchement re-render"),{route:{...o.route,rawShipments:a,groupedStops:l},lastUpdateTime:Date.now()}}),console.log(`✅ [updateShipmentFields] Shipment ${t.slice(-8)} mis à jour avec succès`)},updateReferenceData:(t,n,o)=>{const a=new Map(t.map(d=>[d.id,d])),l=new Map(n.map(d=>[d.id,d])),c=new Map(o.map(d=>[d.id,d]));r(d=>({referenceData:{locations:a,laboratories:l,laboratoryClients:c,lastRefreshTime:Date.now()},lastUpdateTime:Date.now()})),console.log(`📚 Données référence mises à jour: ${t.length} locations, ${n.length} labs, ${o.length} clients`)},addPendingAction:t=>{const n={id:V2(),timestamp:Date.now(),retryCount:0,status:"pending",...t};r(o=>({sync:{...o.sync,pendingActions:[...o.sync.pendingActions,n]},lastUpdateTime:Date.now()})),console.log(`🔄 Action sync ajoutée: ${n.type} (${n.id})`)},markActionAsCompleted:t=>{r(n=>({sync:{...n.sync,pendingActions:n.sync.pendingActions.map(o=>o.id===t?{...o,status:"completed"}:o)}}))},markActionAsFailed:(t,n)=>{r(o=>({sync:{...o.sync,pendingActions:o.sync.pendingActions.map(a=>a.id===t?{...a,status:"failed",error:n}:a),failedActions:[...o.sync.failedActions,...o.sync.pendingActions.filter(a=>a.id===t)]}}))},updateSyncActionStatus:(t,n,o)=>{r(a=>({sync:{...a.sync,pendingActions:a.sync.pendingActions.map(l=>l.id===t?{...l,status:n,error:o}:l)}}))},incrementSyncActionRetry:t=>{r(n=>({sync:{...n.sync,pendingActions:n.sync.pendingActions.map(o=>o.id===t?{...o,retryCount:o.retryCount+1}:o)}}))},retryFailedAction:t=>{r(n=>({sync:{...n.sync,pendingActions:n.sync.pendingActions.map(o=>o.id===t?{...o,status:"pending",retryCount:o.retryCount+1}:o)}}))},clearCompletedActions:()=>{r(t=>({sync:{...t.sync,pendingActions:t.sync.pendingActions.filter(n=>n.status!=="completed"),failedActions:[]}}))},clearFailedActions:()=>{r(t=>({sync:{...t.sync,pendingActions:t.sync.pendingActions.filter(n=>n.status!=="failed"),failedActions:[]}})),console.log("🧹 Actions échouées nettoyées")},clearAllSyncActions:()=>{const t=e(),n=Date.now(),o=t.sync.pendingActions.filter(a=>n-a.timestamp>300*1e3);console.log("🧹 [clearAllSyncActions] Nettoyage actions de sync:",{totalPendingActions:t.sync.pendingActions.length,totalFailedActions:t.sync.failedActions.length,oldActionsCount:o.length,oldestAction:o.length>0?Math.round((n-Math.min(...o.map(a=>a.timestamp)))/(60*1e3))+" minutes":"aucune"}),r(a=>({sync:{...a.sync,pendingActions:[],failedActions:[],isSyncing:!1,lastSyncTime:n},lastUpdateTime:n})),console.log("✅ [clearAllSyncActions] Toutes les actions de sync ont été nettoyées")},safeCleanupActions:()=>{const t=e(),n=Date.now(),o=t.route.driverRoute;console.log("🛡️ [safeCleanupActions] Début nettoyage sécurisé:",{totalPendingActions:t.sync.pendingActions.length,totalFailedActions:t.sync.failedActions.length,hasActiveRoute:!!o,routeId:o?.id});let a=[];const l=[];o?a=t.sync.pendingActions.filter(c=>{const d=c.status==="completed";return c.status==="pending"||c.status,d?(l.push(c),!1):!0}):a=t.sync.pendingActions.filter(d=>{const m=n-d.timestamp>864e5;return d.status==="completed"||m?(l.push(d),!1):!0}),l.length>0?(console.log(`🧹 [safeCleanupActions] Suppression de ${l.length} actions sécurisées:`,{completed:l.filter(c=>c.status==="completed").length,oldSession:l.filter(c=>n-c.timestamp>1440*60*1e3).length}),r(c=>({sync:{...c.sync,pendingActions:a,failedActions:[]},lastUpdateTime:n})),console.log("✅ [safeCleanupActions] Nettoyage sécurisé terminé")):console.log("ℹ️ [safeCleanupActions] Aucune action à nettoyer de façon sécurisée")},clearStaleActions:()=>{const t=e(),n=Date.now(),o=7200*1e3,a=t.sync.pendingActions.filter(c=>n-c.timestamp<=o),l=t.sync.pendingActions.length-a.length;l>0&&(console.log(`🧹 [clearStaleActions] Suppression de ${l} action(s) anciennes`),r(c=>({sync:{...c.sync,pendingActions:a,failedActions:[]},lastUpdateTime:n})))},getPendingActions:()=>e().sync.pendingActions.filter(n=>n.status==="pending"),setOnlineStatus:t=>{r(n=>({sync:{...n.sync,isOnline:t,lastSyncTime:t?Date.now():n.sync.lastSyncTime}})),console.log(`🌐 Statut connexion mis à jour: ${t?"En ligne":"Hors ligne"}`)},detectCriticalInconsistencies:()=>{const t=e(),n=[];if(t.route.driverRoute){const l=Date.now()-new Date(t.route.driverRoute.updated_at).getTime(),c=1440*60*1e3;l>c&&n.push(`Route trop ancienne (${Math.round(l/(3600*1e3))}h)`)}const o=t.sync.failedActions.filter(l=>l.retryCount>=l.maxRetries&&(l.type==="START_ROUTE"||l.type==="COMPLETE_ROUTE"));o.length>0&&n.push(`${o.length} action(s) critique(s) échouée(s)`);const a=t.sync.pendingActions.filter(l=>Date.now()-l.timestamp>1800*1e3);return a.length>0&&n.push(`${a.length} action(s) bloquée(s) depuis > 30min`),n},forceFullResync:async()=>{console.log("🔄 Déclenchement d'une resynchronisation complète...");const t=e(),n=t.sync.failedActions.map(o=>({...o,status:"pending",retryCount:0,error:void 0}));r(o=>({sync:{...o.sync,failedActions:[],pendingActions:[...o.sync.pendingActions.filter(a=>a.status!=="failed"),...n]}})),t.sync.isOnline&&setTimeout(()=>{ct(async()=>{const{syncService:o}=await Promise.resolve().then(()=>K2);return{syncService:o}},void 0).then(({syncService:o})=>{o.triggerSync()})},100)},addPhoto:(t,n)=>{const o=e(),a=50,l=100,c=Array.from(o.assets.photos.values()),d=c.reduce((g,v)=>g+v.localPath.length*.75/(1024*1024),0);console.log(`📸 [addPhoto] État avant ajout: ${c.length} photos, ~${Math.round(d)}MB`),c.length>=a&&(console.warn(`⚠️ [addPhoto] Limite de ${a} photos atteinte, nettoyage forcé`),setTimeout(()=>{e().safeCleanupUploadedPhotos(!0).catch(console.warn)},100)),d>=l&&(console.warn(`⚠️ [addPhoto] Limite de ${l}MB atteinte, nettoyage forcé`),setTimeout(()=>{e().safeCleanupUploadedPhotos(!0).catch(console.warn)},100)),r(g=>{const v=new Map(g.assets.photos);return v.set(t,n),{assets:{...g.assets,photos:v,uploadQueue:[...g.assets.uploadQueue,n],totalPhotos:g.assets.totalPhotos+1}}});const h=n.localPath.length*.75/(1024*1024);console.log(`📸 Photo ajoutée pour shipment ${t} (~${Math.round(h*100)/100}MB)`),d+h>l*.8&&(console.log("🧹 [addPhoto] Déclenchement nettoyage préventif en arrière-plan"),setTimeout(()=>{e().safeCleanupUploadedPhotos(!1).catch(console.warn)},2e3))},markPhotoUploaded:(t,n)=>{r(o=>{const a=new Map(o.assets.photos),l=Array.from(a.values()).find(c=>c.id===t);return l&&a.set(l.shipmentId,{...l,uploaded:!0,uploadUrl:n}),{assets:{...o.assets,photos:a,uploadQueue:o.assets.uploadQueue.filter(c=>c.id!==t),uploadedPhotos:o.assets.uploadedPhotos+1}}}),console.log(`📤 Photo ${t} uploadée: ${n}`),setTimeout(async()=>{if(e().assets.isCleaningPhotos)console.log("ℹ️ [markPhotoUploaded] Nettoyage déjà en cours, skip");else try{console.log(`🧹 [markPhotoUploaded] Déclenchement nettoyage différé pour photo ${t}`);const a=await e().safeCleanupUploadedPhotos(!1);a.cleaned>0&&console.log(`🧹 [markPhotoUploaded] Nettoyage automatique: ${a.cleaned} photos nettoyées`)}catch(a){console.warn("⚠️ [markPhotoUploaded] Erreur lors du nettoyage automatique:",a)}},8e3)},analyzeStoredPhotos:()=>{const t=e(),n=Array.from(t.assets.photos.values()),o={total:n.length,uploaded:n.filter(a=>a.uploaded).length,pending:n.filter(a=>!a.uploaded).length,totalSizeEstimate:0,uploadedPhotos:[],pendingPhotos:[]};return n.forEach(a=>{const c=a.localPath.length*.75;o.totalSizeEstimate+=c,a.uploaded?o.uploadedPhotos.push(a):o.pendingPhotos.push(a)}),console.log("📊 [analyzeStoredPhotos] Analyse des photos en mémoire:",{...o,totalSizeMB:Math.round(o.totalSizeEstimate/(1024*1024)*100)/100,uploadedPhotos:o.uploadedPhotos.map(a=>({id:a.id,shipmentId:a.shipmentId,uploaded:a.uploaded,hasUploadUrl:!!a.uploadUrl})),pendingPhotos:o.pendingPhotos.map(a=>({id:a.id,shipmentId:a.shipmentId,uploaded:a.uploaded}))}),o},verifyPhotosUploadStatus:async()=>{const t=e(),n=Array.from(t.assets.photos.values()).filter(d=>d.uploaded&&d.uploadUrl);if(n.length===0)return console.log("ℹ️ [verifyPhotosUploadStatus] Aucune photo uploadée à vérifier"),{verified:0,accessible:0,notAccessible:0};console.log(`🔍 [verifyPhotosUploadStatus] Vérification de ${n.length} photos uploadées...`);let o=0,a=0;const l=[];for(const d of n.slice(0,10))try{const h=new AbortController,m=setTimeout(()=>h.abort(),5e3),g=await fetch(d.uploadUrl,{method:"HEAD",signal:h.signal});clearTimeout(m),g.ok?(o++,l.push(d.shipmentId)):(a++,console.warn(`⚠️ Photo ${d.id} non accessible: ${g.status}`))}catch(h){a++,h instanceof Error&&h.name==="AbortError"?console.warn(`⚠️ Timeout vérification photo ${d.id} (réseau lent)`):console.warn(`⚠️ Erreur vérification photo ${d.id}:`,h)}const c={verified:n.length,accessible:o,notAccessible:a,photosToCleanup:l};return console.log("✅ [verifyPhotosUploadStatus] Vérification terminée:",c),c},safeCleanupUploadedPhotos:async(t=!1)=>{const n=e();if(n.assets.isCleaningPhotos)return console.log("ℹ️ [safeCleanupUploadedPhotos] Nettoyage déjà en cours, abandon"),{cleaned:0,kept:0};r(o=>({assets:{...o.assets,isCleaningPhotos:!0}}));try{if(!t){const d=await e().verifyPhotosUploadStatus();if(d.accessible===0)return console.log("ℹ️ [safeCleanupUploadedPhotos] Aucune photo accessible confirmée, nettoyage annulé"),{cleaned:0,kept:d.verified}}const o=Array.from(n.assets.photos.values()).filter(d=>d.uploaded&&d.uploadUrl);if(o.length===0)return console.log("ℹ️ [safeCleanupUploadedPhotos] Aucune photo uploadée à nettoyer"),{cleaned:0,kept:0};console.log(`🧹 [safeCleanupUploadedPhotos] Début nettoyage de ${o.length} photos uploadées...`);let a=0,l=0;const c=[];for(const d of o.slice(0,20))try{if(d.uploaded&&d.uploadUrl){let h=t;if(!t)try{const m=new AbortController,g=setTimeout(()=>m.abort(),3e3),v=await fetch(d.uploadUrl,{method:"HEAD",signal:m.signal});clearTimeout(g),h=v.ok}catch(m){m instanceof Error&&m.name==="AbortError"&&console.warn(`⚠️ Timeout cleanup photo ${d.id} (réseau lent)`),h=!1}h?(c.push(d.shipmentId),a++,console.log(`🗑️ Photo ${d.id} marquée pour nettoyage (shipment: ${d.shipmentId})`)):(l++,console.log(`📌 Photo ${d.id} conservée (non accessible)`))}else l++}catch(h){l++,console.warn(`⚠️ Erreur lors de la vérification de la photo ${d.id}:`,h)}return c.length>0?(r(d=>{const h=new Map(d.assets.photos);return c.forEach(m=>{h.delete(m)}),{assets:{...d.assets,photos:h,totalPhotos:Math.max(0,d.assets.totalPhotos-c.length)}}}),console.log(`✅ [safeCleanupUploadedPhotos] ${a} photos nettoyées, ${l} conservées`)):console.log("ℹ️ [safeCleanupUploadedPhotos] Aucune photo confirmée pour nettoyage"),{cleaned:a,kept:l}}catch(o){return console.error("❌ [safeCleanupUploadedPhotos] Erreur lors du nettoyage:",o),{cleaned:0,kept:0}}finally{r(o=>({assets:{...o.assets,isCleaningPhotos:!1}}))}},getPhotoStorageDiagnostic:async()=>{const t=e(),n=e().analyzeStoredPhotos(),o=n.totalSizeEstimate/(1024*1024),a=n.total>0?o/n.total:0,c=o*1.3,d=t.sync.pendingActions.filter(v=>v.type==="UPLOAD_PHOTO"&&v.status==="pending").length,h=t.sync.failedActions.filter(v=>v.type==="UPLOAD_PHOTO").length;let m=null;try{m=await e().verifyPhotosUploadStatus()}catch(v){console.warn("⚠️ [getPhotoStorageDiagnostic] Erreur vérification upload:",v)}const g={stats:n,storage:{totalMB:Math.round(o*100)/100,estimatedLocalForageMB:Math.round(c*100)/100,avgPhotoSizeMB:Math.round(a*100)/100},sync:{pendingUploadActions:d,failedUploadActions:h,hasUploadIssues:h>0||d>5},uploadVerification:m,alerts:[],recommendations:[]};return o>100&&g.alerts.push(`Stockage élevé: ${g.storage.totalMB}MB`),n.total>50&&g.alerts.push(`Nombre élevé de photos: ${n.total}`),d>10&&g.alerts.push(`Uploads en attente: ${d}`),h>0&&g.alerts.push(`Uploads échoués: ${h}`),n.uploaded>20&&g.recommendations.push("Nettoyage des photos uploadées recommandé"),o>80&&g.recommendations.push("Stockage critique - action immédiate requise"),g.sync.hasUploadIssues&&g.recommendations.push("Vérifier la connexion internet"),n.pending>n.uploaded&&g.recommendations.push("Trop de photos en attente d'upload"),console.log("🔍 [getPhotoStorageDiagnostic] Diagnostic complet:",g),g},getCurrentGroupedStop:()=>{const t=e();return t.route.groupedStops[t.route.currentStopIndex]||null},getShipmentById:t=>e().route.rawShipments.find(o=>o.id===t)||null,refreshRouteShipments:async()=>{const t=e(),n=t.route.driverRoute?.id;if(!n){console.warn("⚠️ Aucune route active pour rafraîchir les shipments");return}try{console.log("🔄 Rafraîchissement des shipments pour route:",n);const{supabase:o}=await ct(async()=>{const{supabase:x}=await Promise.resolve().then(()=>Ts);return{supabase:x}},void 0),{data:a,error:l}=await o.from("driver_route_shipments").select("*").eq("route_id",n).order("created_at",{ascending:!0});if(l)throw l;if(!a){console.warn("⚠️ Aucun shipment trouvé pour la route");return}console.log(`📦 ${a.length} shipments récupérés depuis Supabase`);const c=a.filter(x=>x.unexpected===!0);c.length>0&&console.log(`🆕 ${c.length} shipment(s) inattendu(s) détecté(s):`,c.map(x=>({id:x.id.slice(-8),pickupStopId:x.pickup_stop_id?.slice(-8),deliveryStopId:x.delivery_stop_id?.slice(-8),laboratoryId:x.laboratory_id?.slice(-8)})));const d={locations:t.referenceData.locations,laboratories:t.referenceData.laboratories,laboratoryClients:t.referenceData.laboratoryClients,shipmentsByStopId:new Map},h=po(t.route.rawStops,a,d),g={before:t.route.groupedStops.length,after:h.length,stopsWithNewShipments:h.filter(x=>x.deliveryShipments.some(w=>w.unexpected===!0)||x.pickupShipments.some(w=>w.unexpected===!0)).length},v=iu(h);r(x=>({route:{...x.route,rawShipments:a,groupedStops:h,currentStopIndex:v},lastUpdateTime:Date.now()})),console.log(`✅ Shipments rafraîchis: ${a.length} shipments, ${h.length} stops groupés`),console.log(`📍 Index actuel recalculé: ${v}`),c.length>0&&(console.log("🎯 Impact regroupement:",g),console.log("📦 Les shipments inattendus devraient maintenant être visibles dans leurs stops de destination"))}catch(o){throw console.error("❌ Erreur lors du rafraîchissement des shipments:",o),o}},refreshAllReferenceData:async()=>{try{console.log("🌍 Rafraîchissement de toutes les données de référence...");const{supabase:t}=await ct(async()=>{const{supabase:m}=await Promise.resolve().then(()=>Ts);return{supabase:m}},void 0),[n,o,a]=await Promise.allSettled([t.from("locations").select("*"),t.from("laboratories").select("*"),t.from("laboratory_clients").select("*")]),l=n.status==="fulfilled"&&!n.value.error?n.value.data||[]:[],c=o.status==="fulfilled"&&!o.value.error?o.value.data||[]:[],d=a.status==="fulfilled"&&!a.value.error?a.value.data||[]:[];return console.log(`✅ Toutes les données de référence rafraîchies: ${l.length} locations, ${c.length} labs, ${d.length} clients`),e().updateReferenceData(l,c,d),console.log("🎯 Store mis à jour avec toutes les données de référence"),{success:!0,counts:{locations:l.length,laboratories:c.length,clients:d.length}}}catch(t){return console.error("❌ Erreur lors du rafraîchissement de toutes les données de référence:",t),{success:!1,error:t instanceof Error?t.message:"Erreur inconnue"}}},_debug_forceRegroup:()=>{console.log("🔄 Force regroupement des stops");const t=e();if(!t.route.driverRoute){console.warn("⚠️ Aucune route active");return}const n={locations:t.referenceData.locations,laboratories:t.referenceData.laboratories,laboratoryClients:t.referenceData.laboratoryClients},o=po(t.route.rawStops,t.route.rawShipments,n);r({route:{...t.route,groupedStops:o},lastUpdateTime:Date.now()}),console.log("✅ Regroupement forcé terminé")},_debug_logState:()=>{const t=e();console.group("🏪 État du Store Principal (Debug)"),console.log("Route:",t.route),console.log("Reference Data:",t.referenceData),console.log("Sync:",t.sync),console.log("Assets:",t.assets),console.groupEnd()},resetRouteForTesting:()=>{console.log("🔄 Réinitialisation de la route pour les tests"),r(t=>{const n=t.route.rawShipments.map(l=>({...l,pickup_status:"pending",delivery_status:"pending",pickup_time:void 0,delivery_time:void 0,proof_photo_url:void 0,issue_type:void 0})),o=t.route.groupedStops.map(l=>({...l,status:"pending",allDeliveriesCompleted:!1,allPickupsCompleted:!1,deliveryShipments:l.deliveryShipments.map(c=>n.find(d=>d.id===c.id)||c),pickupShipments:l.pickupShipments.map(c=>n.find(d=>d.id===c.id)||c)})),a=t.route.rawStops.map(l=>({...l,completed:!1,arrival_time:void 0}));return{route:{...t.route,rawShipments:n,groupedStops:o,rawStops:a,currentStopIndex:0,isActive:!0,startedAt:new Date().toISOString()},assets:{...t.assets,photos:new Map,uploadQueue:[],totalPhotos:0,uploadedPhotos:0,isCleaningPhotos:!1},sync:{...t.sync,pendingActions:[],failedActions:[]},lastUpdateTime:Date.now()}}),console.log("✅ Route réinitialisée avec succès")},_debug_forceNewArchitecture:(t=!0)=>{const n=e(),{driverRoute:o,rawStops:a,rawShipments:l}=n.route;if(!o||!a.length){console.log("❌ Aucune route active à tester");return}console.log(`🧪 [DEBUG] Test forcé: ${t?"Nouvelle":"Ancienne"} architecture`);const c=t?Cw(a,l,{locations:n.referenceData.locations,laboratories:n.referenceData.laboratories,laboratoryClients:n.referenceData.laboratoryClients}):po(a,l,{locations:n.referenceData.locations,laboratories:n.referenceData.laboratories,laboratoryClients:n.referenceData.laboratoryClients}),d=iu(c),h=new Map;c.forEach(g=>{h.set(g.id,g.originalStopIds)}),r(g=>({route:{...g.route,groupedStops:c,currentStopIndex:d,stopMapping:h},lastUpdateTime:Date.now()})),console.log(`🧪 Test appliqué (${t?"Backend fusionné (forcé)":"Frontend groupé (forcé)"}): ${a.length} stops → ${c.length} groupés`),console.log(`📍 Nouvel index: ${d}/${c.length-1}`)},checkRouteValidity:()=>{const t=e();if(!t.route.driverRoute)return!0;const n=t.route.driverRoute.status,o=t.route.driverRoute.id;if(console.log("🔍 [SIMPLIFIÉ] Vérification validité route:",{routeId:o.slice(-8),routeStatus:n}),n==="in_progress"||n==="completed")return console.log(`✅ [SIMPLIFIÉ] Route ${n} préservée`),!0;const a=Date.now()-new Date(t.route.driverRoute.updated_at).getTime(),l=1440*60*1e3;return n==="validated"&&a>l?(console.log("❌ [SIMPLIFIÉ] Route validated trop ancienne - nettoyage"),e().clearRoute(),!1):(console.log(`✅ [SIMPLIFIÉ] Route ${n} encore valide`),!0)},clearRoute:()=>{console.log("🧹 Nettoyage de la route active"),r(t=>({route:du(),lastUpdateTime:Date.now()}))},searchForNextRoute:async()=>{const t=e();if(!t.currentDriverId){console.log("⚠️ Pas de driver ID, impossible de chercher une nouvelle tournée");return}if(t.route.isActive&&t.route.driverRoute?.status!=="completed"){console.log("ℹ️ Route active non terminée, pas de recherche nécessaire");return}console.log("🔍 [SIMPLIFIÉ] Recherche d'une nouvelle tournée validated...");try{const{supabase:n}=await ct(async()=>{const{supabase:d}=await Promise.resolve().then(()=>Ts);return{supabase:d}},void 0),{formatLocalDateISO:o}=await ct(async()=>{const{formatLocalDateISO:d}=await Promise.resolve().then(()=>R2);return{formatLocalDateISO:d}},void 0),a=o(new Date);console.log("🔍 [SIMPLIFIÉ] Recherche pour la date:",a);const{data:l,error:c}=await n.from("driver_routes").select("*").eq("driver_id",t.currentDriverId).eq("date",a).in("status",["validated","in_progress"]).order("updated_at",{ascending:!1}).limit(1);if(c){console.error("❌ Erreur recherche nouvelle tournée:",c);return}if(l&&l.length>0){const d=l[0];if(t.route.driverRoute?.id===d.id){console.log("ℹ️ Même route trouvée, pas de nouvelle tournée disponible");return}console.log("🎉 Nouvelle tournée trouvée:",d.id,"pour le",a),console.log("📋 Statut:",d.status,"- Mise à jour:",d.updated_at);const[h,m]=await Promise.all([n.from("driver_route_stops").select("*").eq("route_id",d.id).order("stop_order",{ascending:!0}),n.from("driver_route_shipments").select("*").eq("route_id",d.id)]);if(h.error||m.error){console.error("❌ Erreur récupération données nouvelle tournée");return}const g=h.data||[],v=m.data||[];if(g.length===0){console.log("⚠️ Nouvelle route sans stops, ignorée");return}console.log("✅ Chargement de la nouvelle tournée..."),console.log(`📍 ${g.length} stops, 📦 ${v.length} shipments`),await e().setActiveRoute(d,g,v),console.log("🎉 Nouvelle tournée chargée avec succès !")}else console.log("ℹ️ Aucune nouvelle tournée trouvée pour",a)}catch(n){console.error("❌ Erreur lors de la recherche de nouvelle tournée:",n)}},initializeUnexpectedPickups:async()=>{const t=e();if(!t.route.driverRoute||!t.route.groupedStops.length){console.warn("⚠️ Impossible d'initialiser unexpected pickups sans route active");return}console.log("🔄 Initialisation du sous-store unexpected pickups...");try{const{supabase:n}=await ct(async()=>{const{supabase:m}=await Promise.resolve().then(()=>Ts);return{supabase:m}},void 0),a=t.route.groupedStops.map(m=>m.location_id).filter(m=>{const g=t.referenceData.locations.get(m);return g&&(g.type==="dentist_client"||g.type==="lab_client")});if(a.length===0){console.log("ℹ️ Aucune location client trouvée, initialisation terminée"),r(m=>({unexpectedPickups:{...m.unexpectedPickups,isInitialized:!0,lastRefreshTime:Date.now()}}));return}const{data:l,error:c}=await n.from("laboratory_clients").select(`
              id,
              laboratory_id,
              location_id,
              name,
              laboratories!inner(
                id,
                name
              )
            `).in("location_id",a);if(c){console.error("❌ Erreur récupération laboratory_clients:",c),r(m=>({unexpectedPickups:{...m.unexpectedPickups,isInitialized:!0,lastRefreshTime:Date.now()}}));return}const d=new Map;(l||[]).forEach(m=>{const g=m.location_id;d.has(g)||d.set(g,[]),d.get(g).push({id:m.id,laboratory_id:m.laboratory_id,laboratory_name:m.laboratories?.name||"Laboratoire inconnu",client_name:m.name||"Client inconnu"})});const h=new Map;for(const m of t.route.groupedStops)if(m.type==="client_grouped"||m.type==="client_single"){const g=d.get(m.location_id)||[];if(g.length>0)try{const v=await e().checkEligibleLabsForStop(m.location_id,g);h.set(m.id,{stopId:m.id,locationId:m.location_id,eligibleLabs:v,hasButton:v.length>0,lastChecked:Date.now()})}catch(v){console.error(`❌ Erreur vérification éligibilité stop ${m.id}:`,v)}}r(m=>({unexpectedPickups:{...m.unexpectedPickups,eligibilityByStop:h,isInitialized:!0,lastRefreshTime:Date.now(),laboratoryClientsByLocation:d}})),console.log(`✅ Sous-store unexpected initialisé avec ${h.size} stops`)}catch(n){console.error("❌ Erreur initialisation unexpected pickups:",n),r(o=>({unexpectedPickups:{...o.unexpectedPickups,isInitialized:!0,lastRefreshTime:Date.now()}}))}},checkEligibleLabsForStop:async(t,n)=>{e();const o=[];try{const{supabase:a}=await ct(async()=>{const{supabase:m}=await Promise.resolve().then(()=>Ts);return{supabase:m}},void 0),l=new Date,c=l.getHours();let d;c<12?(d=new Date(l),d.setDate(d.getDate()-1)):d=new Date(l);const h=wi(d);for(const m of n)await e().checkScheduledPickupForLab(m.laboratory_id,t,h)||o.push({id:m.laboratory_id,name:m.laboratory_name,laboratory_client_id:m.id,client_name:m.client_name})}catch(a){console.error("❌ Erreur vérification éligibilité labs:",a)}return o},checkScheduledPickupForLab:async(t,n,o)=>{const a=e();try{if(console.log("🔍 [checkScheduledPickupForLab] Vérification pour:",{laboratoryId:t,locationId:n,todayStr:o}),a.route.driverRoute&&a.route.rawShipments.length>0&&(console.log("🔍 [checkScheduledPickupForLab] Vérification dans la tournée actuelle..."),a.route.rawShipments.find(w=>{const S=w.shipment_type==="client_pickup",_=w.laboratory_id===t,C=a.route.rawStops.find(N=>N.id===w.pickup_stop_id&&N.location_id===n),E=S&&_&&!!C;return E&&console.log("✅ [checkScheduledPickupForLab] Shipment trouvé dans la tournée actuelle:",{shipmentId:w.id,shipmentType:w.shipment_type,laboratoryId:w.laboratory_id,pickupStopId:w.pickup_stop_id,locationId:C?.location_id}),E})))return console.log("❌ [checkScheduledPickupForLab] Retour déjà programmé dans la tournée actuelle"),!0;const{supabase:l}=await ct(async()=>{const{supabase:x}=await Promise.resolve().then(()=>Ts);return{supabase:x}},void 0);console.log("🔍 [checkScheduledPickupForLab] Vérification dans lab_tour_shipments...");const{data:c,error:d}=await l.from("lab_tour_shipments").select(`
              id,
              lab_tour_id,
              lab_tours!inner(
                laboratory_id
              )
            `).eq("lab_tours.laboratory_id",t).eq("from_location_id",n).eq("shipment_type","client_to_lab").eq("scheduled_date",o);if(d)return console.error("❌ [checkScheduledPickupForLab] Erreur vérification lab_tour_shipments:",d),!1;if(c&&c.length>0)return console.log("❌ [checkScheduledPickupForLab] Retour programmé dans lab_tour_shipments"),!0;console.log("🔍 [checkScheduledPickupForLab] Vérification des unexpected shipments...");const{data:h,error:m}=await l.from("driver_route_shipments").select(`
              id,
              laboratory_id,
              pickup_stop_id,
              driver_route_stops!inner(
                id,
                location_id
              ),
              unexpected
            `).eq("laboratory_id",t).eq("driver_route_stops.location_id",n).eq("unexpected",!0).gte("created_at",o+"T00:00:00Z").lt("created_at",o+"T23:59:59Z");if(m)return console.error("❌ [checkScheduledPickupForLab] Erreur vérification unexpected shipments:",m),!1;if(h&&h.length>0)return console.log("❌ [checkScheduledPickupForLab] Shipment unexpected déjà créé"),!0;const g=`${t}_${n}`;return(a.unexpectedPickups.createdUnexpectedShipments instanceof Set?a.unexpectedPickups.createdUnexpectedShipments:new Set(Object.keys(a.unexpectedPickups.createdUnexpectedShipments||{}))).has(g)?(console.log("❌ [checkScheduledPickupForLab] Shipment marqué comme créé dans le cache"),!0):(console.log("✅ [checkScheduledPickupForLab] Laboratoire éligible (aucun retour programmé)"),!1)}catch(l){return console.error("❌ [checkScheduledPickupForLab] Erreur:",l),!1}},getEligibleLabsForStop:t=>{const o=e().unexpectedPickups.eligibilityByStop.get(t);if(!o)return{eligibleLabs:[],hasButton:!1,needsRefresh:!0};const l=Date.now()-o.lastChecked>300*1e3;return{eligibleLabs:o.eligibleLabs,hasButton:o.hasButton,needsRefresh:l}},refreshEligibilityForStop:async t=>{const n=e(),o=n.route.groupedStops.find(c=>c.id===t);if(!o){console.warn("⚠️ Stop non trouvé pour rafraîchissement:",t);return}const a=n.unexpectedPickups.laboratoryClientsByLocation.get(o.location_id)||[];if(a.length===0){console.log("ℹ️ Aucun client pour cette location, pas de rafraîchissement nécessaire");return}const l=await e().checkEligibleLabsForStop(o.location_id,a);r(c=>({unexpectedPickups:{...c.unexpectedPickups,eligibilityByStop:new Map(c.unexpectedPickups.eligibilityByStop.set(t,{stopId:t,locationId:o.location_id,eligibleLabs:l,hasButton:l.length>0,lastChecked:Date.now()}))}}))},markUnexpectedShipmentCreated:(t,n)=>{const o=`${t}_${n}`;console.log("🚫 [markUnexpectedShipmentCreated] Marquage shipment comme créé:",{laboratoryId:t.slice(-8),locationId:n.slice(-8),cacheKey:o}),r(c=>{const d=c.unexpectedPickups.createdUnexpectedShipments instanceof Set?c.unexpectedPickups.createdUnexpectedShipments:new Set(Object.keys(c.unexpectedPickups.createdUnexpectedShipments||{}));return console.log("🔍 [markUnexpectedShipmentCreated] État actuel du Set:",{isSet:d instanceof Set,size:d.size,type:typeof c.unexpectedPickups.createdUnexpectedShipments}),{unexpectedPickups:{...c.unexpectedPickups,createdUnexpectedShipments:new Set([...d,o])}}});const l=e().route.groupedStops.filter(c=>c.location_id===n).map(c=>c.id);console.log("🔄 [markUnexpectedShipmentCreated] Rafraîchissement des stops:",{locationId:n.slice(-8),stopsToRefresh:l.map(c=>c.slice(-8))}),l.forEach(c=>{e().refreshEligibilityForStop(c)}),console.log("✅ [markUnexpectedShipmentCreated] Bouton devrait maintenant être masqué")},addUnexpectedShipmentToStore:t=>{console.log("⚡ [addUnexpectedShipmentToStore] Ajout immédiat du shipment:",{shipmentId:t.id.slice(-8),pickupStopId:t.pickup_stop_id?.slice(-8),deliveryStopId:t.delivery_stop_id?.slice(-8)}),r(n=>{const o=[...n.route.rawShipments,t],a={locations:n.referenceData.locations,laboratories:n.referenceData.laboratories,laboratoryClients:n.referenceData.laboratoryClients},l=po(n.route.rawStops,o,a);return console.log("✅ [addUnexpectedShipmentToStore] Regroupement effectué:",{rawShipmentsCount:o.length,groupedStopsCount:l.length}),{route:{...n.route,rawShipments:o,groupedStops:l},lastUpdateTime:Date.now()}})},resetUnexpectedShipmentsCache:()=>{r(t=>({unexpectedPickups:{...t.unexpectedPickups,createdUnexpectedShipments:new Set}}))},removeOldPhotos:t=>{r(n=>{const o=new Map(n.assets.photos);return t.forEach(a=>{o.delete(a)}),{assets:{...n.assets,photos:o}}}),console.log(`🧹 [Store] ${t.length} photos anciennes supprimées du store`)},preserveUserContextOnLateStops:(t,n)=>{const a=e().route.currentStopIndex,l=n[a]?.id;if(!l)return console.log("🤷 Aucun stop courant à préserver"),a;const c=t.findIndex(d=>d.id===l);if(c!==-1)return console.log(`📍 Contexte préservé: Stop "${l}" déplacé de l'index ${a} → ${c}`),r(d=>({route:{...d.route,currentStopIndex:c}})),c;{const d=n[a]?.orderRange[0]||0;let h=0,m=1/0;return t.forEach((g,v)=>{const x=Math.abs(g.orderRange[0]-d);x<m&&(m=x,h=v)}),console.log(`📍 Stop courant non trouvé, passage au plus proche: index ${h} (ordre ${t[h]?.orderRange[0]})`),r(g=>({route:{...g.route,currentStopIndex:h}})),h}},setActiveRouteWithLateStopSupport:(t,n,o)=>{const a=e(),l=a.route.groupedStops,c=a.route.isActive;console.log("🔄 [setActiveRouteWithLateStopSupport] Configuration route avec support late stops");const d=n.filter(w=>w.is_late_stop),h=d.length>0;h&&console.log(`🆕 ${d.length} late stop(s) détecté(s):`,d.map(w=>({id:w.id.slice(-8),order:w.stop_order,location:w.location_id})));const m=po(n,o,{locations:a.referenceData.locations,laboratories:a.referenceData.laboratories,laboratoryClients:a.referenceData.laboratoryClients});let g=0;c&&l.length>0&&h?g=e().preserveUserContextOnLateStops(m,l):g=iu(m);const v=new Map;m.forEach(w=>{v.set(w.id,w.originalStopIds)}),r(w=>({route:{driverRoute:t,rawStops:n,rawShipments:o,groupedStops:m,currentStopIndex:g,isActive:!0,routeInitializedAt:new Date().toISOString(),stopMapping:v},lastUpdateTime:Date.now()}));const x=m.some(w=>w.hasLateStops||w.isLateStop);console.log(`✅ Route configurée: ${n.length} stops → ${m.length} groupés`),console.log(`📍 Index courant: ${g}/${m.length-1}`),x&&console.log("🆕 Route contient des late stops - contexte utilisateur préservé")},syncDataInBackground:async(t,n,o)=>{console.log("🔄 [syncDataInBackground] Début synchronisation discrète...");const a=e();if(a.isUserInteractionActive()||a.isRecentUserActivity(15e3)){console.log("🔒 [syncDataInBackground] BLOQUÉ - Utilisateur actif, sync reportée");return}const l=a.route.driverRoute,c=l&&(l.status==="in_progress"||l.status==="completed")&&t.status==="validated",d=c?{...t,status:l.status,updated_at:l.updated_at}:t;c&&console.log(`🛡️ [syncDataInBackground] PROTECTION: Préservation statut local '${l.status}' contre '${t.status}' de Supabase`);const h=o.map(g=>{const v=a.route.rawShipments.find(x=>x.id===g.id);if(v){const x=new Date(v.updated_at).getTime(),w=new Date(g.updated_at).getTime(),S=Date.now()-x;if(x>w||S<3e4)return console.log(`🛡️ [syncDataInBackground] PROTECTION shipment ${g.id.slice(-8)} - utilise version locale`),v}return g});if(r(g=>({route:{...g.route,rawStops:n,rawShipments:h,driverRoute:d},lastUpdateTime:Date.now()})),Date.now()-a.lastUpdateTime<1e4)console.log("⚡ [syncDataInBackground] Utilisateur actif - données mises à jour, regroupement reporté");else{console.log("💤 [syncDataInBackground] Utilisateur inactif - regroupement sécurisé");const g=po(n,o,{locations:a.referenceData.locations,laboratories:a.referenceData.laboratories,laboratoryClients:a.referenceData.laboratoryClients}),v=a.route.groupedStops[a.route.currentStopIndex]?.id;let x=0;if(v){const w=g.findIndex(S=>S.id===v);w>=0&&(x=w)}r(w=>({route:{...w.route,groupedStops:g,currentStopIndex:x}})),console.log("✅ [syncDataInBackground] Regroupement en arrière-plan terminé")}},forceRouteResync:async()=>(console.log("🚫 [forceRouteResync] Resynchronisation forcée DÉSACTIVÉE pour préserver l'UX"),console.log("💡 [LOCAL-FIRST] Le livreur continue sur son store local, sync en arrière-plan"),e().route.driverRoute?(console.log("✅ [forceRouteResync] Simulation de succès (UX préservée)"),!0):(console.warn("⚠️ Aucune route à resynchroniser"),!1)),waitForSyncAndCleanup:async()=>{let o=0;console.log("🧹 [waitForSyncAndCleanup] Attente de la synchronisation complète...");const a=()=>{const l=e(),c=l.sync.pendingActions.length,d=l.sync.failedActions.length,h=l.sync.isSyncing;return console.log(`⏳ [waitForSyncAndCleanup] État sync: pending=${c}, failed=${d}, syncing=${h}`),c===0&&d===0&&!h};for(;o<3e4;){if(a()){console.log("✅ [waitForSyncAndCleanup] Synchronisation terminée - déclenchement du nettoyage");try{await e().clearCompletedRouteFromCache();const{cleanupService:l}=await ct(async()=>{const{cleanupService:d}=await import("./cleanupService-BP-0KkZd.js");return{cleanupService:d}},[]),c=await l.performFullCleanup();console.log("🧹 [waitForSyncAndCleanup] Nettoyage terminé:",c);return}catch(l){console.error("❌ [waitForSyncAndCleanup] Erreur lors du nettoyage:",l)}return}await new Promise(l=>setTimeout(l,1e3)),o+=1e3}console.warn("⚠️ [waitForSyncAndCleanup] Timeout atteint - nettoyage forcé");try{await e().clearCompletedRouteFromCache();const{cleanupService:l}=await ct(async()=>{const{cleanupService:c}=await import("./cleanupService-BP-0KkZd.js");return{cleanupService:c}},[]);await l.performFullCleanup()}catch(l){console.error("❌ [waitForSyncAndCleanup] Erreur nettoyage forcé:",l)}},clearCompletedRouteFromCache:async()=>{const n=e().route.driverRoute;if(!n||n.status!=="completed"){console.log("ℹ️ [clearCompletedRouteFromCache] Aucune route completed à nettoyer");return}console.log("🧹 [clearCompletedRouteFromCache] Nettoyage du cache pour route completed:",n.id);try{const a=(await Ds.keys()).filter(l=>l.includes(n.id)||l.includes("route_")||l.includes("photo_")||l.includes("temp_"));console.log(`🧹 [clearCompletedRouteFromCache] Suppression de ${a.length} clés LocalForage`);for(const l of a)try{await Ds.removeItem(l)}catch(c){console.warn(`⚠️ Erreur suppression clé ${l}:`,c)}r(l=>({route:du(),assets:{photos:new Map,uploadQueue:[],totalPhotos:0,uploadedPhotos:0,isCleaningPhotos:!1},sync:{...l.sync,pendingActions:[],failedActions:[]},lastUpdateTime:Date.now()})),console.log("✅ [clearCompletedRouteFromCache] Cache nettoyé avec succès")}catch(o){console.error("❌ [clearCompletedRouteFromCache] Erreur:",o)}},forceCompleteReload:async()=>{console.log("🚨 [forceCompleteReload] Rechargement complet forcé de l'état");try{await Ds.clear(),console.log("🧹 [forceCompleteReload] LocalForage vidé"),r(mf()),console.log("🧹 [forceCompleteReload] Store réinitialisé"),setTimeout(async()=>{console.log("🔄 [forceCompleteReload] Redémarrage de la synchronisation...");try{const{supabase:t}=await ct(async()=>{const{supabase:o}=await Promise.resolve().then(()=>Ts);return{supabase:o}},void 0),{data:{user:n}}=await t.auth.getUser();if(n?.email){const{data:o}=await t.from("drivers").select("id").eq("email",n.email).single();o&&(console.log("🔄 [forceCompleteReload] Réinitialisation avec driver:",o.id),e().initializeStore(o.id),setTimeout(()=>{console.log("🔄 [forceCompleteReload] Synchronisation forcée...")},1e3))}}catch(t){console.error("❌ [forceCompleteReload] Erreur lors de la resynchronisation:",t)}},2e3),console.log("✅ [forceCompleteReload] Rechargement complet terminé")}catch(t){console.error("❌ [forceCompleteReload] Erreur:",t)}}}),{name:"main-app-storage",storage:Hp(()=>U2,{replacer:F2,reviver:z2}),partialize:r=>{const{sync:e,...t}=r;return{...t,sync:{...e,isSyncing:!1}}},onRehydrateStorage:()=>r=>{if(r){if(console.log("💾 Store principal réhydraté"),console.log(`  - Route active: ${r.route.driverRoute?.id||"Aucune"}`),console.log(`  - Stops groupés: ${r.route.groupedStops.length}`),console.log(`  - Photos: ${r.assets.photos.size}`),console.log(`  - Actions en attente: ${r.sync.pendingActions.length}`),r.assets&&typeof r.assets.isCleaningPhotos>"u"&&(console.log("🔄 [MIGRATION] Ajout du champ isCleaningPhotos manquant"),r.assets.isCleaningPhotos=!1),r.assets&&r.assets.isCleaningPhotos===!0&&(console.log("🔄 [RECOVERY] Reset du flag isCleaningPhotos bloqué (crash précédent?)"),r.assets.isCleaningPhotos=!1),r.route.driverRoute){const e=r.route.driverRoute,t=Date.now()-new Date(e.updated_at).getTime(),n=1440*60*1e3;console.log("🔍 [REHYDRATE] Validation de la route stockée:",{routeId:e.id.slice(-8),status:e.status,age:Math.round(t/(3600*1e3))+"h"}),e.status==="validated"&&t>n||e.status==="completed"?(console.log("🧹 [REHYDRATE] Nettoyage de la route invalide au démarrage"),r.route=du(),r.lastUpdateTime=Date.now()):console.log("✅ [REHYDRATE] Route valide conservée")}setTimeout(()=>{console.log("🔄 [REHYDRATE] Déclenchement de la synchronisation post-réhydratation")},2e3)}}}));typeof window<"u"&&(window.useMainAppStore=et,window.debugForceFusion=()=>{const r=et.getState();console.log("🔧 FUSION FORCÉE - Analyse des stops successifs...");const e=r.route.rawStops,t=[];let n=0;for(;n<e.length;){const o=e[n],a=[o];let l=n+1;for(;l<e.length&&e[l].location_id===o.location_id&&e[l].stop_order===e[l-1].stop_order+1;)a.push(e[l]),l++;a.length>1&&(console.log(`🔗 FUSION: ${a.length} stops à la location ${o.location_id}`),console.log("   Orders:",a.map(c=>c.stop_order).join(", ")),console.log("   Actions:",a.map(c=>c.client_actions).join(", "))),t.push({id:o.id,location_id:o.location_id,stop_order:o.stop_order,stops:a,shipments:[],isCompleted:!1,displayIcon:a.length>1?"both":a[0].client_actions||"delivery",displayLabel:`${a.length} action${a.length>1?"s":""}`}),n=l}return console.log(`✅ Résultat: ${e.length} stops → ${t.length} stops groupés`),t},window.forceCompleteReload=()=>{console.log("🚨 [DEBUG] Déclenchement du rechargement complet forcé..."),et.getState().forceCompleteReload()},console.log("🔧 Store exposé sur window.useMainAppStore pour debug"),console.log("🔧 Fonction window.debugForceFusion() disponible"),console.log("🚨 Fonction window.forceCompleteReload() disponible (en cas de problème)"));const _u=Object.freeze(Object.defineProperty({__proto__:null,useMainAppStore:et},Symbol.toStringTag,{value:"Module"})),Ew=()=>{const r=et(),e=j.useRef(!1),t=j.useRef(null),n=async()=>{try{console.log("🔍 Récupération de l'ID du livreur connecté...");const{data:{user:g}}=await Oe.auth.getUser();if(!g)return console.warn("⚠️ Aucun utilisateur connecté"),null;const{data:v,error:x}=await Oe.from("drivers").select("id, full_name").eq("user_id",g.id).single();return x?(console.error("❌ Erreur récupération driver:",x),null):v?(console.log("✅ Livreur connecté identifié:",v.full_name,"(ID:",v.id,")"),v.id):null}catch(g){return console.error("❌ Erreur auth getCurrentDriverId:",g),null}},o=()=>{const g=new Date,v=g.getHours();let x;if(v>=15)x=wi(g),console.log("🌙 Mode soirée (15h+) : recherche des routes validées pour",x,"(heure locale)");else if(v<12){const w=new Date(g);w.setDate(w.getDate()-1),x=wi(w),console.log("🌅 Mode matinée : recherche des routes validées hier",x,"(heure locale)")}else x=wi(g),console.log("🔄 Mode transition (12h-15h) : recherche des routes validées pour",x,"(heure locale)");return x},a=async g=>{try{const v=o();console.log("🔍 [CORRIGÉ] Recherche dernière tournée disponible pour driver",g,"date:",v),console.log("📋 [CORRIGÉ] Critères: status=validated OU in_progress (pour continuité)");const{data:x,error:w}=await Oe.from("driver_routes").select("*").eq("driver_id",g).eq("date",v).in("status",["validated","in_progress"]).order("updated_at",{ascending:!1}).limit(1);if(w)return console.error("❌ Erreur récupération tournée disponible:",w),null;if(x&&x.length>0){const S=x[0];return console.log("✅ [CORRIGÉ] Tournée disponible trouvée:",S.id,"statut:",S.status,"mise à jour le",S.updated_at),S}return console.log("ℹ️ [CORRIGÉ] Aucune tournée disponible trouvée pour la date",v),null}catch(v){return console.error("❌ Erreur fetchLatestAvailableRoute:",v),null}},l=async g=>{try{console.log("📍 Récupération des stops pour route",g);const{data:v,error:x}=await Oe.from("driver_route_stops").select("*").eq("route_id",g).order("stop_order",{ascending:!0});return x?(console.error("❌ Erreur récupération stops:",x),[]):(console.log(`✅ ${v?.length||0} stops récupérés`),v||[])}catch(v){return console.error("❌ Erreur fetchRouteStops:",v),[]}},c=async g=>{try{console.log("📦 Récupération des shipments pour route",g);const{data:v,error:x}=await Oe.from("driver_route_shipments").select("*").eq("route_id",g).order("created_at",{ascending:!0});return x?(console.error("❌ Erreur récupération shipments:",x),[]):(v&&v.length>0&&console.log("🔍 Debug premier shipment récupéré:",{id:v[0].id,shipment_type:v[0].shipment_type,pickup_status:v[0].pickup_status,delivery_status:v[0].delivery_status,pickup_stop_id:v[0].pickup_stop_id,delivery_stop_id:v[0].delivery_stop_id,allKeys:Object.keys(v[0])}),console.log(`✅ ${v?.length||0} shipments récupérés`),v||[])}catch(v){return console.error("❌ Erreur fetchRouteShipments:",v),[]}},d=async()=>{try{console.log("🌍 Récupération de TOUTES les données de référence...");const{data:g,error:v}=await Oe.from("locations").select("*");if(v)return console.error("❌ Erreur récupération toutes les locations:",v),{locations:[],laboratories:[],clients:[]};console.log("🧪 Récupération de TOUS les laboratoires...");const{data:x,error:w}=await Oe.from("laboratories").select("*");let S=[];w?console.error("❌ Erreur récupération tous les laboratoires:",w):S=x||[],console.log("👥 Récupération de TOUS les clients...");const{data:_,error:C}=await Oe.from("laboratory_clients").select("*");let E=[];return C?console.error("❌ Erreur récupération tous les clients:",C):E=_||[],console.log(`✅ TOUTES les données référence récupérées: ${g?.length||0} locations, ${S.length} labs, ${E.length} clients`),{locations:g||[],laboratories:S,clients:E}}catch(g){return console.error("❌ Erreur fetchAllReferenceData:",g),{locations:[],laboratories:[],clients:[]}}},h=async g=>{if(e.current){console.log("⏳ Synchronisation déjà en cours, ignorer");return}try{e.current=!0,console.log("🚀 Début synchronisation complète route:",g.id,"statut:",g.status);const v=r.route.driverRoute;if(v&&v.id===g.id){const E=v.status!==g.status,N=E||!r.route.groupedStops.length;if(v.status==="in_progress"&&!E&&r.route.groupedStops.length>0){console.log("ℹ️ Route in_progress déjà synchronisée et complète, ignorer");return}if(!N){console.log("ℹ️ Route déjà synchronisée avec le bon statut, ignorer");return}console.log("🔄 Mise à jour du statut de route existante:",v.status,"→",g.status)}const[x,w]=await Promise.all([l(g.id),c(g.id)]);if(x.length===0){console.warn("⚠️ Aucun stop trouvé pour la route",g.id);return}const S=r.referenceData.locations.size>0,C=Date.now()-r.referenceData.lastRefreshTime>1800*1e3;if(S)C?(console.log("🔄 Données de référence anciennes - rafraîchissement en arrière-plan..."),d().then(E=>{r.updateReferenceData(E.locations,E.laboratories,E.clients),console.log("✅ Données de référence rafraîchies en arrière-plan")}).catch(E=>{console.warn("⚠️ Échec rafraîchissement données de référence:",E)})):console.log("✅ Données de référence fraîches en cache (UX préservée)");else{console.log("📊 Première synchronisation : récupération des données de référence...");const E=await d();r.updateReferenceData(E.locations,E.laboratories,E.clients)}await r.setActiveRoute(g,x,w),console.log("🔄 Initialisation du sous-store unexpected pickups..."),await r.initializeUnexpectedPickups(),console.log("✅ Synchronisation complète terminée"),console.log(`  📍 Route: ${g.id} (${g.status})`),console.log(`  🛤️ Stops: ${x.length}`),console.log(`  📦 Shipments: ${w.length}`),console.log(`  🎯 Grouped stops: ${r.route.groupedStops.length}`),console.log(`  🔄 Unexpected pickups: ${r.unexpectedPickups.isInitialized?"Initialisé":"Non initialisé"}`)}catch(v){console.error("❌ Erreur lors de la synchronisation complète:",v)}finally{e.current=!1}},m=async()=>{try{const g=await n();if(!g){console.log("⚠️ Pas de driver ID, impossible de vérifier les routes");return}const v=r.route.driverRoute;if(v&&(v.status==="in_progress"||v.status==="completed")){console.log(`✅ Route ${v.status} déjà chargée, pas de recherche nécessaire`);return}r.checkRouteValidity()===!1&&console.log("🧹 Route expirée nettoyée, recherche d'une nouvelle route..."),console.log("🔍 Vérification systématique des nouvelles tournées (même si route valide stockée)"),r.isInitialized||r.initializeStore(g);const w=await a(g);if(w){const S=r.route.driverRoute;!S||t.current!==w.id||S&&new Date(w.updated_at)>new Date(S.updated_at)?(console.log("🔄 [REMPLACEMENT AUTOMATIQUE] Nouvelle route détectée:",{nouvelleRoute:w.id.slice(-8),nouveauStatut:w.status,ancienneRoute:S?.id?.slice(-8)||"Aucune",ancienStatut:S?.status||"N/A",raison:S?t.current!==w.id?"Route différente":"Route plus récente":"Première route"}),t.current=w.id,S&&S.id!==w.id&&(console.log("🧹 [REMPLACEMENT] Nettoyage de l'ancienne route avant remplacement"),r.clearRoute()),await h(w)):console.log("ℹ️ Route actuelle confirmée:",w.id.slice(-8),"statut:",w.status)}else{const S=r.route.driverRoute;S&&S.status==="validated"&&(console.log("🧹 [NETTOYAGE AUTO] Aucune route disponible - nettoyage de l'ancienne route validated"),r.clearRoute(),t.current=null)}}catch(g){console.error("❌ Erreur checkForActiveRoutes:",g)}};return j.useEffect(()=>{console.log("🎯 Initialisation du hook de synchronisation des routes"),m();const g=Oe.channel("driver_routes_sync").on("postgres_changes",{event:"*",schema:"public",table:"driver_routes"},w=>{console.log("🔔 Changement détecté sur driver_routes:",w.eventType),console.log("  Route ID:",w.new?w.new.id:"N/A"),console.log("  Status:",w.new?w.new.status:"N/A");const S=w.new?w.new.status:null;(S==="validated"||S==="in_progress")&&(console.log("🔄 Status pertinent détecté, déclenchement de la synchronisation..."),setTimeout(()=>{m()},1e3))}).subscribe(),v=setInterval(()=>{if(r.isUserInteractionActive()||r.isRecentUserActivity(3e4)){console.log("🔒 Vérification périodique ignorée - Utilisateur actif");return}console.log("⏰ Vérification périodique intelligente des nouvelles tournées"),m()},3e5),x=setInterval(()=>{if(r.isUserInteractionActive()){console.log("🔒 Vérification validité ignorée - Utilisateur actif");return}console.log("🕐 Vérification de validité des routes"),r.checkRouteValidity()},6e5);return()=>{console.log("🧹 Nettoyage du hook de synchronisation des routes"),Oe.removeChannel(g),clearInterval(v),clearInterval(x),e.current=!1}},[]),{isInitialized:r.isInitialized,hasActiveRoute:!!r.route.driverRoute,currentRoute:r.route.driverRoute,isSyncInProgress:e.current,manualSync:m,fetchAllReferenceData:d,forceRouteResync:r.forceRouteResync}};class q2{dbName="DeliveryAppPhotos";dbVersion=1;storeName="photos";db=null;async init(){return new Promise((e,t)=>{const n=indexedDB.open(this.dbName,this.dbVersion);n.onerror=()=>{console.error("❌ [PhotoStorage] Erreur ouverture IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{this.db=n.result,console.log("✅ [PhotoStorage] IndexedDB initialisé"),e()},n.onupgradeneeded=o=>{const a=o.target.result;if(!a.objectStoreNames.contains(this.storeName)){const l=a.createObjectStore(this.storeName,{keyPath:"id"});l.createIndex("shipmentId","shipmentId",{unique:!1}),l.createIndex("uploaded","uploaded",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1}),console.log("🏗️ [PhotoStorage] Object store créé")}}})}async storePhoto(e){if(!this.db)throw new Error("PhotoStorage non initialisé");return new Promise((t,n)=>{const l=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(e);l.onsuccess=()=>{console.log(`📸 [PhotoStorage] Photo stockée: ${e.id.slice(-8)}`),t()},l.onerror=()=>{console.error("❌ [PhotoStorage] Erreur stockage:",l.error),n(l.error)}})}async getPhoto(e){if(!this.db)throw new Error("PhotoStorage non initialisé");return new Promise((t,n)=>{const l=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);l.onsuccess=()=>{t(l.result||null)},l.onerror=()=>{console.error("❌ [PhotoStorage] Erreur lecture:",l.error),n(l.error)}})}async getPhotosByShipment(e){if(!this.db)throw new Error("PhotoStorage non initialisé");return new Promise((t,n)=>{const c=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).index("shipmentId").getAll(e);c.onsuccess=()=>{t(c.result||[])},c.onerror=()=>{console.error("❌ [PhotoStorage] Erreur lecture shipment:",c.error),n(c.error)}})}async getAllPhotos(){if(!this.db)throw new Error("PhotoStorage non initialisé");return new Promise((e,t)=>{const a=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();a.onsuccess=()=>{e(a.result||[])},a.onerror=()=>{console.error("❌ [PhotoStorage] Erreur lecture toutes photos:",a.error),t(a.error)}})}async deletePhoto(e){if(!this.db)throw new Error("PhotoStorage non initialisé");return new Promise((t,n)=>{const l=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);l.onsuccess=()=>{console.log(`🗑️ [PhotoStorage] Photo supprimée: ${e.slice(-8)}`),t()},l.onerror=()=>{console.error("❌ [PhotoStorage] Erreur suppression:",l.error),n(l.error)}})}async markAsUploaded(e,t){const n=await this.getPhoto(e);if(!n)throw new Error(`Photo introuvable: ${e}`);n.uploaded=!0,n.uploadUrl=t,await this.storePhoto(n)}async getStorageStats(){const e=await this.getAllPhotos(),t=e.length,n=e.filter(l=>l.uploaded).length,o=t-n,a=e.reduce((l,c)=>l+c.blob.size/(1024*1024),0);return{totalPhotos:t,uploadedPhotos:n,pendingPhotos:o,estimatedSizeMB:Math.round(a*100)/100}}async cleanupUploadedPhotos(){const t=(await this.getAllPhotos()).filter(a=>a.uploaded);let n=0,o=0;for(const a of t)if(Date.now()-a.timestamp<864e5)o++;else try{await this.deletePhoto(a.id),n++}catch(c){console.warn(`⚠️ [PhotoStorage] Impossible de supprimer ${a.id}:`,c),o++}return console.log(`🧹 [PhotoStorage] Nettoyage: ${n} supprimées, ${o} conservées`),{cleaned:n,kept:o}}async blobToBase64(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=n,o.readAsDataURL(e)})}base64ToBlob(e){const t=e.split(","),n=t[0].match(/:(.*?);/)?.[1]||"image/jpeg",o=atob(t[1]),a=new Uint8Array(o.length);for(let l=0;l<o.length;l++)a[l]=o.charCodeAt(l);return new Blob([a],{type:n})}close(){this.db&&(this.db.close(),this.db=null,console.log("🔒 [PhotoStorage] Connexion fermée"))}}const Br=new q2;class H2{isInitialized=!1;migrationInProgress=!1;async init(){if(!this.isInitialized)try{await Br.init(),this.isInitialized=!0,console.log("✅ [PhotoMigration] Service initialisé")}catch(e){throw console.error("❌ [PhotoMigration] Erreur initialisation:",e),e}}async migratePhoto(e){this.isInitialized||await this.init();const t=this.base64ToBlob(e.localPath),n={id:e.id,shipmentId:e.shipmentId,blob:t,uploadUrl:e.uploadUrl,uploaded:e.uploaded,uploadRetries:e.uploadRetries,timestamp:e.timestamp,compressed:!0};return await Br.storePhoto(n),n}async storeNewPhoto(e,t,n=!1,o){this.isInitialized||await this.init();const a=`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,l={id:a,shipmentId:e,blob:t,uploadUrl:o,uploaded:n,uploadRetries:0,timestamp:Date.now(),compressed:!0};return await Br.storePhoto(l),console.log(`📸 [PhotoMigration] Nouvelle photo stockée: ${a.slice(-8)}`),l}async getPhotoForDisplay(e){this.isInitialized||await this.init();const t=await Br.getPhoto(e);return t?this.blobToBase64(t.blob):null}async getPhotoBlob(e){return this.isInitialized||await this.init(),(await Br.getPhoto(e))?.blob||null}async migrateLegacyPhotos(e){if(this.migrationInProgress)throw new Error("Migration déjà en cours");this.migrationInProgress=!0;const t={total:e.size,migrated:0,errors:0,sizeSavedMB:0};console.log(`🔄 [PhotoMigration] Début migration de ${t.total} photos`);for(const[n,o]of e)try{const a=o.localPath.length*.75/1048576;await this.migratePhoto(o);const l=await Br.getPhoto(o.id),c=l?l.blob.size/(1024*1024):a;t.sizeSavedMB+=Math.max(0,a-c),t.migrated++,t.migrated%10===0&&console.log(`🔄 [PhotoMigration] Progression: ${t.migrated}/${t.total}`)}catch(a){console.error(`❌ [PhotoMigration] Erreur migration photo ${o.id}:`,a),t.errors++}return this.migrationInProgress=!1,console.log("✅ [PhotoMigration] Migration terminée:",{...t,sizeSavedMB:Math.round(t.sizeSavedMB*100)/100}),t}async checkMigrationNeeded(){this.isInitialized||await this.init();const e=(await Br.getAllPhotos()).length;return{needsMigration:e===0,indexedDBPhotos:e,estimatedBenefit:e===0?"30-70% réduction mémoire":"Migration déjà effectuée"}}blobToBase64(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=n,o.readAsDataURL(e)})}base64ToBlob(e){const t=e.split(","),n=t[0].match(/:(.*?);/)?.[1]||"image/jpeg",o=atob(t[1]),a=new Uint8Array(o.length);for(let l=0;l<o.length;l++)a[l]=o.charCodeAt(l);return new Blob([a],{type:n})}async cleanupAfterMigration(){console.log("🧹 [PhotoMigration] Nettoyage post-migration..."),await Br.cleanupUploadedPhotos()}}const Wn=new H2;class W2{async getPhotoForSync(e){try{if(e.localPath.startsWith("blob-ref:")){const t=e.localPath.replace("blob-ref:","");console.log(`📸 [PhotoSyncAdapter] Récupération Blob optimisé: ${t.slice(-8)}`);const n=await Wn.getPhotoBlob(t);if(!n)throw new Error(`Blob introuvable pour photo ${t}`);return{blob:n,isOptimized:!0,originalSize:n.size,compressedSize:n.size}}if(e.localPath.startsWith("data:")){console.log("📸 [PhotoSyncAdapter] Conversion base64 legacy vers Blob");const n=await(await fetch(e.localPath)).blob();return{blob:n,isOptimized:!1,originalSize:e.localPath.length*.75,compressedSize:n.size}}throw new Error(`Format de photo non supporté: ${e.localPath.substring(0,20)}...`)}catch(t){throw console.error("❌ [PhotoSyncAdapter] Erreur récupération photo:",t),t}}canCleanupAfterUpload(e){return e.localPath.startsWith("blob-ref:")}async cleanupAfterUpload(e){try{if(e.localPath.startsWith("blob-ref:")){const t=e.localPath.replace("blob-ref:","");e.uploadUrl&&(await Br.markAsUploaded(t,e.uploadUrl),console.log(`✅ [PhotoSyncAdapter] Photo optimisée marquée comme uploadée: ${t.slice(-8)}`));return}console.log("ℹ️ [PhotoSyncAdapter] Photo legacy, pas de nettoyage automatique")}catch(t){console.error("❌ [PhotoSyncAdapter] Erreur nettoyage après upload:",t)}}async getUploadQueueStats(){try{const e=await Br.getStorageStats(),t=e.pendingPhotos,n=e.estimatedSizeMB/Math.max(e.totalPhotos,1),o=e.pendingPhotos*n*2;return{totalPhotos:e.totalPhotos,optimizedPhotos:e.totalPhotos,legacyPhotos:0,totalSizeMB:e.estimatedSizeMB,estimatedUploadTime:Math.round(o)}}catch(e){return console.error("❌ [PhotoSyncAdapter] Erreur stats queue upload:",e),{totalPhotos:0,optimizedPhotos:0,legacyPhotos:0,totalSizeMB:0,estimatedUploadTime:0}}}async optimizeLegacyPhotoOnTheFly(e){try{if(!e.localPath.startsWith("data:"))return e;console.log(`🔄 [PhotoSyncAdapter] Optimisation à la volée: ${e.id.slice(-8)}`);const t=await this.convertBase64ToBlob(e.localPath),n=await Wn.storeNewPhoto(e.shipmentId,t,e.uploaded,e.uploadUrl);return{...e,localPath:`blob-ref:${n.id}`}}catch(t){return console.warn("⚠️ [PhotoSyncAdapter] Optimisation à la volée échouée, utilisation format original:",t),e}}async convertBase64ToBlob(e){return(await fetch(e)).blob()}}const au=new W2;class G2{isProcessing=!1;processingTimer=null;onlineCheckTimer=null;failedActionsTimer=null;constructor(){console.log("🔄 Initialisation du service de synchronisation"),this.startOnlineCheck(),this.startPeriodicProcessing()}startOnlineCheck(){const e=()=>{const t=et.getState(),n=t.sync.isOnline,o=navigator.onLine;n!==o&&(console.log(`🌐 Statut connexion changé: ${o?"En ligne":"Hors ligne"}`),t.setOnlineStatus(o),o&&(console.log("✅ Connexion rétablie, lancement de la synchronisation"),this.processPendingActions()))};e(),window.addEventListener("online",e),window.addEventListener("offline",e),this.onlineCheckTimer=setInterval(e,5e3)}startPeriodicProcessing(){this.processingTimer=setInterval(()=>{const e=et.getState();e.sync.isOnline&&e.sync.pendingActions.length>0&&(console.log("⏰ Traitement périodique de la queue de sync"),this.processPendingActions())},3e4),this.failedActionsTimer=setInterval(()=>{const e=et.getState();e.sync.isOnline&&e.sync.failedActions.length>0&&(console.log("🔄 RETRY AGRESSIF : Relance des actions échouées (toutes les 5 min)"),this.retryFailedActions())},300*1e3)}async processPendingActions(){if(this.isProcessing){console.log("⏳ Traitement déjà en cours, ignorer");return}const e=et.getState();if(!e.sync.isOnline){console.log("📴 Hors ligne, report du traitement");return}const t=e.sync.pendingActions.filter(n=>n.status==="pending");if(t.length===0){console.log("✅ Aucune action en attente");return}try{this.isProcessing=!0,console.log(`🔄 Début traitement de ${t.length} actions en attente`);for(const n of t)await this.processAction(n),await new Promise(o=>setTimeout(o,500));console.log("✅ Traitement de la queue terminé")}catch(n){console.error("❌ Erreur lors du traitement de la queue:",n)}finally{this.isProcessing=!1}}async processAction(e){const t=et.getState();try{switch(console.log(`🔄 Traitement action ${e.type} (${e.id})`),t.updateSyncActionStatus(e.id,"syncing"),e.type){case"START_ROUTE":await this.syncStartRoute(e);break;case"COMPLETE_ROUTE":await this.syncCompleteRoute(e);break;case"COMPLETE_GROUPED_STOP":await this.syncCompleteGroupedStop(e);break;case"UPDATE_SHIPMENT_STATUS":await this.syncUpdateShipment(e);break;case"UPLOAD_PHOTO":await this.syncUploadPhoto(e);break;default:throw new Error(`Type d'action non supporté: ${e.type}`)}t.updateSyncActionStatus(e.id,"completed"),console.log(`✅ Action ${e.type} terminée avec succès`),t.safeCleanupActions()}catch(n){console.error(`❌ Erreur traitement action ${e.type}:`,n),t.incrementSyncActionRetry(e.id);const o=t.sync.pendingActions.find(a=>a.id===e.id);if(o&&o.retryCount>=o.maxRetries)console.error(`💀 Action ${e.type} échouée définitivement après ${o.retryCount} tentatives`),t.updateSyncActionStatus(e.id,"failed",n instanceof Error?n.message:"Erreur inconnue");else{console.log(`🔄 Action ${e.type} sera retentée (tentative ${o?.retryCount}/${o?.maxRetries})`),t.updateSyncActionStatus(e.id,"pending");const a=Math.pow(2,o?.retryCount||0)*1e3;setTimeout(()=>{this.processPendingActions()},a)}}}async syncStartRoute(e){const t=e.data.routeUpdate;if(!t)throw new Error("Données de mise à jour route manquantes");const n=e.data.routeId||et.getState().route.driverRoute?.id;if(!n)throw console.error("❌ [syncStartRoute] Aucun routeId disponible:",{actionData:e.data,storeRoute:et.getState().route.driverRoute}),new Error("Aucune route active - impossible de synchroniser le démarrage");console.log("🏁 [syncStartRoute] Début synchronisation démarrage route:",{routeId:n.slice(-8),updateData:t});const{data:o,error:a}=await Oe.from("driver_routes").update(t).eq("id",n).select();if(a)throw console.error("❌ [syncStartRoute] Erreur Supabase:",a),a;if(!o||o.length===0)throw console.error("❌ [syncStartRoute] Aucune ligne modifiée dans Supabase",{routeId:n.slice(-8),updateData:t}),new Error(`Route ${n} introuvable dans Supabase - aucune ligne modifiée`);console.log("✅ [syncStartRoute] Démarrage route synchronisé avec succès:",{routeId:n.slice(-8),updatedStatus:o[0]?.status,rowsAffected:o.length})}async syncCompleteRoute(e){const t=e.data.routeUpdate;if(!t)throw new Error("Données de mise à jour route manquantes");const n=e.data.routeId||et.getState().route.driverRoute?.id;if(!n)throw console.error("❌ [syncCompleteRoute] Aucun routeId disponible:",{actionData:e.data,storeRoute:et.getState().route.driverRoute}),new Error("Aucune route active - impossible de synchroniser la fin");console.log("🏆 [syncCompleteRoute] Début synchronisation fin route:",{routeId:n.slice(-8),updateData:t});const{data:o,error:a}=await Oe.from("driver_routes").update(t).eq("id",n).select();if(a)throw console.error("❌ [syncCompleteRoute] Erreur Supabase:",a),a;if(!o||o.length===0)throw console.error("❌ [syncCompleteRoute] Aucune ligne modifiée dans Supabase",{routeId:n.slice(-8),updateData:t}),new Error(`Route ${n} introuvable dans Supabase - aucune ligne modifiée`);console.log("✅ [syncCompleteRoute] Fin route synchronisée avec succès:",{routeId:n.slice(-8),updatedStatus:o[0]?.status,rowsAffected:o.length})}async syncCompleteGroupedStop(e){const{originalStopIds:t,shipmentUpdates:n,photoUploads:o}=e.data;if(!t||!n)throw new Error("Données manquantes pour la synchronisation du stop");console.log(`📍 Synchronisation stop groupé: ${t.length} stops, ${n.length} shipments`);const a=new Map,l=[];if(o&&o.length>0){console.log(`📸 [syncCompleteGroupedStop] Upload de ${o.length} photos`);for(const g of o)try{await this.uploadPhotoByShipment(g);const x=et.getState().assets.photos.get(g);x&&x.uploaded&&x.uploadUrl?(a.set(g,x.uploadUrl),console.log(`✅ [syncCompleteGroupedStop] URL récupérée pour shipment ${g.slice(-8)}: ${x.uploadUrl.slice(0,50)}...`)):console.warn(`⚠️ [syncCompleteGroupedStop] Photo uploadée mais URL non récupérée pour ${g.slice(-8)}`)}catch(v){console.error(`❌ [syncCompleteGroupedStop] Erreur upload photo pour shipment ${g.slice(-8)}:`,v),l.push(g)}if(l.length>0){console.warn(`⚠️ [syncCompleteGroupedStop] ${l.length} photo(s) échouée(s), création d'actions de retry`);for(const g of l){const x=et.getState().assets.photos.get(g);x&&!x.uploaded&&(et.getState().addPendingAction({type:"UPLOAD_PHOTO",data:{photoData:x},maxRetries:3}),console.log(`🔄 [syncCompleteGroupedStop] Action UPLOAD_PHOTO créée pour retry: ${x.id}`))}}}console.log(`📍 Mise à jour de ${t.length} stops`);const c=t.map(g=>Oe.from("driver_route_stops").update({completed:!0,arrival_time:new Date().toISOString()}).eq("id",g));(await Promise.allSettled(c)).forEach((g,v)=>{g.status==="rejected"?(console.error(`❌ Erreur mise à jour stop ${t[v]}:`,g.reason),g.reason&&typeof g.reason=="object"&&console.error("📋 Détails erreur Supabase stop:",{message:g.reason.message,details:g.reason.details,hint:g.reason.hint,code:g.reason.code})):console.log(`✅ Stop ${t[v]} mis à jour`)}),console.log(`📦 Mise à jour de ${n.length} shipments`);const h=n.map(g=>{const v={...g};return a.has(g.id)&&(v.proof_photo_url=a.get(g.id),console.log(`📸 Ajout URL photo pour shipment ${g.id}: ${v.proof_photo_url}`)),Oe.from("driver_route_shipments").update({pickup_status:v.pickup_status,delivery_status:v.delivery_status,proof_photo_url:v.proof_photo_url,issue_type:v.issue_type,pickup_time:v.pickup_time,delivery_time:v.delivery_time}).eq("id",g.id)});(await Promise.allSettled(h)).forEach((g,v)=>{g.status==="rejected"?(console.error(`❌ Erreur mise à jour shipment ${n[v].id}:`,g.reason),g.reason&&typeof g.reason=="object"&&console.error("📋 Détails erreur Supabase shipment:",{message:g.reason.message,details:g.reason.details,hint:g.reason.hint,code:g.reason.code})):console.log(`✅ Shipment ${n[v].id} mis à jour`)}),console.log("✅ Stop groupé synchronisé")}async syncUpdateShipment(e){const t=e.data.shipmentUpdate;if(!t||!t.id)throw new Error("Données shipment manquantes");console.log("📦 [syncUpdateShipment] DÉBUT Synchronisation shipment",{id:t.id.slice(-8),pickup_status:t.pickup_status,delivery_status:t.delivery_status,fullUpdate:t});const{error:n,data:o}=await Oe.from("driver_route_shipments").update(t).eq("id",t.id).select();if(n)throw console.error("❌ [syncUpdateShipment] Erreur Supabase:",n),n;console.log("✅ [syncUpdateShipment] Shipment synchronisé avec succès:",{updatedRows:o?.length||0,data:o?.[0]?{id:o[0].id.slice(-8),pickup_status:o[0].pickup_status,delivery_status:o[0].delivery_status}:null})}async syncUploadPhoto(e){const t=e.data.photoData;if(!t)throw new Error("Données photo manquantes");await this.uploadPhoto(t.id)}async uploadPhotoByShipment(e){const n=et.getState().assets.photos.get(e);if(!n){console.log(`📸 [uploadPhotoByShipment] Pas de photo pour shipment ${e.slice(-8)}`);return}if(n.uploaded){console.log(`📸 [uploadPhotoByShipment] Photo ${n.id} déjà uploadée pour shipment ${e.slice(-8)}`);return}console.log("📤 [uploadPhotoByShipment] Début upload photo:",{photoId:n.id,shipmentId:e.slice(-8),photoSize:n.localPath.length,timestamp:new Date().toISOString()});try{console.log("📸 [uploadPhotoByShipment] Récupération photo via adaptateur optimisé...");const o=await au.getPhotoForSync(n),a=o.blob;if(console.log("✅ [uploadPhotoByShipment] Photo récupérée:",{size:a.size,type:a.type,isOptimized:o.isOptimized,compressionRatio:o.originalSize>0?Math.round((1-o.compressedSize/o.originalSize)*100):0}),a.size===0)throw new Error("Photo vide (0 bytes) - impossible à uploader");a.size>10*1024*1024&&console.warn(`⚠️ [uploadPhotoByShipment] Photo très volumineuse: ${(a.size/1024/1024).toFixed(2)} MB`);const c=`photos/${`shipment_${e}_${Date.now()}.jpg`}`;console.log(`📤 [uploadPhotoByShipment] Upload vers Supabase Storage: ${c}`);const{data:d,error:h}=await Oe.storage.from("photos-delivery").upload(c,a,{contentType:"image/jpeg",upsert:!1});if(h)throw console.error("❌ [uploadPhotoByShipment] Erreur Supabase Storage:",{error:h,message:h.message,statusCode:h.statusCode}),h;console.log("✅ [uploadPhotoByShipment] Upload Supabase réussi:",d);const{data:m}=Oe.storage.from("photos-delivery").getPublicUrl(c),g=m.publicUrl;if(!g||g.length===0)throw new Error("URL publique vide retournée par Supabase");et.getState().markPhotoUploaded(n.id,g),await au.cleanupAfterUpload(n),console.log("✅ [uploadPhotoByShipment] Photo uploadée avec succès:",{photoId:n.id,shipmentId:e.slice(-8),publicUrl:g,filePath:c,optimizedCleanup:!0})}catch(o){throw console.error("❌ [uploadPhotoByShipment] Erreur critique upload photo:",{photoId:n.id,shipmentId:e.slice(-8),error:o instanceof Error?o.message:String(o),errorStack:o instanceof Error?o.stack:void 0}),o}}async uploadPhoto(e){const t=et.getState(),n=Array.from(t.assets.photos.values()).find(o=>o.id===e);if(!n)throw console.error(`❌ [uploadPhoto] Photo ${e} introuvable dans le store`),new Error(`Photo ${e} introuvable`);if(n.uploaded){console.log(`📸 [uploadPhoto] Photo ${e} déjà uploadée`);return}console.log("📤 [uploadPhoto] Début upload photo:",{photoId:e,shipmentId:n.shipmentId.slice(-8),photoSize:n.localPath.length,timestamp:new Date().toISOString()});try{console.log("📸 [uploadPhoto] Récupération photo via adaptateur optimisé...");const o=await au.getPhotoForSync(n),a=o.blob;if(console.log("✅ [uploadPhoto] Photo récupérée:",{size:a.size,type:a.type,isOptimized:o.isOptimized,compressionRatio:o.originalSize>0?Math.round((1-o.compressedSize/o.originalSize)*100):0}),a.size===0)throw new Error("Photo vide (0 bytes) - impossible à uploader");a.size>10*1024*1024&&console.warn(`⚠️ [uploadPhoto] Photo très volumineuse: ${(a.size/1024/1024).toFixed(2)} MB`);const c=`photos/${`shipment_${n.shipmentId}_${Date.now()}.jpg`}`;console.log(`📤 [uploadPhoto] Upload vers Supabase Storage: ${c}`);const{data:d,error:h}=await Oe.storage.from("photos-delivery").upload(c,a,{contentType:"image/jpeg",upsert:!1});if(h)throw console.error("❌ [uploadPhoto] Erreur Supabase Storage:",{error:h,message:h.message,statusCode:h.statusCode}),h;console.log("✅ [uploadPhoto] Upload Supabase réussi:",d);const{data:m}=Oe.storage.from("photos-delivery").getPublicUrl(c),g=m.publicUrl;if(!g||g.length===0)throw new Error("URL publique vide retournée par Supabase");et.getState().markPhotoUploaded(e,g),await au.cleanupAfterUpload(n),console.log("✅ [uploadPhoto] Photo uploadée avec succès:",{photoId:e,shipmentId:n.shipmentId.slice(-8),publicUrl:g,filePath:c,optimizedCleanup:!0})}catch(o){throw console.error("❌ [uploadPhoto] Erreur critique upload photo:",{photoId:e,shipmentId:n.shipmentId.slice(-8),error:o instanceof Error?o.message:String(o),errorStack:o instanceof Error?o.stack:void 0}),o}}async retryFailedActions(){const e=et.getState(),t=e.sync.failedActions;if(t.length!==0){console.log(`🔄 [RETRY AGRESSIF] Relance de ${t.length} actions échouées`);for(const n of t)console.log(`🔄 Remise en pending: ${n.type} (était échouée ${n.retryCount} fois)`),e.retryFailedAction(n.id);this.isProcessing||(console.log("🚀 Déclenchement immédiat du traitement après retry"),this.processPendingActions())}}async triggerReconciliation(){try{console.log("🔄 [SyncService] Déclenchement de la réconciliation automatique...");const{reconciliationService:e}=await ct(async()=>{const{reconciliationService:n}=await import("./reconciliationService-cdDIq63q.js");return{reconciliationService:n}},[]),t=await e.reconcileAfterCleanup();t.success&&t.actionsRecreated>0?(console.log(`✅ [SyncService] Réconciliation réussie: ${t.actionsRecreated} actions recréées`),this.triggerSync()):t.success?console.log("ℹ️ [SyncService] Aucune action à recréer"):console.warn("⚠️ [SyncService] Réconciliation échouée:",t.errors)}catch(e){console.error("❌ [SyncService] Erreur lors de la réconciliation:",e)}}cleanup(){console.log("🧹 Nettoyage du service de synchronisation"),this.processingTimer&&clearInterval(this.processingTimer),this.onlineCheckTimer&&clearInterval(this.onlineCheckTimer),this.failedActionsTimer&&clearInterval(this.failedActionsTimer),window.removeEventListener("online",()=>{}),window.removeEventListener("offline",()=>{}),this.isProcessing=!1}triggerSync(){console.log("🔄 Déclenchement manuel de la synchronisation"),this.processPendingActions()}}const ui=new G2,K2=Object.freeze(Object.defineProperty({__proto__:null,syncService:ui},Symbol.toStringTag,{value:"Module"})),Pw=()=>{const r=Ew(),e=et();return j.useEffect(()=>(console.log("🚀 Initialisation complète du système de synchronisation"),e.sync.pendingActions.length>0&&(console.log(`🔄 ${e.sync.pendingActions.length} actions en attente détectées au démarrage`),ui.triggerSync()),(async()=>{try{const{cleanupService:n}=await ct(async()=>{const{cleanupService:o}=await import("./cleanupService-BP-0KkZd.js");return{cleanupService:o}},[]);n.startAutoCleanup(),console.log("🧹 Service de nettoyage automatique démarré")}catch(n){console.warn("⚠️ Erreur initialisation service de nettoyage:",n)}})(),()=>{console.log("🧹 Nettoyage système de synchronisation"),ui.cleanup(),ct(async()=>{const{cleanupService:n}=await import("./cleanupService-BP-0KkZd.js");return{cleanupService:n}},[]).then(({cleanupService:n})=>{n.stopAutoCleanup()}).catch(()=>{})}),[]),j.useEffect(()=>{e.sync.isOnline&&e.sync.pendingActions.length>0&&(console.log("✅ Connexion détectée avec actions en attente, déclenchement sync"),ui.triggerSync())},[e.sync.isOnline,e.sync.pendingActions.length]),{routeSync:{isInitialized:r.isInitialized,hasActiveRoute:r.hasActiveRoute,currentRoute:r.currentRoute,isSyncInProgress:r.isSyncInProgress,manualSync:r.manualSync},actionSync:{isOnline:e.sync.isOnline,isSyncing:e.sync.isSyncing,pendingActions:e.sync.pendingActions.length,failedActions:e.sync.failedActions.length,lastSyncTime:e.sync.lastSyncTime,triggerSync:()=>ui.triggerSync()},appState:{isInitialized:e.isInitialized,currentDriverId:e.currentDriverId,hasActiveRoute:!!e.route.driverRoute,totalPhotos:e.assets.totalPhotos,uploadedPhotos:e.assets.uploadedPhotos,pendingUploads:e.assets.uploadQueue.length},actions:{clearStore:e.clearStore,manualRouteSync:r.manualSync,manualActionSync:()=>ui.triggerSync()}}},Zu=()=>{const r=et(),{hasActiveRoute:e,currentRoute:t}=Ew();return j.useMemo(()=>t?t.status==="validated"?{status:"validated",canStartRoute:!0,buttonText:"Commencer ma tournée",buttonDisabled:!1,currentRoute:t,hasActiveRoute:!1}:t.status==="in_progress"?{status:"in_progress",canStartRoute:!1,buttonText:"Tournée en cours",buttonDisabled:!0,currentRoute:t,hasActiveRoute:!0}:t.status==="completed"?{status:"completed",canStartRoute:!1,buttonText:"Tournée terminée",buttonDisabled:!0,currentRoute:t,hasActiveRoute:!1}:{status:"no_route",canStartRoute:!1,buttonText:"Aucune tournée disponible",buttonDisabled:!0,currentRoute:null,hasActiveRoute:!1}:{status:"no_route",canStartRoute:!1,buttonText:"Aucune tournée disponible",buttonDisabled:!0,currentRoute:null,hasActiveRoute:!1},[t,e,r.route.isActive])},tm=()=>{const r=et();return{startRoute:async()=>{try{return console.log("🚀 Démarrage de la tournée..."),r.startRoute(),console.log("✅ Tournée démarrée avec succès"),!0}catch(t){return console.error("❌ Erreur lors du démarrage de la tournée:",t),!1}}}},Z2=()=>{const r=et(),e=Zu();return j.useMemo(()=>{if(!r.route.driverRoute||e.status==="no_route")return{progression:{completed:0,total:0,percentage:0},deliveries:{completed:0,total:0,percentage:0,shipments:[]},pickups:{completed:0,total:0,percentage:0,shipments:[]},isActiveRoute:!1};const{groupedStops:t,rawShipments:n}=r.route,o=t.filter(g=>g.status==="completed").length,a=t.length,l=a>0?Math.round(o/a*100):0,c=n.filter(g=>g.shipment_type?.trim()==="client_delivery"),d=Fv(c,t,r,"delivery"),h=n.filter(g=>g.shipment_type?.trim()==="client_pickup"),m=Fv(h,t,r,"pickup");return{progression:{completed:o,total:a,percentage:l},deliveries:d,pickups:m,isActiveRoute:e.status==="validated"||e.status==="in_progress"||e.status==="completed"}},[r.route.driverRoute,r.route.groupedStops,r.route.rawShipments,r.referenceData.laboratoryClients,e.status])};function Fv(r,e,t,n){const o=[];let a=0;r.forEach(d=>{const h=n==="delivery"?d.delivery_stop_id:d.pickup_stop_id,m=e.find(E=>E.originalStopIds&&E.originalStopIds.includes(h)),g=t.route.rawStops.find(E=>E.id===h),v=m?.status==="completed";v&&a++;const x=J2(d,t.referenceData.laboratoryClients),w=Q2(d,t.referenceData.laboratories,t.referenceData.laboratoryClients);let S,_;if(g){if(g.estimated_arrival_time)if(/^\d{2}:\d{2}$/.test(g.estimated_arrival_time))S=g.estimated_arrival_time;else try{S=new Date(g.estimated_arrival_time).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}catch{S=g.estimated_arrival_time}if(g.arrival_time)try{_=new Date(g.arrival_time).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}catch{_=void 0}}const C=n==="delivery"?d.delivery_status==="failed"||d.delivery_status==="partial":d.pickup_status==="failed"||d.pickup_status==="partial";o.push({shipment:d,clientName:x,laboratoryName:w,isCompleted:v,stopId:h,stopCompleted:v,estimatedTime:S,actualTime:_,hasError:C})}),o.sort((d,h)=>{if(d.estimatedTime&&h.estimatedTime){const m=x=>{const[w,S]=x.split(":").map(Number);return w*60+S},g=m(d.estimatedTime),v=m(h.estimatedTime);if(g!==v)return g-v}return d.isCompleted!==h.isCompleted?d.isCompleted?-1:1:d.clientName.localeCompare(h.clientName)});const l=r.length,c=l>0?Math.round(a/l*100):0;return{completed:a,total:l,percentage:c,shipments:o}}function J2(r,e){if(r.laboratory_client_id){const t=e.get(r.laboratory_client_id);if(t)return t.name}return`Client ${r.shipment_ref||r.id.slice(-8)}`}function Q2(r,e,t){if(r.laboratory_id){const n=e.get(r.laboratory_id);if(n)return n.name}if(r.laboratory_client_id){const n=t.get(r.laboratory_client_id);if(n&&n.laboratory_id){const o=e.get(n.laboratory_id);if(o)return o.name}}return`Laboratoire ${r.shipment_ref||r.id.slice(-8)}`}const Y2=()=>{const r=et(),[e,t]=j.useState({}),[n,o]=j.useState(!1),a=x=>({id:x.id,url:x.photo_url,description:x.description||""}),l=j.useCallback(async x=>{try{const{data:w,error:S}=await Oe.from("location_photos").select("*").eq("location_id",x).order("created_at",{ascending:!0});return S?(console.error("Erreur lors du chargement des photos:",S),[]):(w||[]).map(a)}catch(w){return console.error("Erreur lors du chargement des photos pour location",x,":",w),[]}},[]),c=j.useMemo(()=>{const{groupedStops:x,currentStopIndex:w}=r.route,S=[];for(let _=w;_<Math.min(w+3,x.length);_++){const C=x[_];C?.location_id&&S.push(C.location_id)}return[...new Set(S)]},[r.route.groupedStops,r.route.currentStopIndex]),d=j.useCallback(async x=>{if(x.length!==0){o(!0);try{const w=x.filter(C=>!e[C]);if(w.length===0){o(!1);return}console.log(`📸 Préchargement photos pour ${w.length} location(s)`,w);const S=w.map(async C=>{const E=await l(C);return{locationId:C,photos:E}}),_=await Promise.all(S);t(C=>{const E={...C};return _.forEach(({locationId:N,photos:M})=>{E[N]={photos:M,loadedAt:Date.now()},console.log(`📸 ${M.length} photo(s) chargée(s) pour location ${N}`)}),E})}catch(w){console.error("Erreur lors du préchargement des photos:",w)}finally{o(!1)}}},[e,l]),h=j.useCallback(x=>{t(w=>{const S={...w},_=Object.keys(S).filter(C=>!x.includes(C));return _.forEach(C=>{delete S[C]}),_.length>0&&console.log(`🧹 Nettoyage cache photos: ${_.length} location(s) supprimée(s)`),S})},[]);j.useEffect(()=>{c.length>0&&d(c)},[c,d]),j.useEffect(()=>{c.length>0&&h(c)},[r.route.currentStopIndex,h,c]);const m=j.useCallback(x=>e[x]?.photos||[],[e]),g=j.useMemo(()=>{const x=r.route.groupedStops[r.route.currentStopIndex];return x?.location_id?m(x.location_id):[]},[r.route.groupedStops,r.route.currentStopIndex,m]),v=j.useCallback(async x=>{console.log(`🔄 Rechargement forcé photos pour location ${x}`),o(!0);try{const w=await l(x);t(S=>({...S,[x]:{photos:w,loadedAt:Date.now()}}))}finally{o(!1)}},[l]);return{currentStopPhotos:g,isLoadingPhotos:n,getPhotosForLocation:m,reloadPhotosForLocation:v,preloadPhotos:d,photosCache:e,locationIdsToPreload:c}};async function X2(r){try{console.log("🚀 [edgeFunctionService] ========== DÉBUT APPEL EDGE FUNCTION =========="),console.log("🚀 [edgeFunctionService] Paramètres:",{shipmentId:r.shipmentId.slice(-8),actionType:r.actionType,status:r.status,photoSize:`${Math.round(r.photoBase64.length/1024)}KB`,hasIssueType:!!r.issueType,issueType:r.issueType});const e=await Oe.auth.getSession();if(console.log("🔐 [edgeFunctionService] Session:",{hasSession:!!e.data.session,hasAccessToken:!!e.data.session?.access_token}),!e.data.session)throw new Error("Utilisateur non authentifié - session manquante");console.log("📡 [edgeFunctionService] Envoi requête à Supabase...");let t,n;try{const o=await Oe.functions.invoke("complete-delivery-with-photo",{body:r});if(t=o.data,n=o.error,n)throw console.warn("⚠️ [edgeFunctionService] invoke() a retourné une erreur, tentative avec fetch() direct:",n),new Error("Invoke failed, using fallback")}catch(o){console.warn("⚠️ [edgeFunctionService] Exception invoke(), tentative avec fetch() direct:",o);try{const l="https://akmicemcgohflolembbb.supabase.co/functions/v1/complete-delivery-with-photo";console.log("🔄 [edgeFunctionService] ==== DÉBUT FETCH DIRECT ===="),console.log("🔄 [edgeFunctionService] URL:",l),console.log("🔄 [edgeFunctionService] Access Token:",e.data.session.access_token.substring(0,30)+"..."),console.log("🔄 [edgeFunctionService] Payload size:",JSON.stringify(r).length,"bytes"),console.log("📡 [edgeFunctionService] Envoi requête fetch()...");const c=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.data.session.access_token}`,apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFrbWljZW1jZ29oZmxvbGVtYmJiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyMzQ3MDMsImV4cCI6MjA2MTgxMDcwM30.CsxmVgBJDY0OOKEcLmuR3_42JDoQcEY9-gFKBmgpJp4"},body:JSON.stringify(r)});if(console.log("📡 [edgeFunctionService] ✅ Réponse reçue !"),console.log("📡 [edgeFunctionService] Status:",c.status,c.statusText),console.log("📡 [edgeFunctionService] OK?",c.ok),console.log("📡 [edgeFunctionService] Headers:",Object.fromEntries(c.headers.entries())),!c.ok){const d=await c.text();throw console.error("❌ [edgeFunctionService] Réponse HTTP non-OK:",d),new Error(`HTTP ${c.status}: ${d}`)}console.log("📦 [edgeFunctionService] Parse JSON..."),t=await c.json(),n=null,console.log("✅ [edgeFunctionService] Fallback fetch() réussi !"),console.log("✅ [edgeFunctionService] Data:",t),console.log("🔄 [edgeFunctionService] ==== FIN FETCH DIRECT ====")}catch(a){throw console.error("❌ [edgeFunctionService] ==== ERREUR FETCH DIRECT ===="),console.error("❌ [edgeFunctionService] Type:",a.constructor.name),console.error("❌ [edgeFunctionService] Message:",a.message),console.error("❌ [edgeFunctionService] Stack:",a.stack),console.error("❌ [edgeFunctionService] Fallback fetch() aussi échoué:",a),a}}if(console.log("📡 [edgeFunctionService] Réponse brute reçue:",{hasData:!!t,hasError:!!n,errorMessage:n?.message,errorContext:n?.context}),n)throw console.error("❌ [edgeFunctionService] Erreur Edge Function:",{message:n.message,context:n.context,status:n.status,fullError:n}),new Error(`Erreur Edge Function: ${n.message||JSON.stringify(n)}`);if(console.log("✅ [edgeFunctionService] Réponse reçue:",{success:t?.success,hasPhotoUrl:!!t?.photoUrl,hasShipment:!!t?.shipment}),!t||!t.success)throw new Error(t?.error||"Réponse invalide de l'Edge Function");return t}catch(e){return console.error("❌ [edgeFunctionService] Erreur critique:",e),{success:!1,error:e instanceof Error?e.message:"Erreur inconnue"}}}const eR=()=>{const r=Vs(),e=et(),t=()=>`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n=async m=>{console.log("📤 [uploadPhotoImmediately] Début upload photo:",m.id);try{const{supabase:g}=await ct(async()=>{const{supabase:N}=await Promise.resolve().then(()=>Ts);return{supabase:N}},void 0);let v;if(m.localPath.startsWith("data:"))v=await(await fetch(m.localPath)).blob();else throw new Error("Format de photo non supporté pour upload immédiat");const w=`photos/${`unexpected_pickup_${m.id}_${Date.now()}.jpg`}`;console.log("📤 [uploadPhotoImmediately] Upload vers Supabase Storage:",w);const{data:S,error:_}=await g.storage.from("photos-delivery").upload(w,v,{contentType:"image/jpeg",upsert:!1});if(_)throw console.error("❌ [uploadPhotoImmediately] Erreur upload:",_),_;const{data:C}=g.storage.from("photos-delivery").getPublicUrl(w),E=C.publicUrl;return console.log("✅ [uploadPhotoImmediately] Photo uploadée avec succès:",E),E}catch(g){throw console.error("❌ [uploadPhotoImmediately] Erreur critique:",g),new Error(`Échec upload photo: ${g instanceof Error?g.message:"Erreur inconnue"}`)}},o=j.useCallback(m=>{for(const g of e.route.groupedStops){const v=[...g.deliveryShipments,...g.pickupShipments].find(x=>x.id===m);if(v)return v}return null},[e.route.groupedStops]),a=j.useCallback(m=>{console.group(`🖱️ CLICK sur package ${m.slice(-8)}`),e.startUserInteraction("package_selection");const g=()=>{setTimeout(()=>e.endUserInteraction(),1e3),console.groupEnd()},v=e.route.groupedStops[e.route.currentStopIndex];if(!v){console.error("❌ Aucun stop actuel trouvé"),g();return}console.log("📍 Stop actuel:",{id:v.id,type:v.type,deliveryShipments:v.deliveryShipments.length,pickupShipments:v.pickupShipments.length});const x=v.type,w=x==="laboratory"?"laboratory":x==="depot"?"depot":"dentist";if(console.log("🏢 Type de stop UI:",w),w==="dentist"){console.log("👩‍⚕️ Stop dentiste - passage par caméra"),g();return}else{const S=o(m);if(!S){console.error(`❌ Shipment ${m} introuvable`),g();return}console.log("📦 Shipment trouvé:",{id:S.id.slice(-8),pickup_status:S.pickup_status,delivery_status:S.delivery_status});const _=v.pickupShipments.some(N=>N.id===m),C=v.deliveryShipments.some(N=>N.id===m);console.log("🔍 Classification:",{isPickupShipment:_,isDeliveryShipment:C,inPickupList:v.pickupShipments.map(N=>N.id.slice(-8)),inDeliveryList:v.deliveryShipments.map(N=>N.id.slice(-8))});let E;if(_)S.pickup_status==="completed"?E="pending_pickup":E="completed_pickup",console.log(`🔄 PICKUP Toggle: ${S.pickup_status} -> ${E}`);else if(C)S.delivery_status==="completed"?E="pending_delivery":E="completed_delivery",console.log(`🔄 DELIVERY Toggle: ${S.delivery_status} -> ${E}`);else{console.error(`❌ Package ${m} n'est ni pickup ni delivery pour ce stop`),g();return}console.log(`🎯 Appel updateShipmentStatus(${m.slice(-8)}, ${E})`),e.updateShipmentStatus(m,E),setTimeout(()=>{const N=e.getShipmentById(m);console.log("📊 Après mise à jour:",{id:m.slice(-8),pickup_status:N?.pickup_status,delivery_status:N?.delivery_status}),g()},100)}},[o,e]),l=j.useCallback(async(m,g,v=!1,x)=>{console.log("📷 [handlePhotoTaken] Début traitement avec Edge Function:",{packageId:g.slice(-8),photoSize:m.length,isForIssue:v,issueType:x});const w=e.route.groupedStops[e.route.currentStopIndex];if(!w){console.error("❌ [handlePhotoTaken] Pas de currentGroupedStop disponible");return}const S=[...w.deliveryShipments,...w.pickupShipments];if(!S.find(M=>M.id===g)){console.error("❌ [handlePhotoTaken] Shipment non trouvé:",{packageId:g.slice(-8),availableShipments:S.map(M=>M.id.slice(-8))});return}const E=w.deliveryShipments.some(M=>M.id===g)?"delivery":"pickup",N=v?"failed":"completed";try{console.log("🚀 [handlePhotoTaken] Appel Edge Function:",{actionType:E,status:N,issueType:x});const M=await X2({shipmentId:g,photoBase64:m,actionType:E,status:N,issueType:x,issueDescription:x?`Problème: ${x}`:void 0});if(!M.success)throw new Error(M.error||"Échec Edge Function");console.log("✅ [handlePhotoTaken] Edge Function réussie:",{photoUrl:M.photoUrl?.substring(0,50)+"...",shipmentId:M.shipment?.id}),console.log("🔄 [handlePhotoTaken] Mise à jour du store local via updateShipmentFields...");const A={proof_photo_url:M.photoUrl,updated_at:new Date().toISOString()};E==="delivery"?(A.delivery_status=N,A.delivery_time=N==="completed"?new Date().toISOString():void 0,x&&(A.issue_type=x,A.issue_description=`Problème: ${x}`)):(A.pickup_status=N,A.pickup_time=N==="completed"?new Date().toISOString():void 0),e.updateShipmentFields(g,A),console.log("✅ [handlePhotoTaken] Store local synchronisé avec succès"),console.log(`📸 Photo ${N==="completed"?"complétée":"de problème"} pour ${g}${x?` - Erreur: ${x}`:""}`)}catch(M){console.error("❌ [handlePhotoTaken] Erreur critique:",M),alert(`Erreur lors de l'enregistrement de la photo:
${M instanceof Error?M.message:"Erreur inconnue"}

Veuillez réessayer.`)}},[e]),c=j.useCallback((m,g,v)=>{console.log("🚀 Récupération inattendue ajoutée:",{labId:m,labName:g,stopIndex:v})},[]),d=j.useCallback(async(m,g,v)=>{console.log("📦 Traitement récupération inattendue avec photo:",{labId:m,labName:g,photoUrl:v.substring(0,50)+"..."});try{const{createSmartUnexpectedPickup:x,findLaboratoryClientId:w}=await ct(async()=>{const{createSmartUnexpectedPickup:K,findLaboratoryClientId:Z}=await import("./unexpectedPickupUtils-Dfzv7Gp9.js");return{createSmartUnexpectedPickup:K,findLaboratoryClientId:Z}},[]),S=e.route.groupedStops[e.route.currentStopIndex];if(!S)throw new Error("Aucun stop actuel trouvé");const _=e.route.driverRoute?.id;if(!_)throw new Error("Aucune route active trouvée");const C=S.location_id,E=S.originalStopIds[0],N=await w(m,C);if(!N)throw new Error(`Laboratory client introuvable pour lab ${m} et location ${C}`);let M;if(v.startsWith("data:image")){console.log("📤 Upload de la photo en cours...");const K=`temp_unexpected_${Date.now()}`,Z={id:t(),shipmentId:K,localPath:v,uploaded:!1,uploadRetries:0,timestamp:Date.now()};e.addPhoto(K,Z),M=await n(Z),console.log("✅ Photo uploadée:",M)}else M=v;console.log("🎯 Utilisation de la logique intelligente pour déterminer le dropoff");const A=await x(_,E,m,N,M);if(A.success){console.log("✅ Shipment de récupération inattendue créé avec logique intelligente:",{shipmentId:A.shipmentId,deliveryStopType:A.deliveryStopType,explanation:A.explanation});const K={id:A.shipmentId,route_id:_,pickup_stop_id:E,delivery_stop_id:A.deliveryStopId,laboratory_id:m,laboratory_client_id:N,shipment_type:"client_pickup",pickup_status:"completed",delivery_status:A.deliveryStopType==="client_same"?"completed":"pending",proof_photo_url:M,shipment_ref:`Récupération inattendue ${new Date().toISOString().slice(0,16)}`,unexpected:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),pickup_time:new Date().toISOString(),delivery_time:A.deliveryStopType==="client_same"?new Date().toISOString():null};return console.log("⚡ Ajout immédiat du shipment au store local:",{shipmentId:K.id,deliveryStopType:A.deliveryStopType}),e.addUnexpectedShipmentToStore(K),e.markUnexpectedShipmentCreated(m,C),console.log("✨ Shipment ajouté localement - synchronisation avec Supabase en arrière-plan"),console.log("🔄 Rafraîchissement des données depuis Supabase..."),await e.refreshRouteShipments(),{shipmentId:A.shipmentId,deliveryStopId:A.deliveryStopId,deliveryStopType:A.deliveryStopType}}else throw new Error(A.error||"Échec de la création du shipment")}catch(x){throw console.error("❌ Erreur lors de la création de la récupération inattendue:",x),x}},[e]),h=j.useCallback(async()=>{e.startUserInteraction("complete_stop");const m=e.route.groupedStops[e.route.currentStopIndex];if(!m){console.error("❌ Aucun stop actuel trouvé"),setTimeout(()=>e.endUserInteraction(),1e3);return}try{console.log(`✅ Validation du stop: ${m.id}`);const g=m.deliveryShipments.every(w=>w.delivery_status==="completed"||w.delivery_status==="failed"),v=m.pickupShipments.every(w=>w.pickup_status==="completed"||w.pickup_status==="failed");console.log("🔍 État des shipments avant validation:",{deliveryShipments:m.deliveryShipments.map(w=>({id:w.id,status:w.delivery_status})),pickupShipments:m.pickupShipments.map(w=>({id:w.id,status:w.pickup_status})),allDeliveriesCompleted:g,allPickupsCompleted:v,canComplete:g&&v});const x=e.route.currentStopIndex===e.route.groupedStops.length-1;if(console.log(`📍 Position dans la tournée: ${e.route.currentStopIndex+1}/${e.route.groupedStops.length} (dernier: ${x})`),!e.route.isActive){console.error("❌ Route non active - impossible de valider le stop");return}if(!e.route.driverRoute){console.error("❌ Aucune route dans le store - impossible de valider");return}if(e.completeGroupedStop(m.id),console.log("✅ Stop validé dans le store local"),x){console.log("🏁 Dernier stop - finalisation de la tournée...");const w=e.route;if(!w.isActive||!w.driverRoute){console.error("❌ État de route invalide pour finalisation:",{isActive:w.isActive,hasDriverRoute:!!w.driverRoute});return}try{e.completeRoute(),console.log("✅ Route finalisée avec succès"),r("/driver/resume")}catch(S){console.error("❌ Erreur lors de la finalisation de la route:",S),console.log("⚠️ Navigation vers résumé malgré l'erreur de finalisation"),r("/driver/resume")}}else e.moveToNextStop(),console.log("➡️ Passage au stop suivant")}catch(g){if(console.error("❌ Erreur lors de la validation du stop:",g),g instanceof Error)if(g.message.includes("Tous les colis doivent être traités")){console.error('💡 SOLUTION: Vérifiez que tous les colis ont un statut "completed" ou "failed"');const v=m.deliveryShipments.filter(w=>w.delivery_status!=="completed"&&w.delivery_status!=="failed"),x=m.pickupShipments.filter(w=>w.pickup_status!=="completed"&&w.pickup_status!=="failed");v.length>0&&console.error("📦 Livraisons non traitées:",v.map(w=>({id:w.id,status:w.delivery_status}))),x.length>0&&console.error("📦 Récupérations non traitées:",x.map(w=>({id:w.id,status:w.pickup_status})))}else g.message.includes("Stop groupé introuvable")?console.error("💡 SOLUTION: Problème de synchronisation - essayez de recharger la page"):g.message.includes("Aucune route active")&&console.error("💡 SOLUTION: Route devenue inactive - vérifiez votre connexion et rechargez")}finally{setTimeout(()=>e.endUserInteraction(),2e3)}},[e,r]);return j.useCallback(m=>{m==="next"?e.moveToNextStop():e.moveToPreviousStop()},[e]),j.useCallback(()=>{!e.route.isActive&&e.route.driverRoute&&(e.startRoute(),console.log("🏁 Route démarrée"))},[e]),j.useCallback((m,g,v)=>{e.updateShipmentStatus(m,g,void 0,v)},[e]),{handlePackageClick:a,handlePhotoTaken:l,handleCompleteStop:h,handleUnexpectedPickup:c,handleUnexpectedPickupPhoto:d,navigateToStop:e.moveToNextStop,startRoute:e.startRoute,updateShipmentStatusDirect:e.updateShipmentStatus,hasActiveRoute:!!e.route.driverRoute&&e.isInitialized,resetRouteForTesting:e.resetRouteForTesting}},tR=()=>{const r=et(),e=c=>{switch(c){case"laboratory":return"laboratory";case"depot":return"depot";case"client_grouped":case"client_single":return"dentist";default:return"dentist"}},t=c=>{const d=c.deliveryShipments.length>0,h=c.pickupShipments.length>0;return d&&h?"both":h?"pickup":"delivery"},n=(c,d)=>{let h="pending",m=!1;d==="delivery"?c.delivery_status==="completed"||c.delivery_status==="completed_delivery"?(h="completed",m=!0):c.delivery_status==="failed"||c.delivery_status==="failed_delivery"?(h="error",m=!0):c.delivery_status==="pending_delivery"&&(h="pending",m=!1):c.pickup_status==="completed"||c.pickup_status==="completed_pickup"?(h="completed",m=!0):c.pickup_status==="failed"||c.pickup_status==="failed_pickup"?(h="error",m=!0):c.pickup_status==="pending_pickup"&&(h="pending",m=!1);const g=r.referenceData.laboratories.get(c.laboratory_id),v=c.laboratory_client_id?r.referenceData.laboratoryClients.get(c.laboratory_client_id):null;return{id:c.id,type:d,status:h,selected:m,from:d==="delivery"?g?.name:void 0,to:d==="pickup"?v?.name||g?.name:void 0,proofPhoto:c.proof_photo_url,issuePhoto:void 0,issueType:c.issue_type}},o=(c,d,h,m)=>{const g=e(c.type),v=t(c),x=c.deliveryShipments.map(E=>r.route.rawShipments.find(M=>M.id===E.id)||E),w=c.pickupShipments.map(E=>r.route.rawShipments.find(M=>M.id===E.id)||E),S=x.map(E=>n(E,"delivery")),_=w.map(E=>n(E,"pickup")),C=Tw(d,h,r.route.rawStops,m);return{id:c.id,name:c.clientName||c.laboratoryName||"Stop",address:c.address,type:g,action:v,packages:[...S,..._],isCompleted:c.status==="completed",photos:[],instructions:c.locationInfo.delivery_instructions||void 0,estimatedTime:C,locationId:c.location_id,isLateStop:c.isLateStop}},a=j.useMemo(()=>{const c=r.route.groupedStops.map((v,x)=>o(v,x,r.route.groupedStops,r.route.startedAt)),d=r.route.currentStopIndex,h=c[d]||null,m=c.slice(d+1,d+4),g=d===c.length-1;return{stops:c,currentStop:h,currentStopIndex:d,nextStops:m,isLastStop:g,totalStops:c.length,isRouteActive:r.route.isActive,hasActiveRoute:!!r.route.driverRoute}},[r.route.groupedStops,r.route.currentStopIndex,r.route.isActive,r.route.driverRoute,r.referenceData.laboratories,r.referenceData.laboratoryClients,r.route.rawShipments,r.assets.photos,r.lastUpdateTime]),l={moveToNextStop:r.moveToNextStop,moveToPreviousStop:r.moveToPreviousStop,updateShipmentStatus:(c,d,h,m)=>{r.updateShipmentStatus(c,d,h,m)},completeCurrentStop:()=>{const c=r.route.groupedStops[r.route.currentStopIndex];c&&r.completeGroupedStop(c.id)},startRoute:r.startRoute,completeRoute:r.completeRoute,addPhoto:r.addPhoto,isInitialized:r.isInitialized,currentDriverId:r.currentDriverId};return{...a,...l}},Tw=(r,e,t,n)=>{const o=e[r];if(!o)return"00:00";if(r===0){const h=o.originalStopIds[0],m=t.find(v=>v.id===h);return m?.estimated_arrival_time?rR(m.estimated_arrival_time):(n?new Date(n):new Date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}const a=e[r-1];if(!a)return"00:00";let l=null;for(const h of a.originalStopIds){const m=t.find(g=>g.id===h);if(m?.arrival_time){l=new Date(m.arrival_time);break}}if(!l){const h=Tw(r-1,e,t,n),m=new Date,[g,v]=h.split(":").map(Number);l=new Date(m.getFullYear(),m.getMonth(),m.getDate(),g,v)}let c=0;for(const h of o.originalStopIds){const m=t.find(g=>g.id===h);m?.duration_from_previous&&(c+=m.duration_from_previous)}return new Date(l.getTime()+c*1e3).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})},rR=r=>{if(/^\d{2}:\d{2}$/.test(r))return r;try{return new Date(r).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}catch{return r}},nR=()=>{const r=d=>d.type==="dentist"?d.packages.every(h=>h.status==="completed"||h.status==="error"):d.packages.some(h=>h.selected);return{canCompleteUIStop:r,canCompleteGroupedStop:d=>{const h=d.deliveryShipments.every(g=>["delivered","delivery_error"].includes(g.delivery_status)),m=d.pickupShipments.every(g=>["picked_up","pickup_error"].includes(g.pickup_status));return h&&m},canProcessPackage:(d,h)=>h==="dentist"?!0:d.status==="pending",canCompleteRoute:(d,h)=>{if(h!==d.length-1)return{canComplete:!1,reason:"Tous les stops doivent être complétés"};const m=d[h];return r(m)?{canComplete:!0}:{canComplete:!1,reason:"Le dernier stop doit être complété"}},analyzeStopProgress:d=>{const h=d.packages.length,m=d.packages.filter(w=>w.status==="completed").length,g=d.packages.filter(w=>w.status==="error").length,v=d.packages.filter(w=>w.status==="pending").length,x=d.packages.filter(w=>w.selected).length;return{total:h,completed:m,errors:g,pending:v,selected:x,progressPercentage:h>0?Math.round(m/h*100):0,canComplete:r(d),hasErrors:g>0,allCompleted:m===h,hasProgress:m>0||g>0}},analyzeRouteProgress:(d,h)=>{const m=d.length,g=d.filter(S=>S.isCompleted).length,v=d.filter(S=>S.packages.some(_=>_.status==="error")).length,x=Math.round(h/m*100),w=Math.round(g/m*100);return{totalStops:m,completedStops:g,currentStopIndex:h,stopsWithErrors:v,currentProgress:x,completionProgress:w,isLastStop:h===m-1,remainingStops:m-h-1,canProceed:h<m}},getNextRequiredAction:d=>{if(d.type==="dentist"){const h=d.packages.filter(m=>m.status==="pending");return h.length>0?`Prendre ${h.length} photo(s) manquante(s)`:"Tous les colis sont traités"}else{const h=d.packages.filter(m=>m.selected);return h.length===0?"Sélectionner au moins un colis":`${h.length} colis sélectionné(s)`}},validatePackageConsistency:d=>{const h=[];return d.status==="completed"&&!d.proofPhoto&&h.push("Photo de preuve manquante pour un colis complété"),d.status==="error"&&(!d.issuePhoto||!d.issueType)&&h.push("Photo et type de problème requis pour un colis en erreur"),d.type==="delivery"&&!d.from&&h.push("Origine manquante pour une livraison"),d.type==="pickup"&&!d.to&&h.push("Destination manquante pour une récupération"),{isValid:h.length===0,errors:h}}}},sR=()=>{const r=et(),e=j.useMemo(()=>(h,m)=>{const g=t(h.id);if(!g)return{...h,displayLabel:h.from||h.to||`Package ${h.id.slice(-8)}`,displayIcon:h.type==="pickup"?"pickup":"delivery",originalShipment:{}};const v=r.route.groupedStops[r.route.currentStopIndex];if(!v)return{...h,displayLabel:h.from||h.to||`Package ${h.id.slice(-8)}`,displayIcon:h.type==="pickup"?"pickup":"delivery",originalShipment:g};const{stop:x,context:w}=n(g,v.id);if(!x)return{...h,displayLabel:h.from||h.to||`Package ${h.id.slice(-8)}`,displayIcon:h.type==="pickup"?"pickup":"delivery",originalShipment:g};console.log("🔍 Contexte et stop pour affichage:",{shipmentId:g.id.slice(-8),context:w,stopType:x.stop_type,stopId:x.id});const{displayLabel:S,displayIcon:_}=o(g,x,w,r.referenceData.locations,r.referenceData.laboratories,r.referenceData.laboratoryClients);return{...h,displayLabel:S,displayIcon:_,originalShipment:g}},[r.referenceData,r.route.currentStopIndex,r.route.groupedStops]),t=h=>{for(const m of r.route.groupedStops){const v=[...m.deliveryShipments,...m.pickupShipments].find(x=>x.id===h);if(v)return v}return null},n=(h,m)=>{const g=r.route.groupedStops.find(_=>_.id===m);if(!g)return console.log("❌ GroupedStop actuel non trouvé:",m),{stop:null,context:"unknown"};const v=r.route.rawStops.find(_=>_.id===h.pickup_stop_id),x=r.route.rawStops.find(_=>_.id===h.delivery_stop_id);console.log("🔍 Debug contexte shipment:",{shipmentId:h.id.slice(-8),shipmentType:h.shipment_type,pickupStopId:h.pickup_stop_id,deliveryStopId:h.delivery_stop_id,currentGroupedStopOriginalIds:g.originalStopIds,pickupStopType:v?.stop_type,deliveryStopType:x?.stop_type});const w=g.originalStopIds.includes(h.pickup_stop_id),S=g.originalStopIds.includes(h.delivery_stop_id);return w&&v?(console.log("🎯 Contexte: PICKUP (départ) - stop:",{stopId:v.id,stopType:v.stop_type}),{stop:v,context:"pickup"}):S&&x?(console.log("🎯 Contexte: DELIVERY (arrivée) - stop:",{stopId:x.id,stopType:x.stop_type}),{stop:x,context:"delivery"}):(console.log("❌ Impossible de déterminer le contexte pour shipment:",h.id.slice(-8)),{stop:null,context:"unknown"})},o=(h,m,g,v,x,w)=>{const S=h.shipment_type?.trim(),_=m.stop_type?.trim(),C=a(h,w),E=l(h,x,w);if(console.log("🔍 Debug affichage avec contexte:",{shipmentId:h.id.slice(-8),shipmentType:S,stopType:_,context:g,clientName:C,laboratoryName:E}),S==="client_delivery"){if(g==="pickup")return console.log("✅ client_delivery + pickup context → Livraison client"),{displayLabel:`Livraison ${C}`,displayIcon:"delivery"};if(g==="delivery")return console.log("✅ client_delivery + delivery context → Livraison laboratoire"),{displayLabel:`Livraison ${E}`,displayIcon:"delivery"}}if(S==="client_pickup"){if(g==="pickup")return console.log("✅ client_pickup + pickup context → Récupération laboratoire"),{displayLabel:`Récupération ${E}`,displayIcon:"pickup"};if(g==="delivery")return console.log("✅ client_pickup + delivery context → Retour client"),{displayLabel:`Retour ${C}`,displayIcon:"return"}}switch(console.log("⚠️ Contexte unknown, fallback sur stop_type"),_){case"lab_pickup":case"depot_pickup":return{displayLabel:`Livraison ${C}`,displayIcon:"delivery"};case"client":return S==="client_delivery"?{displayLabel:`Livraison ${E}`,displayIcon:"delivery"}:S==="client_pickup"?{displayLabel:`Récupération ${E}`,displayIcon:"pickup"}:{displayLabel:`Livraison ${E}`,displayIcon:"delivery"};case"lab_dropoff":case"depot_dropoff":return S==="client_delivery"?{displayLabel:`Livraison ${C}`,displayIcon:"delivery"}:S==="client_pickup"?{displayLabel:`Retour ${C}`,displayIcon:"return"}:{displayLabel:`Livraison ${C}`,displayIcon:"delivery"};default:return{displayLabel:`Shipment ${h.shipment_ref||h.id.slice(-8)}`,displayIcon:"delivery"}}},a=(h,m)=>{if(h.laboratory_client_id){const g=m.get(h.laboratory_client_id);if(g)return g.name}return`Client ${h.shipment_ref||h.id.slice(-8)}`},l=(h,m,g)=>{if(console.log("🔍 Debug getLaboratoryName:",{shipmentId:h.id.slice(-8),laboratoryId:h.laboratory_id,laboratoryClientId:h.laboratory_client_id,laboratoriesMapSize:m.size,clientsMapSize:g.size,shipmentRef:h.shipment_ref}),h.laboratory_id){const x=m.get(h.laboratory_id);if(console.log("🔍 Recherche laboratoire par laboratory_id:",{laboratoryId:h.laboratory_id,found:!!x,laboratoryName:x?.name}),x)return x.name}if(h.laboratory_client_id){const x=g.get(h.laboratory_client_id);if(console.log("🔍 Recherche laboratoire via laboratory_client_id:",{laboratoryClientId:h.laboratory_client_id,clientFound:!!x,clientLaboratoryId:x?.laboratory_id}),x&&x.laboratory_id){const w=m.get(x.laboratory_id);if(console.log("🔍 Laboratoire trouvé via client:",{laboratoryId:x.laboratory_id,found:!!w,laboratoryName:w?.name}),w)return w.name}}if(h.laboratory_id){const x=`Laboratoire ${h.laboratory_id.slice(-8)}`;return console.log("🔍 Fallback avec laboratory_id:",x),x}const v=`Laboratoire ${h.id.slice(-8)}`;return console.log("🔍 Dernier recours:",v),v};return{enrichPackage:e,enrichStopPackages:(h,m)=>{console.log("🔍 État des Maps de référence:",{laboratoriesSize:r.referenceData.laboratories.size,laboratoryClientsSize:r.referenceData.laboratoryClients.size,locationsSize:r.referenceData.locations.size,lastRefreshTime:new Date(r.referenceData.lastRefreshTime).toISOString()});const g=Array.from(r.referenceData.laboratories.values()).slice(0,3);return console.log("🔍 Exemples de laboratories dans la Map:",g),h.map(v=>e(v,m))},getPackageDisplayStyle:h=>{switch(h){case"delivery":return{color:"text-blue-800 dark:text-blue-200",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-700"};case"pickup":return{color:"text-emerald-800 dark:text-emerald-200",bgColor:"bg-emerald-50 dark:bg-emerald-900/20",borderColor:"border-emerald-200 dark:border-emerald-700"};case"return":return{color:"text-amber-800 dark:text-amber-200",bgColor:"bg-amber-50 dark:bg-amber-900/20",borderColor:"border-amber-200 dark:border-amber-700"};default:return{color:"text-gray-800 dark:text-gray-200",bgColor:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-700"}}},findOriginalShipment:t,getShipmentDisplayLogic:o,getClientName:a,getLaboratoryName:l}},oR=()=>{const[r,e]=j.useState(!1),[t,n]=j.useState(!1),[o,a]=j.useState(!1),[l,c]=j.useState(!1),[d,h]=j.useState(!1),[m,g]=j.useState(!1),[v,x]=j.useState(null),[w,S]=j.useState(null),[_,C]=j.useState(null),[E,N]=j.useState(null),[M,A]=j.useState({isForIssue:!1,isUnexpectedPickup:!1}),[K,Z]=j.useState({}),W=tR(),de=eR(),pe=nR(),Ee=sR(),ee=Y2(),ye=j.useMemo(()=>W.isInitialized&&W.hasActiveRoute&&W.currentStop!==null&&!m&&!ee.isLoadingPhotos,[W.isInitialized,W.hasActiveRoute,W.currentStop,m,ee.isLoadingPhotos]);j.useCallback((he,Ve)=>{Z(Be=>({...Be,[he]:Ve}))},[]);const G=j.useCallback(he=>{if(console.log(`🖱️ [handlePackageClick] CLIC sur package ${he.slice(-8)}`),!W.currentStop){console.warn("⚠️ [handlePackageClick] Pas de currentStop, clic ignoré");return}if(_||l){console.warn("⚠️ [handlePackageClick] Caméra déjà active, clic ignoré:",{selectedPackageForPhoto:_?.slice(-8),showCameraModal:l,newPackageId:he.slice(-8),timestamp:Date.now()}),_===he&&console.log("🔍 [handlePackageClick] Double-clic détecté sur le même package");return}const Ve=W.currentStop.packages.find(Be=>Be.id===he);console.log("📦 [handlePackageClick] État du package au clic:",{id:he.slice(-8),status:Ve?.status,selected:Ve?.selected,stopType:W.currentStop.type}),W.currentStop.type==="dentist"?(console.log("👩‍⚕️ [handlePackageClick] Stop dentiste - Ouverture caméra immédiate"),console.log("🔄 [handlePackageClick] Configuration des états caméra..."),C(he),A({isForIssue:!1}),c(!0),console.log("📷 [handlePackageClick] Caméra configurée pour package:",{packageId:he.slice(-8),timestamp:Date.now(),stopType:W.currentStop.type})):(console.log("🏢 [handlePackageClick] Stop lab/dépôt - Toggle statut"),de.handlePackageClick(he))},[W.currentStop,de,_,l]),Se=j.useCallback((he,Ve)=>{if(Ve.stopPropagation(),!W.currentStop)return;const Be=W.currentStop.packages.find(Je=>Je.id===he);Be&&(Be.status==="error"?(C(he),A({isForIssue:!1}),c(!0)):(x(he),n(!0)))},[W.currentStop]),Ce=j.useCallback(he=>{v&&(n(!1),C(v),A({isForIssue:!0,issueType:he}),c(!0))},[v]),_e=j.useCallback(()=>{console.log("📷 [handleCameraClose] Fermeture de la caméra sans photo - Reset complet des états");const he=_;if(he){console.log(`🔍 [handleCameraClose] Package concerné: ${he.slice(-8)}`);const Be=W.currentStop;if(Be){const Je=Be.packages.find(Nt=>Nt.id===he);console.log("📦 [handleCameraClose] État du package avant reset:",{id:he.slice(-8),status:Je?.status,selected:Je?.selected,type:Je?.type})}}console.log("🔄 [handleCameraClose] Reset via setter avec auto-reset..."),(Be=>{c(Be),C(null),x(null),N(null),A({isForIssue:!1,isUnexpectedPickup:!1})})(!1),console.log("✅ [handleCameraClose] États caméra reset immédiatement - Package re-cliquable")},[_,W.currentStop]),te=j.useCallback(async(he,Ve)=>{console.log("🎬 [handlePhotoTaken] ========== DÉBUT ==========");const Be=he instanceof Blob?`[Blob ${Math.round(he.size/1024)}KB]`:he.slice(0,30);console.log("📷 [handlePhotoTaken] Paramètres reçus:",{photoType:he instanceof Blob?"Blob":"base64",photoInfo:Be,packageIdParam:Ve?.slice(-8),selectedPackageForPhoto:_?.slice(-8),showCameraModal:l,photoConfig:M});const Je=Ve||_;if(console.log("📷 [handlePhotoTaken] Package ID résolu:",{targetPackageId:Je?.slice(-8),isUnexpectedPickup:M.isUnexpectedPickup}),!Je){console.error("❌ [handlePhotoTaken] Aucun package ID disponible - FERMETURE FORCÉE"),c(!1),C(null);return}if(M.isUnexpectedPickup&&E){console.log("📦 Traitement récupération inattendue via hook composite:",{labId:E.labId,labName:E.labName,photoUrl:Be,currentStop:W.currentStop?.name});try{await de.handleUnexpectedPickupPhoto(E.labId,E.labName,Be),console.log("✅ Récupération inattendue traitée avec succès")}catch(Nr){console.error("❌ Erreur lors du traitement de la récupération inattendue:",Nr)}(Nr=>{c(Nr),C(null),x(null),N(null),A({isForIssue:!1,isUnexpectedPickup:!1})})(!1),console.log("✅ [handlePhotoTaken] Unexpected pickup traité - États reset via setter auto-reset");return}console.log("📦 [handlePhotoTaken] Traitement package normal:",{packageId:Je.slice(-8),isForIssue:M.isForIssue,issueType:M.issueType});try{if(he instanceof Blob)throw new Error("Erreur de flux : handlePhotoTaken (composite) a reçu un Blob au lieu d'un base64. La conversion aurait dû se faire dans route-page.");await de.handlePhotoTaken(he,Je,M.isForIssue,M.issueType),console.log("✅ [handlePhotoTaken] Photo traitée avec succès pour:",Je.slice(-8))}catch(sr){console.error("❌ [handlePhotoTaken] Erreur lors du traitement photo:",sr),alert(`Erreur lors de l'enregistrement de la photo: ${sr instanceof Error?sr.message:"Erreur inconnue"}

Veuillez réessayer.`),console.log("🚪 [handlePhotoTaken] Fermeture forcée après erreur"),c(!1),C(null),A({isForIssue:!1,isUnexpectedPickup:!1});return}console.log("🚪 [handlePhotoTaken] Préparation fermeture modal...");const Rr=sr=>{console.log(`🚪 [setShowCameraModalWithAutoReset] show=${sr}`),c(sr),console.log("🧹 [setShowCameraModalWithAutoReset] Reset de tous les états..."),C(null),x(null),N(null),A({isForIssue:!1,isUnexpectedPickup:!1})};console.log("🚪 [handlePhotoTaken] Appel setShowCameraModalWithAutoReset(false)..."),Rr(!1),console.log("✅ [handlePhotoTaken] ========== FIN (modal fermée) ==========")},[M,E,de,W.currentStop,l,_]),X=j.useCallback(()=>{const he=Math.random().toString(36).substring(7);S(he),a(!0)},[]),oe=j.useCallback((he,Ve)=>{if(console.log("🏥 [handleSelectLab] Démarrage avec:",{labId:he,labName:Ve}),!W.currentStop){console.warn("⚠️ [handleSelectLab] Pas de currentStop, arrêt");return}N({labId:he,labName:Ve}),C(`unexpected_pickup_${he}_${Date.now()}`),A({isForIssue:!1,isUnexpectedPickup:!0}),a(!1),S(null),c(!0),console.log("📸 [handleSelectLab] Ouverture caméra pour récupération inattendue:",{labId:he,labName:Ve})},[W.currentStop]),L=j.useCallback(async(he,Ve)=>{console.log("📸 Prise de photo directe pour récupération inattendue:",{labId:he,labName:Ve}),N({labId:he,labName:Ve}),C(`unexpected_pickup_${he}_${Date.now()}`),A({isForIssue:!1,isUnexpectedPickup:!0}),c(!0)},[]),Q=j.useCallback(async()=>{if(W.currentStop){if(!pe.canCompleteUIStop(W.currentStop)){console.warn("Stop non validable selon les règles métier");return}h(!0);try{await de.handleCompleteStop()}catch(he){console.error("Erreur lors de la validation:",he)}finally{h(!1)}}},[W.currentStop,pe,de]),De=j.useMemo(()=>{if(!W.currentStop)return null;const he=Ee.enrichStopPackages(W.currentStop.packages,W.currentStop.type);return{...W.currentStop,packages:he}},[W.currentStop,Ee]),He=j.useMemo(()=>De?pe.canCompleteUIStop(De):!1,[De,pe]),rt=j.useMemo(()=>De?pe.analyzeStopProgress(De):null,[De,pe]);return{...W,currentStop:De,isFullyLoaded:ye,isLoadingStopData:m,showLocationPhotos:r,showIssueModal:t,showLabModal:o,showCameraModal:l,isCompleting:d,selectedPackageForIssue:v,selectedPackageForLab:w,selectedPackageForPhoto:_,selectedLabForUnexpected:E,photoConfig:M,canCompleteCurrentStop:He,stopProgress:rt,currentStopPhotos:ee.currentStopPhotos,isLoadingPhotos:ee.isLoadingPhotos,handlePackageClick:G,handleReportIssue:Se,handleSelectIssueType:Ce,handlePhotoTaken:te,handleCameraClose:_e,handleUnexpectedPickup:X,handleSelectLab:oe,handleTakeUnexpectedPickupPhoto:L,handleCompleteStop:Q,setShowLocationPhotos:e,setShowIssueModal:he=>{n(he),he||x(null)},setShowLabModal:he=>{a(he),he||S(null)},setShowCameraModal:he=>{c(he),he||(C(null),x(null),N(null),A({isForIssue:!1,isUnexpectedPickup:!1}))},navigateToStop:de.navigateToStop,startRoute:de.startRoute,validation:pe,routeActions:de,displayLogic:Ee,photosCache:ee,resetRouteForTesting:de.resetRouteForTesting}},iR=()=>{const r=et();return j.useMemo(()=>{if(!r.route.driverRoute)return{stats:{completed:0,errors:0,pending:0,totalStops:0,totalShipments:0},completedStops:[],pendingStops:[],allStops:[],isActiveRoute:!1};const{groupedStops:e,rawStops:t,rawShipments:n}=r.route,{locations:o,laboratories:a,laboratoryClients:l}=r.referenceData,c=e.map(w=>aR(w,t,n,o,a,l));let d=0,h=0,m=0;const g=[],v=[];return c.forEach(w=>{if(w.status==="pending")m++,v.push(w);else{if(w.hasFailedShipments)h++;else if(w.allShipmentsCompleted)d++;else{m++,v.push(w);return}g.push(w)}}),{stats:{completed:d,errors:h,pending:m,totalStops:c.length,totalShipments:c.reduce((w,S)=>w+S.shipments.length,0)},completedStops:g,pendingStops:v,allStops:c,isActiveRoute:!0}},[r.route.driverRoute,r.route.groupedStops,r.route.rawStops,r.route.rawShipments,r.referenceData.locations,r.referenceData.laboratories,r.referenceData.laboratoryClients])};function aR(r,e,t,n,o,a){const l=e.filter(C=>r.originalStopIds.includes(C.id)),d=t.filter(C=>r.originalStopIds.includes(C.pickup_stop_id)||r.originalStopIds.includes(C.delivery_stop_id)).map(C=>cR(C,l,n,o,a)),h=lR(r,l),m=d.some(C=>C.status==="error"),g=d.length>0&&d.every(C=>C.status==="completed"),v=h!=="pending",x=l[0],w=x?.estimated_arrival_time?zv(x.estimated_arrival_time):void 0,S=x?.arrival_time?zv(x.arrival_time):void 0,_=fR(r.type);return{id:r.id,originalStopIds:r.originalStopIds,name:r.type==="depot"?"MIKA":r.clientName||r.laboratoryName||"Lieu inconnu",type:_,status:h,estimatedTime:w,actualTime:S,shipments:d.map(C=>({...C,hasPhoto:_==="client"?C.hasPhoto:!1,photoUrl:_==="client"?C.photoUrl:void 0})),hasFailedShipments:m,allShipmentsCompleted:g,isProcessed:v,isLateStop:r.isLateStop}}function lR(r,e){return r.status==="completed"||e.some(n=>n.completed)?"completed":"pending"}function cR(r,e,t,n,o){const{currentStop:a,context:l}=uR(r,e);if(!a)return yR(r);const{displayLabel:c,displayIcon:d}=dR(r,a,l,t,n,o),h=pR(r,a),m=!!r.proof_photo_url;return{id:r.id,shipment:r,displayLabel:c,displayIcon:d,status:h,hasPhoto:m,photoUrl:r.proof_photo_url}}function uR(r,e){const t=e.find(d=>d.id===r.pickup_stop_id),n=e.find(d=>d.id===r.delivery_stop_id),o=e.map(d=>d.id),a=o.includes(r.pickup_stop_id),l=o.includes(r.delivery_stop_id);return a&&t?{currentStop:t,context:"pickup"}:l&&n?{currentStop:n,context:"delivery"}:{currentStop:t||n||null,context:"unknown"}}function dR(r,e,t,n,o,a){const l=r.shipment_type?.trim(),c=mR(r,a),d=gR(r,o,a);if(l==="client_delivery"){if(t==="pickup")return{displayLabel:`Livraison ${c}`,displayIcon:"delivery"};if(t==="delivery")return{displayLabel:`Livraison ${d}`,displayIcon:"delivery"}}if(l==="client_pickup"){if(t==="pickup")return{displayLabel:`Récupération ${d}`,displayIcon:"pickup"};if(t==="delivery")return{displayLabel:`Retour ${c}`,displayIcon:"return"}}return hR(r,e,c,d)}function hR(r,e,t,n){const o=r.shipment_type?.trim(),a=e.stop_type?.trim();if(o==="client_delivery")switch(a){case"lab_pickup":case"depot_pickup":return{displayLabel:`Livraison ${t}`,displayIcon:"delivery"};case"client":return{displayLabel:`Livraison ${n}`,displayIcon:"delivery"};case"depot_dropoff":return{displayLabel:`Livraison ${t}`,displayIcon:"delivery"};default:return{displayLabel:`Livraison ${t}`,displayIcon:"delivery"}}if(o==="client_pickup")switch(a){case"lab_dropoff":return{displayLabel:`Retour ${t}`,displayIcon:"return"};case"client":return{displayLabel:`Récupération ${n}`,displayIcon:"pickup"};case"depot_dropoff":return{displayLabel:`Retour ${t}`,displayIcon:"return"};default:return{displayLabel:`Récupération ${t}`,displayIcon:"pickup"}}return{displayLabel:`Shipment ${r.shipment_ref||r.id.slice(-8)}`,displayIcon:"delivery"}}function fR(r){switch(r){case"laboratory":return"laboratory";case"depot":return"depot";case"client_grouped":case"client_single":return"client";default:return"client"}}function pR(r,e){const t=e.id===r.pickup_stop_id,n=e.id===r.delivery_stop_id;if(t){const o=r.pickup_status?.trim();return o==="completed"?"completed":o==="failed"?"error":"pending"}if(n){const o=r.delivery_status?.trim();return o==="completed"?"completed":o==="failed"?"error":"pending"}return"pending"}function zv(r){if(/^\d{2}:\d{2}$/.test(r))return r;try{return new Date(r).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}catch{return r}}function mR(r,e){if(r.laboratory_client_id){const t=e.get(r.laboratory_client_id);if(t)return t.name}return`Client ${r.shipment_ref||r.id.slice(-8)}`}function gR(r,e,t){if(r.laboratory_id){const n=e.get(r.laboratory_id);if(n)return n.name}if(r.laboratory_client_id){const n=t.get(r.laboratory_client_id);if(n&&n.laboratory_id){const o=e.get(n.laboratory_id);if(o)return o.name}}return`Laboratoire ${r.shipment_ref||r.id.slice(-8)}`}function yR(r){return{id:r.id,shipment:r,displayLabel:`Shipment ${r.shipment_ref||r.id.slice(-8)}`,displayIcon:"delivery",status:"pending",hasPhoto:!!r.proof_photo_url,photoUrl:r.proof_photo_url}}const vR=r=>{const{locationId:e,enabled:t=!0,isLocationId:n=!0}=r,o=et(),[a,l]=j.useState(!1),[c,d]=j.useState(null),[h,m]=j.useState(!1),g=j.useRef(null),v=j.useRef(null),x=j.useCallback(N=>n?o.route.groupedStops.find(M=>M.location_id===N):null,[o.route.groupedStops,n]),w=j.useCallback(async(N=!1)=>{if(!(!e||!t)){l(!0),d(null);try{if(!n){console.warn("⚠️ [useUnexpectedPickup] Mode adresse non supporté par le cache optimisé"),d("Mode adresse non supporté");return}if(!o.unexpectedPickups.isInitialized){console.log("⏳ [useUnexpectedPickup] Attente initialisation du sous-store unexpected..."),setTimeout(()=>w(N),1e3);return}const M=x(e);if(!M){console.warn("⚠️ [useUnexpectedPickup] Stop non trouvé pour location:",e),d("Stop non trouvé");return}if(o.getEligibleLabsForStop(M.id).needsRefresh&&N){console.log("🔄 [useUnexpectedPickup] Rafraîchissement du cache pour stop:",M.id),await o.refreshEligibilityForStop(M.id);const K=o.getEligibleLabsForStop(M.id);console.log("✅ [useUnexpectedPickup] Cache rafraîchi:",K)}m(!0)}catch(M){console.error("❌ [useUnexpectedPickup] Erreur lors du chargement:",M),d(M instanceof Error?M.message:"Erreur inconnue")}finally{l(!1)}}},[e,t,n,o,x]),S=j.useCallback(()=>{w(!0)},[w]);j.useEffect(()=>{if(!(!e||!t))return v.current&&clearTimeout(v.current),g.current!==e?(g.current=e,m(!1),w(!0)):v.current=setTimeout(()=>{w(!1)},500),()=>{v.current&&clearTimeout(v.current)}},[e,t,w]);const C=j.useCallback(()=>{if(!e||!n)return{eligibleLabs:[],hasButton:!1,needsRefresh:!1};const N=x(e);return N?o.getEligibleLabsForStop(N.id):{eligibleLabs:[],hasButton:!1,needsRefresh:!1}},[e,n,x,o])(),E=C.hasButton&&h&&!c;return Me.useEffect(()=>{},[E,C.hasButton,h,c,e,C.eligibleLabs.length]),{eligibleLabs:C.eligibleLabs,isLoading:a&&!h,error:c,shouldShowButton:E,needsLabSelection:C.eligibleLabs.length>1,refetch:S}},Aw=()=>{const r=et(),e=Pw(),[t,n]=j.useState(!0),[o,a]=j.useState(0),l=j.useRef(null),[c,d]=j.useState(!1),[h,m]=j.useState([]);console.log("🔍 [useSyncStatus] État initial:",{hasRoute:!!r.route.driverRoute,routeId:r.route.driverRoute?.id,routeExistsInSupabase:t,syncPendingActions:r.sync.pendingActions.length,syncFailedActions:r.sync.failedActions.length,appSyncOnline:e.actionSync.isOnline,appSyncSyncing:e.actionSync.isSyncing});const g=j.useCallback(async()=>{const S=r.route.driverRoute;if(!S)return console.log("✅ [useSyncStatus] Aucune route chargée dans le store - état synchronisé"),n(!0),{routeExists:!0,inconsistencies:[]};const _=[];try{console.log("🔍 [useSyncStatus] Vérification complète route + stops + shipments:",S.id);const{data:C,error:E}=await Oe.from("driver_routes").select("id, status, updated_at").eq("id",S.id).single();if(E)return console.error("❌ [useSyncStatus] Erreur vérification route:",E),E.code==="PGRST116"?(console.log("🔴 [useSyncStatus] Route supprimée de Supabase !"),n(!1),{routeExists:!1,inconsistencies:["Route supprimée de Supabase"]}):(n(!0),{routeExists:!0,inconsistencies:[]});if(!C)return console.log("❌ [useSyncStatus] Route non trouvée sur Supabase"),n(!1),{routeExists:!1,inconsistencies:["Route non trouvée sur Supabase"]};const{data:N,error:M}=await Oe.from("driver_route_stops").select("id, completed, arrival_time, stop_order").eq("route_id",S.id).order("stop_order",{ascending:!0});if(M)console.error("❌ [useSyncStatus] Erreur vérification stops:",M);else{const Z=r.route.rawStops,W=new Set(Z.map(ee=>ee.id)),de=new Set((N||[]).map(ee=>ee.id)),pe=Z.filter(ee=>!de.has(ee.id)),Ee=(N||[]).filter(ee=>!W.has(ee.id));pe.length>0&&console.log("ℹ️ [useSyncStatus] Stops supprimés détectés (sync temps réel):",pe.map(ee=>ee.id)),Ee.length>0&&console.log("ℹ️ [useSyncStatus] Nouveaux stops détectés (sync temps réel):",Ee.map(ee=>ee.id)),console.log("📍 [useSyncStatus] Vérification stops:",{local:Z.length,supabase:N?.length||0,deleted:pe.length,added:Ee.length})}const{data:A,error:K}=await Oe.from("driver_route_shipments").select("id, pickup_status, delivery_status, updated_at").eq("route_id",S.id);if(K)console.error("❌ [useSyncStatus] Erreur vérification shipments:",K);else{const Z=r.route.rawShipments,W=new Set(Z.map(G=>G.id)),de=new Set((A||[]).map(G=>G.id)),pe=Z.filter(G=>!de.has(G.id)),Ee=(A||[]).filter(G=>!W.has(G.id));pe.length>0&&console.log("ℹ️ [useSyncStatus] Shipments supprimés détectés (sync temps réel):",pe.map(G=>G.id)),Ee.length>0&&console.log("ℹ️ [useSyncStatus] Nouveaux shipments détectés (sync temps réel):",Ee.map(G=>G.id));let ee=0;const ye=Date.now()-1e4;Z.forEach(G=>{const Se=(A||[]).find(Ce=>Ce.id===G.id);if(Se){const Ce=new Date(G.updated_at||0).getTime();new Date(Se.updated_at||0).getTime()>Ce&&(Se.pickup_status!==G.pickup_status||Se.delivery_status!==G.delivery_status)&&Ce<ye&&ee++}}),ee>0&&(console.log("⚠️ [useSyncStatus] Vrais conflits externes détectés:",ee),_.push(`${ee} shipment(s) modifié(s) par un système externe`)),console.log("📦 [useSyncStatus] Vérification shipments:",{local:Z.length,supabase:A?.length||0,deleted:pe.length,added:Ee.length,statusConflicts:ee})}return console.log("✅ [useSyncStatus] Vérification complète terminée"),n(!0),a(Date.now()),{routeExists:!0,inconsistencies:_,route:C,stopsCount:N?.length||0,shipmentsCount:A?.length||0}}catch(C){return console.error("❌ [useSyncStatus] Erreur exception vérification complète:",C),n(!0),{routeExists:!0,inconsistencies:[]}}},[r.route.driverRoute,r.route.rawStops,r.route.rawShipments]),v=j.useCallback(async()=>(await g()).routeExists,[g]);j.useEffect(()=>{if(!c){console.log("🔍 [useSyncStatus] Initialisation vérification légère route..."),d(!0);const S=setInterval(()=>{r.route.driverRoute&&(console.log("🔍 [useSyncStatus] Vérification périodique existence route..."),g().then(C=>{C.routeExists||(console.log("🚨 [useSyncStatus] Route supprimée détectée lors de la vérification périodique !"),m(["Route supprimée de Supabase"]))}).catch(C=>{console.warn("⚠️ [useSyncStatus] Erreur vérification périodique:",C)}))},12e4);return()=>{clearInterval(S)}}},[c,r,g]),typeof window<"u"&&(window.debugCheckRoute=()=>{console.log("🔍 [DEBUG] Vérification manuelle de la route..."),g().then(S=>{console.log("📊 [DEBUG] Résultat vérification:",S),S.routeExists?(console.log("✅ [DEBUG] Route existe encore"),m([])):(console.log("🚨 [DEBUG] Route supprimée détectée !"),m(["Route supprimée de Supabase"]))})}),j.useEffect(()=>{const S=r.route.driverRoute;if(S?(console.log("🔍 [useSyncStatus] Vérification existence route (sans refetch)..."),g().then(C=>{m(C.inconsistencies),C.routeExists||console.log("🚨 [useSyncStatus] Route supprimée détectée !")}).catch(C=>{console.warn("⚠️ [useSyncStatus] Erreur vérification route:",C),m([])})):m([]),!S){console.log("🧹 [useSyncStatus] Pas de route courante - nettoyage subscription"),l.current&&(Oe.removeChannel(l.current),l.current=null);return}console.log("🎧 [useSyncStatus] Écoute changements sur route:",S.id);const _=Oe.channel(`sync_status_route_${S.id}`).on("postgres_changes",{event:"DELETE",schema:"public",table:"driver_routes",filter:`id=eq.${S.id}`},C=>{console.log("🔴 [useSyncStatus] Route supprimée détectée en temps réel !",C),n(!1)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"driver_routes",filter:`id=eq.${S.id}`},C=>{console.log("🔄 [useSyncStatus] Route mise à jour détectée:",C),n(!0)}).subscribe();return l.current=_,()=>{l.current&&(Oe.removeChannel(l.current),l.current=null)}},[r.route.driverRoute?.id,g]),j.useEffect(()=>{const S=setInterval(()=>{Date.now()-o>12e4&&g().then(E=>{m(E.inconsistencies)})},12e4);return()=>clearInterval(S)},[g,o]);const x=j.useCallback(()=>{const S=[],_=r.route.driverRoute;console.log("🔍 [useSyncStatus] Vérification incohérences complètes:",{hasRoute:!!_,routeId:_?.id,routeExistsInSupabase:t,detectedInconsistencies:h.length,shouldShowCritical:!!_&&(!t||h.length>0)}),h.length>0&&(console.log("🔴 [useSyncStatus] Incohérences détectées par vérification complète:",h),S.push(...h)),_&&!t&&!h.includes("Route supprimée de Supabase")&&(console.log("🔴 [useSyncStatus] Incohérence détectée : route dans store mais supprimée de Supabase"),S.push("Route supprimée de Supabase"));const C=r.sync.failedActions.filter(A=>A.retryCount>=A.maxRetries&&(A.type==="START_ROUTE"||A.type==="COMPLETE_ROUTE"));C.length>0&&S.push(`${C.length} action(s) critique(s) échouée(s)`);const E=Date.now(),N=r.route.driverRoute;let M=[];if(N?M=r.sync.pendingActions.filter(A=>{const K=E-A.timestamp,Z=A.retryCount>=3,W=K>14400*1e3;return Z&&W||A.type==="START_ROUTE"||A.type==="COMPLETE_ROUTE"}):M=r.sync.pendingActions.filter(A=>E-A.timestamp>1440*60*1e3),M.length>0){const A=N?"actions critiques échouées":"actions anciennes (>24h)";S.push(`${M.length} ${A}`)}if(_){const A=Date.now()-new Date(_.updated_at).getTime(),K=1440*60*1e3;A>K&&S.push(`Route trop ancienne (${Math.round(A/(3600*1e3))}h)`)}return console.log("🔍 [useSyncStatus] Incohérences détectées:",S),S},[r.route.driverRoute,r.sync.failedActions,r.sync.pendingActions,t,h]);return{syncStatus:j.useCallback(()=>{const S=x(),_=S.length>0,C=r.sync.failedActions.some(N=>N.retryCount>=N.maxRetries&&(N.type==="START_ROUTE"||N.type==="COMPLETE_ROUTE")),E=r.sync.failedActions.length>0&&!C;return console.log("🔍 [getSyncStatus] État complet:",{currentRoute:r.route.driverRoute?.id||"AUCUNE",routeExistsInSupabase:t,inconsistencies:S,hasCriticalIssues:_,hasCriticalFailedActions:C,hasMinorFailedActions:E,totalFailedActions:r.sync.failedActions.length,isOnline:e.actionSync.isOnline,isSyncing:e.actionSync.isSyncing,pendingActions:e.actionSync.pendingActions,failedActions:e.actionSync.failedActions}),S.length>0&&console.log("🚨 [getSyncStatus] DÉTAIL DES INCOHÉRENCES CRITIQUES:",{count:S.length,details:S,detectedInconsistencies:h,routeExists:t,failedActionTypes:r.sync.failedActions.map(N=>`${N.type} (retry: ${N.retryCount}/${N.maxRetries})`)}),_||C?{status:"critical_error",color:"bg-red-500",label:"Incohérence critique détectée",description:_?S.join(", "):"Action(s) critique(s) échouée(s) définitivement",canSync:!0,isCritical:!0,isSpinning:!1,details:{isOnline:e.actionSync.isOnline,isSyncing:e.actionSync.isSyncing,pendingActions:e.actionSync.pendingActions,failedActions:e.actionSync.failedActions,routeExists:t,routeId:r.route.driverRoute?.id,inconsistencies:S}}:E?{status:"offline",color:"bg-orange-500",label:"Actions échouées en cours de retry",description:`${r.sync.failedActions.length} action(s) échouée(s) - retry automatique`,canSync:!1,isCritical:!1,isSpinning:!1,details:{isOnline:e.actionSync.isOnline,isSyncing:e.actionSync.isSyncing,pendingActions:e.actionSync.pendingActions,failedActions:e.actionSync.failedActions,routeExists:t,routeId:r.route.driverRoute?.id,inconsistencies:S}}:e.actionSync.isSyncing||e.routeSync.isSyncInProgress?{status:"syncing",color:"bg-yellow-500",label:"Synchronisation en cours",description:"Synchronisation en cours...",canSync:!1,isCritical:!1,isSpinning:!0,details:{isOnline:e.actionSync.isOnline,isSyncing:e.actionSync.isSyncing,pendingActions:e.actionSync.pendingActions,failedActions:e.actionSync.failedActions,routeExists:t,routeId:r.route.driverRoute?.id,inconsistencies:S}}:!e.actionSync.isOnline&&e.actionSync.pendingActions>0?{status:"offline",color:"bg-orange-500",label:"Hors ligne - Actions en attente",description:`${e.actionSync.pendingActions} action(s) en attente de connexion`,canSync:!1,isCritical:!1,isSpinning:!1,details:{isOnline:e.actionSync.isOnline,isSyncing:e.actionSync.isSyncing,pendingActions:e.actionSync.pendingActions,failedActions:e.actionSync.failedActions,routeExists:t,routeId:r.route.driverRoute?.id,inconsistencies:S}}:{status:"synced",color:"bg-green-500",label:e.actionSync.pendingActions>0?"Actions en attente":"Synchronisé",description:e.actionSync.pendingActions>0?`${e.actionSync.pendingActions} action(s) en attente`:"Toutes les données sont synchronisées",canSync:!1,isCritical:!1,isSpinning:!1,details:{isOnline:e.actionSync.isOnline,isSyncing:e.actionSync.isSyncing,pendingActions:e.actionSync.pendingActions,failedActions:e.actionSync.failedActions,routeExists:t,routeId:r.route.driverRoute?.id,inconsistencies:S}}},[e.actionSync.isOnline,e.actionSync.isSyncing,e.actionSync.pendingActions,e.actionSync.failedActions,e.routeSync.isSyncInProgress,r.sync.failedActions,r.route.driverRoute,t,x])(),forceRouteCheck:v,forceCompleteCheck:g,routeExistsInSupabase:t,detectedInconsistencies:h}};var Al=r=>r.type==="checkbox",yo=r=>r instanceof Date,cr=r=>r==null;const jw=r=>typeof r=="object";var Lt=r=>!cr(r)&&!Array.isArray(r)&&jw(r)&&!yo(r),xR=r=>Lt(r)&&r.target?Al(r.target)?r.target.checked:r.target.value:r,bR=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,wR=(r,e)=>r.has(bR(e)),SR=r=>{const e=r.constructor&&r.constructor.prototype;return Lt(e)&&e.hasOwnProperty("isPrototypeOf")},rm=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Xt(r){let e;const t=Array.isArray(r),n=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)e=new Date(r);else if(r instanceof Set)e=new Set(r);else if(!(rm&&(r instanceof Blob||n))&&(t||Lt(r)))if(e=t?[]:{},!t&&!SR(r))e=r;else for(const o in r)r.hasOwnProperty(o)&&(e[o]=Xt(r[o]));else return r;return e}var Ju=r=>Array.isArray(r)?r.filter(Boolean):[],Mt=r=>r===void 0,je=(r,e,t)=>{if(!e||!Lt(r))return t;const n=Ju(e.split(/[,[\].]+?/)).reduce((o,a)=>cr(o)?o:o[a],r);return Mt(n)||n===r?Mt(r[e])?t:r[e]:n},mn=r=>typeof r=="boolean",nm=r=>/^\w*$/.test(r),Rw=r=>Ju(r.replace(/["|']|\]/g,"").split(/\.|\[/)),ft=(r,e,t)=>{let n=-1;const o=nm(e)?[e]:Rw(e),a=o.length,l=a-1;for(;++n<a;){const c=o[n];let d=t;if(n!==l){const h=r[c];d=Lt(h)||Array.isArray(h)?h:isNaN(+o[n+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;r[c]=d,r=r[c]}};const Vv={BLUR:"blur",FOCUS_OUT:"focusout"},Xr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Vn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};Me.createContext(null);var _R=(r,e,t,n=!0)=>{const o={defaultValues:e._defaultValues};for(const a in r)Object.defineProperty(o,a,{get:()=>{const l=a;return e._proxyFormState[l]!==Xr.all&&(e._proxyFormState[l]=!n||Xr.all),r[l]}});return o},yn=r=>typeof r=="string",kR=(r,e,t,n,o)=>yn(r)?(n&&e.watch.add(r),je(t,r,o)):Array.isArray(r)?r.map(a=>(n&&e.watch.add(a),je(t,a))):(n&&(e.watchAll=!0),t),Nw=(r,e,t,n,o)=>e?{...t[r],types:{...t[r]&&t[r].types?t[r].types:{},[n]:o||!0}}:{},Ja=r=>Array.isArray(r)?r:[r],Bv=()=>{let r=[];return{get observers(){return r},next:o=>{for(const a of r)a.next&&a.next(o)},subscribe:o=>(r.push(o),{unsubscribe:()=>{r=r.filter(a=>a!==o)}}),unsubscribe:()=>{r=[]}}},Qf=r=>cr(r)||!jw(r);function Rs(r,e){if(Qf(r)||Qf(e))return r===e;if(yo(r)&&yo(e))return r.getTime()===e.getTime();const t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(const o of t){const a=r[o];if(!n.includes(o))return!1;if(o!=="ref"){const l=e[o];if(yo(a)&&yo(l)||Lt(a)&&Lt(l)||Array.isArray(a)&&Array.isArray(l)?!Rs(a,l):a!==l)return!1}}return!0}var lr=r=>Lt(r)&&!Object.keys(r).length,sm=r=>r.type==="file",en=r=>typeof r=="function",ku=r=>{if(!rm)return!1;const e=r?r.ownerDocument:0;return r instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Iw=r=>r.type==="select-multiple",om=r=>r.type==="radio",CR=r=>om(r)||Al(r),gf=r=>ku(r)&&r.isConnected;function ER(r,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)r=Mt(r)?n++:r[e[n++]];return r}function PR(r){for(const e in r)if(r.hasOwnProperty(e)&&!Mt(r[e]))return!1;return!0}function Ft(r,e){const t=Array.isArray(e)?e:nm(e)?[e]:Rw(e),n=t.length===1?r:ER(r,t),o=t.length-1,a=t[o];return n&&delete n[a],o!==0&&(Lt(n)&&lr(n)||Array.isArray(n)&&PR(n))&&Ft(r,t.slice(0,-1)),r}var Dw=r=>{for(const e in r)if(en(r[e]))return!0;return!1};function Cu(r,e={}){const t=Array.isArray(r);if(Lt(r)||t)for(const n in r)Array.isArray(r[n])||Lt(r[n])&&!Dw(r[n])?(e[n]=Array.isArray(r[n])?[]:{},Cu(r[n],e[n])):cr(r[n])||(e[n]=!0);return e}function Lw(r,e,t){const n=Array.isArray(r);if(Lt(r)||n)for(const o in r)Array.isArray(r[o])||Lt(r[o])&&!Dw(r[o])?Mt(e)||Qf(t[o])?t[o]=Array.isArray(r[o])?Cu(r[o],[]):{...Cu(r[o])}:Lw(r[o],cr(e)?{}:e[o],t[o]):t[o]=!Rs(r[o],e[o]);return t}var Ia=(r,e)=>Lw(r,e,Cu(e));const qv={value:!1,isValid:!1},Hv={value:!0,isValid:!0};var Ow=r=>{if(Array.isArray(r)){if(r.length>1){const e=r.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!Mt(r[0].attributes.value)?Mt(r[0].value)||r[0].value===""?Hv:{value:r[0].value,isValid:!0}:Hv:qv}return qv},Mw=(r,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>Mt(r)?r:e?r===""?NaN:r&&+r:t&&yn(r)?new Date(r):n?n(r):r;const Wv={isValid:!1,value:null};var $w=r=>Array.isArray(r)?r.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Wv):Wv;function Gv(r){const e=r.ref;return sm(e)?e.files:om(e)?$w(r.refs).value:Iw(e)?[...e.selectedOptions].map(({value:t})=>t):Al(e)?Ow(r.refs).value:Mw(Mt(e.value)?r.ref.value:e.value,r)}var TR=(r,e,t,n)=>{const o={};for(const a of r){const l=je(e,a);l&&ft(o,a,l._f)}return{criteriaMode:t,names:[...r],fields:o,shouldUseNativeValidation:n}},Eu=r=>r instanceof RegExp,Da=r=>Mt(r)?r:Eu(r)?r.source:Lt(r)?Eu(r.value)?r.value.source:r.value:r,Kv=r=>({isOnSubmit:!r||r===Xr.onSubmit,isOnBlur:r===Xr.onBlur,isOnChange:r===Xr.onChange,isOnAll:r===Xr.all,isOnTouch:r===Xr.onTouched});const Zv="AsyncFunction";var AR=r=>!!r&&!!r.validate&&!!(en(r.validate)&&r.validate.constructor.name===Zv||Lt(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===Zv)),jR=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),Jv=(r,e,t)=>!t&&(e.watchAll||e.watch.has(r)||[...e.watch].some(n=>r.startsWith(n)&&/^\.\w+/.test(r.slice(n.length))));const Qa=(r,e,t,n)=>{for(const o of t||Object.keys(r)){const a=je(r,o);if(a){const{_f:l,...c}=a;if(l){if(l.refs&&l.refs[0]&&e(l.refs[0],o)&&!n)return!0;if(l.ref&&e(l.ref,l.name)&&!n)return!0;if(Qa(c,e))break}else if(Lt(c)&&Qa(c,e))break}}};function Qv(r,e,t){const n=je(r,t);if(n||nm(t))return{error:n,name:t};const o=t.split(".");for(;o.length;){const a=o.join("."),l=je(e,a),c=je(r,a);if(l&&!Array.isArray(l)&&t!==a)return{name:t};if(c&&c.type)return{name:a,error:c};o.pop()}return{name:t}}var RR=(r,e,t,n)=>{t(r);const{name:o,...a}=r;return lr(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(l=>e[l]===(!n||Xr.all))},NR=(r,e,t)=>!r||!e||r===e||Ja(r).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),IR=(r,e,t,n,o)=>o.isOnAll?!1:!t&&o.isOnTouch?!(e||r):(t?n.isOnBlur:o.isOnBlur)?!r:(t?n.isOnChange:o.isOnChange)?r:!0,DR=(r,e)=>!Ju(je(r,e)).length&&Ft(r,e),LR=(r,e,t)=>{const n=Ja(je(r,t));return ft(n,"root",e[t]),ft(r,t,n),r},hu=r=>yn(r);function Yv(r,e,t="validate"){if(hu(r)||Array.isArray(r)&&r.every(hu)||mn(r)&&!r)return{type:t,message:hu(r)?r:"",ref:e}}var li=r=>Lt(r)&&!Eu(r)?r:{value:r,message:""},Xv=async(r,e,t,n,o,a)=>{const{ref:l,refs:c,required:d,maxLength:h,minLength:m,min:g,max:v,pattern:x,validate:w,name:S,valueAsNumber:_,mount:C}=r._f,E=je(t,S);if(!C||e.has(S))return{};const N=c?c[0]:l,M=ee=>{o&&N.reportValidity&&(N.setCustomValidity(mn(ee)?"":ee||""),N.reportValidity())},A={},K=om(l),Z=Al(l),W=K||Z,de=(_||sm(l))&&Mt(l.value)&&Mt(E)||ku(l)&&l.value===""||E===""||Array.isArray(E)&&!E.length,pe=Nw.bind(null,S,n,A),Ee=(ee,ye,G,Se=Vn.maxLength,Ce=Vn.minLength)=>{const _e=ee?ye:G;A[S]={type:ee?Se:Ce,message:_e,ref:l,...pe(ee?Se:Ce,_e)}};if(a?!Array.isArray(E)||!E.length:d&&(!W&&(de||cr(E))||mn(E)&&!E||Z&&!Ow(c).isValid||K&&!$w(c).isValid)){const{value:ee,message:ye}=hu(d)?{value:!!d,message:d}:li(d);if(ee&&(A[S]={type:Vn.required,message:ye,ref:N,...pe(Vn.required,ye)},!n))return M(ye),A}if(!de&&(!cr(g)||!cr(v))){let ee,ye;const G=li(v),Se=li(g);if(!cr(E)&&!isNaN(E)){const Ce=l.valueAsNumber||E&&+E;cr(G.value)||(ee=Ce>G.value),cr(Se.value)||(ye=Ce<Se.value)}else{const Ce=l.valueAsDate||new Date(E),_e=oe=>new Date(new Date().toDateString()+" "+oe),te=l.type=="time",X=l.type=="week";yn(G.value)&&E&&(ee=te?_e(E)>_e(G.value):X?E>G.value:Ce>new Date(G.value)),yn(Se.value)&&E&&(ye=te?_e(E)<_e(Se.value):X?E<Se.value:Ce<new Date(Se.value))}if((ee||ye)&&(Ee(!!ee,G.message,Se.message,Vn.max,Vn.min),!n))return M(A[S].message),A}if((h||m)&&!de&&(yn(E)||a&&Array.isArray(E))){const ee=li(h),ye=li(m),G=!cr(ee.value)&&E.length>+ee.value,Se=!cr(ye.value)&&E.length<+ye.value;if((G||Se)&&(Ee(G,ee.message,ye.message),!n))return M(A[S].message),A}if(x&&!de&&yn(E)){const{value:ee,message:ye}=li(x);if(Eu(ee)&&!E.match(ee)&&(A[S]={type:Vn.pattern,message:ye,ref:l,...pe(Vn.pattern,ye)},!n))return M(ye),A}if(w){if(en(w)){const ee=await w(E,t),ye=Yv(ee,N);if(ye&&(A[S]={...ye,...pe(Vn.validate,ye.message)},!n))return M(ye.message),A}else if(Lt(w)){let ee={};for(const ye in w){if(!lr(ee)&&!n)break;const G=Yv(await w[ye](E,t),N,ye);G&&(ee={...G,...pe(ye,G.message)},M(G.message),n&&(A[S]=ee))}if(!lr(ee)&&(A[S]={ref:N,...ee},!n))return A}}return M(!0),A};const OR={mode:Xr.onSubmit,reValidateMode:Xr.onChange,shouldFocusError:!0};function MR(r={}){let e={...OR,...r},t={submitCount:0,isDirty:!1,isLoading:en(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const n={};let o=Lt(e.defaultValues)||Lt(e.values)?Xt(e.values||e.defaultValues)||{}:{},a=e.shouldUnregister?{}:Xt(o),l={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},d,h=0;const m={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let g={...m};const v={array:Bv(),state:Bv()},x=Kv(e.mode),w=Kv(e.reValidateMode),S=e.criteriaMode===Xr.all,_=I=>q=>{clearTimeout(h),h=setTimeout(I,q)},C=async I=>{if(!e.disabled&&(m.isValid||g.isValid||I)){const q=e.resolver?lr((await de()).errors):await Ee(n,!0);q!==t.isValid&&v.state.next({isValid:q})}},E=(I,q)=>{!e.disabled&&(m.isValidating||m.validatingFields||g.isValidating||g.validatingFields)&&((I||Array.from(c.mount)).forEach(J=>{J&&(q?ft(t.validatingFields,J,q):Ft(t.validatingFields,J))}),v.state.next({validatingFields:t.validatingFields,isValidating:!lr(t.validatingFields)}))},N=(I,q=[],J,xe,ge=!0,le=!0)=>{if(xe&&J&&!e.disabled){if(l.action=!0,le&&Array.isArray(je(n,I))){const be=J(je(n,I),xe.argA,xe.argB);ge&&ft(n,I,be)}if(le&&Array.isArray(je(t.errors,I))){const be=J(je(t.errors,I),xe.argA,xe.argB);ge&&ft(t.errors,I,be),DR(t.errors,I)}if((m.touchedFields||g.touchedFields)&&le&&Array.isArray(je(t.touchedFields,I))){const be=J(je(t.touchedFields,I),xe.argA,xe.argB);ge&&ft(t.touchedFields,I,be)}(m.dirtyFields||g.dirtyFields)&&(t.dirtyFields=Ia(o,a)),v.state.next({name:I,isDirty:ye(I,q),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ft(a,I,q)},M=(I,q)=>{ft(t.errors,I,q),v.state.next({errors:t.errors})},A=I=>{t.errors=I,v.state.next({errors:t.errors,isValid:!1})},K=(I,q,J,xe)=>{const ge=je(n,I);if(ge){const le=je(a,I,Mt(J)?je(o,I):J);Mt(le)||xe&&xe.defaultChecked||q?ft(a,I,q?le:Gv(ge._f)):Ce(I,le),l.mount&&C()}},Z=(I,q,J,xe,ge)=>{let le=!1,be=!1;const nt={name:I};if(!e.disabled){if(!J||xe){(m.isDirty||g.isDirty)&&(be=t.isDirty,t.isDirty=nt.isDirty=ye(),le=be!==nt.isDirty);const ht=Rs(je(o,I),q);be=!!je(t.dirtyFields,I),ht?Ft(t.dirtyFields,I):ft(t.dirtyFields,I,!0),nt.dirtyFields=t.dirtyFields,le=le||(m.dirtyFields||g.dirtyFields)&&be!==!ht}if(J){const ht=je(t.touchedFields,I);ht||(ft(t.touchedFields,I,J),nt.touchedFields=t.touchedFields,le=le||(m.touchedFields||g.touchedFields)&&ht!==J)}le&&ge&&v.state.next(nt)}return le?nt:{}},W=(I,q,J,xe)=>{const ge=je(t.errors,I),le=(m.isValid||g.isValid)&&mn(q)&&t.isValid!==q;if(e.delayError&&J?(d=_(()=>M(I,J)),d(e.delayError)):(clearTimeout(h),d=null,J?ft(t.errors,I,J):Ft(t.errors,I)),(J?!Rs(ge,J):ge)||!lr(xe)||le){const be={...xe,...le&&mn(q)?{isValid:q}:{},errors:t.errors,name:I};t={...t,...be},v.state.next(be)}},de=async I=>{E(I,!0);const q=await e.resolver(a,e.context,TR(I||c.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return E(I),q},pe=async I=>{const{errors:q}=await de(I);if(I)for(const J of I){const xe=je(q,J);xe?ft(t.errors,J,xe):Ft(t.errors,J)}else t.errors=q;return q},Ee=async(I,q,J={valid:!0})=>{for(const xe in I){const ge=I[xe];if(ge){const{_f:le,...be}=ge;if(le){const nt=c.array.has(le.name),ht=ge._f&&AR(ge._f);ht&&m.validatingFields&&E([xe],!0);const yt=await Xv(ge,c.disabled,a,S,e.shouldUseNativeValidation&&!q,nt);if(ht&&m.validatingFields&&E([xe]),yt[le.name]&&(J.valid=!1,q))break;!q&&(je(yt,le.name)?nt?LR(t.errors,yt,le.name):ft(t.errors,le.name,yt[le.name]):Ft(t.errors,le.name))}!lr(be)&&await Ee(be,q,J)}}return J.valid},ee=()=>{for(const I of c.unMount){const q=je(n,I);q&&(q._f.refs?q._f.refs.every(J=>!gf(J)):!gf(q._f.ref))&&Je(I)}c.unMount=new Set},ye=(I,q)=>!e.disabled&&(I&&q&&ft(a,I,q),!Rs(Q(),o)),G=(I,q,J)=>kR(I,c,{...l.mount?a:Mt(q)?o:yn(I)?{[I]:q}:q},J,q),Se=I=>Ju(je(l.mount?a:o,I,e.shouldUnregister?je(o,I,[]):[])),Ce=(I,q,J={})=>{const xe=je(n,I);let ge=q;if(xe){const le=xe._f;le&&(!le.disabled&&ft(a,I,Mw(q,le)),ge=ku(le.ref)&&cr(q)?"":q,Iw(le.ref)?[...le.ref.options].forEach(be=>be.selected=ge.includes(be.value)):le.refs?Al(le.ref)?le.refs.length>1?le.refs.forEach(be=>(!be.defaultChecked||!be.disabled)&&(be.checked=Array.isArray(ge)?!!ge.find(nt=>nt===be.value):ge===be.value)):le.refs[0]&&(le.refs[0].checked=!!ge):le.refs.forEach(be=>be.checked=be.value===ge):sm(le.ref)?le.ref.value="":(le.ref.value=ge,le.ref.type||v.state.next({name:I,values:Xt(a)})))}(J.shouldDirty||J.shouldTouch)&&Z(I,ge,J.shouldTouch,J.shouldDirty,!0),J.shouldValidate&&L(I)},_e=(I,q,J)=>{for(const xe in q){const ge=q[xe],le=`${I}.${xe}`,be=je(n,le);(c.array.has(I)||Lt(ge)||be&&!be._f)&&!yo(ge)?_e(le,ge,J):Ce(le,ge,J)}},te=(I,q,J={})=>{const xe=je(n,I),ge=c.array.has(I),le=Xt(q);ft(a,I,le),ge?(v.array.next({name:I,values:Xt(a)}),(m.isDirty||m.dirtyFields||g.isDirty||g.dirtyFields)&&J.shouldDirty&&v.state.next({name:I,dirtyFields:Ia(o,a),isDirty:ye(I,le)})):xe&&!xe._f&&!cr(le)?_e(I,le,J):Ce(I,le,J),Jv(I,c)&&v.state.next({...t}),v.state.next({name:l.mount?I:void 0,values:Xt(a)})},X=async I=>{l.mount=!0;const q=I.target;let J=q.name,xe=!0;const ge=je(n,J),le=be=>{xe=Number.isNaN(be)||yo(be)&&isNaN(be.getTime())||Rs(be,je(a,J,be))};if(ge){let be,nt;const ht=q.type?Gv(ge._f):xR(I),yt=I.type===Vv.BLUR||I.type===Vv.FOCUS_OUT,Co=!jR(ge._f)&&!e.resolver&&!je(t.errors,J)&&!ge._f.deps||IR(yt,je(t.touchedFields,J),t.isSubmitted,w,x),Pn=Jv(J,c,yt);ft(a,J,ht),yt?(ge._f.onBlur&&ge._f.onBlur(I),d&&d(0)):ge._f.onChange&&ge._f.onChange(I);const an=Z(J,ht,yt),Vi=!lr(an)||Pn;if(!yt&&v.state.next({name:J,type:I.type,values:Xt(a)}),Co)return(m.isValid||g.isValid)&&(e.mode==="onBlur"?yt&&C():yt||C()),Vi&&v.state.next({name:J,...Pn?{}:an});if(!yt&&Pn&&v.state.next({...t}),e.resolver){const{errors:rs}=await de([J]);if(le(ht),xe){const Tn=Qv(t.errors,n,J),An=Qv(rs,n,Tn.name||J);be=An.error,J=An.name,nt=lr(rs)}}else E([J],!0),be=(await Xv(ge,c.disabled,a,S,e.shouldUseNativeValidation))[J],E([J]),le(ht),xe&&(be?nt=!1:(m.isValid||g.isValid)&&(nt=await Ee(n,!0)));xe&&(ge._f.deps&&L(ge._f.deps),W(J,nt,be,an))}},oe=(I,q)=>{if(je(t.errors,q)&&I.focus)return I.focus(),1},L=async(I,q={})=>{let J,xe;const ge=Ja(I);if(e.resolver){const le=await pe(Mt(I)?I:ge);J=lr(le),xe=I?!ge.some(be=>je(le,be)):J}else I?(xe=(await Promise.all(ge.map(async le=>{const be=je(n,le);return await Ee(be&&be._f?{[le]:be}:be)}))).every(Boolean),!(!xe&&!t.isValid)&&C()):xe=J=await Ee(n);return v.state.next({...!yn(I)||(m.isValid||g.isValid)&&J!==t.isValid?{}:{name:I},...e.resolver||!I?{isValid:J}:{},errors:t.errors}),q.shouldFocus&&!xe&&Qa(n,oe,I?ge:c.mount),xe},Q=I=>{const q={...l.mount?a:o};return Mt(I)?q:yn(I)?je(q,I):I.map(J=>je(q,J))},De=(I,q)=>({invalid:!!je((q||t).errors,I),isDirty:!!je((q||t).dirtyFields,I),error:je((q||t).errors,I),isValidating:!!je(t.validatingFields,I),isTouched:!!je((q||t).touchedFields,I)}),He=I=>{I&&Ja(I).forEach(q=>Ft(t.errors,q)),v.state.next({errors:I?t.errors:{}})},rt=(I,q,J)=>{const xe=(je(n,I,{_f:{}})._f||{}).ref,ge=je(t.errors,I)||{},{ref:le,message:be,type:nt,...ht}=ge;ft(t.errors,I,{...ht,...q,ref:xe}),v.state.next({name:I,errors:t.errors,isValid:!1}),J&&J.shouldFocus&&xe&&xe.focus&&xe.focus()},he=(I,q)=>en(I)?v.state.subscribe({next:J=>I(G(void 0,q),J)}):G(I,q,!0),Ve=I=>v.state.subscribe({next:q=>{NR(I.name,q.name,I.exact)&&RR(q,I.formState||m,En,I.reRenderRoot)&&I.callback({values:{...a},...t,...q})}}).unsubscribe,Be=I=>(l.mount=!0,g={...g,...I.formState},Ve({...I,formState:g})),Je=(I,q={})=>{for(const J of I?Ja(I):c.mount)c.mount.delete(J),c.array.delete(J),q.keepValue||(Ft(n,J),Ft(a,J)),!q.keepError&&Ft(t.errors,J),!q.keepDirty&&Ft(t.dirtyFields,J),!q.keepTouched&&Ft(t.touchedFields,J),!q.keepIsValidating&&Ft(t.validatingFields,J),!e.shouldUnregister&&!q.keepDefaultValue&&Ft(o,J);v.state.next({values:Xt(a)}),v.state.next({...t,...q.keepDirty?{isDirty:ye()}:{}}),!q.keepIsValid&&C()},Nt=({disabled:I,name:q})=>{(mn(I)&&l.mount||I||c.disabled.has(q))&&(I?c.disabled.add(q):c.disabled.delete(q))},Rr=(I,q={})=>{let J=je(n,I);const xe=mn(q.disabled)||mn(e.disabled);return ft(n,I,{...J||{},_f:{...J&&J._f?J._f:{ref:{name:I}},name:I,mount:!0,...q}}),c.mount.add(I),J?Nt({disabled:mn(q.disabled)?q.disabled:e.disabled,name:I}):K(I,!0,q.value),{...xe?{disabled:q.disabled||e.disabled}:{},...e.progressive?{required:!!q.required,min:Da(q.min),max:Da(q.max),minLength:Da(q.minLength),maxLength:Da(q.maxLength),pattern:Da(q.pattern)}:{},name:I,onChange:X,onBlur:X,ref:ge=>{if(ge){Rr(I,q),J=je(n,I);const le=Mt(ge.value)&&ge.querySelectorAll&&ge.querySelectorAll("input,select,textarea")[0]||ge,be=CR(le),nt=J._f.refs||[];if(be?nt.find(ht=>ht===le):le===J._f.ref)return;ft(n,I,{_f:{...J._f,...be?{refs:[...nt.filter(gf),le,...Array.isArray(je(o,I))?[{}]:[]],ref:{type:le.type,name:I}}:{ref:le}}}),K(I,!1,void 0,le)}else J=je(n,I,{}),J._f&&(J._f.mount=!1),(e.shouldUnregister||q.shouldUnregister)&&!(wR(c.array,I)&&l.action)&&c.unMount.add(I)}}},sr=()=>e.shouldFocusError&&Qa(n,oe,c.mount),Nr=I=>{mn(I)&&(v.state.next({disabled:I}),Qa(n,(q,J)=>{const xe=je(n,J);xe&&(q.disabled=xe._f.disabled||I,Array.isArray(xe._f.refs)&&xe._f.refs.forEach(ge=>{ge.disabled=xe._f.disabled||I}))},0,!1))},ts=(I,q)=>async J=>{let xe;J&&(J.preventDefault&&J.preventDefault(),J.persist&&J.persist());let ge=Xt(a);if(v.state.next({isSubmitting:!0}),e.resolver){const{errors:le,values:be}=await de();t.errors=le,ge=be}else await Ee(n);if(c.disabled.size)for(const le of c.disabled)ft(ge,le,void 0);if(Ft(t.errors,"root"),lr(t.errors)){v.state.next({errors:{}});try{await I(ge,J)}catch(le){xe=le}}else q&&await q({...t.errors},J),sr(),setTimeout(sr);if(v.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:lr(t.errors)&&!xe,submitCount:t.submitCount+1,errors:t.errors}),xe)throw xe},xr=(I,q={})=>{je(n,I)&&(Mt(q.defaultValue)?te(I,Xt(je(o,I))):(te(I,q.defaultValue),ft(o,I,Xt(q.defaultValue))),q.keepTouched||Ft(t.touchedFields,I),q.keepDirty||(Ft(t.dirtyFields,I),t.isDirty=q.defaultValue?ye(I,Xt(je(o,I))):ye()),q.keepError||(Ft(t.errors,I),m.isValid&&C()),v.state.next({...t}))},Hs=(I,q={})=>{const J=I?Xt(I):o,xe=Xt(J),ge=lr(I),le=ge?o:xe;if(q.keepDefaultValues||(o=J),!q.keepValues){if(q.keepDirtyValues){const be=new Set([...c.mount,...Object.keys(Ia(o,a))]);for(const nt of Array.from(be))je(t.dirtyFields,nt)?ft(le,nt,je(a,nt)):te(nt,je(le,nt))}else{if(rm&&Mt(I))for(const be of c.mount){const nt=je(n,be);if(nt&&nt._f){const ht=Array.isArray(nt._f.refs)?nt._f.refs[0]:nt._f.ref;if(ku(ht)){const yt=ht.closest("form");if(yt){yt.reset();break}}}}for(const be of c.mount)te(be,je(le,be))}a=Xt(le),v.array.next({values:{...le}}),v.state.next({values:{...le}})}c={mount:q.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!m.isValid||!!q.keepIsValid||!!q.keepDirtyValues,l.watch=!!e.shouldUnregister,v.state.next({submitCount:q.keepSubmitCount?t.submitCount:0,isDirty:ge?!1:q.keepDirty?t.isDirty:!!(q.keepDefaultValues&&!Rs(I,o)),isSubmitted:q.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:ge?{}:q.keepDirtyValues?q.keepDefaultValues&&a?Ia(o,a):t.dirtyFields:q.keepDefaultValues&&I?Ia(o,I):q.keepDirty?t.dirtyFields:{},touchedFields:q.keepTouched?t.touchedFields:{},errors:q.keepErrors?t.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},kn=(I,q)=>Hs(en(I)?I(a):I,q),Cn=(I,q={})=>{const J=je(n,I),xe=J&&J._f;if(xe){const ge=xe.refs?xe.refs[0]:xe.ref;ge.focus&&(ge.focus(),q.shouldSelect&&en(ge.select)&&ge.select())}},En=I=>{t={...t,...I}},br={control:{register:Rr,unregister:Je,getFieldState:De,handleSubmit:ts,setError:rt,_subscribe:Ve,_runSchema:de,_getWatch:G,_getDirty:ye,_setValid:C,_setFieldArray:N,_setDisabledField:Nt,_setErrors:A,_getFieldArray:Se,_reset:Hs,_resetDefaultValues:()=>en(e.defaultValues)&&e.defaultValues().then(I=>{kn(I,e.resetOptions),v.state.next({isLoading:!1})}),_removeUnmounted:ee,_disableForm:Nr,_subjects:v,_proxyFormState:m,get _fields(){return n},get _formValues(){return a},get _state(){return l},set _state(I){l=I},get _defaultValues(){return o},get _names(){return c},set _names(I){c=I},get _formState(){return t},get _options(){return e},set _options(I){e={...e,...I}}},subscribe:Be,trigger:L,register:Rr,handleSubmit:ts,watch:he,setValue:te,getValues:Q,reset:kn,resetField:xr,clearErrors:He,unregister:Je,setError:rt,setFocus:Cn,getFieldState:De};return{...br,formControl:br}}function $R(r={}){const e=Me.useRef(void 0),t=Me.useRef(void 0),[n,o]=Me.useState({isDirty:!1,isValidating:!1,isLoading:en(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,defaultValues:en(r.defaultValues)?void 0:r.defaultValues});e.current||(e.current={...r.formControl?r.formControl:MR(r),formState:n},r.formControl&&r.defaultValues&&!en(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions));const a=e.current.control;return a._options=r,Me.useLayoutEffect(()=>a._subscribe({formState:a._proxyFormState,callback:()=>o({...a._formState}),reRenderRoot:!0}),[a]),Me.useEffect(()=>a._disableForm(r.disabled),[a,r.disabled]),Me.useEffect(()=>{if(a._proxyFormState.isDirty){const l=a._getDirty();l!==n.isDirty&&a._subjects.state.next({isDirty:l})}},[a,n.isDirty]),Me.useEffect(()=>{r.values&&!Rs(r.values,t.current)?(a._reset(r.values,a._options.resetOptions),t.current=r.values,o(l=>({...l}))):a._resetDefaultValues()},[r.values,a]),Me.useEffect(()=>{r.errors&&!lr(r.errors)&&a._setErrors(r.errors)},[r.errors,a]),Me.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),Me.useEffect(()=>{r.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[r.shouldUnregister,a]),e.current.formState=_R(n,a),e.current}var it;(function(r){r.assertEqual=o=>o;function e(o){}r.assertIs=e;function t(o){throw new Error}r.assertNever=t,r.arrayToEnum=o=>{const a={};for(const l of o)a[l]=l;return a},r.getValidEnumValues=o=>{const a=r.objectKeys(o).filter(c=>typeof o[o[c]]!="number"),l={};for(const c of a)l[c]=o[c];return r.objectValues(l)},r.objectValues=o=>r.objectKeys(o).map(function(a){return o[a]}),r.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const a=[];for(const l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.push(l);return a},r.find=(o,a)=>{for(const l of o)if(a(l))return l},r.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&isFinite(o)&&Math.floor(o)===o;function n(o,a=" | "){return o.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}r.joinValues=n,r.jsonStringifyReplacer=(o,a)=>typeof a=="bigint"?a.toString():a})(it||(it={}));var Yf;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Yf||(Yf={}));const ke=it.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Hn=r=>{switch(typeof r){case"undefined":return ke.undefined;case"string":return ke.string;case"number":return isNaN(r)?ke.nan:ke.number;case"boolean":return ke.boolean;case"function":return ke.function;case"bigint":return ke.bigint;case"symbol":return ke.symbol;case"object":return Array.isArray(r)?ke.array:r===null?ke.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?ke.promise:typeof Map<"u"&&r instanceof Map?ke.map:typeof Set<"u"&&r instanceof Set?ke.set:typeof Date<"u"&&r instanceof Date?ke.date:ke.object;default:return ke.unknown}},ae=it.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),UR=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class Ar extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},n={_errors:[]},o=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(o);else if(l.code==="invalid_return_type")o(l.returnTypeError);else if(l.code==="invalid_arguments")o(l.argumentsError);else if(l.path.length===0)n._errors.push(t(l));else{let c=n,d=0;for(;d<l.path.length;){const h=l.path[d];d===l.path.length-1?(c[h]=c[h]||{_errors:[]},c[h]._errors.push(t(l))):c[h]=c[h]||{_errors:[]},c=c[h],d++}}};return o(this),n}static assert(e){if(!(e instanceof Ar))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,it.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const o of this.issues)o.path.length>0?(t[o.path[0]]=t[o.path[0]]||[],t[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Ar.create=r=>new Ar(r);const Ai=(r,e)=>{let t;switch(r.code){case ae.invalid_type:r.received===ke.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case ae.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,it.jsonStringifyReplacer)}`;break;case ae.unrecognized_keys:t=`Unrecognized key(s) in object: ${it.joinValues(r.keys,", ")}`;break;case ae.invalid_union:t="Invalid input";break;case ae.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${it.joinValues(r.options)}`;break;case ae.invalid_enum_value:t=`Invalid enum value. Expected ${it.joinValues(r.options)}, received '${r.received}'`;break;case ae.invalid_arguments:t="Invalid function arguments";break;case ae.invalid_return_type:t="Invalid function return type";break;case ae.invalid_date:t="Invalid date";break;case ae.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:it.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case ae.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case ae.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case ae.custom:t="Invalid input";break;case ae.invalid_intersection_types:t="Intersection results could not be merged";break;case ae.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case ae.not_finite:t="Number must be finite";break;default:t=e.defaultError,it.assertNever(r)}return{message:t}};let Uw=Ai;function FR(r){Uw=r}function Pu(){return Uw}const Tu=r=>{const{data:e,path:t,errorMaps:n,issueData:o}=r,a=[...t,...o.path||[]],l={...o,path:a};if(o.message!==void 0)return{...o,path:a,message:o.message};let c="";const d=n.filter(h=>!!h).slice().reverse();for(const h of d)c=h(l,{data:e,defaultError:c}).message;return{...o,path:a,message:c}},zR=[];function ve(r,e){const t=Pu(),n=Tu({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Ai?void 0:Ai].filter(o=>!!o)});r.common.issues.push(n)}class nr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const o of t){if(o.status==="aborted")return We;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const o of t){const a=await o.key,l=await o.value;n.push({key:a,value:l})}return nr.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const o of t){const{key:a,value:l}=o;if(a.status==="aborted"||l.status==="aborted")return We;a.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||o.alwaysSet)&&(n[a.value]=l.value)}return{status:e.value,value:n}}}const We=Object.freeze({status:"aborted"}),vi=r=>({status:"dirty",value:r}),ur=r=>({status:"valid",value:r}),Xf=r=>r.status==="aborted",ep=r=>r.status==="dirty",bo=r=>r.status==="valid",al=r=>typeof Promise<"u"&&r instanceof Promise;function Au(r,e,t,n){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(r)}function Fw(r,e,t,n,o){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t}var Ie;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(Ie||(Ie={}));var Fa,za;class wn{constructor(e,t,n,o){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=o}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ex=(r,e)=>{if(bo(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ar(r.common.issues);return this._error=t,this._error}}};function Qe(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:o}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(l,c)=>{var d,h;const{message:m}=r;return l.code==="invalid_enum_value"?{message:m??c.defaultError}:typeof c.data>"u"?{message:(d=m??n)!==null&&d!==void 0?d:c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:(h=m??t)!==null&&h!==void 0?h:c.defaultError}},description:o}}class tt{get description(){return this._def.description}_getType(e){return Hn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Hn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new nr,ctx:{common:e.parent.common,data:e.data,parsedType:Hn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(al(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const o={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Hn(e)},a=this._parseSync({data:e,path:o.path,parent:o});return ex(o,a)}"~validate"(e){var t,n;const o={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Hn(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:o});return bo(a)?{value:a.value}:{issues:o.common.issues}}catch(a){!((n=(t=a?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),o.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:o}).then(a=>bo(a)?{value:a.value}:{issues:o.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Hn(e)},o=this._parse({data:e,path:n.path,parent:n}),a=await(al(o)?o:Promise.resolve(o));return ex(n,a)}refine(e,t){const n=o=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(o):t;return this._refinement((o,a)=>{const l=e(o),c=()=>a.addIssue({code:ae.custom,...n(o)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,t){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof t=="function"?t(n,o):t),!1))}_refinement(e){return new sn({schema:this,typeName:qe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return bn.create(this,this._def)}nullable(){return zs.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nn.create(this)}promise(){return Ri.create(this,this._def)}or(e){return dl.create([this,e],this._def)}and(e){return hl.create(this,e,this._def)}transform(e){return new sn({...Qe(this._def),schema:this,typeName:qe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new yl({...Qe(this._def),innerType:this,defaultValue:t,typeName:qe.ZodDefault})}brand(){return new im({typeName:qe.ZodBranded,type:this,...Qe(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new vl({...Qe(this._def),innerType:this,catchValue:t,typeName:qe.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return jl.create(this,e)}readonly(){return xl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const VR=/^c[^\s-]{8,}$/i,BR=/^[0-9a-z]+$/,qR=/^[0-9A-HJKMNP-TV-Z]{26}$/i,HR=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,WR=/^[a-z0-9_-]{21}$/i,GR=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,KR=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ZR=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,JR="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let yf;const QR=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,YR=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,XR=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,eN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tN=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,rN=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,zw="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",nN=new RegExp(`^${zw}$`);function Vw(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function sN(r){return new RegExp(`^${Vw(r)}$`)}function Bw(r){let e=`${zw}T${Vw(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function oN(r,e){return!!((e==="v4"||!e)&&QR.test(r)||(e==="v6"||!e)&&XR.test(r))}function iN(r,e){if(!GR.test(r))return!1;try{const[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||!o.typ||!o.alg||e&&o.alg!==e)}catch{return!1}}function aN(r,e){return!!((e==="v4"||!e)&&YR.test(r)||(e==="v6"||!e)&&eN.test(r))}class tn extends tt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ke.string){const a=this._getOrReturnCtx(e);return ve(a,{code:ae.invalid_type,expected:ke.string,received:a.parsedType}),We}const n=new nr;let o;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const l=e.data.length>a.value,c=e.data.length<a.value;(l||c)&&(o=this._getOrReturnCtx(e,o),l?ve(o,{code:ae.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):c&&ve(o,{code:ae.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")ZR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"email",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")yf||(yf=new RegExp(JR,"u")),yf.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"emoji",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")HR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"uuid",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")WR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"nanoid",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")VR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"cuid",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")BR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"cuid2",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")qR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"ulid",code:ae.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),ve(o,{validation:"url",code:ae.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"regex",code:ae.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Bw(a).test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?nN.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?sN(a).test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?KR.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"duration",code:ae.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?oN(e.data,a.version)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"ip",code:ae.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?iN(e.data,a.alg)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"jwt",code:ae.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?aN(e.data,a.version)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"cidr",code:ae.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?tN.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"base64",code:ae.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?rN.test(e.data)||(o=this._getOrReturnCtx(e,o),ve(o,{validation:"base64url",code:ae.invalid_string,message:a.message}),n.dirty()):it.assertNever(a);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(o=>e.test(o),{validation:t,code:ae.invalid_string,...Ie.errToObj(n)})}_addCheck(e){return new tn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ie.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ie.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ie.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ie.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ie.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...Ie.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...Ie.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...Ie.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Ie.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...Ie.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Ie.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Ie.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Ie.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Ie.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Ie.errToObj(t)})}nonempty(e){return this.min(1,Ie.errToObj(e))}trim(){return new tn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new tn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new tn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}tn.create=r=>{var e;return new tn({checks:[],typeName:qe.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...Qe(r)})};function lN(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=t>n?t:n,a=parseInt(r.toFixed(o).replace(".","")),l=parseInt(e.toFixed(o).replace(".",""));return a%l/Math.pow(10,o)}class $s extends tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ke.number){const a=this._getOrReturnCtx(e);return ve(a,{code:ae.invalid_type,expected:ke.number,received:a.parsedType}),We}let n;const o=new nr;for(const a of this._def.checks)a.kind==="int"?it.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.invalid_type,expected:"integer",received:"float",message:a.message}),o.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),o.dirty()):a.kind==="multipleOf"?lN(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.not_finite,message:a.message}),o.dirty()):it.assertNever(a);return{status:o.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ie.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ie.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ie.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ie.toString(t))}setLimit(e,t,n,o){return new $s({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Ie.toString(o)}]})}_addCheck(e){return new $s({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ie.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ie.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&it.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}$s.create=r=>new $s({checks:[],typeName:qe.ZodNumber,coerce:r?.coerce||!1,...Qe(r)});class Us extends tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ke.bigint)return this._getInvalidInput(e);let n;const o=new nr;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),o.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),ve(n,{code:ae.not_multiple_of,multipleOf:a.value,message:a.message}),o.dirty()):it.assertNever(a);return{status:o.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return ve(t,{code:ae.invalid_type,expected:ke.bigint,received:t.parsedType}),We}gte(e,t){return this.setLimit("min",e,!0,Ie.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ie.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ie.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ie.toString(t))}setLimit(e,t,n,o){return new Us({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Ie.toString(o)}]})}_addCheck(e){return new Us({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Us.create=r=>{var e;return new Us({checks:[],typeName:qe.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...Qe(r)})};class ll extends tt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ke.boolean){const n=this._getOrReturnCtx(e);return ve(n,{code:ae.invalid_type,expected:ke.boolean,received:n.parsedType}),We}return ur(e.data)}}ll.create=r=>new ll({typeName:qe.ZodBoolean,coerce:r?.coerce||!1,...Qe(r)});class wo extends tt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ke.date){const a=this._getOrReturnCtx(e);return ve(a,{code:ae.invalid_type,expected:ke.date,received:a.parsedType}),We}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return ve(a,{code:ae.invalid_date}),We}const n=new nr;let o;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(o=this._getOrReturnCtx(e,o),ve(o,{code:ae.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):it.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new wo({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Ie.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Ie.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}wo.create=r=>new wo({checks:[],coerce:r?.coerce||!1,typeName:qe.ZodDate,...Qe(r)});class ju extends tt{_parse(e){if(this._getType(e)!==ke.symbol){const n=this._getOrReturnCtx(e);return ve(n,{code:ae.invalid_type,expected:ke.symbol,received:n.parsedType}),We}return ur(e.data)}}ju.create=r=>new ju({typeName:qe.ZodSymbol,...Qe(r)});class cl extends tt{_parse(e){if(this._getType(e)!==ke.undefined){const n=this._getOrReturnCtx(e);return ve(n,{code:ae.invalid_type,expected:ke.undefined,received:n.parsedType}),We}return ur(e.data)}}cl.create=r=>new cl({typeName:qe.ZodUndefined,...Qe(r)});class ul extends tt{_parse(e){if(this._getType(e)!==ke.null){const n=this._getOrReturnCtx(e);return ve(n,{code:ae.invalid_type,expected:ke.null,received:n.parsedType}),We}return ur(e.data)}}ul.create=r=>new ul({typeName:qe.ZodNull,...Qe(r)});class ji extends tt{constructor(){super(...arguments),this._any=!0}_parse(e){return ur(e.data)}}ji.create=r=>new ji({typeName:qe.ZodAny,...Qe(r)});class xo extends tt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ur(e.data)}}xo.create=r=>new xo({typeName:qe.ZodUnknown,...Qe(r)});class Qn extends tt{_parse(e){const t=this._getOrReturnCtx(e);return ve(t,{code:ae.invalid_type,expected:ke.never,received:t.parsedType}),We}}Qn.create=r=>new Qn({typeName:qe.ZodNever,...Qe(r)});class Ru extends tt{_parse(e){if(this._getType(e)!==ke.undefined){const n=this._getOrReturnCtx(e);return ve(n,{code:ae.invalid_type,expected:ke.void,received:n.parsedType}),We}return ur(e.data)}}Ru.create=r=>new Ru({typeName:qe.ZodVoid,...Qe(r)});class nn extends tt{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),o=this._def;if(t.parsedType!==ke.array)return ve(t,{code:ae.invalid_type,expected:ke.array,received:t.parsedType}),We;if(o.exactLength!==null){const l=t.data.length>o.exactLength.value,c=t.data.length<o.exactLength.value;(l||c)&&(ve(t,{code:l?ae.too_big:ae.too_small,minimum:c?o.exactLength.value:void 0,maximum:l?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&t.data.length<o.minLength.value&&(ve(t,{code:ae.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&t.data.length>o.maxLength.value&&(ve(t,{code:ae.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((l,c)=>o.type._parseAsync(new wn(t,l,t.path,c)))).then(l=>nr.mergeArray(n,l));const a=[...t.data].map((l,c)=>o.type._parseSync(new wn(t,l,t.path,c)));return nr.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new nn({...this._def,minLength:{value:e,message:Ie.toString(t)}})}max(e,t){return new nn({...this._def,maxLength:{value:e,message:Ie.toString(t)}})}length(e,t){return new nn({...this._def,exactLength:{value:e,message:Ie.toString(t)}})}nonempty(e){return this.min(1,e)}}nn.create=(r,e)=>new nn({type:r,minLength:null,maxLength:null,exactLength:null,typeName:qe.ZodArray,...Qe(e)});function di(r){if(r instanceof Et){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=bn.create(di(n))}return new Et({...r._def,shape:()=>e})}else return r instanceof nn?new nn({...r._def,type:di(r.element)}):r instanceof bn?bn.create(di(r.unwrap())):r instanceof zs?zs.create(di(r.unwrap())):r instanceof Sn?Sn.create(r.items.map(e=>di(e))):r}class Et extends tt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=it.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ke.object){const h=this._getOrReturnCtx(e);return ve(h,{code:ae.invalid_type,expected:ke.object,received:h.parsedType}),We}const{status:n,ctx:o}=this._processInputParams(e),{shape:a,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof Qn&&this._def.unknownKeys==="strip"))for(const h in o.data)l.includes(h)||c.push(h);const d=[];for(const h of l){const m=a[h],g=o.data[h];d.push({key:{status:"valid",value:h},value:m._parse(new wn(o,g,o.path,h)),alwaysSet:h in o.data})}if(this._def.catchall instanceof Qn){const h=this._def.unknownKeys;if(h==="passthrough")for(const m of c)d.push({key:{status:"valid",value:m},value:{status:"valid",value:o.data[m]}});else if(h==="strict")c.length>0&&(ve(o,{code:ae.unrecognized_keys,keys:c}),n.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const m of c){const g=o.data[m];d.push({key:{status:"valid",value:m},value:h._parse(new wn(o,g,o.path,m)),alwaysSet:m in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const h=[];for(const m of d){const g=await m.key,v=await m.value;h.push({key:g,value:v,alwaysSet:m.alwaysSet})}return h}).then(h=>nr.mergeObjectSync(n,h)):nr.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(e){return Ie.errToObj,new Et({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var o,a,l,c;const d=(l=(a=(o=this._def).errorMap)===null||a===void 0?void 0:a.call(o,t,n).message)!==null&&l!==void 0?l:n.defaultError;return t.code==="unrecognized_keys"?{message:(c=Ie.errToObj(e).message)!==null&&c!==void 0?c:d}:{message:d}}}:{}})}strip(){return new Et({...this._def,unknownKeys:"strip"})}passthrough(){return new Et({...this._def,unknownKeys:"passthrough"})}extend(e){return new Et({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Et({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:qe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Et({...this._def,catchall:e})}pick(e){const t={};return it.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new Et({...this._def,shape:()=>t})}omit(e){const t={};return it.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new Et({...this._def,shape:()=>t})}deepPartial(){return di(this)}partial(e){const t={};return it.objectKeys(this.shape).forEach(n=>{const o=this.shape[n];e&&!e[n]?t[n]=o:t[n]=o.optional()}),new Et({...this._def,shape:()=>t})}required(e){const t={};return it.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof bn;)a=a._def.innerType;t[n]=a}}),new Et({...this._def,shape:()=>t})}keyof(){return qw(it.objectKeys(this.shape))}}Et.create=(r,e)=>new Et({shape:()=>r,unknownKeys:"strip",catchall:Qn.create(),typeName:qe.ZodObject,...Qe(e)});Et.strictCreate=(r,e)=>new Et({shape:()=>r,unknownKeys:"strict",catchall:Qn.create(),typeName:qe.ZodObject,...Qe(e)});Et.lazycreate=(r,e)=>new Et({shape:r,unknownKeys:"strip",catchall:Qn.create(),typeName:qe.ZodObject,...Qe(e)});class dl extends tt{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function o(a){for(const c of a)if(c.result.status==="valid")return c.result;for(const c of a)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const l=a.map(c=>new Ar(c.ctx.common.issues));return ve(t,{code:ae.invalid_union,unionErrors:l}),We}if(t.common.async)return Promise.all(n.map(async a=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(o);{let a;const l=[];for(const d of n){const h={...t,common:{...t.common,issues:[]},parent:null},m=d._parseSync({data:t.data,path:t.path,parent:h});if(m.status==="valid")return m;m.status==="dirty"&&!a&&(a={result:m,ctx:h}),h.common.issues.length&&l.push(h.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const c=l.map(d=>new Ar(d));return ve(t,{code:ae.invalid_union,unionErrors:c}),We}}get options(){return this._def.options}}dl.create=(r,e)=>new dl({options:r,typeName:qe.ZodUnion,...Qe(e)});const Bn=r=>r instanceof pl?Bn(r.schema):r instanceof sn?Bn(r.innerType()):r instanceof ml?[r.value]:r instanceof Fs?r.options:r instanceof gl?it.objectValues(r.enum):r instanceof yl?Bn(r._def.innerType):r instanceof cl?[void 0]:r instanceof ul?[null]:r instanceof bn?[void 0,...Bn(r.unwrap())]:r instanceof zs?[null,...Bn(r.unwrap())]:r instanceof im||r instanceof xl?Bn(r.unwrap()):r instanceof vl?Bn(r._def.innerType):[];class Qu extends tt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ke.object)return ve(t,{code:ae.invalid_type,expected:ke.object,received:t.parsedType}),We;const n=this.discriminator,o=t.data[n],a=this.optionsMap.get(o);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(ve(t,{code:ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),We)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const o=new Map;for(const a of t){const l=Bn(a.shape[e]);if(!l.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of l){if(o.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);o.set(c,a)}}return new Qu({typeName:qe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:o,...Qe(n)})}}function tp(r,e){const t=Hn(r),n=Hn(e);if(r===e)return{valid:!0,data:r};if(t===ke.object&&n===ke.object){const o=it.objectKeys(e),a=it.objectKeys(r).filter(c=>o.indexOf(c)!==-1),l={...r,...e};for(const c of a){const d=tp(r[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(t===ke.array&&n===ke.array){if(r.length!==e.length)return{valid:!1};const o=[];for(let a=0;a<r.length;a++){const l=r[a],c=e[a],d=tp(l,c);if(!d.valid)return{valid:!1};o.push(d.data)}return{valid:!0,data:o}}else return t===ke.date&&n===ke.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class hl extends tt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=(a,l)=>{if(Xf(a)||Xf(l))return We;const c=tp(a.value,l.value);return c.valid?((ep(a)||ep(l))&&t.dirty(),{status:t.value,value:c.data}):(ve(n,{code:ae.invalid_intersection_types}),We)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,l])=>o(a,l)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}hl.create=(r,e,t)=>new hl({left:r,right:e,typeName:qe.ZodIntersection,...Qe(t)});class Sn extends tt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ke.array)return ve(n,{code:ae.invalid_type,expected:ke.array,received:n.parsedType}),We;if(n.data.length<this._def.items.length)return ve(n,{code:ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),We;!this._def.rest&&n.data.length>this._def.items.length&&(ve(n,{code:ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new wn(n,l,n.path,c)):null}).filter(l=>!!l);return n.common.async?Promise.all(a).then(l=>nr.mergeArray(t,l)):nr.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new Sn({...this._def,rest:e})}}Sn.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Sn({items:r,typeName:qe.ZodTuple,rest:null,...Qe(e)})};class fl extends tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ke.object)return ve(n,{code:ae.invalid_type,expected:ke.object,received:n.parsedType}),We;const o=[],a=this._def.keyType,l=this._def.valueType;for(const c in n.data)o.push({key:a._parse(new wn(n,c,n.path,c)),value:l._parse(new wn(n,n.data[c],n.path,c)),alwaysSet:c in n.data});return n.common.async?nr.mergeObjectAsync(t,o):nr.mergeObjectSync(t,o)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof tt?new fl({keyType:e,valueType:t,typeName:qe.ZodRecord,...Qe(n)}):new fl({keyType:tn.create(),valueType:e,typeName:qe.ZodRecord,...Qe(t)})}}class Nu extends tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ke.map)return ve(n,{code:ae.invalid_type,expected:ke.map,received:n.parsedType}),We;const o=this._def.keyType,a=this._def.valueType,l=[...n.data.entries()].map(([c,d],h)=>({key:o._parse(new wn(n,c,n.path,[h,"key"])),value:a._parse(new wn(n,d,n.path,[h,"value"]))}));if(n.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const h=await d.key,m=await d.value;if(h.status==="aborted"||m.status==="aborted")return We;(h.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(h.value,m.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const d of l){const h=d.key,m=d.value;if(h.status==="aborted"||m.status==="aborted")return We;(h.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(h.value,m.value)}return{status:t.value,value:c}}}}Nu.create=(r,e,t)=>new Nu({valueType:e,keyType:r,typeName:qe.ZodMap,...Qe(t)});class So extends tt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ke.set)return ve(n,{code:ae.invalid_type,expected:ke.set,received:n.parsedType}),We;const o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(ve(n,{code:ae.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),t.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(ve(n,{code:ae.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),t.dirty());const a=this._def.valueType;function l(d){const h=new Set;for(const m of d){if(m.status==="aborted")return We;m.status==="dirty"&&t.dirty(),h.add(m.value)}return{status:t.value,value:h}}const c=[...n.data.values()].map((d,h)=>a._parse(new wn(n,d,n.path,h)));return n.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,t){return new So({...this._def,minSize:{value:e,message:Ie.toString(t)}})}max(e,t){return new So({...this._def,maxSize:{value:e,message:Ie.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}So.create=(r,e)=>new So({valueType:r,minSize:null,maxSize:null,typeName:qe.ZodSet,...Qe(e)});class Si extends tt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ke.function)return ve(t,{code:ae.invalid_type,expected:ke.function,received:t.parsedType}),We;function n(c,d){return Tu({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Pu(),Ai].filter(h=>!!h),issueData:{code:ae.invalid_arguments,argumentsError:d}})}function o(c,d){return Tu({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Pu(),Ai].filter(h=>!!h),issueData:{code:ae.invalid_return_type,returnTypeError:d}})}const a={errorMap:t.common.contextualErrorMap},l=t.data;if(this._def.returns instanceof Ri){const c=this;return ur(async function(...d){const h=new Ar([]),m=await c._def.args.parseAsync(d,a).catch(x=>{throw h.addIssue(n(d,x)),h}),g=await Reflect.apply(l,this,m);return await c._def.returns._def.type.parseAsync(g,a).catch(x=>{throw h.addIssue(o(g,x)),h})})}else{const c=this;return ur(function(...d){const h=c._def.args.safeParse(d,a);if(!h.success)throw new Ar([n(d,h.error)]);const m=Reflect.apply(l,this,h.data),g=c._def.returns.safeParse(m,a);if(!g.success)throw new Ar([o(m,g.error)]);return g.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Si({...this._def,args:Sn.create(e).rest(xo.create())})}returns(e){return new Si({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Si({args:e||Sn.create([]).rest(xo.create()),returns:t||xo.create(),typeName:qe.ZodFunction,...Qe(n)})}}class pl extends tt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}pl.create=(r,e)=>new pl({getter:r,typeName:qe.ZodLazy,...Qe(e)});class ml extends tt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ve(t,{received:t.data,code:ae.invalid_literal,expected:this._def.value}),We}return{status:"valid",value:e.data}}get value(){return this._def.value}}ml.create=(r,e)=>new ml({value:r,typeName:qe.ZodLiteral,...Qe(e)});function qw(r,e){return new Fs({values:r,typeName:qe.ZodEnum,...Qe(e)})}class Fs extends tt{constructor(){super(...arguments),Fa.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return ve(t,{expected:it.joinValues(n),received:t.parsedType,code:ae.invalid_type}),We}if(Au(this,Fa)||Fw(this,Fa,new Set(this._def.values)),!Au(this,Fa).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return ve(t,{received:t.data,code:ae.invalid_enum_value,options:n}),We}return ur(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Fs.create(e,{...this._def,...t})}exclude(e,t=this._def){return Fs.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}Fa=new WeakMap;Fs.create=qw;class gl extends tt{constructor(){super(...arguments),za.set(this,void 0)}_parse(e){const t=it.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ke.string&&n.parsedType!==ke.number){const o=it.objectValues(t);return ve(n,{expected:it.joinValues(o),received:n.parsedType,code:ae.invalid_type}),We}if(Au(this,za)||Fw(this,za,new Set(it.getValidEnumValues(this._def.values))),!Au(this,za).has(e.data)){const o=it.objectValues(t);return ve(n,{received:n.data,code:ae.invalid_enum_value,options:o}),We}return ur(e.data)}get enum(){return this._def.values}}za=new WeakMap;gl.create=(r,e)=>new gl({values:r,typeName:qe.ZodNativeEnum,...Qe(e)});class Ri extends tt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ke.promise&&t.common.async===!1)return ve(t,{code:ae.invalid_type,expected:ke.promise,received:t.parsedType}),We;const n=t.parsedType===ke.promise?t.data:Promise.resolve(t.data);return ur(n.then(o=>this._def.type.parseAsync(o,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ri.create=(r,e)=>new Ri({type:r,typeName:qe.ZodPromise,...Qe(e)});class sn extends tt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===qe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=this._def.effect||null,a={addIssue:l=>{ve(n,l),l.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),o.type==="preprocess"){const l=o.transform(n.data,a);if(n.common.async)return Promise.resolve(l).then(async c=>{if(t.value==="aborted")return We;const d=await this._def.schema._parseAsync({data:c,path:n.path,parent:n});return d.status==="aborted"?We:d.status==="dirty"||t.value==="dirty"?vi(d.value):d});{if(t.value==="aborted")return We;const c=this._def.schema._parseSync({data:l,path:n.path,parent:n});return c.status==="aborted"?We:c.status==="dirty"||t.value==="dirty"?vi(c.value):c}}if(o.type==="refinement"){const l=c=>{const d=o.refinement(c,a);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?We:(c.status==="dirty"&&t.dirty(),l(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?We:(c.status==="dirty"&&t.dirty(),l(c.value).then(()=>({status:t.value,value:c.value}))))}if(o.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!bo(l))return l;const c=o.transform(l.value,a);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>bo(l)?Promise.resolve(o.transform(l.value,a)).then(c=>({status:t.value,value:c})):l);it.assertNever(o)}}sn.create=(r,e,t)=>new sn({schema:r,typeName:qe.ZodEffects,effect:e,...Qe(t)});sn.createWithPreprocess=(r,e,t)=>new sn({schema:e,effect:{type:"preprocess",transform:r},typeName:qe.ZodEffects,...Qe(t)});class bn extends tt{_parse(e){return this._getType(e)===ke.undefined?ur(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}bn.create=(r,e)=>new bn({innerType:r,typeName:qe.ZodOptional,...Qe(e)});class zs extends tt{_parse(e){return this._getType(e)===ke.null?ur(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}zs.create=(r,e)=>new zs({innerType:r,typeName:qe.ZodNullable,...Qe(e)});class yl extends tt{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===ke.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}yl.create=(r,e)=>new yl({innerType:r,typeName:qe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Qe(e)});class vl extends tt{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return al(o)?o.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ar(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Ar(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}vl.create=(r,e)=>new vl({innerType:r,typeName:qe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Qe(e)});class Iu extends tt{_parse(e){if(this._getType(e)!==ke.nan){const n=this._getOrReturnCtx(e);return ve(n,{code:ae.invalid_type,expected:ke.nan,received:n.parsedType}),We}return{status:"valid",value:e.data}}}Iu.create=r=>new Iu({typeName:qe.ZodNaN,...Qe(r)});const cN=Symbol("zod_brand");class im extends tt{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class jl extends tt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?We:a.status==="dirty"?(t.dirty(),vi(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?We:o.status==="dirty"?(t.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,t){return new jl({in:e,out:t,typeName:qe.ZodPipeline})}}class xl extends tt{_parse(e){const t=this._def.innerType._parse(e),n=o=>(bo(o)&&(o.value=Object.freeze(o.value)),o);return al(t)?t.then(o=>n(o)):n(t)}unwrap(){return this._def.innerType}}xl.create=(r,e)=>new xl({innerType:r,typeName:qe.ZodReadonly,...Qe(e)});function tx(r,e){const t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function Hw(r,e={},t){return r?ji.create().superRefine((n,o)=>{var a,l;const c=r(n);if(c instanceof Promise)return c.then(d=>{var h,m;if(!d){const g=tx(e,n),v=(m=(h=g.fatal)!==null&&h!==void 0?h:t)!==null&&m!==void 0?m:!0;o.addIssue({code:"custom",...g,fatal:v})}});if(!c){const d=tx(e,n),h=(l=(a=d.fatal)!==null&&a!==void 0?a:t)!==null&&l!==void 0?l:!0;o.addIssue({code:"custom",...d,fatal:h})}}):ji.create()}const uN={object:Et.lazycreate};var qe;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(qe||(qe={}));const dN=(r,e={message:`Input not instance of ${r.name}`})=>Hw(t=>t instanceof r,e),Ww=tn.create,Gw=$s.create,hN=Iu.create,fN=Us.create,Kw=ll.create,pN=wo.create,mN=ju.create,gN=cl.create,yN=ul.create,vN=ji.create,xN=xo.create,bN=Qn.create,wN=Ru.create,SN=nn.create,_N=Et.create,kN=Et.strictCreate,CN=dl.create,EN=Qu.create,PN=hl.create,TN=Sn.create,AN=fl.create,jN=Nu.create,RN=So.create,NN=Si.create,IN=pl.create,DN=ml.create,LN=Fs.create,ON=gl.create,MN=Ri.create,rx=sn.create,$N=bn.create,UN=zs.create,FN=sn.createWithPreprocess,zN=jl.create,VN=()=>Ww().optional(),BN=()=>Gw().optional(),qN=()=>Kw().optional(),HN={string:r=>tn.create({...r,coerce:!0}),number:r=>$s.create({...r,coerce:!0}),boolean:r=>ll.create({...r,coerce:!0}),bigint:r=>Us.create({...r,coerce:!0}),date:r=>wo.create({...r,coerce:!0})},WN=We;var vf=Object.freeze({__proto__:null,defaultErrorMap:Ai,setErrorMap:FR,getErrorMap:Pu,makeIssue:Tu,EMPTY_PATH:zR,addIssueToContext:ve,ParseStatus:nr,INVALID:We,DIRTY:vi,OK:ur,isAborted:Xf,isDirty:ep,isValid:bo,isAsync:al,get util(){return it},get objectUtil(){return Yf},ZodParsedType:ke,getParsedType:Hn,ZodType:tt,datetimeRegex:Bw,ZodString:tn,ZodNumber:$s,ZodBigInt:Us,ZodBoolean:ll,ZodDate:wo,ZodSymbol:ju,ZodUndefined:cl,ZodNull:ul,ZodAny:ji,ZodUnknown:xo,ZodNever:Qn,ZodVoid:Ru,ZodArray:nn,ZodObject:Et,ZodUnion:dl,ZodDiscriminatedUnion:Qu,ZodIntersection:hl,ZodTuple:Sn,ZodRecord:fl,ZodMap:Nu,ZodSet:So,ZodFunction:Si,ZodLazy:pl,ZodLiteral:ml,ZodEnum:Fs,ZodNativeEnum:gl,ZodPromise:Ri,ZodEffects:sn,ZodTransformer:sn,ZodOptional:bn,ZodNullable:zs,ZodDefault:yl,ZodCatch:vl,ZodNaN:Iu,BRAND:cN,ZodBranded:im,ZodPipeline:jl,ZodReadonly:xl,custom:Hw,Schema:tt,ZodSchema:tt,late:uN,get ZodFirstPartyTypeKind(){return qe},coerce:HN,any:vN,array:SN,bigint:fN,boolean:Kw,date:pN,discriminatedUnion:EN,effect:rx,enum:LN,function:NN,instanceof:dN,intersection:PN,lazy:IN,literal:DN,map:jN,nan:hN,nativeEnum:ON,never:bN,null:yN,nullable:UN,number:Gw,object:_N,oboolean:qN,onumber:BN,optional:$N,ostring:VN,pipeline:zN,preprocess:FN,promise:MN,record:AN,set:RN,strictObject:kN,string:Ww,symbol:mN,transformer:rx,tuple:TN,undefined:gN,union:CN,unknown:xN,void:wN,NEVER:WN,ZodIssueCode:ae,quotelessJson:UR,ZodError:Ar});const nx=(r,e,t)=>{if(r&&"reportValidity"in r){const n=je(t,e);r.setCustomValidity(n&&n.message||""),r.reportValidity()}},Zw=(r,e)=>{for(const t in e.fields){const n=e.fields[t];n&&n.ref&&"reportValidity"in n.ref?nx(n.ref,t,r):n.refs&&n.refs.forEach(o=>nx(o,t,r))}},GN=(r,e)=>{e.shouldUseNativeValidation&&Zw(r,e);const t={};for(const n in r){const o=je(e.fields,n),a=Object.assign(r[n]||{},{ref:o&&o.ref});if(KN(e.names||Object.keys(r),n)){const l=Object.assign({},je(t,n));ft(l,"root",a),ft(t,n,l)}else ft(t,n,a)}return t},KN=(r,e)=>r.some(t=>t.startsWith(e+"."));var ZN=function(r,e){for(var t={};r.length;){var n=r[0],o=n.code,a=n.message,l=n.path.join(".");if(!t[l])if("unionErrors"in n){var c=n.unionErrors[0].errors[0];t[l]={message:c.message,type:c.code}}else t[l]={message:a,type:o};if("unionErrors"in n&&n.unionErrors.forEach(function(m){return m.errors.forEach(function(g){return r.push(g)})}),e){var d=t[l].types,h=d&&d[n.code];t[l]=Nw(l,e,t,o,h?[].concat(h,n.message):n.message)}r.shift()}return t},JN=function(r,e,t){return t===void 0&&(t={}),function(n,o,a){try{return Promise.resolve(function(l,c){try{var d=Promise.resolve(r[t.mode==="sync"?"parse":"parseAsync"](n,e)).then(function(h){return a.shouldUseNativeValidation&&Zw({},a),{errors:{},values:t.raw?n:h}})}catch(h){return c(h)}return d&&d.then?d.then(void 0,c):d}(0,function(l){if(function(c){return Array.isArray(c?.errors)}(l))return{values:{},errors:GN(ZN(l.errors,!a.shouldUseNativeValidation&&a.criteriaMode==="all"),a)};throw l}))}catch(l){return Promise.reject(l)}}};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var QN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ke=(r,e)=>{const t=j.forwardRef(({color:n="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:c="",children:d,...h},m)=>j.createElement("svg",{ref:m,...QN,width:o,height:o,stroke:n,strokeWidth:l?Number(a)*24/Number(o):a,className:["lucide",`lucide-${YN(r)}`,c].join(" "),...h},[...e.map(([g,v])=>j.createElement(g,v)),...Array.isArray(d)?d:[d]]));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=Ke("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=Ke("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=Ke("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=Ke("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=Ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=Ke("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=Ke("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=Ke("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=Ke("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=Ke("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=Ke("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Ke("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=Ke("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Ke("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=Ke("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=Ke("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=Ke("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=Ke("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=Ke("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=Ke("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=Ke("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=Ke("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=Ke("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=Ke("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=Ke("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=Ke("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=Ke("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=Ke("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=Ke("PackageCheck",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Ke("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=Ke("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=Ke("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=Ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=Ke("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lu=Ke("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=Ke("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=Ke("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=Ke("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const np=Ke("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=Ke("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=Ke("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=Ke("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=Ke("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=Ke("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=Ke("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=Ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Tt=Me.forwardRef(({className:r,children:e,variant:t="primary",size:n="md",isLoading:o=!1,leftIcon:a,rightIcon:l,disabled:c,...d},h)=>{const m="inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",g={primary:"bg-primary-500 text-white hover:bg-primary-600 focus-visible:ring-primary-500 dark:bg-primary-600 dark:hover:bg-primary-700",secondary:"bg-secondary-500 text-white hover:bg-secondary-600 focus-visible:ring-secondary-500 dark:bg-secondary-600 dark:hover:bg-secondary-700",accent:"bg-accent-500 text-white hover:bg-accent-600 focus-visible:ring-accent-500 dark:bg-accent-600 dark:hover:bg-accent-700",outline:"border border-input bg-transparent hover:bg-accent-100 hover:text-accent-700 dark:border-gray-600 dark:hover:bg-gray-800 dark:hover:text-accent-400",ghost:"hover:bg-accent-100 hover:text-accent-700 bg-transparent dark:hover:bg-gray-800 dark:hover:text-accent-400",link:"text-primary-500 underline-offset-4 hover:underline bg-transparent dark:text-primary-400",danger:"bg-error-500 text-white hover:bg-error-600 focus-visible:ring-error-500 dark:bg-error-600 dark:hover:bg-error-700"},v={sm:"h-8 px-3 text-xs",md:"h-10 px-4 py-2",lg:"h-12 px-6 py-3 text-lg"};return p.jsxs("button",{className:es(m,g[t],v[n],o&&"opacity-70 pointer-events-none",r),disabled:c||o,ref:h,...d,children:[o&&p.jsxs("svg",{className:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",children:[p.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),p.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!o&&a&&p.jsx("span",{className:"mr-2",children:a}),e,!o&&l&&p.jsx("span",{className:"ml-2",children:l})]})});Tt.displayName="Button";const Ou=Me.forwardRef(({className:r,type:e,error:t,leftIcon:n,rightIcon:o,...a},l)=>p.jsxs("div",{className:"relative",children:[n&&p.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:n}),p.jsx("input",{type:e,className:es("flex h-10 w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm text-gray-900 dark:text-gray-100 file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-400 dark:placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-300",t&&"border-error-500 focus-visible:ring-error-500",n&&"pl-10",o&&"pr-10",r),ref:l,...a}),o&&p.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400",children:o}),t&&p.jsx("p",{className:"mt-1 text-sm text-error-500 dark:text-error-400",children:t})]}));Ou.displayName="Input";const yI=vf.object({email:vf.string().email("Email invalide"),password:vf.string().min(6,"Le mot de passe doit contenir au moins 6 caractères")}),vI=()=>{const{signIn:r,isLoading:e,error:t,clearError:n}=Ti(),o=Vs(),[a,l]=j.useState(!1),{register:c,handleSubmit:d,formState:{errors:h}}=$R({resolver:JN(yI),defaultValues:{email:"",password:""}});j.useEffect(()=>{t&&(t.includes("laboratoire")||t.includes("administrateur")||t.includes("Cette application est réservée"))&&l(!0)},[t]);const m=async w=>{n(),l(!1),(await r(w.email,w.password)).success&&o("/")},g=()=>{l(!1),n()},x=t?t.includes("laboratoire")?{type:"laboratory",icon:bl,title:"Compte Laboratoire",suggestion:"Vous devez utiliser l'interface dédiée aux laboratoires pour accéder à vos fonctionnalités.",color:"blue",actionText:"Accéder à l'interface laboratoire",actionUrl:"#"}:t.includes("administrateur")?{type:"admin",icon:dI,title:"Compte Administrateur",suggestion:"Vous devez utiliser l'interface d'administration pour gérer la plateforme.",color:"purple",actionText:"Accéder à l'interface admin",actionUrl:"#"}:t.includes("Cette application est réservée")?{type:"restricted",icon:pI,title:"Accès Restreint",suggestion:"Cette application mobile est exclusivement réservée aux chauffeurs-livreurs.",color:"red",actionText:"Contacter le support",actionUrl:"mailto:support@provence-courses.fr"}:{type:"auth",icon:Pr,title:"Erreur de Connexion",suggestion:"",color:"red"}:{type:"unknown",icon:Pr,title:"Erreur",suggestion:"",color:"amber"};return p.jsxs("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-primary-50 via-white to-accent-50 dark:from-gray-900 dark:via-gray-800 dark:to-primary-900/20",children:[p.jsxs("div",{className:"absolute inset-0",children:[p.jsx("div",{className:"absolute top-0 -left-4 w-72 h-72 bg-primary-300 dark:bg-primary-600 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-xl opacity-20 animate-blob"}),p.jsx("div",{className:"absolute top-0 -right-4 w-72 h-72 bg-accent-300 dark:bg-accent-600 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-xl opacity-20 animate-blob animation-delay-2000"}),p.jsx("div",{className:"absolute -bottom-8 left-20 w-72 h-72 bg-success-300 dark:bg-success-600 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-xl opacity-20 animate-blob animation-delay-4000"})]}),p.jsx("div",{className:"relative min-h-screen flex items-center justify-center p-4",children:p.jsxs(Le.div,{className:"w-full max-w-md",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[p.jsxs(Le.div,{className:"text-center mb-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.6},children:[p.jsx("div",{className:"flex justify-center mb-0",children:p.jsx("div",{className:"h-64 w-64",children:p.jsx("img",{src:"/provence-courses-logo.png",alt:"Provence Courses Logo",className:"h-full w-full object-contain"})})}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"application pour livreurs"})]}),p.jsxs(Le.div,{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/20 dark:border-gray-700/20 p-8",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.6},children:[p.jsxs("div",{className:"mb-6",children:[p.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Connexion"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Accédez à votre espace chauffeur"})]}),p.jsxs("form",{onSubmit:d(m),className:"space-y-6",children:[p.jsxs(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.6,duration:.5},children:[p.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adresse email"}),p.jsx("div",{className:"relative",children:p.jsx(Ou,{id:"email",type:"email",autoComplete:"email",leftIcon:p.jsx(aI,{className:"h-4 w-4 text-gray-400"}),error:h.email?.message,className:"pl-10 bg-gray-50/50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600 focus:ring-primary-500 focus:border-primary-500",placeholder:"votre.email@exemple.com",...c("email")})})]}),p.jsxs(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:[p.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Mot de passe"}),p.jsx("div",{className:"relative",children:p.jsx(Ou,{id:"password",type:"password",autoComplete:"current-password",leftIcon:p.jsx(oI,{className:"h-4 w-4 text-gray-400"}),error:h.password?.message,className:"pl-10 bg-gray-50/50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600 focus:ring-primary-500 focus:border-primary-500",placeholder:"••••••••",...c("password")})})]}),t&&!a&&!t.includes("Cette application est réservée")&&p.jsxs(Le.div,{className:"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 text-error-700 dark:text-error-400 px-4 py-3 rounded-xl flex items-start gap-3",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.3},children:[p.jsx(Pr,{className:"h-5 w-5 text-error-500 dark:text-error-400 mt-0.5 flex-shrink-0"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-sm font-medium",children:"Erreur de connexion"}),p.jsx("p",{className:"text-sm",children:t})]})]}),p.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:p.jsx(Tt,{type:"submit",className:"w-full bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white font-medium py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] flex items-center justify-center gap-2",isLoading:e,disabled:e,children:e?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Connexion..."]}):p.jsxs(p.Fragment,{children:["Se connecter",p.jsx(Jw,{className:"h-4 w-4"})]})})})]}),p.jsx(Le.div,{className:"mt-6 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:1,duration:.5},children:p.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Version chauffeur • Accès sécurisé"})})]}),p.jsx(Le.div,{className:"text-center mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2,duration:.5},children:p.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"© 2024 Provence Courses • Application de livraison"})})]})}),p.jsx(Mi,{children:a&&p.jsx(Le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-lg z-50 flex items-center justify-center p-4",onClick:g,children:p.jsxs(Le.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white dark:bg-gray-900 rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden border border-gray-200 dark:border-gray-700",onClick:w=>w.stopPropagation(),children:[p.jsx("div",{className:`p-8 pb-6 bg-gradient-to-br ${x.color==="blue"?"from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30":x.color==="purple"?"from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30":"from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/30"}`,children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:`inline-flex items-center justify-center w-20 h-20 rounded-full ${x.color==="blue"?"bg-blue-100 dark:bg-blue-800/50":x.color==="purple"?"bg-purple-100 dark:bg-purple-800/50":"bg-red-100 dark:bg-red-800/50"} mb-6`,children:p.jsx(x.icon,{className:`w-10 h-10 ${x.color==="blue"?"text-blue-600 dark:text-blue-400":x.color==="purple"?"text-purple-600 dark:text-purple-400":"text-red-600 dark:text-red-400"}`})}),p.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-3",children:x.title}),p.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${x.color==="blue"?"bg-blue-100 text-blue-800 dark:bg-blue-800/50 dark:text-blue-200":x.color==="purple"?"bg-purple-100 text-purple-800 dark:bg-purple-800/50 dark:text-purple-200":"bg-red-100 text-red-800 dark:bg-red-800/50 dark:text-red-200"}`,children:"Accès non autorisé"})]})}),p.jsxs("div",{className:"px-8 pb-8",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg leading-relaxed mb-4",children:t}),x.suggestion&&p.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:p.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 leading-relaxed",children:["💡 ",p.jsx("strong",{children:"Suggestion :"})," ",x.suggestion]})})]}),p.jsxs("div",{className:"space-y-3",children:[x.actionText&&p.jsx(Tt,{onClick:()=>window.open(x.actionUrl,"_blank"),className:`w-full ${x.color==="blue"?"bg-blue-600 hover:bg-blue-700 text-white":x.color==="purple"?"bg-purple-600 hover:bg-purple-700 text-white":"bg-red-600 hover:bg-red-700 text-white"} font-medium py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]`,children:x.actionText}),p.jsx(Tt,{onClick:g,variant:"outline",className:"w-full bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium py-3 px-4 rounded-xl transition-all duration-200",children:"Retour à la connexion"})]})]}),p.jsx("button",{onClick:g,className:"absolute top-6 right-6 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:p.jsx(_n,{className:"h-5 w-5"})})]})})})]})},gn=Me.forwardRef(({className:r,isPressable:e,isHoverable:t,isCompact:n,...o},a)=>p.jsx("div",{className:es("bg-white dark:bg-gray-800 rounded-2xl shadow-card border border-gray-100 dark:border-gray-700","transform-gpu backface-hidden will-change-transform",n?"p-4":"p-6",e&&"cursor-pointer active:scale-95 transition-transform duration-200 ease-out",t&&"hover:shadow-card-hover transition-shadow duration-200",r),ref:a,...o}));gn.displayName="Card";const ip=Me.forwardRef(({className:r,...e},t)=>p.jsx("div",{ref:t,className:es("mb-4 space-y-1.5 flex flex-col",r),...e}));ip.displayName="CardHeader";const ap=Me.forwardRef(({className:r,...e},t)=>p.jsx("h3",{ref:t,className:es("font-semibold text-xl leading-none tracking-tight text-gray-900 dark:text-gray-100",r),...e}));ap.displayName="CardTitle";const xI=Me.forwardRef(({className:r,...e},t)=>p.jsx("p",{ref:t,className:es("text-sm text-gray-500 dark:text-gray-400",r),...e}));xI.displayName="CardDescription";const Va=Me.forwardRef(({className:r,...e},t)=>p.jsx("div",{ref:t,className:es("",r),...e}));Va.displayName="CardContent";const bI=Me.forwardRef(({className:r,...e},t)=>p.jsx("div",{ref:t,className:es("flex items-center pt-4 mt-auto",r),...e}));bI.displayName="CardFooter";const wI=()=>{const r=et(),e=j.useCallback(async()=>{console.log("🔄 Début du rafraîchissement de toutes les données...");try{const n=await r.refreshAllReferenceData();return n.success?(console.log("✅ Toutes les données rafraîchies avec succès:",n.counts),{success:!0,message:`Données rafraîchies: ${n.counts?.locations} locations, ${n.counts?.laboratories} laboratoires, ${n.counts?.clients} clients`,counts:n.counts}):(console.error("❌ Échec du rafraîchissement:",n.error),{success:!1,message:`Erreur: ${n.error}`,error:n.error})}catch(n){return console.error("❌ Erreur inattendue lors du rafraîchissement:",n),{success:!1,message:"Erreur inattendue lors du rafraîchissement",error:n instanceof Error?n.message:"Erreur inconnue"}}},[r]),t={locations:r.referenceData.locations.size,laboratories:r.referenceData.laboratories.size,clients:r.referenceData.laboratoryClients.size};return{refreshAllData:e,currentCounts:t,isDataLoaded:t.locations>0&&t.laboratories>0}},SI=()=>{const r=Vs(),[e,t]=j.useState(""),[n,o]=j.useState(!1),[a,l]=j.useState(!1),[c,d]=j.useState(!1),{labTours:h,loading:m,error:g,isRefreshing:v}=I2(),{currentDriverId:x}=Ku(),w=Z2(),S=Zu(),{startRoute:_}=tm(),{refreshAllData:C,currentCounts:E,isDataLoaded:N}=wI(),{user:M}=Ti(),A={completed:w.deliveries.shipments.filter(G=>G.isCompleted),pending:w.deliveries.shipments.filter(G=>!G.isCompleted)},K={completed:w.pickups.shipments.filter(G=>G.isCompleted),pending:w.pickups.shipments.filter(G=>!G.isCompleted)},Z=new Date().toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),W=h.map(G=>{const Se=e.toLowerCase().trim();if(Se&&!G.laboratoryName.toLowerCase().includes(Se))return null;let Ce=G.pickups;return c&&x&&(Ce=G.pickups.filter(_e=>_e.isCurrentDriver)),Ce.length===0?null:{...G,pickups:Ce,totalPickups:Ce.length}}).filter(G=>G!==null);j.useEffect(()=>{N||(console.log("🔄 Rafraîchissement des données de référence au chargement du dashboard..."),C().then(G=>{G.success?console.log("✅ Dashboard: Toutes les données rafraîchies avec succès"):console.error("❌ Dashboard: Échec du rafraîchissement:",G.error)}))},[N,C]),j.useEffect(()=>(n||a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n,a]),console.log("📊 Dashboard - Compteurs actuels des données de référence:",E);const de=j.useCallback(()=>{o(!1),l(!1)},[]),pe=G=>{const Se=[{bg:"bg-sky-400",border:"border-sky-300",text:"text-white",gradient:"from-sky-400 to-sky-500",cardBg:"bg-sky-50 dark:bg-sky-900/20",cardBorder:"border-sky-200 dark:border-sky-800"},{bg:"bg-violet-400",border:"border-violet-300",text:"text-white",gradient:"from-violet-400 to-violet-500",cardBg:"bg-violet-50 dark:bg-violet-900/20",cardBorder:"border-violet-200 dark:border-violet-800"},{bg:"bg-gray-400",border:"border-gray-300",text:"text-white",gradient:"from-gray-400 to-gray-500",cardBg:"bg-gray-50 dark:bg-gray-900/20",cardBorder:"border-gray-200 dark:border-gray-800"},{bg:"bg-amber-300",border:"border-amber-200",text:"text-gray-800",gradient:"from-amber-300 to-amber-400",cardBg:"bg-amber-50 dark:bg-amber-900/20",cardBorder:"border-amber-200 dark:border-amber-800"},{bg:"bg-orange-400",border:"border-orange-300",text:"text-white",gradient:"from-orange-400 to-orange-500",cardBg:"bg-orange-50 dark:bg-orange-900/20",cardBorder:"border-orange-200 dark:border-orange-800"}];if(!G||G.trim()==="")return Se[0];let Ce=0;const _e=G.toString().toLowerCase();for(let X=0;X<_e.length;X++){const oe=_e.charCodeAt(X);Ce=(Ce<<5)-Ce+oe,Ce=Ce&Ce}const te=Math.abs(Ce)%Se.length;return Se[te]},Ee={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},ee={hidden:{y:20,opacity:0},show:{y:0,opacity:1}},ye=async()=>{if(!S.canStartRoute)return;await _()&&r("/driver/route")};return p.jsxs("div",{className:"space-y-6 pb-36",children:[p.jsx("div",{className:"p-4 bg-gradient-to-r from-sky-400 to-blue-500 text-white shadow-sm",children:p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsxs("h2",{className:"text-xl font-bold",children:["Bonjour, ",M?.profile?.full_name||"Livreur"]}),p.jsx("p",{className:"text-sm opacity-90",children:Z})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[!1,p.jsx("div",{className:"bg-white/10 px-3 py-2 rounded-lg",children:p.jsxs("div",{className:"text-center",children:[p.jsxs("div",{className:"font-bold text-lg",children:[w.progression.completed,"/",w.progression.total]}),p.jsx("div",{className:"text-xs opacity-90",children:S.status==="completed"?"tournée terminée":S.status==="validated"?"prête à démarrer":"arrêts restants"})]})})]})]})}),p.jsxs("div",{className:"px-4 sm:px-6 lg:px-8",children:[w.isActiveRoute?p.jsxs(Le.div,{className:"grid grid-cols-2 gap-4",variants:Ee,initial:"hidden",animate:"show",children:[p.jsx(Le.div,{variants:ee,className:"col-span-2",children:p.jsxs(gn,{className:`text-white ${S.status==="completed"?"bg-gradient-to-r from-green-500 to-emerald-600 dark:from-green-600 dark:to-emerald-700":"bg-gradient-to-r from-sky-400 to-blue-500 dark:from-sky-500 dark:to-blue-600"}`,children:[p.jsx(ip,{children:p.jsxs(ap,{className:"flex justify-between",children:[p.jsx("span",{className:"text-white dark:text-white",children:S.status==="completed"?"Tournée terminée":"Progression"}),S.status==="completed"?p.jsx(Ls,{className:"h-5 w-5 text-white"}):p.jsx(tr,{className:"h-5 w-5 text-white"})]})}),p.jsxs(Va,{children:[p.jsxs("div",{className:"text-3xl font-bold",children:[w.progression.completed,"/",w.progression.total]}),p.jsx("div",{className:"w-full bg-white/20 h-2 rounded-full mt-2",children:p.jsx("div",{className:"bg-white h-2 rounded-full",style:{width:`${w.progression.percentage}%`}})}),p.jsx("p",{className:"text-sm mt-2 text-white/80",children:S.status==="completed"?"Tous les arrêts ont été complétés":"Arrêts complétés"})]})]})}),p.jsx(Le.div,{variants:ee,children:p.jsxs(gn,{isPressable:!0,className:"relative overflow-hidden hover:shadow-lg transition-shadow duration-200 dark:bg-gray-800 dark:border-gray-700",onClick:()=>o(!0),children:[p.jsx("div",{className:"absolute inset-0 bg-secondary-50 dark:bg-green-500/40",style:{width:`${w.deliveries.percentage}%`}}),p.jsx(Va,{className:"p-4 relative",children:p.jsxs("div",{className:"text-center",children:[p.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[p.jsx(ox,{className:"h-5 w-5 text-secondary-600 dark:text-secondary-400"}),p.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Livraisons"})]}),p.jsxs("div",{className:"text-2xl font-bold text-secondary-600 dark:text-secondary-400",children:[w.deliveries.completed,"/",w.deliveries.total]})]})})]})}),p.jsx(Le.div,{variants:ee,children:p.jsxs(gn,{isPressable:!0,className:"relative overflow-hidden hover:shadow-lg transition-shadow duration-200 dark:bg-gray-800 dark:border-gray-700",onClick:()=>l(!0),children:[p.jsx("div",{className:"absolute inset-0 bg-primary-50 dark:bg-blue-400/50",style:{width:`${w.pickups.percentage}%`}}),p.jsx(Va,{className:"p-4 relative",children:p.jsxs("div",{className:"text-center",children:[p.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[p.jsx(ax,{className:"h-5 w-5 text-primary-600 dark:text-primary-400"}),p.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Récupérations"})]}),p.jsxs("div",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:[w.pickups.completed,"/",w.pickups.total]})]})})]})})]}):p.jsxs(gn,{className:"p-6 text-center",children:[p.jsx(Pr,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),p.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Aucune route active"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Aucune route validée n'a été trouvée pour aujourd'hui."})]}),n&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[110] flex items-start justify-center p-4 overflow-y-auto backdrop-blur-sm",onClick:de,children:p.jsxs(Le.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"bg-white dark:bg-gray-800 rounded-3xl w-full max-w-2xl h-[90vh] flex flex-col shadow-2xl",onClick:G=>G.stopPropagation(),children:[p.jsxs("div",{className:"p-6 flex items-center justify-between border-b dark:border-gray-700 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-t-3xl",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(ox,{className:"h-6 w-6 text-white"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Mes livraisons"})]}),p.jsx(Tt,{variant:"ghost",size:"sm",onClick:de,className:"hover:bg-white/50 dark:hover:bg-gray-700 rounded-full p-2 transition-all duration-200",children:p.jsx(_n,{className:"h-5 w-5"})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[p.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full"}),p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Livraisons complétées"}),p.jsx("div",{className:"h-px bg-gradient-to-r from-green-200 to-transparent flex-1"})]}),p.jsx("div",{className:"space-y-4",children:A.completed.map((G,Se)=>p.jsx(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:Se*.1},className:`p-5 rounded-2xl shadow-sm hover:shadow-md transition-all duration-200 ${G.hasError?"bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 border-2 border-red-200 dark:border-red-700":"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-200 dark:border-green-700"}`,children:p.jsxs("div",{className:"flex items-start gap-4",children:[G.hasError?p.jsx("div",{className:"h-10 w-10 bg-red-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(Pr,{className:"h-5 w-5 text-white"})}):p.jsx("div",{className:"h-10 w-10 bg-green-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(Ls,{className:"h-5 w-5 text-white"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:`font-bold text-lg leading-tight ${G.hasError?"text-red-800 dark:text-red-200":"text-green-800 dark:text-green-200"}`,children:G.clientName}),p.jsx("p",{className:`text-sm mt-1 font-medium ${G.hasError?"text-red-600 dark:text-red-300":"text-green-600 dark:text-green-300"}`,children:G.laboratoryName}),p.jsxs("div",{className:`flex items-center gap-2 text-sm mt-3 font-medium ${G.hasError?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:[p.jsx(tr,{className:"h-4 w-4 flex-shrink-0"}),p.jsxs("span",{children:["Livré à ",G.actualTime||G.estimatedTime||"heure inconnue"]})]})]})]})},G.shipment.id))})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[p.jsx("div",{className:"h-2 w-2 bg-orange-500 rounded-full"}),p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Livraisons en attente"}),p.jsx("div",{className:"h-px bg-gradient-to-r from-orange-200 to-transparent flex-1"})]}),p.jsx("div",{className:"space-y-4",children:A.pending.map((G,Se)=>p.jsx(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:Se*.1},className:"p-5 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700/50 dark:to-gray-600/50 rounded-2xl border-2 border-gray-200 dark:border-gray-600 shadow-sm hover:shadow-md transition-all duration-200",children:p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"h-10 w-10 bg-orange-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(tr,{className:"h-5 w-5 text-white"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:"font-bold text-lg text-gray-800 dark:text-gray-200 leading-tight",children:G.clientName}),p.jsx("p",{className:"text-sm mt-1 text-gray-600 dark:text-gray-400 font-medium",children:G.laboratoryName}),p.jsxs("div",{className:"flex items-center gap-2 text-sm mt-3 text-orange-600 dark:text-orange-400 font-medium",children:[p.jsx(tr,{className:"h-4 w-4 flex-shrink-0"}),p.jsxs("span",{children:["Prévu à ",G.estimatedTime||"heure non définie"]})]})]})]})},G.shipment.id))})]})]})]})}),a&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-[110] flex items-start justify-center p-4 overflow-y-auto backdrop-blur-sm",onClick:de,children:p.jsxs(Le.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"bg-white dark:bg-gray-800 rounded-3xl w-full max-w-2xl h-[90vh] flex flex-col shadow-2xl",onClick:G=>G.stopPropagation(),children:[p.jsxs("div",{className:"p-6 flex items-center justify-between border-b dark:border-gray-700 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-gray-800 dark:to-gray-700 rounded-t-3xl",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(ax,{className:"h-6 w-6 text-white"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Mes récupérations"})]}),p.jsx(Tt,{variant:"ghost",size:"sm",onClick:de,className:"hover:bg-white/50 dark:hover:bg-gray-700 rounded-full p-2 transition-all duration-200",children:p.jsx(_n,{className:"h-5 w-5"})})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[p.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full"}),p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Récupérations complétées"}),p.jsx("div",{className:"h-px bg-gradient-to-r from-green-200 to-transparent flex-1"})]}),p.jsx("div",{className:"space-y-4",children:K.completed.map((G,Se)=>p.jsx(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:Se*.1},className:`p-5 rounded-2xl shadow-sm hover:shadow-md transition-all duration-200 ${G.hasError?"bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 border-2 border-red-200 dark:border-red-700":"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-200 dark:border-green-700"}`,children:p.jsxs("div",{className:"flex items-start gap-4",children:[G.hasError?p.jsx("div",{className:"h-10 w-10 bg-red-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(Pr,{className:"h-5 w-5 text-white"})}):p.jsx("div",{className:"h-10 w-10 bg-green-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(Ls,{className:"h-5 w-5 text-white"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:`font-bold text-lg leading-tight ${G.hasError?"text-red-800 dark:text-red-200":"text-green-800 dark:text-green-200"}`,children:G.clientName}),p.jsx("p",{className:`text-sm mt-1 font-medium ${G.hasError?"text-red-600 dark:text-red-300":"text-green-600 dark:text-green-300"}`,children:G.laboratoryName}),p.jsxs("div",{className:`flex items-center gap-2 text-sm mt-3 font-medium ${G.hasError?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:[p.jsx(tr,{className:"h-4 w-4 flex-shrink-0"}),p.jsxs("span",{children:["Récupéré à ",G.actualTime||G.estimatedTime||"heure inconnue"]})]})]})]})},G.shipment.id))})]}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[p.jsx("div",{className:"h-2 w-2 bg-orange-500 rounded-full"}),p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Récupérations en attente"}),p.jsx("div",{className:"h-px bg-gradient-to-r from-orange-200 to-transparent flex-1"})]}),p.jsx("div",{className:"space-y-4",children:K.pending.map((G,Se)=>p.jsx(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:Se*.1},className:"p-5 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700/50 dark:to-gray-600/50 rounded-2xl border-2 border-gray-200 dark:border-gray-600 shadow-sm hover:shadow-md transition-all duration-200",children:p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"h-10 w-10 bg-orange-500 rounded-2xl flex items-center justify-center shadow-lg",children:p.jsx(tr,{className:"h-5 w-5 text-white"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:"font-bold text-lg text-gray-800 dark:text-gray-200 leading-tight",children:G.clientName}),p.jsx("p",{className:"text-sm mt-1 text-gray-600 dark:text-gray-400 font-medium",children:G.laboratoryName}),p.jsxs("div",{className:"flex items-center gap-2 text-sm mt-3 text-orange-600 dark:text-orange-400 font-medium",children:[p.jsx(tr,{className:"h-4 w-4 flex-shrink-0"}),p.jsxs("span",{children:["Prévu à ",G.estimatedTime||"heure non définie"]})]})]})]})},G.shipment.id))})]})]})]})}),p.jsxs(Le.div,{className:"mt-6 space-y-6",variants:Ee,initial:"hidden",animate:"show",children:[p.jsx(Le.div,{variants:ee,children:p.jsxs(gn,{className:"dark:bg-gray-800 dark:border-gray-700",children:[p.jsx(ip,{className:"pb-2",children:p.jsxs(ap,{className:"text-lg dark:text-gray-100 flex items-center justify-between",children:[p.jsx("span",{children:"Récupérations laboratoires"}),p.jsxs("div",{className:"flex items-center gap-4",children:[v&&p.jsxs("div",{className:"flex items-center gap-2 text-blue-500 animate-pulse",children:[p.jsx(rp,{className:"h-4 w-4 animate-spin"}),p.jsx("span",{className:"text-sm font-normal",children:"Mise à jour..."})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mes colis uniquement"}),p.jsx("button",{onClick:()=>d(!c),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ease-in-out ${c?"bg-emerald-500 hover:bg-emerald-600":"bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500"}`,title:c?"Afficher tous les colis":"Afficher uniquement mes colis",children:p.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-lg transition-transform duration-200 ease-in-out ${c?"translate-x-6":"translate-x-1"}`})})]})]})]})}),p.jsxs(Va,{children:[p.jsx("div",{className:"mb-4",children:p.jsx(Ou,{placeholder:"Rechercher un laboratoire...",value:e,onChange:G=>t(G.target.value),leftIcon:p.jsx(uI,{className:"h-4 w-4"})})}),p.jsx("div",{className:"space-y-4",children:m?p.jsxs("div",{className:"flex items-center justify-center py-8",children:[p.jsx(rp,{className:"h-6 w-6 animate-spin text-blue-500"}),p.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Chargement des récupérations..."})]}):g?p.jsxs("div",{className:"flex items-center justify-center py-8 text-red-500",children:[p.jsx(Pr,{className:"h-6 w-6"}),p.jsxs("span",{className:"ml-2",children:["Erreur: ",g]})]}):W.length===0?p.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Aucune récupération laboratoire disponible"}):p.jsx("div",{className:`space-y-3 transition-opacity duration-300 ${v?"opacity-60":"opacity-100"}`,children:W.map(G=>p.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-xl overflow-hidden border-2 border-blue-300 dark:border-blue-600 shadow-sm",children:[p.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-800/50 border-b-2 border-blue-200 dark:border-blue-600",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center shadow-md",children:p.jsx(bl,{className:"h-4 w-4 text-white"})}),p.jsx("h3",{className:"font-bold text-blue-800 dark:text-blue-200 text-lg",children:G.laboratoryName})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("span",{className:"text-blue-600 dark:text-blue-300 font-bold text-lg",children:G.totalPickups}),p.jsx("span",{className:"text-blue-600 dark:text-blue-300 text-xs font-medium",children:"colis"})]})]})}),p.jsx("div",{className:"p-3 bg-white dark:bg-gray-800",children:p.jsx("div",{className:"space-y-2",children:p.jsx(Mi,{mode:"popLayout",children:G.pickups.map(Se=>p.jsxs(Le.div,{initial:{opacity:0,height:0,y:-20},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-20},transition:{duration:.3,ease:"easeInOut",height:{duration:.4}},className:`flex items-center justify-between p-3 rounded-lg border-2 overflow-hidden ${Se.isCurrentDriver?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800":(()=>{const Ce=pe(Se.assignedDriverName);return`${Ce.cardBg} ${Ce.cardBorder}`})()}`,children:[p.jsx("div",{className:"flex items-center",children:p.jsx("div",{className:"pl-4 ml-1 border-l-2 border-gray-200 dark:border-gray-700",children:p.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:Se.clientName})})}),p.jsxs("div",{className:"flex items-center gap-2",children:[Se.shipmentType==="depot_to_client"&&p.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-orange-100 dark:bg-orange-900/20 rounded-lg border border-orange-300 dark:border-orange-700",children:[p.jsx(Lu,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"}),p.jsx(Jw,{className:"h-3 w-3 text-orange-600 dark:text-orange-400"})]}),Se.shipmentType==="lab_to_depot"&&p.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-orange-100 dark:bg-orange-900/20 rounded-lg border border-orange-300 dark:border-orange-700",children:[p.jsx(Lu,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"}),p.jsx(XN,{className:"h-3 w-3 text-orange-600 dark:text-orange-400"})]}),Se.isCurrentDriver?p.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-4 py-2 rounded-lg text-xs font-semibold shadow-sm border border-emerald-400",children:"Vous"}):(()=>{const Ce=pe(Se.assignedDriverName);return p.jsx("div",{className:`bg-gradient-to-r ${Ce.gradient} ${Ce.text} px-4 py-2 rounded-lg text-xs font-semibold shadow-sm border ${Ce.border}`,children:Se.assignedDriverName})})()]})]},Se.id))})})})]},G.id))})})]})]})}),p.jsx(Le.div,{variants:ee,className:"flex justify-center",children:S.status==="in_progress"?p.jsx(bx,{to:"/driver/route",className:"w-full",children:p.jsxs(Tt,{size:"lg",className:"w-full shadow-lg flex items-center justify-center gap-2",children:[p.jsx(um,{className:"h-5 w-5"}),"Continuer ma tournée"]})}):p.jsxs(Tt,{size:"lg",className:`w-full shadow-lg flex items-center justify-center gap-2 ${S.buttonDisabled?"bg-gray-400 hover:bg-gray-400 cursor-not-allowed opacity-60":""}`,disabled:S.buttonDisabled,onClick:ye,children:[p.jsx(wl,{className:"h-5 w-5"}),S.buttonText]})})]})]})]})},_I=(r,e=800,t=.6)=>new Promise((n,o)=>{const a=document.createElement("canvas"),l=a.getContext("2d");if(!l){o(new Error("Canvas context non disponible"));return}const c=new Image;c.onload=()=>{try{const d=Math.min(e/c.width,e/c.height),h=Math.floor(c.width*d),m=Math.floor(c.height*d);a.width=h,a.height=m,l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(c,0,0,h,m),a.toBlob(g=>{if(!g){o(new Error("Impossible de créer le blob"));return}const v=r.size,x=g.size,w=Math.round((v-x)/v*100);console.log("📸 [compressImage] Compression terminée:",{originalSize:Math.round(v/1024)+"KB",compressedSize:Math.round(x/1024)+"KB",compressionRatio:w+"%",dimensions:`${h}x${m}`,format:g.type}),n(g)},"image/jpeg",t)}catch(d){console.error("❌ [compressImage] Erreur lors de la compression:",d),o(d)}finally{URL.revokeObjectURL(c.src)}},c.onerror=()=>{o(new Error("Erreur de chargement de l'image"))},c.src=URL.createObjectURL(r)}),kI=({onCapture:r,onClose:e,packageId:t})=>{const n=j.useRef(null),o=async a=>{const l=a.target.files?.[0];if(console.log("📷 [CameraCapture] handleFileSelect déclenché:",{hasFile:!!l,fileName:l?.name,fileSize:l?.size,packageId:t?.slice(-8),timestamp:Date.now()}),!l){console.log("📷 [CameraCapture] Utilisateur a annulé - fermeture"),e();return}try{console.log("📷 [CameraCapture] Début compression image...");const c=await _I(l);console.log("✅ [CameraCapture] Compression terminée - envoi Blob:",{blobSize:`${Math.round(c.size/1024)}KB`,packageId:t?.slice(-8)}),r(c,t)}catch(c){console.error("❌ [CameraCapture] Erreur lors de la compression de l'image:",c),alert("Erreur lors du traitement de l'image. Réessayez."),e()}};return Me.useEffect(()=>{console.log("📷 [CameraCapture] Composant monté:",{packageId:t?.slice(-8),hasPackageId:!!t,timestamp:Date.now()});const a=setTimeout(()=>{n.current?(console.log("📷 [CameraCapture] Déclenchement appareil photo:",{packageId:t?.slice(-8),inputElement:"available",timestamp:Date.now()}),n.current.click()):(console.warn("⚠️ [CameraCapture] fileInputRef non disponible, nouvel essai..."),setTimeout(()=>{n.current?(console.log("📷 [CameraCapture] Retry déclenchement réussi"),n.current.click()):console.error("❌ [CameraCapture] fileInputRef toujours indisponible après retry")},50))},100);return()=>{console.log("🧹 [CameraCapture] Cleanup timer"),clearTimeout(a)}},[t]),p.jsx(p.Fragment,{children:p.jsx("input",{ref:n,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"})})},CI=({currentStopIndex:r,totalStops:e})=>{const t=Math.round(r/e*100);return p.jsx(gn,{className:"p-4",children:p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Arrêts complétés : ",r,"/",e]}),p.jsxs("span",{className:"text-sm font-medium text-primary-500",children:[t,"%"]})]}),p.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:p.jsx("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:`${t}%`}})})]})})},EI=(r,e="h-8 w-8")=>{switch(r){case"laboratory":return p.jsx(bl,{className:`${e} text-primary-500`});case"dentist":return p.jsx(cm,{className:`${e} text-success-500`});case"depot":return p.jsx(mI,{className:`${e} text-accent-500`})}},Xw=r=>{switch(r){case"laboratory":return"bg-primary-50 dark:bg-primary-900/20";case"dentist":return"bg-success-50 dark:bg-success-900/20";case"depot":return"bg-accent-50 dark:bg-accent-900/20"}},PI=r=>{const t=r.toUpperCase().replace(/[^A-Z\s]/g,"").split(" ").filter(n=>n.length>0);return t.length===1?t[0].substring(0,2):t.slice(0,2).map(n=>n[0]).join("")},TI=(r,e,t="md")=>{const n=PI(e),o={sm:"text-sm",md:"text-2xl font-black",lg:"text-3xl font-black"};switch(r){case"laboratory":return p.jsx("div",{className:`bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold ${o[t]} shadow-lg w-full h-full`,children:n});case"dentist":return p.jsx("div",{className:`bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center text-white font-bold ${o[t]} shadow-lg w-full h-full`,children:n});case"depot":return p.jsx("div",{className:`bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center text-white font-bold ${o[t]} shadow-lg w-full h-full`,children:n})}},AI=({type:r,size:e="md",showBackground:t=!0,onClick:n,stopName:o})=>{const a={sm:"h-6 w-6",md:"h-8 w-8",lg:"h-10 w-10"},l={sm:"h-10 w-10",md:"h-16 w-16",lg:"h-20 w-20"};if(o){const d=TI(r,o,e);return t?p.jsx("div",{className:`${l[e]} rounded-2xl ${n?"cursor-pointer hover:shadow-lg transition-all duration-200":""}`,onClick:n,children:d}):d}const c=EI(r,a[e]);return t?p.jsx("div",{className:`${l[e]} rounded-2xl ${Xw(r)} flex items-center justify-center ${n?"cursor-pointer hover:shadow-lg transition-all duration-200":""}`,onClick:n,children:c}):c},jI=({stop:r})=>{if(r.type==="dentist"){const e=r.packages.some(n=>n.type==="delivery"),t=r.packages.some(n=>n.type==="pickup");if(e&&t)return p.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[p.jsxs("span",{className:"px-3 py-1 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 rounded-full text-sm flex items-center",children:[p.jsx(rn,{className:"h-4 w-4 mr-1"}),"Livraison"]}),p.jsxs("span",{className:"px-3 py-1 bg-accent-50 dark:bg-accent-900/20 text-accent-600 dark:text-accent-400 rounded-full text-sm flex items-center",children:[p.jsx(Ni,{className:"h-4 w-4 mr-1"}),"Récupération"]})]});if(e)return p.jsx("div",{className:"flex justify-center mt-2",children:p.jsxs("span",{className:"px-3 py-1 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 rounded-full text-sm flex items-center",children:[p.jsx(rn,{className:"h-4 w-4 mr-1"}),"Livraison"]})});if(t)return p.jsx("div",{className:"flex justify-center mt-2",children:p.jsxs("span",{className:"px-3 py-1 bg-accent-50 dark:bg-accent-900/20 text-accent-600 dark:text-accent-400 rounded-full text-sm flex items-center",children:[p.jsx(Ni,{className:"h-4 w-4 mr-1"}),"Récupération"]})})}return null},La=({package:r,stopType:e,onClick:t,onReportIssue:n})=>{const o=()=>{switch(r.displayIcon){case"delivery":return p.jsx(rn,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"});case"pickup":return p.jsx(Ni,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"});case"return":return p.jsx(Ni,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"});default:return p.jsx(rn,{className:"h-5 w-5 text-primary-500"})}},a=()=>{switch(r.displayIcon){case"delivery":return"text-blue-800 dark:text-blue-200 font-semibold";case"pickup":return"text-emerald-800 dark:text-emerald-200 font-semibold";case"return":return"text-amber-800 dark:text-amber-200 font-semibold";default:return"text-gray-700 dark:text-gray-300 font-medium"}},l=h=>{const m=/\b[A-Z]{2,}(?:\s+[A-Z0-9]+)*\b/g,g=h.match(m)||[];if(g.length>0){let v=h;g.forEach(w=>{v=v.replace(w,`<HIGHLIGHT>${w}</HIGHLIGHT>`)});const x=v.split(/<HIGHLIGHT>|<\/HIGHLIGHT>/);return p.jsx("span",{className:"text-sm leading-relaxed",children:x.map((w,S)=>S%2===1?p.jsx("span",{className:"font-bold text-primary-700 dark:text-primary-300",children:w},S):p.jsx("span",{children:w},S))})}return p.jsx("span",{className:"text-sm leading-relaxed font-medium",children:h})},c=()=>e==="dentist"?r.status==="completed"?"bg-success-50 dark:bg-success-900/30 border-2 border-white dark:border-white/80 shadow-md":r.status==="error"?"bg-error-50 dark:bg-error-900/30 border-2 border-white dark:border-white/80 shadow-md":"bg-gray-50 dark:bg-gray-800 border-2 border-white dark:border-white/60 hover:bg-gray-100 dark:hover:bg-gray-700 hover:border-white dark:hover:border-white/80 shadow-sm hover:shadow-md transition-all duration-200":r.selected?"bg-primary-50 dark:bg-primary-900/30 border-2 border-primary-400 dark:border-primary-300 shadow-md ring-2 ring-white dark:ring-white/40":"bg-gray-50 dark:bg-gray-800 border-2 border-white dark:border-white/60 hover:bg-gray-100 dark:hover:bg-gray-700 hover:border-white dark:hover:border-white/80 shadow-sm hover:shadow-md transition-all duration-200",d=e==="dentist"?!0:r.status!=="error";return p.jsx("div",{className:`p-4 rounded-xl transition-all duration-200 ${d?"cursor-pointer":""} ${c()}`,onClick:d?t:void 0,children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-md border border-gray-200 dark:border-gray-600",children:o()}),p.jsx("div",{className:"flex-1",children:p.jsx("div",{className:a(),children:r.displayLabel?l(r.displayLabel):p.jsxs(p.Fragment,{children:[p.jsxs("span",{className:`font-medium ${r.status==="error"?"text-error-700 dark:text-error-400":"dark:text-gray-100"}`,children:["Colis ",r.id]}),r.type==="delivery"&&r.from&&p.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["De : ",r.from]}),r.type==="pickup"&&r.to&&p.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Pour : ",r.to]})]})})})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[e==="dentist"&&r.status==="pending"&&p.jsx(Tt,{variant:"ghost",size:"sm",className:"bg-error-100 dark:bg-error-900/30 text-error-600 dark:text-error-400 hover:bg-error-200 dark:hover:bg-error-900/40 border border-white dark:border-white/60 h-[60px] w-[60px] flex items-center justify-center rounded-xl shadow-md transition-all duration-200",onClick:n,title:"Signaler un problème",children:p.jsx(Pr,{className:"h-5 w-5"})}),r.status==="completed"?p.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-md border border-gray-200 dark:border-gray-600",children:p.jsx(Du,{className:"h-5 w-5 text-success-500"})}):r.status==="error"?p.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-md border border-gray-200 dark:border-gray-600",children:p.jsx(_n,{className:"h-5 w-5 text-error-500"})}):r.selected?p.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded-lg shadow-md border border-gray-200 dark:border-gray-600",children:p.jsx(Du,{className:"h-5 w-5 text-primary-500"})}):null]})]})})},RI=({currentStop:r,onPackageClick:e,onReportIssue:t})=>{const n=c=>{e(c)},o=c=>d=>{t(c,d)};if(r.type==="dentist"){const c=r.packages.filter(h=>h.type==="delivery"),d=r.packages.filter(h=>h.type==="pickup");return p.jsxs("div",{className:"space-y-6",children:[c.length>0&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("h2",{className:"font-medium dark:text-gray-100",children:"Colis à livrer :"}),c.map(h=>p.jsx(La,{package:h,stopType:r.type,onClick:()=>n(h.id),onReportIssue:o(h.id)},h.id))]}),d.length>0&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("h2",{className:"font-medium dark:text-gray-100",children:"Colis à récupérer :"}),d.map(h=>p.jsx(La,{package:h,stopType:r.type,onClick:()=>n(h.id),onReportIssue:o(h.id)},h.id))]})]})}const a=r.packages.filter(c=>c.type==="pickup"),l=r.packages.filter(c=>c.type==="delivery");return r.action==="both"?p.jsxs("div",{className:"space-y-6",children:[a.length>0&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("h2",{className:"font-medium dark:text-gray-100",children:"Colis à récupérer :"}),a.map(c=>p.jsx(La,{package:c,stopType:r.type,onClick:()=>n(c.id),onReportIssue:o(c.id)},c.id))]}),l.length>0&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("h2",{className:"font-medium dark:text-gray-100",children:"Colis à déposer :"}),l.map(c=>p.jsx(La,{package:c,stopType:r.type,onClick:()=>n(c.id),onReportIssue:o(c.id)},c.id))]})]}):p.jsxs("div",{className:"space-y-3",children:[p.jsxs("h2",{className:"font-medium dark:text-gray-100",children:[r.action==="pickup"?"Colis à récupérer":"Colis à déposer"," :"]}),r.packages.map(c=>p.jsx(La,{package:c,stopType:r.type,onClick:()=>n(c.id),onReportIssue:o(c.id)},c.id))]})},NI=({nextStops:r})=>{if(r.length===0)return null;const e=Me.useMemo(()=>({hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}}),[]),t=Me.useMemo(()=>({hidden:{y:10,opacity:0},show:{y:0,opacity:1,transition:{duration:.2}}}),[]),n=Me.useCallback(c=>c.split(" ").filter(d=>d.length>0).slice(0,2).map(d=>d[0].toUpperCase()).join(""),[]),o=Me.useCallback((c,d)=>{const h=n(d);switch(c){case"laboratory":return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:h});case"dentist":return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:h});case"depot":return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:h});default:return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-slate-500 to-slate-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:h})}},[n]),a=Me.useCallback(c=>{switch(c){case"laboratory":return"bg-gradient-to-br from-blue-50/90 via-indigo-50/80 to-blue-100/70 dark:from-blue-950/30 dark:via-indigo-950/20 dark:to-blue-900/25";case"dentist":return"bg-gradient-to-br from-emerald-50/90 via-green-50/80 to-emerald-100/70 dark:from-emerald-950/30 dark:via-green-950/20 dark:to-emerald-900/25";case"depot":return"bg-gradient-to-br from-orange-50/90 via-amber-50/80 to-orange-100/70 dark:from-orange-950/30 dark:via-amber-950/20 dark:to-orange-900/25";default:return"bg-gradient-to-br from-slate-50/90 via-gray-50/80 to-slate-100/70 dark:from-slate-800/30 dark:via-gray-800/20 dark:to-slate-700/25"}},[]),l=Me.useCallback(c=>{const d=c.packages.filter(v=>v.type==="delivery").length,h=c.packages.filter(v=>v.type==="pickup").length,g=(v=>{const x=v.match(/\b[A-Z][A-Z0-9]*(?:\s+[A-Z][A-Z0-9]*)*\b/g);return x?x.join(" "):v.toUpperCase()})(c.name);if(c.type==="laboratory"&&d>0&&h===0)return[{text:`${d} retour${d>1?"s":""} labo`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-purple-100 to-purple-200 dark:from-purple-900/40 dark:to-purple-800/30",textColor:"text-purple-800 dark:text-purple-300",iconColor:"text-purple-700 dark:text-purple-400"}];if(c.type==="laboratory"&&h>0&&d===0)return[{text:`${h} récupération${h>1?"s":""} labo`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/30",textColor:"text-blue-800 dark:text-blue-300",iconColor:"text-blue-700 dark:text-blue-400"}];if(c.type==="depot"&&d>0&&h===0)return[{text:`${d} retour${d>1?"s":""} ${g}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-orange-100 to-orange-200 dark:from-orange-900/40 dark:to-orange-800/30",textColor:"text-orange-800 dark:text-orange-300",iconColor:"text-orange-700 dark:text-orange-400"}];if(c.type==="depot"&&h>0&&d===0)return[{text:`${h} récupération${h>1?"s":""} ${g}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-amber-100 to-amber-200 dark:from-amber-900/40 dark:to-amber-800/30",textColor:"text-amber-800 dark:text-amber-300",iconColor:"text-amber-700 dark:text-amber-400"}];if(d>0&&h>0){const v=[];return c.type==="laboratory"?(v.push({text:`${d} retour${d>1?"s":""} labo`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-purple-100 to-purple-200 dark:from-purple-900/40 dark:to-purple-800/30",textColor:"text-purple-800 dark:text-purple-300",iconColor:"text-purple-700 dark:text-purple-400"}),v.push({text:`${h} récupération${h>1?"s":""} labo`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/30",textColor:"text-blue-800 dark:text-blue-300",iconColor:"text-blue-700 dark:text-blue-400"})):c.type==="depot"?(v.push({text:`${d} retour${d>1?"s":""} ${g}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-orange-100 to-orange-200 dark:from-orange-900/40 dark:to-orange-800/30",textColor:"text-orange-800 dark:text-orange-300",iconColor:"text-orange-700 dark:text-orange-400"}),v.push({text:`${h} récupération${h>1?"s":""} ${g}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-amber-100 to-amber-200 dark:from-amber-900/40 dark:to-amber-800/30",textColor:"text-amber-800 dark:text-amber-300",iconColor:"text-amber-700 dark:text-amber-400"})):(v.push({text:`${d} livraison${d>1?"s":""}`,icon:p.jsx(sx,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/40 dark:to-emerald-800/30",textColor:"text-emerald-800 dark:text-emerald-300",iconColor:"text-emerald-700 dark:text-emerald-400"}),v.push({text:`${h} récupération${h>1?"s":""}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/30",textColor:"text-blue-800 dark:text-blue-300",iconColor:"text-blue-700 dark:text-blue-400"})),v}else{if(d>0)return c.type==="laboratory"||c.type==="depot"?[{text:`${d} retour${d>1?"s":""} ${c.type==="laboratory"?"labo":g}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:c.type==="laboratory"?"bg-gradient-to-r from-purple-100 to-purple-200 dark:from-purple-900/40 dark:to-purple-800/30":"bg-gradient-to-r from-orange-100 to-orange-200 dark:from-orange-900/40 dark:to-orange-800/30",textColor:c.type==="laboratory"?"text-purple-800 dark:text-purple-300":"text-orange-800 dark:text-orange-300",iconColor:c.type==="laboratory"?"text-purple-700 dark:text-purple-400":"text-orange-700 dark:text-orange-400"}]:[{text:`${d} livraison${d>1?"s":""}`,icon:p.jsx(sx,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/40 dark:to-emerald-800/30",textColor:"text-emerald-800 dark:text-emerald-300",iconColor:"text-emerald-700 dark:text-emerald-400"}];if(h>0)return c.type==="laboratory"||c.type==="depot"?[{text:`${h} récupération${h>1?"s":""} ${c.type==="laboratory"?"labo":g}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:c.type==="laboratory"?"bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/30":"bg-gradient-to-r from-amber-100 to-amber-200 dark:from-amber-900/40 dark:to-amber-800/30",textColor:c.type==="laboratory"?"text-blue-800 dark:text-blue-300":"text-amber-800 dark:text-amber-300",iconColor:c.type==="laboratory"?"text-blue-700 dark:text-blue-400":"text-amber-700 dark:text-amber-400"}]:[{text:`${h} récupération${h>1?"s":""}`,icon:p.jsx(zr,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/30",textColor:"text-blue-800 dark:text-blue-300",iconColor:"text-blue-700 dark:text-blue-400"}]}return[{text:"Action non définie",icon:p.jsx(rn,{className:"h-4 w-4"}),bgColor:"bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-800/40 dark:to-slate-700/30",textColor:"text-slate-800 dark:text-slate-300",iconColor:"text-slate-700 dark:text-slate-400"}]},[]);return p.jsxs("div",{className:"mt-6",children:[p.jsxs("h2",{className:"text-lg font-bold mb-4 text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[p.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-primary-500 to-primary-600 rounded-full"}),"Prochains arrêts"]}),p.jsx(Le.div,{className:"space-y-4",variants:e,initial:"hidden",animate:"show",children:r.map((c,d)=>{const h=l(c);return p.jsx(Le.div,{variants:t,children:p.jsx("div",{className:`overflow-hidden ${a(c.type)} border border-slate-300/60 dark:border-slate-600/50 shadow-md shadow-slate-200/40 dark:shadow-slate-800/50 ${c.isLateStop?"ring-4 ring-yellow-400/70 dark:ring-yellow-500/50 bg-gradient-to-r from-yellow-50 via-orange-50 to-yellow-100 dark:from-yellow-950/40 dark:via-orange-950/30 dark:to-yellow-900/40 border-yellow-400 dark:border-yellow-500":""} transition-all duration-300 backdrop-blur-sm rounded-2xl`,children:p.jsxs("div",{className:"p-5",children:[c.isLateStop&&p.jsx("div",{className:"mb-4 flex justify-center",children:p.jsxs("div",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg border-2 border-white/30",children:[p.jsx(tr,{className:"w-3 h-3 mr-1.5"}),"Arrêt Ajouté"]})}),p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-xl bg-gradient-to-br from-slate-500 to-slate-600 flex items-center justify-center shadow-lg ring-2 ring-white/50 dark:ring-gray-800/50",children:p.jsx("span",{className:"text-sm font-bold text-white",children:d+2})}),p.jsx("div",{className:"flex-shrink-0",children:o(c.type,c.name)}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("div",{className:"flex items-start justify-between mb-4",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("h4",{className:"font-bold text-lg text-slate-900 dark:text-slate-100 truncate",children:c.name}),p.jsx("button",{onClick:()=>{const g=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(c.address)}&travelmode=driving`;window.open(g,"_blank")},className:"text-sm text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 truncate leading-relaxed transition-colors text-left w-full",children:c.address})]}),p.jsx("div",{className:"ml-3 flex-shrink-0",children:p.jsxs("div",{className:"flex items-center px-3 py-1.5 rounded-xl shadow-md bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700/60 dark:to-slate-600/60 border border-slate-300/50 dark:border-slate-600/50",children:[p.jsx(tr,{className:"h-3.5 w-3.5 mr-1.5 text-slate-600 dark:text-slate-400"}),p.jsx("span",{className:"text-xs font-semibold text-slate-700 dark:text-slate-300",children:c.estimatedTime||"--:--"})]})})]}),p.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:h.map((m,g)=>p.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-xl ${m.bgColor} shadow-md backdrop-blur-sm border border-white/30 dark:border-gray-600/30`,children:[p.jsx("span",{className:m.iconColor,children:m.icon}),p.jsx("span",{className:`text-sm font-semibold ${m.textColor}`,children:m.text})]},g))})]})]})]})})},c.id)})})]})},eS=({isOpen:r,onClose:e,onSelectLab:t,availableLabs:n})=>r?p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4",onClick:e,children:p.jsxs(Le.div,{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-md shadow-2xl border border-gray-200 dark:border-gray-700",onClick:o=>o.stopPropagation(),initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[p.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-10 h-10 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:p.jsx(eI,{className:"h-5 w-5 text-primary-600 dark:text-primary-400"})}),p.jsx("div",{children:p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Choisir le laboratoire de destination"})})]}),p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-3",children:"Sélectionnez le laboratoire qui doit recevoir ce colis de récupération inattendue"})]}),p.jsx("div",{className:"p-4",children:n.length>0?p.jsx("div",{className:"space-y-2",children:n.map(o=>p.jsx("button",{onClick:()=>t(o.id,o.name),className:"w-full p-4 text-left rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600 hover:border-primary-300 dark:hover:border-primary-600",children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-8 h-8 bg-primary-100 dark:bg-primary-900/30 rounded-lg flex items-center justify-center",children:p.jsx(bl,{className:"h-4 w-4 text-primary-600 dark:text-primary-400"})}),p.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:o.name})]})},o.id))}):p.jsxs("div",{className:"text-center py-8",children:[p.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-xl flex items-center justify-center mx-auto mb-3",children:p.jsx(bl,{className:"h-6 w-6 text-gray-400 dark:text-gray-500"})}),p.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Aucun laboratoire disponible"}),p.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs mt-1",children:"Aucun laboratoire n'a livré ce dentiste aujourd'hui"})]})}),p.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:p.jsx("button",{onClick:e,className:"w-full py-2 px-4 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl transition-colors",children:"Annuler"})})]})}):null,II=({locationId:r,address:e,onUnexpectedPickup:t,onSelectLab:n,onTakePhoto:o,disabled:a=!1})=>{const l=r||e,c=!!r,{shouldShowButton:d,isLoading:h,eligibleLabs:m,error:g,needsLabSelection:v}=vR({locationId:l,enabled:!!l,isLocationId:c}),[x,w]=j.useState(!1);Me.useEffect(()=>{},[r,d,h,m,g,v,x,c]);const S=()=>{console.log("🔍 [UnexpectedPickupButton] Clic détecté:",{needsLabSelection:v,eligibleLabsCount:m.length,hasOnSelectLab:!!n,eligibleLabs:m.map(N=>N.name)}),m.length>0?(console.log("🔍 Ouverture de la modal de sélection des laboratoires"),w(!0)):(console.log("🔍 Fallback vers onUnexpectedPickup (aucun labo éligible)"),t())},_=(N,M)=>{w(!1),n?n(N,M):(console.log("Laboratoire sélectionné:",M,N),t())},C=()=>{w(!1)},E=m.map(N=>({id:N.id,name:N.name}));return p.jsx(Mi,{children:(d||h)&&p.jsxs(Le.div,{initial:{opacity:0,height:0,marginBottom:0},animate:{opacity:1,height:"auto",marginBottom:12},exit:{opacity:0,height:0,marginBottom:0},transition:{duration:.3,ease:[.4,0,.2,1],height:{duration:.4}},children:[p.jsx(Tt,{variant:"primary",size:"lg",className:"w-full bg-orange-400 hover:bg-orange-500 dark:bg-orange-500 dark:hover:bg-orange-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200",onClick:S,disabled:a||h,children:h?p.jsxs(p.Fragment,{children:[p.jsx(rp,{className:"h-4 w-4 mr-2 animate-spin"}),"Vérification..."]}):"Récupération ?"}),g&&!1,p.jsx(eS,{isOpen:x,onClose:C,onSelectLab:_,availableLabs:E})]})})},DI=({isOpen:r,onClose:e,photos:t=[],locationName:n,isLoading:o=!1})=>{if(j.useEffect(()=>{if(r){const l=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${l}px`,document.body.style.width="100%",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,l)}}},[r]),!r)return null;const a=t.length>0;return p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[110] flex items-center justify-center p-4",onClick:e,children:p.jsxs(Le.div,{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col shadow-2xl border border-gray-200 dark:border-gray-700",onClick:l=>l.stopPropagation(),initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[p.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-xl flex items-center justify-center",children:p.jsx(cm,{className:"h-6 w-6 text-primary-600 dark:text-primary-400"})}),p.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:n})]}),p.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors",children:p.jsx(_n,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o?p.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[p.jsx("div",{className:"w-16 h-16 bg-primary-100 dark:bg-primary-900/30 rounded-2xl flex items-center justify-center mb-4",children:p.jsx(lm,{className:"h-8 w-8 text-primary-600 dark:text-primary-400 animate-pulse"})}),p.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Chargement des photos..."}),p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:"Récupération des photos du lieu en cours"})]}):a?p.jsx("div",{className:"space-y-6",children:t.map((l,c)=>p.jsxs(Le.div,{className:"space-y-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:c*.1},children:[p.jsxs("div",{className:"relative overflow-hidden rounded-2xl shadow-lg",children:[p.jsx("img",{src:l.url,alt:l.description||`Photo ${c+1}`,className:"w-full h-64 object-cover",loading:"lazy"}),p.jsxs("div",{className:"absolute top-3 right-3 bg-black/50 backdrop-blur-sm text-white px-3 py-1 rounded-full text-sm font-medium",children:[c+1," / ",t.length]})]}),l.description&&p.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:p.jsxs("div",{className:"flex items-start gap-3",children:[p.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:p.jsx("span",{className:"text-white text-xs font-bold",children:c+1})}),p.jsx("p",{className:"text-blue-800 dark:text-blue-200 text-sm leading-relaxed",children:l.description})]})})]},l.id))}):p.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[p.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-2xl flex items-center justify-center mb-4",children:p.jsx(nI,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),p.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Aucune photo disponible"}),p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center max-w-sm",children:"Il n'y a pas encore de photos disponibles pour ce lieu. Les photos aident les livreurs à identifier facilement les lieux de livraison."})]})}),p.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o?"Chargement en cours...":a?`${t.length} photo${t.length>1?"s":""} disponible${t.length>1?"s":""}`:"Aucune photo disponible"}),p.jsx("button",{onClick:e,className:"bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-xl font-medium transition-colors",children:"Fermer"})]})})]})})},LI=({currentStop:r,onCompleteStop:e,onPackageClick:t,onReportIssue:n,isCompleting:o,showLocationPhotos:a,onToggleLocationPhotos:l,isLastStop:c=!1,locationPhotos:d=[],isLoadingPhotos:h=!1,onUnexpectedPickup:m,onSelectLab:g,onTakePhoto:v})=>{const x=()=>r.type==="dentist"?r.packages.every(_=>_.status==="completed"||_.status==="error"):r.packages.length===0||r.packages.every(_=>_.selected),w=()=>{const C=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(r.address)}&travelmode=driving`;window.open(C,"_blank")},S=`overflow-hidden max-w-xl mx-auto ${r.isLateStop?"ring-2 ring-yellow-300 dark:ring-yellow-500 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20":""}`;return p.jsxs(p.Fragment,{children:[p.jsx(gn,{className:S,children:p.jsxs("div",{className:"p-6",children:[r.isLateStop&&p.jsx("div",{className:"mb-4 flex justify-center",children:p.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-yellow-200 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-200 border border-yellow-300 dark:border-yellow-600",children:[p.jsx(tr,{className:"w-3 h-3 mr-1"}),"Arrêt Ajouté"]})}),p.jsx("div",{className:"flex items-center justify-center mb-6",children:p.jsxs("div",{className:"text-center",children:[r.estimatedTime&&p.jsx("div",{className:"mb-3",children:p.jsx("span",{className:"inline-block bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 px-4 py-2 rounded-lg text-sm font-medium border border-slate-200 dark:border-slate-700 shadow-sm",children:r.estimatedTime})}),p.jsx("div",{className:`relative h-20 w-20 rounded-2xl ${Xw(r.type)} flex items-center justify-center cursor-pointer hover:shadow-xl transition-all duration-300 mx-auto border-2 border-white/50 dark:border-slate-600/50 shadow-lg hover:scale-105 hover:border-white/70 dark:hover:border-slate-400/70`,onClick:l,title:"Cliquer pour voir les photos du lieu",children:p.jsx(AI,{type:r.type,size:"md",showBackground:!1,stopName:r.name})})]})}),p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("h1",{className:"text-xl font-semibold dark:text-gray-100 mb-4",children:r.name}),p.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/30 dark:to-teal-900/30 border border-emerald-200 dark:border-emerald-700 rounded-xl p-4 mb-4 shadow-sm",children:p.jsxs("button",{onClick:w,className:"text-emerald-800 dark:text-emerald-200 hover:text-emerald-900 dark:hover:text-emerald-100 transition-colors flex items-center justify-center gap-3 text-sm font-semibold w-full",children:[p.jsx(um,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"}),p.jsx("span",{className:"text-center leading-relaxed",children:r.address})]})}),p.jsx("div",{className:"flex justify-center",children:p.jsx(jI,{stop:r})}),r.instructions&&p.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl text-blue-700 dark:text-blue-400 text-sm text-center",children:[p.jsx("strong",{children:"Instructions :"})," ",r.instructions]})]}),p.jsx("div",{className:"flex justify-center",children:p.jsx("div",{className:"w-full max-w-md",children:p.jsx(RI,{currentStop:r,onPackageClick:t,onReportIssue:n})})}),p.jsxs("div",{className:"mt-6 space-y-3",children:[(()=>{const _=r.type==="dentist"&&!!m&&(r.locationId||r.address);return _&&console.log("✅ [CurrentStopCard] Bouton UnexpectedPickup affiché pour:",{stopName:r.name,locationId:r.locationId}),_})()&&m&&p.jsx(II,{locationId:r.locationId,address:r.locationId?void 0:r.address,onUnexpectedPickup:m,onSelectLab:g,onTakePhoto:v}),p.jsx(Tt,{className:"w-full flex items-center justify-center gap-2",onClick:e,disabled:!x()||o,children:o?"Validation en cours...":c?p.jsxs(p.Fragment,{children:[p.jsx(rI,{className:"h-4 w-4"}),"Terminer la tournée"]}):p.jsxs(p.Fragment,{children:[p.jsx(Du,{className:"h-4 w-4"}),"Valider et continuer"]})})]})]})}),p.jsx(DI,{isOpen:a,onClose:l,photos:d,locationName:r.name,isLoading:h})]})},OI=({isOpen:r,onClose:e,onSelectIssueType:t,packageId:n,packageInfo:o,stopInfo:a})=>{if(!r)return null;const l=()=>{if(!o||!a)return n?`Colis ${n.slice(-8)}`:"Action non définie";const g=(v=>{const x=v.match(/\b[A-Z][A-Z0-9]*(?:\s+[A-Z][A-Z0-9]*)*\b/g);return x?x.join(" "):v.split(" ")[0].toUpperCase()})(a.name);return o.type==="delivery"?`livraison ${g}`:o.type==="pickup"?`récupération ${g}`:"Action non définie"},c=[{type:"missing_package",icon:p.jsx(rn,{className:"h-5 w-5"}),title:"Colis introuvable",description:"Le colis n'est pas présent sur le lieu de livraison",bgGradient:"bg-gradient-to-br from-red-50 via-red-100/80 to-red-200/60 dark:from-red-950/40 dark:via-red-900/30 dark:to-red-800/20",iconBg:"bg-gradient-to-br from-red-500 to-red-600",borderColor:"border-red-300/60 dark:border-red-600/50",textColor:"text-red-800 dark:text-red-300",shadowColor:"shadow-red-200/40 dark:shadow-red-800/30"},{type:"missing_label",icon:p.jsx(fI,{className:"h-5 w-5"}),title:"Étiquette non retournée",description:"L'étiquette de retour n'a pas été récupérée",bgGradient:"bg-gradient-to-br from-orange-50 via-orange-100/80 to-amber-200/60 dark:from-orange-950/40 dark:via-orange-900/30 dark:to-amber-800/20",iconBg:"bg-gradient-to-br from-orange-500 to-amber-600",borderColor:"border-orange-300/60 dark:border-orange-600/50",textColor:"text-orange-800 dark:text-orange-300",shadowColor:"shadow-orange-200/40 dark:shadow-orange-800/30"},{type:"delivery_problem",icon:p.jsx(gI,{className:"h-5 w-5"}),title:"Problème de livraison",description:"Autre problème empêchant la livraison",bgGradient:"bg-gradient-to-br from-purple-50 via-purple-100/80 to-violet-200/60 dark:from-purple-950/40 dark:via-purple-900/30 dark:to-violet-800/20",iconBg:"bg-gradient-to-br from-purple-500 to-violet-600",borderColor:"border-purple-300/60 dark:border-purple-600/50",textColor:"text-purple-800 dark:text-purple-300",shadowColor:"shadow-purple-200/40 dark:shadow-purple-800/30"}],d={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},h={hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:300,damping:20}}};return p.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-lg z-[110] flex items-center justify-center p-4",onClick:e,children:p.jsxs(Le.div,{className:"bg-gradient-to-br from-white via-slate-50/95 to-slate-100/90 dark:from-slate-900/95 dark:via-slate-800/90 dark:to-slate-700/85 backdrop-blur-xl rounded-3xl w-full max-w-md shadow-2xl shadow-slate-900/20 dark:shadow-black/40 border border-slate-200/50 dark:border-slate-600/40 overflow-hidden",onClick:m=>m.stopPropagation(),initial:{scale:.8,opacity:0,y:30},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:30},transition:{type:"spring",duration:.5,bounce:.3},children:[p.jsxs("div",{className:"relative bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 dark:from-slate-900 dark:via-slate-800 dark:to-black p-6 text-white overflow-hidden",children:[p.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-black/10"}),p.jsx("div",{className:"absolute top-4 right-20 w-2 h-2 bg-white/20 rounded-full animate-pulse"}),p.jsx("div",{className:"absolute bottom-6 left-8 w-1 h-1 bg-white/30 rounded-full animate-ping"}),p.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-10 h-10 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center transition-all duration-200 z-20 border border-white/10 hover:border-white/20",children:p.jsx(_n,{className:"h-4 w-4"})}),p.jsxs("div",{className:"relative z-10",children:[p.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[p.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-red-500/80 to-orange-600/80 backdrop-blur-sm rounded-2xl flex items-center justify-center shadow-lg shadow-red-500/20 border border-white/10",children:p.jsx(am,{className:"h-6 w-6"})}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-white to-slate-200 bg-clip-text text-transparent",children:"Signaler un problème"}),p.jsx(Yw,{className:"h-4 w-4 text-orange-400/80"})]}),p.jsx("p",{className:"text-white/70 text-sm font-medium bg-white/10 px-3 py-1 rounded-lg backdrop-blur-sm border border-white/10",children:l()})]})]}),p.jsx("p",{className:"text-white/80 text-sm leading-relaxed",children:"Sélectionnez le type de problème et prenez une photo pour justifier"})]})]}),p.jsx("div",{className:"p-6 space-y-4",children:p.jsx(Le.div,{variants:d,initial:"hidden",animate:"visible",className:"space-y-4",children:c.map((m,g)=>p.jsxs(Le.button,{variants:h,className:`w-full p-5 text-left rounded-2xl transition-all duration-300 border ${m.bgGradient} ${m.borderColor} hover:shadow-lg ${m.shadowColor} group relative overflow-hidden backdrop-blur-sm`,onClick:()=>t(m.type),whileTap:{scale:.98},children:[p.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-out"}),p.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[p.jsx("div",{className:`w-12 h-12 rounded-xl ${m.iconBg} text-white flex items-center justify-center shadow-lg ring-2 ring-white/20 dark:ring-slate-600/30`,children:m.icon}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h3",{className:`font-bold text-lg mb-1 ${m.textColor} group-hover:scale-105 transition-all duration-200`,children:m.title}),p.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-sm leading-relaxed",children:m.description})]}),p.jsxs("div",{className:"flex items-center gap-2 text-slate-400 dark:text-slate-500",children:[p.jsx("div",{className:"p-2 bg-white/50 dark:bg-slate-800/50 rounded-lg backdrop-blur-sm border border-slate-200/50 dark:border-slate-600/30",children:p.jsx(lm,{className:"h-4 w-4"})}),p.jsx(Le.div,{className:"w-2 h-2 bg-current rounded-full",animate:{scale:[1,1.3,1],opacity:[.5,1,.5]},transition:{repeat:1/0,duration:2,ease:"easeInOut"}})]})]})]},m.type))})}),p.jsx("div",{className:"p-6 bg-gradient-to-br from-slate-50/80 via-slate-100/60 to-slate-200/40 dark:from-slate-800/60 dark:via-slate-700/40 dark:to-slate-600/30 backdrop-blur-sm border-t border-slate-200/60 dark:border-slate-600/40",children:p.jsx(Le.button,{onClick:e,className:"w-full py-3.5 px-4 text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 bg-white/60 dark:bg-slate-800/60 hover:bg-white/80 dark:hover:bg-slate-700/80 rounded-xl transition-all duration-200 font-semibold backdrop-blur-sm border border-slate-200/50 dark:border-slate-600/40 hover:border-slate-300/60 dark:hover:border-slate-500/50 shadow-sm hover:shadow-md",whileTap:{scale:.98},children:"Annuler"})})]})})};class MI{migrationKey="photo_migration_completed";migrationInProgress=!1;isMigrationCompleted(){return localStorage.getItem(this.migrationKey)==="true"}markMigrationCompleted(){localStorage.setItem(this.migrationKey,"true"),console.log("✅ [AutoMigration] Migration marquée comme terminée")}async runAutoMigrationIfNeeded(){if(this.isMigrationCompleted())return console.log("ℹ️ [AutoMigration] Migration déjà effectuée, ignorer"),{needed:!1,completed:!0};if(this.migrationInProgress)return console.log("⚠️ [AutoMigration] Migration déjà en cours"),{needed:!0,completed:!1};try{this.migrationInProgress=!0,console.log("🔄 [AutoMigration] Début de la migration automatique..."),await Wn.init();const t=et.getState().assets.photos;if(t.size===0)return console.log("ℹ️ [AutoMigration] Aucune photo legacy à migrer"),this.markMigrationCompleted(),{needed:!1,completed:!0};console.log(`🔄 [AutoMigration] Migration de ${t.size} photos...`);const n=await Wn.migrateLegacyPhotos(t);return this.markMigrationCompleted(),console.log("✅ [AutoMigration] Migration automatique terminée:",n),{needed:!0,completed:!0,stats:n}}catch(e){return console.error("❌ [AutoMigration] Erreur lors de la migration automatique:",e),{needed:!0,completed:!1,error:e instanceof Error?e.message:"Erreur inconnue"}}finally{this.migrationInProgress=!1}}async forceMigration(){return localStorage.removeItem(this.migrationKey),this.runAutoMigrationIfNeeded()}async runBackgroundMigration(){try{const e=await this.runAutoMigrationIfNeeded();!e.completed&&e.error&&(console.log("⏰ [AutoMigration] Retry prévu dans 30s..."),setTimeout(async()=>{try{await this.runAutoMigrationIfNeeded()}catch(t){console.error("❌ [AutoMigration] Erreur lors du retry:",t)}},3e4))}catch(e){console.error("❌ [AutoMigration] Erreur migration background:",e)}}async estimateMigrationBenefit(){try{const t=et.getState().analyzeStoredPhotos(),n=t.totalSizeEstimate*.4;return{legacyPhotos:t.total,estimatedSavingsMB:Math.round(n*100)/100,migrationRecommended:t.total>5||t.totalSizeEstimate>20}}catch(e){return console.error("❌ [AutoMigration] Erreur estimation:",e),{legacyPhotos:0,estimatedSavingsMB:0,migrationRecommended:!1}}}}const $I=new MI,UI=()=>{const[r,e]=j.useState(!1),[t,n]=j.useState(null),[o,a]=j.useState(!1),l=et();j.useEffect(()=>{(async()=>{try{await Wn.init(),e(!0),console.log("✅ [useOptimizedPhotos] Service initialisé"),$I.runBackgroundMigration().catch(w=>{console.warn("⚠️ [useOptimizedPhotos] Migration automatique échouée (non bloquant):",w)})}catch(w){console.error("❌ [useOptimizedPhotos] Erreur initialisation:",w)}})()},[]);const c=j.useCallback(async(x,w)=>{if(!r||!w){console.warn("⚠️ [useOptimizedPhotos] Service non initialisé ou packageId manquant");return}try{console.log("📸 [useOptimizedPhotos] Capture photo optimisée:",{packageId:w.slice(-8),blobSize:`${Math.round(x.size/1024)}KB`,timestamp:Date.now()});const S=await Wn.storeNewPhoto(w,x,!1),_={id:S.id,shipmentId:w,localPath:`blob-ref:${S.id}`,uploadUrl:S.uploadUrl,uploaded:S.uploaded,uploadRetries:S.uploadRetries,timestamp:S.timestamp};l.addPhoto(w,_),console.log("✅ [useOptimizedPhotos] Photo ajoutée avec référence optimisée"),localStorage.setItem(`photo_optimized_${S.id}`,"true"),await m()}catch(S){throw console.error("❌ [useOptimizedPhotos] Erreur capture photo:",S),S}},[r,l]),d=j.useCallback(async x=>{if(!r)return null;try{return await Wn.getPhotoForDisplay(x)}catch(w){return console.error("❌ [useOptimizedPhotos] Erreur récupération photo:",w),null}},[r]),h=j.useCallback(async x=>{if(!r)return null;try{return await Wn.getPhotoBlob(x)}catch(w){return console.error("❌ [useOptimizedPhotos] Erreur récupération blob:",w),null}},[r]),m=j.useCallback(async()=>{if(r)try{const x=await Br.getStorageStats();n({totalPhotos:x.totalPhotos,uploadedPhotos:x.uploadedPhotos,pendingPhotos:x.pendingPhotos,estimatedSizeMB:x.estimatedSizeMB})}catch(x){console.error("❌ [useOptimizedPhotos] Erreur stats:",x)}},[r]),g=j.useCallback(async()=>{if(!(!r||o)){a(!0);try{console.log("🔄 [useOptimizedPhotos] Début migration photos existantes...");const x=l.assets.photos;if(x.size===0){console.log("ℹ️ [useOptimizedPhotos] Aucune photo à migrer"),a(!1);return}const w=await Wn.migrateLegacyPhotos(x);await m(),n(S=>S?{...S,migrationStats:w}:null),console.log("✅ [useOptimizedPhotos] Migration terminée:",w)}catch(x){console.error("❌ [useOptimizedPhotos] Erreur migration:",x)}finally{a(!1)}}},[r,o,l,m]),v=j.useCallback(async()=>{if(r)try{const x=await Br.cleanupUploadedPhotos();return console.log("🧹 [useOptimizedPhotos] Nettoyage effectué:",x),await m(),x}catch(x){throw console.error("❌ [useOptimizedPhotos] Erreur nettoyage:",x),x}},[r,m]);return j.useEffect(()=>{r&&m()},[r,m]),{isInitialized:r,isLoading:o,stats:t,handlePhotoCapture:c,getPhotoForDisplay:d,getPhotoBlob:h,migrateLegacyPhotos:g,cleanup:v,refreshStats:m}},FI=[{id:"lab1",name:"Laboratoire Central"},{id:"lab2",name:"Laboratoire Provence"},{id:"lab3",name:"Laboratoire Méditerranée"},{id:"lab4",name:"Prothèse Plus"},{id:"lab5",name:"Dental Lab Premium"},{id:"lab6",name:"Laboratoire Sud"}];function zI(){const r=Vs(),e=oR(),t=Zu(),{startRoute:n}=tm(),o=UI();j.useEffect(()=>{console.log("🔄 Route Page - Source de données:",{hasActiveRoute:e.hasActiveRoute,currentStopFromStore:!!e.currentStop,isInitialized:e.isInitialized,routeStatus:t.status})},[e.hasActiveRoute,e.currentStop,e.isInitialized,t.status]),j.useEffect(()=>{console.log("🔍 Debug RoutePage - État des hooks:",{routeHook:!!e,routeStatus:!!t,startRoute:!!n,hasError:!e||!t||!n})},[e,t,n]),j.useEffect(()=>{const w=S=>{S.key==="Escape"&&(e.setShowLocationPhotos(!1),e.setShowIssueModal(!1),e.setShowLabModal(!1),e.setShowCameraModal(!1))};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[e]);const a=async()=>{if(!t.canStartRoute)return;await n()&&console.log("✅ Tournée démarrée, affichage des données en cours")},l=w=>{e.handlePackageClick(w)},c=(w,S)=>{e.handleReportIssue(w,S)},d=w=>{e.handleSelectIssueType(w)},h=async(w,S)=>{if(console.log("📸 [RoutePage] ========== PHOTO CAPTURÉE =========="),console.log("📸 [RoutePage] Type:",w instanceof Blob?"Blob":"base64"),!S){console.error("❌ [RoutePage] PackageId manquant");return}try{let _,C;w instanceof Blob?(console.log("💾 [RoutePage] Photo Blob reçue - Stockage dans IndexedDB..."),C=w,o.isInitialized?(await o.handlePhotoCapture(C,S),console.log("✅ [RoutePage] Photo stockée dans IndexedDB"),console.log("🔄 [RoutePage] Conversion Blob → base64 pour Edge Function..."),_=await new Promise((E,N)=>{const M=new FileReader;M.onload=()=>E(M.result),M.onerror=N,M.readAsDataURL(C)})):(console.warn("⚠️ [RoutePage] IndexedDB non initialisé, conversion directe"),_=await new Promise((E,N)=>{const M=new FileReader;M.onload=()=>E(M.result),M.onerror=N,M.readAsDataURL(C)}))):(console.log("📝 [RoutePage] base64 reçu directement"),_=w),console.log("🚀 [RoutePage] Appel Edge Function:",{packageId:S.slice(-8),base64Size:`${Math.round(_.length/1024)}KB`}),await e.handlePhotoTaken(_,S),console.log("✅ [RoutePage] ========== PHOTO TRAITÉE AVEC SUCCÈS ==========")}catch(_){throw console.error("❌ [RoutePage] ========== ERREUR TRAITEMENT PHOTO =========="),console.error("❌ [RoutePage] Erreur:",_),_}},m=()=>{e.handleUnexpectedPickup()},g=(w,S)=>{e.handleSelectLab(w,S)},v=async(w,S)=>{await e.handleTakeUnexpectedPickupPhoto(w,S)},x=async()=>{await e.handleCompleteStop()};return!e||!t?p.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:p.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 max-w-md",children:[p.jsx("h2",{className:"text-yellow-800 font-bold mb-2",children:"Problème de chargement"}),p.jsx("p",{className:"text-yellow-600 mb-4",children:"Les hooks de données ne se chargent pas correctement."}),p.jsxs("p",{className:"text-sm text-yellow-500 mb-4",children:["routeHook: ",e?"✅":"❌"," | routeStatus: ",t?"✅":"❌"]}),p.jsx("button",{onClick:()=>r("/"),className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700",children:"Retour au tableau de bord"})]})}):e.isInitialized&&t.status==="no_route"?p.jsx("div",{className:"flex items-center justify-center pb-32",style:{minHeight:"calc(100vh - 64px)"},children:p.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 max-w-md mx-4 text-center",children:[p.jsx(Pr,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),p.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Aucune tournée disponible"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Aucune tournée n'a été assignée pour aujourd'hui"}),p.jsx("button",{onClick:()=>r("/"),className:"w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Retour au tableau de bord"})]})}):t.status==="validated"?p.jsx("div",{className:"flex items-center justify-center pb-32",style:{minHeight:"calc(100vh - 64px)"},children:p.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 max-w-md mx-4 text-center",children:[p.jsx(wl,{className:"h-16 w-16 text-primary-600 mx-auto mb-4"}),p.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Tournée prête à démarrer"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Votre tournée est prête. Cliquez sur le bouton ci-dessous pour commencer."}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("button",{onClick:a,disabled:!t.canStartRoute,className:"w-full bg-primary-600 hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2",children:[p.jsx(wl,{className:"h-5 w-5"}),t.buttonText]}),p.jsx("button",{onClick:()=>r("/"),className:"w-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-semibold py-3 px-6 rounded-lg transition-colors",children:"Retour au tableau de bord"})]}),!1]})}):t.status==="in_progress"&&!e.currentStop?p.jsx("div",{className:"flex items-center justify-center pb-32",style:{minHeight:"calc(100vh - 64px)"},children:p.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 max-w-md mx-4 text-center",children:[p.jsx(Pr,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),p.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Aucun arrêt disponible"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Aucun arrêt n'a été trouvé pour cette tournée"}),p.jsx("button",{onClick:()=>r("/"),className:"w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Retour au tableau de bord"})]})}):t.status==="completed"?p.jsx("div",{className:"flex items-center justify-center pb-32",style:{minHeight:"calc(100vh - 64px)"},children:p.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8 max-w-md mx-4 text-center",children:[p.jsx("div",{className:"h-16 w-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(Ls,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),p.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Tournée terminée"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Votre tournée a été complétée avec succès. Félicitations !"}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("button",{onClick:()=>r("/driver/resume"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2",children:[p.jsx(Ls,{className:"h-5 w-5"}),"Voir le résumé"]}),p.jsx("button",{onClick:()=>r("/"),className:"w-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-semibold py-3 px-6 rounded-lg transition-colors",children:"Retour au tableau de bord"})]})]})}):e.currentStop?p.jsxs("div",{className:"min-h-full bg-gray-50 dark:bg-gray-900 pb-28",children:[p.jsxs("div",{className:"px-4 py-4 space-y-6",children:[!1,p.jsx(CI,{currentStopIndex:e.currentStopIndex,totalStops:e.totalStops}),p.jsx(LI,{currentStop:e.currentStop,onCompleteStop:x,onPackageClick:l,onReportIssue:c,isCompleting:e.isCompleting,showLocationPhotos:e.showLocationPhotos,onToggleLocationPhotos:()=>e.setShowLocationPhotos(!e.showLocationPhotos),isLastStop:e.isLastStop,locationPhotos:e.currentStopPhotos,isLoadingPhotos:e.isLoadingPhotos,onUnexpectedPickup:m,onSelectLab:g,onTakePhoto:v}),p.jsx(NI,{nextStops:e.nextStops}),p.jsx(OI,{isOpen:e.showIssueModal,onClose:()=>{e.setShowIssueModal(!1)},onSelectIssueType:d,packageId:e.selectedPackageForIssue||void 0,packageInfo:e.selectedPackageForIssue&&e.currentStop?e.currentStop.packages.find(w=>w.id===e.selectedPackageForIssue):void 0,stopInfo:e.currentStop||void 0}),p.jsx(eS,{isOpen:e.showLabModal,onClose:()=>{e.setShowLabModal(!1)},onSelectLab:g,availableLabs:FI})]}),e.showCameraModal&&p.jsx(kI,{onCapture:h,onClose:e.handleCameraClose,packageId:e.selectedPackageForPhoto})]}):p.jsx("div",{className:"min-h-screen pb-28",style:{minHeight:"calc(100vh - 64px)"},children:p.jsx("div",{className:"px-4 py-4 space-y-6",children:p.jsxs("div",{className:"text-center py-12",children:[p.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Aucun arrêt disponible"}),p.jsx(Tt,{onClick:()=>r("/"),children:"Retour au tableau de bord"})]})})})}const VI=Me.memo(({stop:r,onPhotoClick:e,getStopIcon:t,getStopBackgroundColor:n,getStopBorderAndShadowStyle:o,getStatusColor:a,getStatusIcon:l,getShipmentIcon:c,getDepotShipmentStyle:d,getShipmentActionStyle:h,formatShipmentLabel:m,sortShipments:g,isDepotDestination:v})=>p.jsx(gn,{className:`overflow-hidden ${n(r.type)} ${o(r)} ${r.isLateStop?"ring-4 ring-yellow-400/70 dark:ring-yellow-500/50 bg-gradient-to-r from-yellow-50 via-orange-50 to-yellow-100 dark:from-yellow-950/40 dark:via-orange-950/30 dark:to-yellow-900/40 border-yellow-400 dark:border-yellow-500":""} transition-all duration-300 backdrop-blur-sm`,children:p.jsxs("div",{className:"p-5",children:[r.isLateStop&&p.jsx("div",{className:"mb-4 flex justify-center",children:p.jsxs("div",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg border-2 border-white/30",children:[p.jsx(tr,{className:"w-3 h-3 mr-1.5"}),"Arrêt Ajouté"]})}),p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:`p-1 rounded-2xl ${a(r.status)} shadow-lg ring-2 ring-white/60 dark:ring-gray-700/60`,children:t(r.type,r.name)}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-slate-100",children:r.name}),p.jsxs("div",{className:`flex items-center px-3 py-1.5 rounded-xl shadow-md ${r.actualTime?"text-emerald-800 dark:text-emerald-200 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/40 dark:to-emerald-800/30 border border-emerald-300/50 dark:border-emerald-600/50":"text-slate-700 dark:text-slate-300 bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700/60 dark:to-slate-600/60 border border-slate-300/50 dark:border-slate-600/50"}`,children:[p.jsx(tr,{className:"h-3.5 w-3.5 mr-1.5"}),p.jsx("span",{className:"text-xs font-semibold",children:r.actualTime&&r.estimatedTime?`${r.actualTime} (prévu: ${r.estimatedTime})`:r.actualTime||r.estimatedTime||"N/A"})]})]}),p.jsx("div",{className:"mt-4 space-y-3",children:g(r).map(x=>p.jsx("div",{className:`p-4 rounded-xl ${d(x,x.status)} transition-all duration-200 backdrop-blur-sm`,children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"p-2.5 bg-white/90 dark:bg-gray-600/90 rounded-xl shadow-md backdrop-blur-sm",children:c(x.displayIcon)}),p.jsx("div",{className:"flex-1",children:p.jsx("div",{className:`${h(x.displayIcon)}`,children:m(x.displayLabel)})})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[r.type==="client"&&x.hasPhoto&&x.photoUrl&&p.jsx("button",{onClick:()=>e(x.photoUrl),className:"p-2 rounded-xl transition-all duration-200 bg-white/80 dark:bg-gray-600/80 shadow-md backdrop-blur-sm",children:p.jsx(lm,{className:"h-4 w-4 text-slate-700 dark:text-slate-300"})}),v(x)&&p.jsx("div",{className:"p-2 bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-900/40 dark:to-orange-800/30 rounded-xl shadow-md backdrop-blur-sm",children:p.jsx(Lu,{className:"h-4 w-4 text-orange-700 dark:text-orange-400"})}),p.jsx("div",{className:"p-1.5 bg-white/80 dark:bg-gray-600/80 rounded-lg shadow-md backdrop-blur-sm",children:l(x.status)})]})]})},x.id))})]})]})]})})),BI=Me.memo(({stop:r,getStopIcon:e,getShipmentIcon:t,getShipmentActionStyle:n,formatShipmentLabel:o,sortShipments:a,isDepotDestination:l})=>p.jsx(gn,{className:`overflow-hidden bg-gradient-to-br from-slate-50/80 via-white/90 to-slate-100/70 dark:from-slate-800/60 dark:via-slate-700/50 dark:to-slate-800/70 border border-slate-300/60 dark:border-slate-600/50 shadow-md shadow-slate-200/40 dark:shadow-slate-800/50 ${r.isLateStop?"ring-4 ring-yellow-400/70 dark:ring-yellow-500/50 bg-gradient-to-r from-yellow-50 via-orange-50 to-yellow-100 dark:from-yellow-950/40 dark:via-orange-950/30 dark:to-yellow-900/40 border-yellow-400 dark:border-yellow-500":""} transition-all duration-300 backdrop-blur-sm`,children:p.jsxs("div",{className:"p-5",children:[r.isLateStop&&p.jsx("div",{className:"mb-4 flex justify-center",children:p.jsxs("div",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-bold bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg border-2 border-white/30",children:[p.jsx(tr,{className:"w-3 h-3 mr-1.5"}),"Arrêt Ajouté"]})}),p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:"p-1 rounded-2xl bg-gradient-to-br from-amber-100 to-yellow-200 dark:from-amber-900/40 dark:to-yellow-800/30 shadow-lg ring-2 ring-white/60 dark:ring-gray-700/60 border border-amber-200/50 dark:border-amber-700/50",children:e(r.type,r.name)}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-slate-100",children:r.name}),p.jsxs("div",{className:`flex items-center px-3 py-1.5 rounded-xl shadow-md ${r.actualTime?"text-emerald-800 dark:text-emerald-200 bg-gradient-to-r from-emerald-100 to-emerald-200 dark:from-emerald-900/40 dark:to-emerald-800/30 border border-emerald-300/50 dark:border-emerald-600/50":"text-slate-700 dark:text-slate-300 bg-gradient-to-r from-slate-100 to-slate-200 dark:from-slate-700/60 dark:to-slate-600/60 border border-slate-300/50 dark:border-slate-600/50"}`,children:[p.jsx(tr,{className:"h-3.5 w-3.5 mr-1.5"}),p.jsx("span",{className:"text-xs font-semibold",children:r.actualTime&&r.estimatedTime?`${r.actualTime} (prévu: ${r.estimatedTime})`:r.actualTime||r.estimatedTime||"N/A"})]})]}),p.jsx("div",{className:"mt-4 space-y-3",children:a(r).map(c=>p.jsx("div",{className:`p-4 rounded-xl ${l(c)?"bg-gradient-to-br from-orange-50/80 to-orange-100/60 dark:from-orange-950/25 dark:to-orange-900/20 border border-orange-400/70 dark:border-orange-500/60 border-l-4 border-l-orange-500 dark:border-l-orange-400 shadow-lg shadow-orange-200/40 dark:shadow-orange-900/30":"bg-gradient-to-br from-slate-50/80 to-slate-100/60 dark:from-slate-700/50 dark:to-slate-600/40 border border-slate-300/60 dark:border-slate-500/50 shadow-md shadow-slate-200/40 dark:shadow-slate-800/50"} transition-all duration-200 backdrop-blur-sm`,children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"p-2.5 bg-white/90 dark:bg-gray-600/90 rounded-xl shadow-md backdrop-blur-sm",children:t(c.displayIcon)}),p.jsx("div",{className:"flex-1",children:p.jsx("div",{className:`${n(c.displayIcon)}`,children:o(c.displayLabel)})})]}),p.jsx("div",{className:"flex items-center gap-2",children:l(c)&&p.jsx("div",{className:"p-2 bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-900/50 dark:to-orange-800/40 rounded-xl shadow-md backdrop-blur-sm",children:p.jsx(Lu,{className:"h-4 w-4 text-orange-700 dark:text-orange-400"})})})]})},c.id))})]})]})]})})),qI=()=>{const r=Vs(),{stats:e,completedStops:t,pendingStops:n,isActiveRoute:o}=iR(),a=Zu(),{startRoute:l}=tm(),[c,d]=Me.useState(!1),[h,m]=Me.useState(!1),[g,v]=Me.useState(""),[x,w]=Me.useState(""),S=et(),{rawStops:_,rawShipments:C}=S.route,{locations:E}=S.referenceData,N=Me.useCallback(async()=>{if(!a.canStartRoute)return;await l()&&console.log("✅ Tournée démarrée, affichage du résumé en cours")},[a.canStartRoute,l]),M=Me.useCallback(X=>{v(X),m(!0)},[]),A=Me.useCallback(X=>X.split(" ").filter(oe=>oe.length>0).slice(0,2).map(oe=>oe[0].toUpperCase()).join(""),[]),K=Me.useCallback((X,oe)=>{const L=A(oe);switch(X){case"laboratory":return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:L});case"client":return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:L});case"depot":return p.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center text-white font-bold text-sm shadow-lg",children:L})}},[A]),Z=Me.useCallback(X=>{switch(X){case"completed":return"bg-gradient-to-br from-emerald-50 to-green-100 dark:from-emerald-900/20 dark:to-green-900/30 text-emerald-800 dark:text-emerald-300 border border-emerald-400/70 dark:border-emerald-500/60";case"error":return"bg-gradient-to-br from-red-50 to-rose-100 dark:from-red-900/20 dark:to-rose-900/30 text-red-800 dark:text-red-300 border border-red-400/70 dark:border-red-500/60";default:return"bg-gradient-to-br from-slate-50 to-gray-100 dark:from-slate-800/50 dark:to-gray-800/50 text-slate-700 dark:text-slate-300 border border-slate-300/60 dark:border-slate-500/50"}},[]),W=Me.useCallback(X=>{switch(X){case"completed":return p.jsx(Ls,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"});case"error":return p.jsx(Pr,{className:"h-5 w-5 text-red-600 dark:text-red-400"});default:return p.jsx(tr,{className:"h-5 w-5 text-slate-500 dark:text-slate-400"})}},[]),de=Me.useCallback(X=>{switch(X){case"delivery":return p.jsx(rn,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"});case"pickup":return p.jsx(Ni,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400"});case"return":return p.jsx(Ni,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}},[]),pe=Me.useCallback(X=>{const oe=X.shipment,L=_.find(De=>De.id===oe.delivery_stop_id);if(!L)return!1;const Q=E.get(L.location_id);return Q?Q.type==="depot":!1},[_,E]),Ee=Me.useCallback(X=>X.hasFailedShipments?"border-2 border-red-300 dark:border-red-600 shadow-lg shadow-red-200/50 dark:shadow-red-900/30 ring-2 ring-red-100 dark:ring-red-900/20":X.allShipmentsCompleted?"border-2 border-emerald-400 dark:border-emerald-500 shadow-lg shadow-emerald-200/60 dark:shadow-emerald-900/40 ring-2 ring-emerald-100 dark:ring-emerald-900/30":"border border-slate-300/60 dark:border-slate-600/50 shadow-md shadow-slate-200/40 dark:shadow-slate-800/50",[]),ee=Me.useCallback(X=>{switch(X){case"laboratory":return"bg-gradient-to-br from-blue-50/90 via-indigo-50/80 to-blue-100/70 dark:from-blue-950/30 dark:via-indigo-950/20 dark:to-blue-900/25";case"client":return"bg-gradient-to-br from-emerald-50/90 via-green-50/80 to-emerald-100/70 dark:from-emerald-950/30 dark:via-green-950/20 dark:to-emerald-900/25";case"depot":return"bg-gradient-to-br from-orange-50/90 via-amber-50/80 to-orange-100/70 dark:from-orange-950/30 dark:via-amber-950/20 dark:to-orange-900/25";default:return"bg-gradient-to-br from-white/95 via-slate-50/90 to-white/95 dark:from-slate-800/80 dark:via-slate-850/70 dark:to-slate-800/80"}},[]),ye=Me.useCallback((X,oe)=>pe(X)?`${Z(oe)} border-l-4 border-l-orange-500 dark:border-l-orange-400 shadow-lg shadow-orange-200/40 dark:shadow-orange-900/30 ring-1 ring-orange-300/30 dark:ring-orange-600/20`:`${Z(oe)} shadow-md`,[pe,Z]),G=Me.useCallback(X=>{switch(X){case"delivery":return"text-blue-700 dark:text-blue-300 font-medium px-2 py-1 rounded-md";case"pickup":return"text-emerald-700 dark:text-emerald-300 font-medium px-2 py-1 rounded-md";case"return":return"text-amber-700 dark:text-amber-300 font-medium px-2 py-1 rounded-md"}},[]),Se=Me.useCallback(X=>{const oe={prothèse:"🦷",protheses:"🦷",bridge:"🌉",couronne:"👑",gouttière:"🛡️",gouttieres:"🛡️",implant:"⚙️",implants:"⚙️",empreinte:"👁️",empreintes:"👁️",modèle:"🏛️",modeles:"🏛️",plaque:"📋",plaques:"📋",appareil:"🔧",appareils:"🔧"},L=X.toLowerCase().split(" "),Q=Object.entries(oe).find(([De])=>L.some(He=>He.includes(De)));return Q?p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx("span",{children:Q[1]}),p.jsx("span",{children:X})]}):p.jsx("span",{children:X})},[]),Ce=Me.useCallback(X=>[...X.shipments].sort((L,Q)=>{if(L.status==="error"&&Q.status!=="error")return-1;if(Q.status==="error"&&L.status!=="error")return 1;if(L.status==="completed"&&Q.status==="pending")return-1;if(Q.status==="completed"&&L.status==="pending")return 1;const De=L.displayIcon==="delivery"?"A":"B",He=Q.displayIcon==="delivery"?"A":"B";return De!==He?De.localeCompare(He):L.displayLabel.localeCompare(Q.displayLabel)}),[]),_e=Me.useMemo(()=>({hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}}),[]),te=Me.useMemo(()=>({hidden:{y:10,opacity:0},show:{y:0,opacity:1,transition:{duration:.2}}}),[]);return a.status==="no_route"?p.jsx("div",{className:"flex items-center justify-center pb-32",style:{minHeight:"calc(100vh - 64px)"},children:p.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-white via-gray-50 to-gray-100 dark:from-gray-800 dark:via-gray-850 dark:to-gray-900 rounded-2xl shadow-xl border border-gray-200/50 dark:border-gray-700/50 p-8 max-w-md mx-4 text-center backdrop-blur-sm",children:[p.jsx("div",{className:"bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full p-4 w-20 h-20 mx-auto mb-6 shadow-lg",children:p.jsx(Pr,{className:"h-12 w-12 text-gray-500 dark:text-gray-400"})}),p.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 dark:from-gray-100 dark:to-gray-300 bg-clip-text text-transparent mb-3",children:"Aucune tournée disponible"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 leading-relaxed",children:"Aucune tournée n'a été assignée pour aujourd'hui"}),p.jsx("button",{onClick:()=>r("/"),className:"w-full bg-gradient-to-r from-primary-600 to-primary-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg",children:"Retour au tableau de bord"})]})}):a.status==="validated"?p.jsx("div",{className:"flex items-center justify-center pb-32",style:{minHeight:"calc(100vh - 64px)"},children:p.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-white via-blue-50 to-indigo-100 dark:from-gray-800 dark:via-blue-950 dark:to-indigo-950 rounded-2xl shadow-xl border border-blue-200/50 dark:border-blue-800/50 p-8 max-w-md mx-4 text-center backdrop-blur-sm",children:[p.jsx("div",{className:"bg-gradient-to-br from-primary-500 to-primary-600 rounded-full p-4 w-20 h-20 mx-auto mb-6 shadow-lg",children:p.jsx(wl,{className:"h-12 w-12 text-white"})}),p.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-primary-700 to-primary-500 dark:from-primary-400 dark:to-primary-300 bg-clip-text text-transparent mb-3",children:"Tournée prête à démarrer"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 leading-relaxed",children:"Votre tournée est prête. Cliquez sur le bouton ci-dessous pour commencer."}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("button",{onClick:N,disabled:!a.canStartRoute,className:"w-full bg-gradient-to-r from-primary-600 to-primary-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 shadow-lg disabled:shadow-md flex items-center justify-center gap-2",children:[p.jsx(wl,{className:"h-5 w-5"}),a.buttonText]}),p.jsx("button",{onClick:()=>r("/"),className:"w-full bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-semibold py-3 px-6 rounded-xl transition-all duration-200 shadow-md backdrop-blur-sm",children:"Retour au tableau de bord"})]})]})}):p.jsxs("div",{className:"min-h-full bg-gradient-to-br from-slate-50 via-white to-blue-50/30 dark:from-slate-900 dark:via-gray-900 dark:to-blue-950/30 pb-32",children:[p.jsxs("div",{className:"bg-gradient-to-br from-white via-blue-50/50 to-indigo-100/30 dark:from-gray-800 dark:via-blue-950/30 dark:to-indigo-950/20 px-4 py-8 border-b border-slate-200/60 dark:border-slate-700/60 shadow-lg backdrop-blur-sm",children:[p.jsx("div",{className:"flex items-center justify-center mb-6",children:p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"h-20 w-20 bg-gradient-to-br from-emerald-400 via-emerald-500 to-emerald-600 rounded-3xl flex items-center justify-center shadow-2xl shadow-emerald-200/40 dark:shadow-emerald-900/30 ring-4 ring-white/50 dark:ring-gray-800/50",children:p.jsx(Ls,{className:"h-10 w-10 text-white"})}),p.jsx("div",{className:"absolute -top-1 -right-1 h-6 w-6 bg-gradient-to-br from-yellow-400 to-yellow-500 rounded-full flex items-center justify-center shadow-lg",children:p.jsx(Yw,{className:"h-3 w-3 text-white"})})]})}),p.jsx("h1",{className:"text-2xl font-bold text-center bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 dark:from-slate-100 dark:via-white dark:to-slate-100 bg-clip-text text-transparent mb-6",children:"Résumé de la tournée"}),p.jsxs("div",{className:"flex items-center justify-center gap-4 mt-6",children:[p.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-white to-emerald-50/50 dark:from-gray-700/80 dark:to-emerald-950/30 rounded-2xl shadow-xl backdrop-blur-sm transition-all duration-300 border border-emerald-200/60 dark:border-emerald-700/30",children:[p.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-emerald-500 dark:from-emerald-400 dark:to-emerald-300 bg-clip-text text-transparent",children:e.completed}),p.jsx("div",{className:"text-xs font-semibold text-emerald-700 dark:text-emerald-400 mt-1",children:"Complétés"})]}),p.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-white to-red-50/50 dark:from-gray-700/80 dark:to-red-950/30 rounded-2xl shadow-xl backdrop-blur-sm transition-all duration-300 border border-red-200/60 dark:border-red-700/30",children:[p.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-red-600 to-red-500 dark:from-red-400 dark:to-red-300 bg-clip-text text-transparent",children:e.errors}),p.jsx("div",{className:"text-xs font-semibold text-red-700 dark:text-red-400 mt-1",children:"Problèmes"})]}),p.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-white to-slate-50/50 dark:from-gray-700/80 dark:to-slate-800/30 rounded-2xl shadow-xl backdrop-blur-sm transition-all duration-300 border border-slate-200/60 dark:border-slate-600/30",children:[p.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-slate-600 to-slate-500 dark:from-slate-400 dark:to-slate-300 bg-clip-text text-transparent",children:e.pending}),p.jsx("div",{className:"text-xs font-semibold text-slate-700 dark:text-slate-400 mt-1",children:"En attente"})]})]})]}),p.jsx("div",{className:"p-4",children:p.jsxs(Le.div,{variants:_e,initial:"hidden",animate:"show",className:"space-y-6",children:[t.length>0&&p.jsxs("div",{children:[p.jsxs("h2",{className:"text-lg font-bold mb-4 text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[p.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-emerald-500 to-emerald-600 rounded-full"}),"Arrêts traités (",t.length,")"]}),p.jsx("div",{className:"space-y-4",children:t.map(X=>p.jsx(Le.div,{variants:te,children:p.jsx(VI,{stop:X,onPhotoClick:M,getStopIcon:K,getStopBackgroundColor:ee,getStopBorderAndShadowStyle:Ee,getStatusColor:Z,getStatusIcon:W,getShipmentIcon:de,getDepotShipmentStyle:ye,getShipmentActionStyle:G,formatShipmentLabel:Se,sortShipments:Ce,isDepotDestination:pe})},X.id))})]}),n.length>0&&p.jsxs("div",{children:[p.jsxs("h2",{className:"text-lg font-bold mb-4 text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[p.jsx("div",{className:"w-1 h-6 bg-gradient-to-b from-amber-500 to-amber-600 rounded-full"}),"Arrêts en attente (",n.length,")"]}),p.jsx("div",{className:"space-y-4",children:n.map(X=>p.jsx(Le.div,{variants:te,children:p.jsx(BI,{stop:X,getStopIcon:K,getShipmentIcon:de,getShipmentActionStyle:G,formatShipmentLabel:Se,sortShipments:Ce,isDepotDestination:pe})},X.id))})]}),p.jsxs(Tt,{variant:"outline",className:"w-full flex items-center justify-center gap-3 mt-8 p-4 text-slate-700 dark:text-slate-300 transition-all duration-300 rounded-2xl shadow-lg bg-gradient-to-r from-white/90 to-slate-50/80 dark:from-slate-800/90 dark:to-slate-700/80 font-bold text-base backdrop-blur-sm",onClick:()=>d(!0),children:[p.jsx("div",{className:"p-2 bg-gradient-to-br from-primary-100 to-primary-200 dark:from-primary-900/40 dark:to-primary-800/30 rounded-xl shadow-md",children:p.jsx(ix,{className:"h-5 w-5 text-primary-600 dark:text-primary-400"})}),"Laisser un commentaire"]})]})}),c&&p.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md z-[100] flex items-center justify-center p-4",onClick:()=>d(!1),children:p.jsxs(Le.div,{className:"bg-gradient-to-br from-white via-slate-50 to-white dark:from-gray-800 dark:via-gray-850 dark:to-gray-800 rounded-3xl w-full max-w-lg shadow-2xl backdrop-blur-sm",onClick:X=>X.stopPropagation(),initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[p.jsxs("div",{className:"p-6 border-b border-slate-200/60 dark:border-slate-700/60",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"p-2 bg-gradient-to-br from-primary-100 to-primary-200 dark:from-primary-900/40 dark:to-primary-800/30 rounded-xl shadow-md",children:p.jsx(ix,{className:"h-6 w-6 text-primary-600 dark:text-primary-400"})}),p.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 dark:from-slate-100 dark:to-slate-300 bg-clip-text text-transparent",children:"Commentaire pour l'administrateur"})]}),p.jsx("button",{onClick:()=>d(!1),className:"p-2 rounded-xl transition-all duration-200 shadow-md bg-slate-100/50 dark:bg-slate-700/50 backdrop-blur-sm",children:p.jsx(_n,{className:"h-5 w-5 text-slate-500 dark:text-slate-400"})})]}),p.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-3 font-medium",children:"Laissez un commentaire sur le déroulement de votre tournée"})]}),p.jsx("div",{className:"p-6",children:p.jsx("textarea",{className:"w-full h-36 p-4 bg-gradient-to-br from-white to-slate-50/50 dark:from-slate-700 dark:to-slate-600/50 text-slate-900 dark:text-slate-100 rounded-2xl focus:outline-none focus:ring-4 focus:ring-primary-500/30 dark:focus:ring-primary-400/30 resize-none placeholder-slate-500 dark:placeholder-slate-400 font-medium shadow-inner transition-all duration-200 backdrop-blur-sm",placeholder:"Écrivez votre commentaire ici...",value:x,onChange:X=>w(X.target.value)})}),p.jsxs("div",{className:"p-6 border-t border-slate-200/60 dark:border-slate-700/60 bg-gradient-to-r from-slate-50/80 to-slate-100/50 dark:from-slate-750/80 dark:to-slate-700/50 rounded-b-3xl flex justify-end gap-3",children:[p.jsx(Tt,{variant:"ghost",onClick:()=>d(!1),className:"text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-xl font-semibold px-6 py-2.5 transition-all duration-200 shadow-md",children:"Annuler"}),p.jsx(Tt,{onClick:()=>{console.log("Comment submitted:",x),d(!1),w("")},disabled:!x.trim(),className:"bg-gradient-to-r from-primary-600 to-primary-700 text-white disabled:from-slate-300 disabled:to-slate-400 disabled:cursor-not-allowed rounded-xl font-semibold px-6 py-2.5 transition-all duration-200 shadow-lg",children:"Envoyer"})]})]})}),h&&g&&p.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-md z-[100] flex items-center justify-center p-4",onClick:()=>m(!1),children:p.jsxs(Le.div,{className:"relative max-w-4xl max-h-[90vh] w-full",onClick:X=>X.stopPropagation(),initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},children:[p.jsx("button",{onClick:()=>m(!1),className:"absolute -top-4 -right-4 z-10 p-3 bg-gradient-to-br from-white to-slate-100 dark:from-slate-800 dark:to-slate-700 rounded-full shadow-2xl transition-all duration-200 backdrop-blur-sm",children:p.jsx(_n,{className:"h-6 w-6 text-slate-600 dark:text-slate-400"})}),p.jsx("div",{className:"bg-gradient-to-br from-white via-slate-50 to-white dark:from-slate-800 dark:via-slate-850 dark:to-slate-800 p-4 rounded-3xl shadow-2xl backdrop-blur-sm",children:p.jsx("img",{src:g,alt:"Photo de preuve",className:"w-full h-full object-contain rounded-2xl shadow-xl",onError:X=>{console.error("Erreur de chargement de l'image:",g),X.currentTarget.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIxIDlWN0MyMSA1Ljg5NTQzIDIwLjEwNDYgNSAxOSA1SDVDMy44OTU0MyA1IDMgNS44OTU0MyAzIDdWMTdDMyAxOC4xMDQ2IDMuODk1NDMgMTkgNSAxOUgxOUMyMC4xMDQ2IDE5IDIxIDE4LjEwNDYgMjEgMTdWMTVNMjEgOUwyMC41IDkuNUwxNSAxNUwxMyAxM0w5IDE3SDVMMTUgN0wyMSA5WiIgc3Ryb2tlPSIjOTlBM0FGIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K"}})})]})})]})},HI=()=>{const{theme:r,isTransitioning:e,toggleTheme:t}=Qb();return p.jsxs(Le.button,{onClick:t,disabled:e,className:`
        relative inline-flex items-center justify-center
        w-12 h-12 rounded-full transition-all duration-300 ease-in-out
        ${r==="dark"?"bg-gray-800 text-yellow-300 shadow-lg border-yellow-400/20":"bg-white text-gray-600 shadow-md hover:shadow-lg border-gray-200"}
        border-2 backdrop-blur-sm
        ${e?"scale-95 opacity-80":"hover:scale-105 active:scale-95"}
        ${e?"cursor-wait":"cursor-pointer"}
        focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500
      `,whileTap:e?{}:{scale:.95},whileHover:e?{}:{scale:1.05},"aria-label":r==="dark"?"Activer le mode clair":"Activer le mode sombre",initial:!1,children:[p.jsx(Mi,{mode:"wait",children:p.jsx(Le.div,{initial:{rotate:-180,opacity:0,scale:.5},animate:{rotate:0,opacity:1,scale:e?.8:1},exit:{rotate:180,opacity:0,scale:.5},transition:{duration:.4,ease:[.4,0,.2,1],opacity:{duration:.2}},className:"flex items-center justify-center",children:r==="dark"?p.jsx(hI,{className:"h-5 w-5"}):p.jsx(lI,{className:"h-5 w-5"})},r)}),e&&p.jsx(Le.div,{className:"absolute inset-0 rounded-full border-2 border-transparent border-t-current",animate:{rotate:360},transition:{duration:.8,repeat:1/0,ease:"linear"}})]})},WI=()=>{const{syncStatus:r}=Aw();if(j.useEffect(()=>{console.log("🔍 [SyncStatusIndicator] État du voyant:",{status:r.status,color:r.color,label:r.label,description:r.description})},[r]),r.status==="critical_error")return null;const e=()=>{switch(r.status){case"synced":return Du;case"syncing":return Ii;case"offline":return sp;default:return op}},t=()=>{switch(r.status){case"synced":return"bg-emerald-500 border-emerald-400";case"syncing":return"bg-amber-500 border-amber-400";case"offline":return"bg-orange-500 border-orange-400";default:return"bg-gray-500 border-gray-400"}},n=e();return p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:`
          flex items-center justify-center w-6 h-6 rounded-full transition-all duration-300
          ${t()}
          border-2 border-opacity-60 shadow-sm
        `,title:r.label,children:p.jsx(n,{className:`h-3 w-3 text-white ${r.isSpinning?"animate-spin":""}`})}),r.isSpinning&&p.jsx("div",{className:"absolute inset-0 rounded-full bg-amber-400 animate-ping opacity-30"})]})},GI=({isOpen:r,onClose:e,isCriticalError:t=!1,errorDescription:n=""})=>{const[o,a]=j.useState(!1),l=async()=>{if(!o){a(!0);try{console.log("🧹 [CleanupModal] Début nettoyage complet + redémarrage...");const{versionService:d}=await ct(async()=>{const{versionService:h}=await Promise.resolve().then(()=>ZI);return{versionService:h}},void 0);await d.forceUpdate()}catch(d){console.error("❌ Erreur nettoyage:",d),window.location.reload()}}};if(!r)return null;const c=p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000] p-4",style:{zIndex:1e4},children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl max-w-md w-full shadow-2xl border border-gray-200 dark:border-gray-700",children:[p.jsxs("div",{className:"p-6 text-center border-b border-gray-100 dark:border-gray-800",children:[p.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:p.jsx(_n,{className:"w-5 h-5"})}),p.jsx("div",{className:`w-16 h-16 ${t?"bg-gradient-to-br from-red-500 to-orange-600":"bg-gradient-to-br from-blue-500 to-purple-600"} rounded-full flex items-center justify-center mx-auto mb-4`,children:p.jsx(np,{className:"w-8 h-8 text-white"})}),p.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:t?"Réparer l'Application":"Nettoyer l'Application"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t?`Erreur détectée: ${n}. Un nettoyage va résoudre le problème.`:"Supprime toutes les données locales et redémarre l'application"})]}),p.jsxs("div",{className:"p-6 space-y-4",children:[p.jsx("div",{className:`${t?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800":"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800"} rounded-lg p-4`,children:p.jsxs("div",{className:"flex items-start space-x-3",children:[p.jsx(Pr,{className:`w-5 h-5 ${t?"text-red-600 dark:text-red-400":"text-amber-600 dark:text-amber-400"} mt-0.5 flex-shrink-0`}),p.jsxs("div",{className:"text-sm",children:[p.jsx("p",{className:`${t?"text-red-800 dark:text-red-200":"text-amber-800 dark:text-amber-200"} font-medium mb-1`,children:t?"Réparation Nécessaire":"Attention"}),p.jsx("p",{className:`${t?"text-red-700 dark:text-red-300":"text-amber-700 dark:text-amber-300"}`,children:t?"Un problème a été détecté dans vos données. Le nettoyage va corriger automatiquement cette erreur et redémarrer l'application.":"Cette action supprimera toutes vos données locales (photos, cache, préférences). Vos données de tournée seront rechargées depuis le serveur."})]})]})}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:t?"Réparations qui seront effectuées :":"Données qui seront supprimées :"}),p.jsx("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:t?p.jsxs(p.Fragment,{children:[p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),p.jsx("span",{children:"Correction des incohérences de données"})]}),p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),p.jsx("span",{children:"Nettoyage des erreurs de synchronisation"})]}),p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full"}),p.jsx("span",{children:"Réinitialisation du cache corrompu"})]}),p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),p.jsx("span",{className:"text-green-600 dark:text-green-400",children:"✓ Récupération automatique des données"})]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),p.jsx("span",{children:"Photos en cache"})]}),p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),p.jsx("span",{children:"Données de tournée locale"})]}),p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full"}),p.jsx("span",{children:"Préférences et cache navigateur"})]}),p.jsxs("li",{className:"flex items-center space-x-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),p.jsx("span",{className:"text-green-600 dark:text-green-400",children:"✓ Connexion préservée"})]})]})})]})]}),p.jsxs("div",{className:"p-6 border-t border-gray-100 dark:border-gray-800 space-y-3",children:[p.jsx("button",{onClick:l,disabled:o,className:`w-full ${t?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700":"bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700"} disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-3 px-4 rounded-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:cursor-not-allowed`,children:o?p.jsxs(p.Fragment,{children:[p.jsx(Ii,{className:"w-5 h-5 animate-spin"}),p.jsx("span",{children:t?"Réparation en cours...":"Nettoyage en cours..."})]}):p.jsxs(p.Fragment,{children:[p.jsx(np,{className:"w-5 h-5"}),p.jsx("span",{children:t?"Réparer Maintenant":"Nettoyer & Redémarrer"})]})}),p.jsx("button",{onClick:e,disabled:o,className:"w-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium py-3 px-4 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Annuler"})]})]})});return W_.createPortal(c,document.body)};class KI{STORAGE_KEY="app_version_info";CHECK_INTERVAL=300*1e3;checkTimer=null;getCurrentVersion(){return"1.3.8"}getStoredVersionInfo(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):null}catch(e){return console.error("Erreur lors de la lecture des infos de version:",e),null}}saveVersionInfo(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Erreur lors de la sauvegarde des infos de version:",t)}}async checkForUpdates(){try{const e=this.getCurrentVersion(),t=this.getStoredVersionInfo();if(console.log(`🔍 Vérification des mises à jour - Version actuelle: ${e}`),"serviceWorker"in navigator){const o=await navigator.serviceWorker.getRegistration();if(o&&(await o.update(),o.waiting))return console.log("🆕 Nouvelle version détectée via Service Worker"),!0}const n={version:e,buildTime:new Date().toISOString(),lastCheck:new Date().toISOString()};return this.saveVersionInfo(n),!t||t.version!==e?(console.log(`🔄 Version mise à jour: ${t?.version||"inconnue"} → ${e}`),!0):!1}catch(e){return console.error("Erreur lors de la vérification des mises à jour:",e),!1}}async forceUpdate(){console.log("🔄 Mise à jour forcée de l'application avec nettoyage complet...");try{const e=this.preserveAuthenticationData();console.log("💾 Données d'authentification sauvegardées"),await this.clearMainAppStore(),console.log("🧹 Store principal vidé"),await this.clearLocalForageData(),console.log("🗑️ LocalForage vidé"),await this.clearBrowserCache(),console.log("🧽 Cache navigateur vidé"),this.restoreAuthenticationData(e),console.log("🔐 Authentification restaurée"),console.log("✅ Nettoyage complet terminé - Rechargement..."),window.location.reload()}catch(e){console.error("❌ Erreur lors du nettoyage:",e),window.location.reload()}}preserveAuthenticationData(){try{const e=localStorage.getItem("supabase.auth.token.delivery-app"),t=localStorage.getItem("auth-storage");return{supabaseAuth:e,authStore:t}}catch(e){return console.warn("⚠️ Erreur sauvegarde auth:",e),null}}restoreAuthenticationData(e){if(e)try{e.supabaseAuth&&localStorage.setItem("supabase.auth.token.delivery-app",e.supabaseAuth),e.authStore&&localStorage.setItem("auth-storage",e.authStore),console.log("🔐 Authentification restaurée avec succès")}catch(t){console.warn("⚠️ Erreur restauration auth:",t)}}async clearMainAppStore(){try{const{useMainAppStore:e}=await ct(async()=>{const{useMainAppStore:t}=await Promise.resolve().then(()=>_u);return{useMainAppStore:t}},void 0);e.getState().clearStore(),localStorage.removeItem("main-app-storage")}catch(e){console.warn("⚠️ Erreur vidage store principal:",e)}}async clearLocalForageData(){try{const e=(await ct(async()=>{const{default:n}=await Promise.resolve().then(()=>Zj);return{default:n}},void 0)).default;await e.clear(),await e.createInstance({name:"provenceCourses",storeName:"mainApp"}).clear()}catch(e){console.warn("⚠️ Erreur vidage LocalForage:",e)}}async clearBrowserCache(){try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(t=>caches.delete(t)))}}catch(e){console.warn("⚠️ Erreur vidage cache navigateur:",e)}}startAutoCheck(){console.log("🚀 Démarrage de la vérification automatique des mises à jour"),this.checkForUpdates().then(e=>{e&&console.log("⚡ Mise à jour détectée au démarrage")}),this.checkTimer=setInterval(async()=>{await this.checkForUpdates()&&(console.log("⚡ Mise à jour détectée - Nettoyage complet et rechargement"),await this.forceUpdate())},this.CHECK_INTERVAL)}stopAutoCheck(){this.checkTimer&&(clearInterval(this.checkTimer),this.checkTimer=null,console.log("⏹️ Vérification automatique arrêtée"))}getUpdateStats(){const e=this.getStoredVersionInfo();return{currentVersion:this.getCurrentVersion(),lastCheck:e?.lastCheck||null,autoCheckActive:this.checkTimer!==null}}}const Yu=new KI,ZI=Object.freeze(Object.defineProperty({__proto__:null,versionService:Yu},Symbol.toStringTag,{value:"Module"})),JI=()=>{const[r,e]=j.useState(!1),{syncStatus:t}=Aw();return p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm",children:p.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx(WI,{}),p.jsxs("div",{className:"flex flex-col",children:[p.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"PC"}),p.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 -mt-1",children:["v",Yu.getCurrentVersion()]})]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs(Tt,{variant:"ghost",size:"sm",onClick:()=>e(!0),className:`flex items-center gap-1 px-2 py-1 transition-all duration-200 ${t.status==="critical_error"?"bg-red-500 hover:bg-red-600 text-white animate-pulse":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:t.status==="critical_error"?`Erreur critique détectée: ${t.description} - Cliquez pour nettoyer`:"Nettoyage complet et redémarrage",children:[p.jsx(np,{className:"w-4 h-4"}),p.jsx("span",{className:"text-xs",children:t.status==="critical_error"?"Réparer":"Nettoyer"})]}),p.jsx(HI,{})]})]})}),p.jsx(GI,{isOpen:r,onClose:()=>e(!1),isCriticalError:t.status==="critical_error",errorDescription:t.description})]})},QI=()=>{const{signOut:r}=Ti(),e=Vs(),t=async()=>{await r(),e("/login")};return p.jsxs("div",{className:"min-h-full bg-gray-50 dark:bg-gray-900 flex flex-col",children:[p.jsx("div",{className:"fixed top-0 left-0 right-0 z-50",children:p.jsx(JI,{})}),p.jsx("main",{className:"flex-1 pt-16 bg-gray-50 dark:bg-gray-900",children:p.jsx(Ok,{})}),p.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-[100] bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg backdrop-blur-sm pb-6",children:p.jsxs("div",{className:"flex items-center justify-around py-3 px-2",children:[p.jsxs(zh,{to:"/",end:!0,className:({isActive:n})=>`mobile-nav-item flex flex-col items-center py-3 px-4 rounded-xl min-w-[70px] ${n?"text-white bg-gradient-to-t from-blue-600 to-blue-500 shadow-lg shadow-blue-500/25 scale-105 active-nav-shadow":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-800 dark:hover:text-gray-200"}`,children:[p.jsx(sI,{className:"h-6 w-6"}),p.jsx("span",{className:"text-xs mt-1 font-medium",children:"Accueil"})]}),p.jsxs(zh,{to:"/driver/route",className:({isActive:n})=>`mobile-nav-item flex flex-col items-center py-3 px-4 rounded-xl min-w-[70px] ${n?"text-white bg-gradient-to-t from-orange-600 to-orange-500 shadow-lg shadow-orange-500/25 scale-105 active-nav-shadow":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-800 dark:hover:text-gray-200"}`,children:[p.jsx(cI,{className:"h-6 w-6"}),p.jsx("span",{className:"text-xs mt-1 font-medium",children:"Tournée"})]}),p.jsxs(zh,{to:"/driver/resume",className:({isActive:n})=>`mobile-nav-item flex flex-col items-center py-3 px-4 rounded-xl min-w-[70px] ${n?"text-white bg-gradient-to-t from-green-600 to-green-500 shadow-lg shadow-green-500/25 scale-105 active-nav-shadow":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-800 dark:hover:text-gray-200"}`,children:[p.jsx(tI,{className:"h-6 w-6"}),p.jsx("span",{className:"text-xs mt-1 font-medium",children:"Résumé"})]}),p.jsxs("button",{onClick:t,className:"mobile-nav-item flex flex-col items-center py-3 px-4 rounded-xl min-w-[70px] text-gray-600 dark:text-gray-300 hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-600 dark:hover:text-red-400",children:[p.jsx(iI,{className:"h-6 w-6"}),p.jsx("span",{className:"text-xs mt-1 font-medium",children:"Quitter"})]})]})})]})};class YI{sessionId;logQueue=[];isOnline=!0;batchTimer;BATCH_SIZE=5;BATCH_TIMEOUT=1e4;constructor(){this.sessionId=this.generateSessionId(),this.setupNetworkListeners(),this.startBatchProcessor()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setupNetworkListeners(){window.addEventListener("online",()=>{console.log("🌐 [ErrorLogger] Connexion rétablie - envoi des logs en queue"),this.isOnline=!0,this.processQueue()}),window.addEventListener("offline",()=>{console.log("🌐 [ErrorLogger] Connexion perdue - mise en queue des logs"),this.isOnline=!1}),this.isOnline=navigator.onLine}startBatchProcessor(){this.batchTimer=setInterval(()=>{this.logQueue.length>0&&this.isOnline&&this.processQueue()},this.BATCH_TIMEOUT)}async logError(e){try{const t=await this.enrichErrorData(e);console.log("📝 [ErrorLogger] Logging erreur:",{type:t.error_type,message:t.error_message.substring(0,100)+"...",source:t.error_source,severity:t.severity}),this.logQueue.push(t),t.severity==="critical"&&this.isOnline?(await this.sendErrorToSupabase(t),this.logQueue=this.logQueue.filter(n=>n!==t)):this.logQueue.length>=this.BATCH_SIZE&&this.isOnline&&await this.processQueue()}catch(t){console.error("❌ [ErrorLogger] Erreur lors du logging:",t)}}async enrichErrorData(e){const t={...e};Ti.getState().user,t.device_type||(t.device_type=this.detectDeviceType()),t.device_model||(t.device_model=this.detectDeviceModel()),t.os_version||(t.os_version=this.detectOSVersion()),t.browser_name||(t.browser_name=this.detectBrowserName()),t.user_agent||(t.user_agent=navigator.userAgent),t.app_version||(t.app_version="1.2.9"),t.page_url||(t.page_url=window.location.href),t.memory_usage||(t.memory_usage=this.getMemoryUsage()),t.storage_usage||(t.storage_usage=await this.getStorageUsage()),t.network_status||(t.network_status=this.getNetworkStatus());try{const{useMainAppStore:o}=await ct(async()=>{const{useMainAppStore:l}=await Promise.resolve().then(()=>_u);return{useMainAppStore:l}},void 0),a=o.getState();!t.current_route_id&&a.route.driverRoute&&(t.current_route_id=a.route.driverRoute.id),t.current_stop_index===void 0&&(t.current_stop_index=a.route.currentStopIndex),t.pending_sync_actions===void 0&&(t.pending_sync_actions=a.sync.pendingActions.length)}catch(o){console.warn("⚠️ [ErrorLogger] Impossible de récupérer le contexte métier:",o)}return t.severity||(t.severity=this.determineSeverity(t)),t}detectDeviceType(){const e=navigator.userAgent;return/iPad/.test(e)?"iPad":/iPhone/.test(e)?"iPhone":/iPod/.test(e)?"iPod":/Android/.test(e)?"Android":"Desktop"}detectDeviceModel(){const e=navigator.userAgent;return/iPhone/.test(e)?/iPhone OS 17/.test(e)?"iPhone (iOS 17)":/iPhone OS 16/.test(e)?"iPhone (iOS 16)":/iPhone OS 15/.test(e)?"iPhone (iOS 15)":"iPhone (version inconnue)":/iPad/.test(e)?"iPad":"Inconnu"}detectOSVersion(){const t=navigator.userAgent.match(/OS (\d+_\d+_?\d*)/);return t?t[1].replace(/_/g,"."):"inconnue"}detectBrowserName(){const e=navigator.userAgent;return/Safari/.test(e)&&!/Chrome/.test(e)?"Safari":/Chrome/.test(e)?"Chrome":/Firefox/.test(e)?"Firefox":"Inconnu"}getMemoryUsage(){if(!performance.memory)return;const e=performance.memory,t=Math.round(e.usedJSHeapSize/1024/1024),n=Math.round(e.totalJSHeapSize/1024/1024),o=Math.round(e.jsHeapSizeLimit/1024/1024);return{used:t,total:n,percentage:Math.round(t/o*100)}}async getStorageUsage(){const e={localStorage:0,indexedDB:0,total:0};try{let t=0;for(const n in localStorage)localStorage.hasOwnProperty(n)&&(t+=localStorage[n].length+n.length);e.localStorage=Math.round(t/1024)}catch{}try{if("storage"in navigator&&"estimate"in navigator.storage){const t=await navigator.storage.estimate();e.indexedDB=Math.round((t.usage||0)/1024)}}catch{}return e.total=e.localStorage+e.indexedDB,e}getNetworkStatus(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return{isOnline:navigator.onLine,effectiveType:e?.effectiveType||"unknown",downlink:e?.downlink||0}}determineSeverity(e){return e.error_type==="memory"&&e.memory_usage?.percentage&&e.memory_usage.percentage>90||e.error_message.toLowerCase().includes("out of memory")||e.error_message.toLowerCase().includes("maximum call stack")?"critical":e.error_type==="ios_specific"||e.error_source==="ErrorBoundary"?"error":e.error_type==="network"&&!e.network_status?.isOnline?"warning":"error"}async processQueue(){if(this.logQueue.length===0||!this.isOnline)return;console.log(`📤 [ErrorLogger] Envoi de ${this.logQueue.length} log(s) vers Supabase`);const e=this.logQueue.splice(0,this.BATCH_SIZE);try{await Promise.all(e.map(t=>this.sendErrorToSupabase(t))),console.log(`✅ [ErrorLogger] ${e.length} log(s) envoyé(s) avec succès`)}catch(t){console.error("❌ [ErrorLogger] Erreur envoi batch:",t),this.logQueue.unshift(...e)}}async sendErrorToSupabase(e){const n=Ti.getState().user,o={user_id:n?.id||null,user_email:n?.profile?.email||null,driver_id:n?.profile?.id||null,error_type:e.error_type,error_message:e.error_message,error_stack:e.error_stack,error_source:e.error_source,app_version:e.app_version,page_url:e.page_url,user_action:e.user_action,device_type:e.device_type,device_model:e.device_model,os_version:e.os_version,browser_name:e.browser_name,browser_version:e.browser_version,user_agent:e.user_agent,memory_usage:e.memory_usage,storage_usage:e.storage_usage,network_status:e.network_status,current_route_id:e.current_route_id,current_stop_index:e.current_stop_index,pending_sync_actions:e.pending_sync_actions,severity:e.severity,session_id:this.sessionId},{error:a}=await Oe.from("error_logs").insert([o]);if(a)throw new Error(`Erreur Supabase: ${a.message}`)}logJavaScriptError(e,t,n){this.logError({error_type:"javascript",error_message:e.message,error_stack:e.stack,error_source:t,user_action:n})}logNetworkError(e,t,n){this.logError({error_type:"network",error_message:e,error_source:t,user_action:n,severity:"warning"})}logMemoryError(e,t){this.logError({error_type:"memory",error_message:e,error_source:t,severity:"critical"})}logIOSError(e,t,n){this.logError({error_type:"ios_specific",error_message:e,error_source:t,user_action:n,severity:"error"})}logInfo(e,t,n){this.logError({error_type:"unknown",error_message:e,error_source:t,user_action:n,severity:"info"})}cleanup(){this.batchTimer&&clearInterval(this.batchTimer),this.logQueue.length>0&&this.isOnline&&this.processQueue()}getStats(){return{sessionId:this.sessionId,queueSize:this.logQueue.length,isOnline:this.isOnline,totalLogged:0}}}const Gn=new YI;window.addEventListener("beforeunload",()=>{Gn.cleanup()});class bf extends j.Component{constructor(e){super(e),this.state={hasError:!1,errorId:""}}static getDerivedStateFromError(e){const t=`ERR_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return{hasError:!0,error:e,errorId:t}}componentDidCatch(e,t){console.error("🚨 [ErrorBoundary] Erreur capturée:",{error:e.message,stack:e.stack,errorInfo:t,errorId:this.state.errorId,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href}),Gn.logJavaScriptError(e,"ErrorBoundary","Navigation dans l'application");try{const n={errorId:this.state.errorId,message:e.message,stack:e.stack,componentStack:t.componentStack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href},o=JSON.parse(localStorage.getItem("app_error_logs")||"[]");o.push(n);const a=o.slice(-10);localStorage.setItem("app_error_logs",JSON.stringify(a))}catch(n){console.warn("Impossible de sauvegarder le log d'erreur:",n)}this.setState({error:e,errorInfo:t})}handleRetry=()=>{console.log("🔄 [ErrorBoundary] Tentative de récupération..."),this.setState({hasError:!1,error:void 0,errorInfo:void 0,errorId:""})};handleReload=()=>{console.log("🔄 [ErrorBoundary] Rechargement complet de l'application...");try{const e=localStorage.getItem("supabase.auth.token.delivery-app"),t=localStorage.getItem("auth-storage");localStorage.removeItem("main-app-storage"),e&&localStorage.setItem("supabase.auth.token.delivery-app",e),t&&localStorage.setItem("auth-storage",t)}catch(e){console.warn("Erreur lors du nettoyage:",e)}window.location.reload()};handleGoHome=()=>{console.log("🏠 [ErrorBoundary] Retour à l'accueil..."),this.setState({hasError:!1,error:void 0,errorInfo:void 0,errorId:""}),window.location.hash="/"};render(){return this.state.hasError?this.props.fallback?this.props.fallback:p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-xl p-6 text-center",children:[p.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:p.jsx(am,{className:"w-8 h-8 text-red-600"})}),p.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Oops ! Un problème est survenu"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"L'application a rencontré une erreur inattendue. Pas de panique, vos données sont sauvegardées !"}),p.jsxs("div",{className:"bg-gray-100 rounded p-2 mb-6 text-xs text-gray-500",children:["ID: ",this.state.errorId]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs(Tt,{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700",children:[p.jsx(Ii,{className:"w-4 h-4 mr-2"}),"Réessayer"]}),p.jsxs(Tt,{onClick:this.handleGoHome,variant:"outline",className:"w-full",children:[p.jsx(Qw,{className:"w-4 h-4 mr-2"}),"Retour à l'accueil"]}),p.jsxs(Tt,{onClick:this.handleReload,variant:"outline",className:"w-full text-orange-600 border-orange-600 hover:bg-orange-50",children:[p.jsx(Ii,{className:"w-4 h-4 mr-2"}),"Redémarrer l'app"]})]}),!1]})}):this.props.children}}class dm extends j.Component{networkCheckInterval;constructor(e){super(e),this.state={hasError:!1,errorType:"unknown",isOnline:navigator.onLine}}static getDerivedStateFromError(e){const t=dm.categorizeError(e);return{hasError:!0,error:e,errorType:t}}static categorizeError(e){const t=e.message.toLowerCase(),n=e.stack?.toLowerCase()||"";return t.includes("network")||t.includes("fetch")||t.includes("connection")||t.includes("offline")?"network":t.includes("memory")||t.includes("heap")||n.includes("out of memory")?"memory":t.includes("webkit")||t.includes("safari")||t.includes("ios")||n.includes("webkit")?"ios_specific":"unknown"}componentDidCatch(e,t){console.error("🍎 [IOSErrorHandler] Erreur iOS capturée:",{error:e.message,stack:e.stack,errorType:this.state.errorType,userAgent:navigator.userAgent,isIOS:/iPad|iPhone|iPod/.test(navigator.userAgent),isSafari:/Safari/.test(navigator.userAgent),memoryInfo:performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1024/1024),total:Math.round(performance.memory.totalJSHeapSize/1024/1024),limit:Math.round(performance.memory.jsHeapSizeLimit/1024/1024)}:"non disponible",timestamp:new Date().toISOString()}),this.state.errorType==="ios_specific"?Gn.logIOSError(e.message,"IOSErrorHandler","Utilisation de l'application sur iOS"):this.state.errorType==="memory"?Gn.logMemoryError(e.message,"IOSErrorHandler"):this.state.errorType==="network"?Gn.logNetworkError(e.message,"IOSErrorHandler","Opération réseau sur iOS"):Gn.logJavaScriptError(e,"IOSErrorHandler","Erreur générale sur iOS"),this.saveErrorForDebug(e,t),this.startNetworkMonitoring()}componentWillUnmount(){this.networkCheckInterval&&clearInterval(this.networkCheckInterval)}saveErrorForDebug(e,t){try{const n={timestamp:new Date().toISOString(),error:e.message,stack:e.stack,errorType:this.state.errorType,componentStack:t.componentStack,userAgent:navigator.userAgent,url:window.location.href,memoryUsage:performance.memory?performance.memory.usedJSHeapSize:null,isOnline:navigator.onLine},o=JSON.parse(localStorage.getItem("ios_error_logs")||"[]");o.push(n);const a=o.slice(-5);localStorage.setItem("ios_error_logs",JSON.stringify(a))}catch(n){console.warn("Impossible de sauvegarder le log d'erreur iOS:",n)}}startNetworkMonitoring(){this.networkCheckInterval=setInterval(()=>{const e=navigator.onLine;e!==this.state.isOnline&&(this.setState({isOnline:e}),e&&(console.log("🌐 Connexion rétablie - tentative de récupération automatique"),setTimeout(()=>this.handleRetry(),2e3)))},3e3)}handleRetry=()=>{switch(console.log(`🔄 [IOSErrorHandler] Tentative de récupération - Type: ${this.state.errorType}`),this.state.errorType){case"memory":this.handleMemoryError();break;case"network":this.handleNetworkError();break;case"ios_specific":this.handleIOSSpecificError();break;default:this.handleGenericError()}this.setState({hasError:!1,error:void 0,errorType:"unknown"})};handleMemoryError(){console.log("🧹 Nettoyage mémoire iOS..."),"caches"in window&&caches.keys().then(e=>{e.forEach(t=>{(t.includes("images")||t.includes("photos"))&&caches.delete(t)})}),window.gc&&window.gc(),window.dispatchEvent(new CustomEvent("ios-memory-cleanup"))}handleNetworkError(){console.log("🌐 Gestion erreur réseau iOS..."),window.dispatchEvent(new CustomEvent("reset-supabase-connection")),window.dispatchEvent(new CustomEvent("cleanup-subscriptions"))}handleIOSSpecificError(){console.log("🍎 Gestion erreur spécifique iOS...");const e=document.querySelector("meta[name=viewport]");e&&e.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover"),document.body.style.display="none",document.body.offsetHeight,document.body.style.display=""}handleGenericError(){console.log("🔧 Récupération générique...");const e=["supabase.auth.token.delivery-app","auth-storage"];Object.keys(localStorage).forEach(n=>{if(!e.includes(n))try{localStorage.removeItem(n)}catch{}})}handleFullReload=()=>{console.log("🔄 [IOSErrorHandler] Rechargement complet iOS...");const e=localStorage.getItem("supabase.auth.token.delivery-app"),t=localStorage.getItem("auth-storage");localStorage.clear(),e&&localStorage.setItem("supabase.auth.token.delivery-app",e),t&&localStorage.setItem("auth-storage",t),"caches"in window?caches.keys().then(n=>{Promise.all(n.map(o=>caches.delete(o))).then(()=>window.location.reload())}):window.location.reload()};render(){if(this.state.hasError){const{errorType:e,isOnline:t}=this.state;return p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center p-4",children:p.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-xl p-6 text-center",children:[p.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e==="network"?t?p.jsx(op,{className:"w-8 h-8 text-orange-600"}):p.jsx(sp,{className:"w-8 h-8 text-red-600"}):p.jsx(am,{className:"w-8 h-8 text-red-600"})}),p.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:this.getErrorTitle(e)}),p.jsx("p",{className:"text-gray-600 mb-6",children:this.getErrorDescription(e,t)}),p.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm mb-6 ${t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[t?p.jsx(op,{className:"w-4 h-4 mr-1"}):p.jsx(sp,{className:"w-4 h-4 mr-1"}),t?"En ligne":"Hors ligne"]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs(Tt,{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700",disabled:!t&&e==="network",children:[p.jsx(Ii,{className:"w-4 h-4 mr-2"}),this.getRetryButtonText(e,t)]}),p.jsxs(Tt,{onClick:()=>window.location.hash="/",variant:"outline",className:"w-full",children:[p.jsx(Qw,{className:"w-4 h-4 mr-2"}),"Retour à l'accueil"]}),p.jsxs(Tt,{onClick:this.handleFullReload,variant:"outline",className:"w-full text-orange-600 border-orange-600 hover:bg-orange-50",children:[p.jsx(Ii,{className:"w-4 h-4 mr-2"}),"Redémarrage complet"]})]}),!1]})})}return this.props.children}getErrorTitle(e){switch(e){case"network":return"Problème de connexion";case"memory":return"Mémoire insuffisante";case"ios_specific":return"Problème iOS détecté";default:return"Une erreur est survenue"}}getErrorDescription(e,t){switch(e){case"network":return t?"La connexion au serveur a été interrompue. Nous tentons de rétablir la connexion...":"Vous êtes actuellement hors ligne. Vérifiez votre connexion internet.";case"memory":return"L'application utilise trop de mémoire. Un nettoyage automatique va être effectué.";case"ios_specific":return"Un problème spécifique à iOS Safari a été détecté. Redémarrage recommandé.";default:return"L'application a rencontré un problème inattendu. Vos données sont sécurisées."}}getRetryButtonText(e,t){if(e==="network"&&!t)return"Attendre la connexion...";switch(e){case"memory":return"Nettoyer et reprendre";case"network":return"Reconnecter";case"ios_specific":return"Corriger et reprendre";default:return"Réessayer"}}}class XI{subscriptions=new Map;isOnline=!0;maxSubscriptions=5;subscriptionQueue=[];debounceTimers=new Map;constructor(){this.setupNetworkListeners()}setupNetworkListeners(){window.addEventListener("online",()=>{console.log("🌐 [SubscriptionManager] Connexion rétablie - réactivation des subscriptions"),this.isOnline=!0,this.reconnectAllSubscriptions()}),window.addEventListener("offline",()=>{console.log("🌐 [SubscriptionManager] Connexion perdue - pause des subscriptions"),this.isOnline=!1,this.pauseAllSubscriptions()}),setInterval(()=>{const e=this.isOnline;this.isOnline=navigator.onLine,e!==this.isOnline&&(this.isOnline?this.reconnectAllSubscriptions():this.pauseAllSubscriptions())},1e4)}subscribe(e){this.debounceTimers.has(e.id)&&clearTimeout(this.debounceTimers.get(e.id));const t=setTimeout(()=>{this.createSubscription(e),this.debounceTimers.delete(e.id)},100);this.debounceTimers.set(e.id,t)}createSubscription(e){if(!this.isOnline){console.log(`⏸️ [SubscriptionManager] Hors ligne - mise en queue: ${e.id}`),this.subscriptionQueue.push(e);return}this.subscriptions.size>=this.maxSubscriptions&&this.cleanupLowPrioritySubscriptions(),this.unsubscribe(e.id),console.log(`🎧 [SubscriptionManager] Création subscription: ${e.id}`);try{const t=Oe.channel(`subscription-${e.id}`).on("postgres_changes",{event:e.events?.join("|")||"*",schema:"public",table:e.table,filter:e.filter},n=>{this.isOnline&&this.debounceCallback(e.id,e.callback,n)}).subscribe(n=>{n==="SUBSCRIBED"?console.log(`✅ [SubscriptionManager] Subscription active: ${e.id}`):n==="CHANNEL_ERROR"&&(console.error(`❌ [SubscriptionManager] Erreur subscription: ${e.id}`),setTimeout(()=>this.createSubscription(e),5e3))});this.subscriptions.set(e.id,t)}catch(t){console.error(`❌ [SubscriptionManager] Erreur création subscription ${e.id}:`,t)}}debounceCallback(e,t,n){const o=`callback-${e}`;this.debounceTimers.has(o)&&clearTimeout(this.debounceTimers.get(o));const a=setTimeout(()=>{try{t(n)}catch(l){console.error(`❌ [SubscriptionManager] Erreur callback ${e}:`,l)}this.debounceTimers.delete(o)},500);this.debounceTimers.set(o,a)}unsubscribe(e){const t=this.subscriptions.get(e);t&&(console.log(`🧹 [SubscriptionManager] Suppression subscription: ${e}`),Oe.removeChannel(t),this.subscriptions.delete(e));const n=`callback-${e}`;this.debounceTimers.has(n)&&(clearTimeout(this.debounceTimers.get(n)),this.debounceTimers.delete(n)),this.debounceTimers.has(e)&&(clearTimeout(this.debounceTimers.get(e)),this.debounceTimers.delete(e))}cleanupLowPrioritySubscriptions(){console.log("🧹 [SubscriptionManager] Nettoyage subscriptions faible priorité");const e=Array.from(this.subscriptions.keys())[0];e&&this.unsubscribe(e)}pauseAllSubscriptions(){console.log("⏸️ [SubscriptionManager] Pause de toutes les subscriptions");for(const[e,t]of this.subscriptions)Oe.removeChannel(t)}reconnectAllSubscriptions(){for(console.log("🔄 [SubscriptionManager] Reconnexion de toutes les subscriptions");this.subscriptionQueue.length>0;){const e=this.subscriptionQueue.shift();e&&this.createSubscription(e)}}cleanup(){console.log("🧹 [SubscriptionManager] Nettoyage complet");for(const e of this.debounceTimers.values())clearTimeout(e);this.debounceTimers.clear();for(const[e,t]of this.subscriptions)Oe.removeChannel(t);this.subscriptions.clear(),this.subscriptionQueue=[]}getStats(){return{activeSubscriptions:this.subscriptions.size,queuedSubscriptions:this.subscriptionQueue.length,maxSubscriptions:this.maxSubscriptions,isOnline:this.isOnline,pendingTimers:this.debounceTimers.size}}setMaxSubscriptions(e){for(this.maxSubscriptions=e;this.subscriptions.size>this.maxSubscriptions;)this.cleanupLowPrioritySubscriptions()}}const hi=new XI;window.addEventListener("beforeunload",()=>{hi.cleanup()});const eD=({enabled:r=!0,onRouteModification:e}={})=>{const t=et(),n=t.route.driverRoute?.id,o=j.useRef(!1),a=j.useRef(null),l=j.useCallback(v=>{console.log("📦 [OptimizedRealtime] Changement shipments:",v),!(!n||v.new?.route_id!==n)&&(setTimeout(()=>{t.route.driverRoute&&t.syncDataInBackground(t.route.driverRoute,t.route.rawStops,t.route.rawShipments)},1e3),e&&v.eventType==="INSERT"&&e({type:"new_shipment",shipment:v.new,timestamp:Date.now()}))},[n,t,e]),c=j.useCallback(v=>{console.log("📍 [OptimizedRealtime] Changement stops:",v),!(!n||v.new?.route_id!==n)&&(setTimeout(()=>{t.route.driverRoute&&t.syncDataInBackground(t.route.driverRoute,t.route.rawStops,t.route.rawShipments)},1e3),e&&v.new?.is_late_stop&&e({type:"late_stop_added",stop:v.new,timestamp:Date.now()}))},[n,t,e]),d=j.useCallback(()=>{!r||!n||(console.log("🎧 [OptimizedRealtime] Configuration subscriptions pour route:",n),hi.subscribe({id:`shipments-${n}`,table:"driver_route_shipments",filter:`route_id=eq.${n}`,events:["INSERT","UPDATE","DELETE"],callback:l,priority:"high"}),hi.subscribe({id:`stops-${n}`,table:"driver_route_stops",filter:`route_id=eq.${n}`,events:["INSERT","UPDATE","DELETE"],callback:c,priority:"high"}))},[r,n,l,c]),h=j.useCallback(()=>{a.current&&(console.log("🧹 [OptimizedRealtime] Nettoyage subscriptions route:",a.current),hi.unsubscribe(`shipments-${a.current}`),hi.unsubscribe(`stops-${a.current}`))},[]);j.useEffect(()=>(o.current||(console.log("🚀 [OptimizedRealtime] Initialisation du hook realtime optimisé"),o.current=!0),a.current!==n&&(h(),a.current=n),n&&d(),()=>{n||h()}),[n,r,d,h]),j.useEffect(()=>()=>{console.log("🧹 [OptimizedRealtime] Nettoyage complet du hook"),h(),o.current=!1},[h]);const m=j.useCallback(()=>{n&&t.route.driverRoute&&(console.log("🔄 [OptimizedRealtime] Resynchronisation forcée"),t.syncDataInBackground(t.route.driverRoute,t.route.rawStops,t.route.rawShipments))},[n,t]),g=j.useCallback(()=>({currentRouteId:n,subscriptionsActive:!!n,subscriptionManagerStats:hi.getStats()}),[n]);return{isActive:!!n&&r,forceResync:m,getStats:g}},tD=({isOpen:r,onClose:e,modification:t})=>{const n=et();if(j.useEffect(()=>{if(r){const x=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${x}px`,document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,x)}}},[r]),!r||!t||t.type!=="late_stop_added")return null;const a=(()=>{if(!t.stop)return null;const x=t.stop,w=n.referenceData.locations.get(x.location_id);let S="",_=p.jsx(rn,{className:"w-5 h-5"}),C="text-blue-600 dark:text-blue-400";if(x.client_actions){const A=x.client_actions.includes("delivery"),K=x.client_actions.includes("pickup");A&&K?(S="Livraison / Récupération",_=p.jsxs("div",{className:"flex items-center space-x-1",children:[p.jsx(xf,{className:"w-4 h-4"}),p.jsx("span",{children:"/"}),p.jsx(rn,{className:"w-4 h-4"})]}),C="text-purple-600 dark:text-purple-400"):A?(S="Livraison",_=p.jsx(xf,{className:"w-5 h-5"}),C="text-green-600 dark:text-green-400"):K&&(S="Récupération",_=p.jsx(rn,{className:"w-5 h-5"}),C="text-blue-600 dark:text-blue-400")}else x.stop_type&&(x.stop_type.includes("pickup")?(S="Récupération",_=p.jsx(rn,{className:"w-5 h-5"}),C="text-blue-600 dark:text-blue-400"):x.stop_type.includes("delivery")?(S="Livraison",_=p.jsx(xf,{className:"w-5 h-5"}),C="text-green-600 dark:text-green-400"):(S="Arrêt",_=p.jsx(tr,{className:"w-5 h-5"}),C="text-gray-600 dark:text-gray-400"));let E="Client inconnu",N="";if(w){if(N=w.formatted_address||"Adresse inconnue",w.type==="laboratory"?E=Array.from(n.referenceData.laboratories.values()).find(K=>K.location_id===w.id)?.name||"Laboratoire inconnu":w.type==="dentist_client"||w.type==="lab_client"?E=Array.from(n.referenceData.laboratoryClients.values()).find(K=>K.location_id===w.id)?.name||"Client inconnu":E=(w.formatted_address||"").split(",")[0]?.trim()||"Lieu inconnu",E==="Client inconnu"||E==="Lieu inconnu"){const Z=(w.formatted_address||"").split(",")[0]?.trim()||"";Z&&!Z.match(/^\d/)&&(E=Z)}E.length>35&&(E=E.substring(0,35)+"...")}return{actionType:S,actionIcon:_,actionColor:C,clientName:E,clientAddress:N,positionText:(()=>{const A=x.stop_order,K=n.route.groupedStops;let Z="",W="";const de=[...K].sort((pe,Ee)=>pe.orderRange[0]-Ee.orderRange[0]);for(let pe=0;pe<de.length;pe++){const Ee=de[pe],[ee,ye]=Ee.orderRange;if(A>=ee&&A<=ye+1){if(pe>0){const G=de[pe-1];Z=G.clientName||G.laboratoryName||"Arrêt précédent"}if(A>ye&&pe<de.length-1){const G=de[pe+1];W=G.clientName||G.laboratoryName||"Arrêt suivant"}else A<=ye&&(W=Ee.clientName||Ee.laboratoryName||"Arrêt suivant");break}}return Z&&W?`entre "${Z}" et "${W}"`:Z?`après "${Z}"`:W?`avant "${W}"`:`position #${A}`})()}})();if(!a)return null;const{actionType:l,actionIcon:c,actionColor:d,clientName:h,clientAddress:m,positionText:g}=a,v=`${l} "${h}" Ajoutée !`;return p.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm overflow-y-auto",children:p.jsx("div",{className:"min-h-full flex items-center justify-center p-4 py-8",children:p.jsxs(Le.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 mx-4 max-w-md w-full border border-gray-200 dark:border-gray-700 my-8",children:[p.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-10 w-8 h-8 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full flex items-center justify-center transition-colors","aria-label":"Fermer",children:p.jsx(_n,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})}),p.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-orange-100/50 to-transparent dark:from-orange-800/20 rounded-full -translate-y-16 translate-x-16"}),p.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-yellow-100/50 to-transparent dark:from-yellow-800/20 rounded-full translate-y-12 -translate-x-12"}),p.jsxs("div",{className:"relative text-center mb-8",children:[p.jsx("div",{className:"flex justify-center mb-6",children:p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-100 to-yellow-100 dark:from-orange-900/40 dark:to-yellow-900/40 rounded-2xl flex items-center justify-center border-2 border-orange-200 dark:border-orange-700 shadow-lg",children:p.jsx("div",{className:`${d} flex items-center`,children:c})}),p.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:p.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]})}),p.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3 leading-tight",children:v}),p.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Votre tournée a été mise à jour automatiquement"})]}),p.jsx("div",{className:"relative bg-gradient-to-br from-orange-50 via-orange-50 to-yellow-50 dark:from-orange-900/30 dark:via-orange-900/20 dark:to-yellow-900/30 rounded-2xl p-6 mb-8 border border-orange-200 dark:border-orange-700/50 shadow-inner",children:p.jsxs("div",{className:"flex items-start justify-between",children:[p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[p.jsx(um,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),p.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Nouvel arrêt ajouté"})]}),p.jsxs("div",{className:"pl-8",children:[p.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Position dans votre tournée :"}),p.jsx("p",{className:"text-base font-medium text-gray-800 dark:text-gray-200 leading-relaxed",children:g})]})]}),p.jsx("div",{className:"flex-shrink-0",children:p.jsx("div",{className:"px-3 py-2 bg-gradient-to-r from-orange-200 to-yellow-200 dark:from-orange-800 dark:to-yellow-800 rounded-xl shadow-sm",children:p.jsx("span",{className:"text-xs font-bold text-orange-900 dark:text-orange-100 uppercase tracking-wide",children:"Nouveau"})})})]})}),p.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 mb-8",children:p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx(cm,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide font-medium",children:"Adresse"}),p.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-200 mt-1",children:m})]})]})}),p.jsx(Tt,{onClick:e,className:"w-full bg-gradient-to-r from-orange-600 to-yellow-600 hover:from-orange-700 hover:to-yellow-700 text-white font-semibold py-4 rounded-2xl shadow-lg transform transition-all duration-200 hover:scale-105 hover:shadow-xl",children:p.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[p.jsx(Ls,{className:"w-5 h-5"}),p.jsx("span",{children:"Confirmer"})]})})]})})})},rD=({onComplete:r})=>{const[e,t]=j.useState(!0),[n,o]=j.useState(0);return j.useEffect(()=>{const a=setInterval(()=>{o(c=>c>=100?(clearInterval(a),100):c+2)},50),l=setTimeout(()=>{t(!1),setTimeout(r,600)},2500);return()=>{clearTimeout(l),clearInterval(a)}},[r]),p.jsx(Mi,{children:e&&p.jsxs(Le.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.6},className:"fixed inset-0 z-[200] bg-gradient-to-br from-orange-500 via-red-500 to-pink-600 flex items-center justify-center overflow-hidden",style:{width:"100vw",height:"100vh",maxWidth:"100%",maxHeight:"100%"},children:[p.jsx(Le.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.8,delay:.2,type:"spring",stiffness:100},className:"relative z-10 text-center mb-16",children:p.jsx(Le.h1,{className:"text-4xl md:text-6xl lg:text-7xl font-black text-white text-center",style:{textShadow:"0 0 20px rgba(255,255,255,0.5), 0 0 40px rgba(255,255,255,0.3)"},initial:{letterSpacing:"8px"},animate:{letterSpacing:"2px"},transition:{duration:1,delay:.5},children:"PROVENCE COURSES"})}),p.jsxs(Le.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},className:"absolute bottom-12 left-1/2 transform -translate-x-1/2 w-72 max-w-[90vw]",children:[p.jsx("div",{className:"mb-3 text-center",children:p.jsx("span",{className:"text-white/90 text-base font-medium",children:"Chargement..."})}),p.jsx("div",{className:"w-full bg-white/20 rounded-full h-3 overflow-hidden shadow-lg",children:p.jsx(Le.div,{className:"h-full bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full shadow-inner",initial:{width:"0%"},animate:{width:`${n}%`},transition:{duration:.1}})}),p.jsx("div",{className:"mt-2 text-center",children:p.jsxs("span",{className:"text-white/80 text-sm font-medium",children:[Math.round(n),"%"]})})]})]})})};class nD{metrics={memoryUsage:0,subscriptionsCount:0,errorCount:0,renderTime:0,networkLatency:0};errorLog=[];isMonitoring=!1;monitoringInterval;start(){this.isMonitoring||(console.log("📊 [PerformanceMonitor] Démarrage du monitoring"),this.isMonitoring=!0,this.monitoringInterval=setInterval(()=>{this.collectMetrics(),this.checkThresholds()},3e4),this.setupErrorListeners(),this.collectMetrics())}stop(){this.isMonitoring&&(console.log("📊 [PerformanceMonitor] Arrêt du monitoring"),this.isMonitoring=!1,this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=void 0))}collectMetrics(){try{if("memory"in performance){const t=performance.memory;this.metrics.memoryUsage=t.usedJSHeapSize/(1024*1024)}const e=performance.getEntriesByType("navigation")[0];if(e&&(this.metrics.renderTime=e.loadEventEnd-e.fetchStart),this.measureNetworkLatency(),window.subscriptionManager){const t=window.subscriptionManager.getStats();this.metrics.subscriptionsCount=t.activeSubscriptions}}catch(e){console.warn("⚠️ [PerformanceMonitor] Erreur collecte métriques:",e)}}async measureNetworkLatency(){try{const e=performance.now();await fetch("/favicon.ico",{method:"HEAD",cache:"no-cache"});const t=performance.now();this.metrics.networkLatency=t-e}catch{this.metrics.networkLatency=-1}}setupErrorListeners(){window.addEventListener("error",e=>{this.recordError(e.message,e.error?.stack)}),window.addEventListener("unhandledrejection",e=>{this.recordError(`Promise rejected: ${e.reason}`,e.reason?.stack)}),window.addEventListener("react-error",e=>{this.recordError(e.detail.message,e.detail.stack)})}recordError(e,t){this.metrics.errorCount++,this.metrics.lastError=e,this.errorLog.push({timestamp:Date.now(),error:e,stack:t}),this.errorLog.length>20&&this.errorLog.shift(),console.error("🚨 [PerformanceMonitor] Erreur enregistrée:",e),(this.metrics.memoryUsage>100||this.metrics.subscriptionsCount>10)&&Gn.logError({error_type:"memory",error_message:`Performance critique: ${e}`,error_stack:t,error_source:"PerformanceMonitor",user_action:"Monitoring automatique des performances",severity:"critical"})}checkThresholds(){const e=[];this.metrics.memoryUsage>100&&e.push(`Mémoire élevée: ${this.metrics.memoryUsage.toFixed(1)}MB`),this.metrics.subscriptionsCount>10&&e.push(`Trop de subscriptions: ${this.metrics.subscriptionsCount}`);const t=this.errorLog.filter(n=>Date.now()-n.timestamp<3e5);t.length>5&&e.push(`Erreurs fréquentes: ${t.length} en 5min`),this.metrics.networkLatency>5e3&&e.push(`Latence élevée: ${this.metrics.networkLatency.toFixed(0)}ms`),e.length>0&&(console.warn("⚠️ [PerformanceMonitor] Seuils critiques dépassés:",e),window.dispatchEvent(new CustomEvent("performance-warning",{detail:{warnings:e,metrics:this.metrics}})))}getMetrics(){return{...this.metrics,recentErrors:[...this.errorLog]}}getHealthReport(){const e=[],t=[];this.metrics.memoryUsage>150?(e.push("Consommation mémoire critique"),t.push("Redémarrer l'application")):this.metrics.memoryUsage>100&&(e.push("Consommation mémoire élevée"),t.push("Fermer les onglets inutiles")),this.errorLog.filter(a=>Date.now()-a.timestamp<6e5).length>10&&(e.push("Erreurs fréquentes"),t.push("Vérifier la connexion réseau")),this.metrics.subscriptionsCount>15&&(e.push("Trop de connexions temps réel"),t.push("Redémarrer l'application"));let o="healthy";return e.length>2||this.metrics.memoryUsage>150?o="critical":e.length>0&&(o="warning"),{status:o,issues:e,recommendations:t}}forceCleanup(){console.log("🧹 [PerformanceMonitor] Nettoyage forcé des ressources"),this.errorLog=this.errorLog.filter(e=>Date.now()-e.timestamp<3e5),"gc"in window&&window.gc(),window.dispatchEvent(new CustomEvent("force-cleanup"))}exportDebugData(){const e={timestamp:new Date().toISOString(),metrics:this.metrics,recentErrors:this.errorLog,healthReport:this.getHealthReport(),userAgent:navigator.userAgent,url:window.location.href};return JSON.stringify(e,null,2)}}const lp=new nD;lp.start();const sD=({children:r})=>{const[e,t]=j.useState(!1),[n,o]=j.useState(null),a=c=>{console.log("🚨 [GLOBAL] Modification détectée en temps réel:",{type:c.type,details:c.details,clientName:c.clientName,timestamp:c.timestamp,shipment:c.shipment,stop:c.stop}),c.type==="late_stop_added"?(console.log("🚨 [GLOBAL] Affichage de la modale late stop"),o(c),t(!0)):c.type==="new_shipment"?console.log("📦 [GLOBAL] Nouveau colis détecté:",{shipmentId:c.shipment?.id,clientName:c.clientName,shipmentType:c.shipment?.shipment_type}):c.type==="shipment_updated"&&console.log("📦 [GLOBAL] Colis mis à jour:",{shipmentId:c.shipment?.id,clientName:c.clientName})},l=()=>{t(!1),o(null)};return eD({onRouteModification:a,enabled:!0}),p.jsxs(p.Fragment,{children:[r,p.jsx(tD,{isOpen:e,onClose:l,modification:n})]})};function oD(){const{user:r,isLoading:e}=Ti(),[t,n]=j.useState(()=>{const o=new Date().toDateString();return localStorage.getItem("lastSplashDate")!==o});return Me.useEffect(()=>(r&&(lp.start(),console.log("📊 Monitoring des performances démarré")),()=>{lp.stop()}),[r]),Pw(),console.log("🎬 Animation check:",{user:!!r,showSplash:t,isLoading:e}),r&&t?(console.log("🚀 Affichage de l'animation splash"),p.jsx(rD,{onComplete:()=>{console.log("✅ Animation terminée"),n(!1);const o=new Date().toDateString();localStorage.setItem("lastSplashDate",o)}})):e?p.jsx("div",{className:"min-h-full flex items-center justify-center",children:p.jsx("div",{className:"text-lg",children:"Chargement..."})}):p.jsx(dm,{children:p.jsx(bf,{children:p.jsx(Wk,{children:p.jsxs($k,{children:[p.jsx(co,{path:"/login",element:r?p.jsx(Fh,{to:"/",replace:!0}):p.jsx(bf,{children:p.jsx(vI,{})})}),!1,p.jsxs(co,{path:"/*",element:r?p.jsx(bf,{children:p.jsx(OT,{children:p.jsx(sD,{children:p.jsx(QI,{})})})}):p.jsx(Fh,{to:"/login",replace:!0}),children:[p.jsx(co,{index:!0,element:p.jsx(SI,{})}),p.jsx(co,{path:"driver",element:p.jsx(Fh,{to:"/",replace:!0})}),p.jsx(co,{path:"driver/route",element:p.jsx(zI,{})}),p.jsx(co,{path:"driver/resume",element:p.jsx(qI,{})})]})]})})})})}function iD(r={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:n,onRegistered:o,onRegisteredSW:a,onRegisterError:l}=r;let c,d;const h=async(g=!0)=>{await d};async function m(){if("serviceWorker"in navigator){if(c=await ct(async()=>{const{Workbox:g}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:g}},[]).then(({Workbox:g})=>new g("/sw.js",{scope:"/",type:"classic"})).catch(g=>{l?.(g)}),!c)return;c.addEventListener("activated",g=>{(g.isUpdate||g.isExternal)&&window.location.reload()}),c.addEventListener("installed",g=>{g.isUpdate||n?.()}),c.register({immediate:e}).then(g=>{a?a("/sw.js",g):o?.(g)}).catch(g=>{l?.(g)})}}return d=m(),h}class aD{isCleaningUp=!1;async cleanupSession(e={}){if(this.isCleaningUp)return console.warn("⏳ [SessionCleanup] Nettoyage déjà en cours"),this.createErrorResult("Nettoyage en cours");const t=Date.now();this.isCleaningUp=!0;const n={clearMainAppStore:!1,clearLabToursStore:!1,clearLocalForage:!1,clearLocalStorage:!1,clearAuthStorage:!1,...e};console.log("🧹 [SessionCleanup] Début nettoyage avec options:",n);const o={success:!0,operations:{mainAppStore:!1,labToursStore:!1,localForage:0,localStorage:0,authStorage:!1},errors:[],duration:0};try{n.clearMainAppStore&&(o.operations.mainAppStore=await this.clearMainAppStore()),n.clearLabToursStore&&(o.operations.labToursStore=await this.clearLabToursStore()),n.clearLocalForage&&(o.operations.localForage=await this.clearLocalForageData()),n.clearLocalStorage&&(o.operations.localStorage=await this.clearLocalStorageData()),n.clearAuthStorage&&(o.operations.authStorage=await this.clearAuthStorage()),o.duration=Date.now()-t,o.success=o.errors.length===0,console.log("✅ [SessionCleanup] Nettoyage terminé:",{duration:o.duration,operations:o.operations,errors:o.errors.length})}catch(a){const l=a instanceof Error?a.message:"Erreur inconnue";o.errors.push(l),o.success=!1,console.error("❌ [SessionCleanup] Erreur lors du nettoyage:",a)}finally{this.isCleaningUp=!1}return o}async clearMainAppStore(){try{console.log("🏪 [SessionCleanup] Nettoyage MainAppStore...");const{useMainAppStore:e}=await ct(async()=>{const{useMainAppStore:o}=await Promise.resolve().then(()=>_u);return{useMainAppStore:o}},void 0),t=e.getState();if(t.sync.isSyncing||t.sync.pendingActions.length>0)return console.warn("⚠️ [SessionCleanup] Actions de sync en cours - nettoyage reporté"),!1;const n=t.route.driverRoute?{id:t.route.driverRoute.id,status:t.route.driverRoute.status}:null;return console.log("💾 [SessionCleanup] Backup route avant nettoyage:",n),t.clearStore(),console.log("✅ [SessionCleanup] MainAppStore nettoyé"),!0}catch(e){return console.error("❌ [SessionCleanup] Erreur nettoyage MainAppStore:",e),!1}}async clearLabToursStore(){try{console.log("🏥 [SessionCleanup] Nettoyage LabToursStore...");const{useLabToursStore:e}=await ct(async()=>{const{useLabToursStore:n}=await Promise.resolve().then(()=>Qj);return{useLabToursStore:n}},void 0);return e.getState().clearStore(),console.log("✅ [SessionCleanup] LabToursStore nettoyé"),!0}catch(e){return console.error("❌ [SessionCleanup] Erreur nettoyage LabToursStore:",e),!1}}async clearLocalForageData(){let e=0;try{console.log("💾 [SessionCleanup] Nettoyage LocalForage...");const t=["provenceCourses","lab-tours-storage","photos-cache"];for(const n of t)try{const o=Ds.createInstance({name:n}),a=await o.keys();console.log(`📦 [SessionCleanup] Instance ${n}: ${a.length} clés trouvées`),await o.clear(),e+=a.length,console.log(`✅ [SessionCleanup] Instance ${n} nettoyée`)}catch(o){console.warn(`⚠️ [SessionCleanup] Erreur instance ${n}:`,o)}console.log(`✅ [SessionCleanup] LocalForage nettoyé: ${e} éléments supprimés`)}catch(t){console.error("❌ [SessionCleanup] Erreur nettoyage LocalForage:",t)}return e}async clearLocalStorageData(){let e=0;try{console.log("🗂️ [SessionCleanup] Nettoyage localStorage...");const t=["main-app-storage","lab-tours-storage","lastSplashDate","theme-preference","debug-mode"];for(const n of t)localStorage.getItem(n)&&(localStorage.removeItem(n),e++,console.log(`🗑️ [SessionCleanup] Clé supprimée: ${n}`));console.log(`✅ [SessionCleanup] localStorage nettoyé: ${e} clés supprimées`)}catch(t){console.error("❌ [SessionCleanup] Erreur nettoyage localStorage:",t)}return e}async clearAuthStorage(){try{return console.log("🔐 [SessionCleanup] Nettoyage auth storage..."),localStorage.removeItem("auth-storage"),console.log("✅ [SessionCleanup] Auth storage nettoyé"),!0}catch(e){return console.error("❌ [SessionCleanup] Erreur nettoyage auth storage:",e),!1}}async analyzeDataSize(){const e={localForage:{},localStorage:{},estimatedTotalKB:0};try{const t=["provenceCourses","lab-tours-storage","photos-cache"];for(const o of t)try{const l=await Ds.createInstance({name:o}).keys();e.localForage[o]=l.length}catch{e.localForage[o]=0}for(let o=0;o<localStorage.length;o++){const a=localStorage.key(o);if(a){const l=localStorage.getItem(a);e.localStorage[a]=l?l.length:0}}const n=Object.values(e.localStorage).reduce((o,a)=>o+a,0);e.estimatedTotalKB=Math.round(n/1024),console.log("📊 [SessionCleanup] Analyse des données:",e)}catch(t){console.error("❌ [SessionCleanup] Erreur analyse:",t)}return e}async cleanupOnLogout(){return console.log("🚪 [SessionCleanup] Nettoyage complet déconnexion..."),this.cleanupSession({clearMainAppStore:!0,clearLabToursStore:!0,clearLocalForage:!0,clearLocalStorage:!0,clearAuthStorage:!1})}createErrorResult(e){return{success:!1,operations:{mainAppStore:!1,labToursStore:!1,localForage:0,localStorage:0,authStorage:!1},errors:[e],duration:0}}async cleanupObsoleteRoutes(){console.log("🕒 [SessionCleanup] Vérification des tournées obsolètes...");const e={success:!0,operations:{mainAppStore:!1,labToursStore:!1,localForage:0,localStorage:0,authStorage:!1},errors:[],duration:0},t=Date.now();try{const{useMainAppStore:n}=await ct(async()=>{const{useMainAppStore:h}=await Promise.resolve().then(()=>_u);return{useMainAppStore:h}},void 0),o=n.getState(),a=o.route.driverRoute;if(!a)return console.log("📍 [SessionCleanup] Aucune route active"),e;const l=o.route.routeInitializedAt||a.updated_at,c=Date.now()-new Date(l).getTime(),d=1440*60*1e3;if(console.log("📊 [SessionCleanup] Analyse âge route:",{routeId:a.id.slice(-8),initTime:l,ageHours:Math.round(c/(3600*1e3)),isObsolete:c>d}),c>d){console.warn(`⚠️ [SessionCleanup] Route obsolète détectée (${Math.round(c/(3600*1e3))}h) - nettoyage complet`);const h=await this.cleanupSession({clearMainAppStore:!0,clearLabToursStore:!0,clearLocalForage:!0,clearLocalStorage:!0,clearAuthStorage:!1});e.operations=h.operations,e.errors=h.errors,e.success=h.success,console.log("✅ [SessionCleanup] Route obsolète nettoyée - l'app se réinitialisera")}else console.log("✅ [SessionCleanup] Route encore valide - pas de nettoyage nécessaire")}catch(n){const o=n instanceof Error?n.message:"Erreur nettoyage obsolète";e.errors.push(o),e.success=!1,console.error("❌ [SessionCleanup] Erreur nettoyage routes obsolètes:",n)}return e.duration=Date.now()-t,e}startObsoleteRouteMonitoring(){console.log("🚀 [SessionCleanup] Démarrage surveillance routes obsolètes"),this.cleanupObsoleteRoutes(),setInterval(()=>{this.cleanupObsoleteRoutes()},3600*1e3)}getStatus(){return{isCleaningUp:this.isCleaningUp,version:"1.3.5-complete-cleanup"}}}const tS=new aD,lD=Object.freeze(Object.defineProperty({__proto__:null,sessionCleanupService:tS},Symbol.toStringTag,{value:"Module"}));iD({onNeedRefresh(){console.log("🔄 Nouvelle version détectée - Mise à jour iOS optimisée..."),setTimeout(()=>{/iPad|iPhone|iPod/.test(navigator.userAgent)&&"caches"in window?caches.keys().then(r=>{Promise.all(r.map(e=>caches.delete(e))).then(()=>location.reload()).catch(()=>location.reload())}):location.reload()},1e3)},onOfflineReady(){console.log("✅ L'application est prête pour une utilisation hors ligne"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&console.log("🍎 Mode hors ligne iOS activé")},onRegistered(r){console.log("🚀 Service Worker enregistré");const t=/iPad|iPhone|iPod/.test(navigator.userAgent)?6e4:3e4,n=setInterval(()=>{navigator.onLine&&r?.update().catch(o=>{console.warn("⚠️ Erreur vérification mise à jour:",o)})},t);window.addEventListener("beforeunload",()=>{clearInterval(n)})},onRegisterError(r){console.error("❌ Erreur lors de l'enregistrement du Service Worker:",r),/iPad|iPhone|iPod/.test(navigator.userAgent)&&console.log("🍎 Fallback iOS - Application sans Service Worker")}});document.body.classList.add("preload");Yu.startAutoCheck();tS.startObsoleteRouteMonitoring();const wf=Yu.getUpdateStats();console.log("📱 Application PWA démarrée:",{version:wf.currentVersion,derniereVerification:wf.lastCheck,verificationAutomatique:wf.autoCheckActive,nettoyageRoutesObsoletes:"activé"});window.addEventListener("error",r=>{console.error("🚨 [Global] Erreur JavaScript non capturée:",r.error),Gn.logJavaScriptError(r.error||new Error(r.message),"GlobalErrorHandler","Erreur JavaScript non capturée")});window.addEventListener("unhandledrejection",r=>{console.error("🚨 [Global] Promise rejetée non gérée:",r.reason);const e=r.reason instanceof Error?r.reason:new Error(String(r.reason));Gn.logJavaScriptError(e,"GlobalPromiseHandler","Promise rejetée non gérée")});H_.createRoot(document.getElementById("root")).render(p.jsx(Me.StrictMode,{children:p.jsx(oD,{})}));setTimeout(()=>{document.body.classList.remove("preload")},100);export{ct as _,K2 as a,wi as f,Sl as g,Ds as l,Oe as s,et as u};
